<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>安全性测试（一）安全性测试的基本概念</title>
      <link href="/2021/10/15/%E5%AE%89%E5%85%A8%E6%80%A7%E6%B5%8B%E8%AF%9501/"/>
      <url>/2021/10/15/%E5%AE%89%E5%85%A8%E6%80%A7%E6%B5%8B%E8%AF%9501/</url>
      <content type="html"><![CDATA[<p>软件因为漏洞，导致产品的数据泄露、功能受到影响和系统被入侵等危害。安全测试就是为了发现这些问题，并给予一定的安全评估。<br>本文章主要介绍如何进行软件的安全性测试。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="安全方面"><a href="#安全方面" class="headerlink" title="安全方面"></a>安全方面</h3><ul><li>应用程序层的安全<ul><li>应用程序本身的安全性</li><li>应用程序的数据安全</li></ul></li><li>操作系统的安全</li><li>网络的安全</li></ul><h3 id="安全测试的要求"><a href="#安全测试的要求" class="headerlink" title="安全测试的要求"></a>安全测试的要求</h3><ol><li>熟悉常见漏洞、逻辑漏洞的原理和检测方式</li><li>较强编程能力，能使用脚本或者安全工具检测漏洞</li><li>做好安全评估</li></ol><h4 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h4><h5 id="外部攻击方式"><a href="#外部攻击方式" class="headerlink" title="外部攻击方式"></a>外部攻击方式</h5><table><thead><tr><th style="text-align:center">种类</th><th style="text-align:center">类型</th><th>简单描述</th></tr></thead><tbody><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">暴力破解</td><td>利用密码字典循环去破解密码</td></tr><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">SQL注入</td><td>注入攻击漏洞,这些攻击发生在当不可信的SQL语句作为命令或者查询语句的一部分,被发送给解释器的时候。攻击者发送的恶意数据可以欺骗解释器,以执行计划外的命令或者在未被恰当授权时访问数据。</td></tr><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">XPath注入</td><td>XPath注入攻击是指利用XPath 解析器的松散输入和容错特性，能够在URL、表单或其它信息上附带恶意的XPath 查询代码，以获得权限信息的访问权并更改这些信息。XPath注入攻击是针对Web服务应用新的攻击方法，它允许攻击者在事先不知道XPath查询相关知识的情况下，通过XPath查询得到一个XML文档的完整内容。</td></tr><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">不安全的加密存储</td><td>未对需要保护的数据进行加密或者加密算法太弱都是不安全的加密存储</td></tr><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">敏感信息泄露</td><td>许多Web应用程序没有正确保护敏感数据,如信用卡、税务ID和身份验证凭据。攻击者可能会窃取或篡改这些弱保护的数据以进行信用卡诈骗、身份窃取或其他犯罪。敏感数据值需额外的保护,比如在存放或在传输过程中的加密,以及在与浏览器交换时进行特殊的预防措施。</td></tr><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">XSS跨站脚本攻击</td><td>恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意用户的特殊目的。</td></tr><tr><td style="text-align:center">通用漏洞</td><td style="text-align:center">CSRF跨站请求伪造</td><td>攻击者通过调用第三方网站的恶意脚本来伪造请求，在用户不知情的情况下，攻击者强行递交构造的具有“操作行为”的数据包。（测试对象：网页中可进行输入的表单）</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">篡改输入</td><td>利用一些命令或者工具等篡改一些字段的值，从而达到恶意的效果。例如，篡改商品的单价和数量等。</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">不安全的直接对象引用</td><td>在具有导出/下载功能的页面参数中修改内容，WEB服务器便会导出/下载程序源代码或者指定文件（测试对象：URL中有用户参数的地址，可以进行下载操作的地址）或者当开发人员暴露一个对内部实现对象的引用时,例如,一个文件、目录或者数据库密匙, 就会产生一个不安全的直接对象引用。在没有访问控制检测或其他保护时,攻击者会操控这些引用去访问未授权数据</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">功能级访问控制缺失</td><td>大多数Web应用程序的功能在UI页面显示之前,会验证功能级别的访问权限。但是,应用程序需要在每个功能被访问时在服务器端执行相同的访问控制检查。如果请求没有被验证,攻击者能够伪造请求从而在未经适当授权时访问功能。</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">缓冲区溢出</td><td>当计算机向缓冲区内填充数据位数时超过了缓冲区本身的容量，溢出的数据覆盖在合法数据上。</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">失效的身份验证机制</td><td>只对首次传递的Cookie加以验证，程序没有持续对Cookie中内含信息验证比对，攻击者可以修改Cookie中的重要信息以提升权限进行网站数据存取或是冒用他人账号取得个人私密资料（测试对象：可以进行传参的URL，提交请求页面，登录后的Cookie）</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">会话管理劫持</td><td>检测Web应用程序会话机制是否存在安全隐患，能否被非法利用（会话劫持，伪装成合法用户）而影响Web应用程序的安全。</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">没有限制URL访问</td><td>系统已经对URL的访问做了限制，但这种限制却实际并没有生效。攻击者能够很容易的就伪造请求直接访问未被授权的页面（测试对象：需要身份验证的页面）</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">传输层保护不足</td><td>在身份验证过程中没有使用SSL/TLS，因此暴露传输数据和会话ID，被攻击者截听。它们有时还会使用过期或者配置不正确的证书。（测试对象：登录模块）</td></tr><tr><td style="text-align:center">逻辑漏洞</td><td style="text-align:center">未验证的重定向（redirectUrl）和转发</td><td>攻击者可以引导用户访问他们所要用户访问的站点。而最终造成的后果，重定向会使得用户访问钓鱼网站或是恶意网站。</td></tr><tr><td style="text-align:center">配置漏洞</td><td style="text-align:center">安全配置错误</td><td>Config中的链接字符串以及用户信息，邮件，数据存储信息等都需要加以保护，如果没有进行保护，那么就是安全配置出现了问题。</td></tr><tr><td style="text-align:center">APP漏洞</td><td style="text-align:center">逆向反编译</td><td>通过提供的安装包或者客户端，反编译出原代码获取信息</td></tr><tr><td style="text-align:center">系统漏洞</td><td style="text-align:center">LDAP注入</td><td>利用LDAP注入技术的关键在于控制用于目录搜索服务的过滤器。使用这些技术，攻击者可能直接访问LDAP目录树下的数据库，及重要的公司信息。情况还可能比这更严重，因为许多应用的安全性依赖于基于LDAP目录的单点登录环境。</td></tr><tr><td style="text-align:center">系统漏洞</td><td style="text-align:center">使用含有已知漏洞的组件</td><td>组件,比如:库文件、框架和其他软件模块,几乎总是以全部的权限运行。如果使用含有已知漏洞的组件,这种攻击可以造成更为严重的数据丢失或服务器接管。应用程序使用带有已知漏洞的组件会破坏应用程序防御系统,并使一系列可能的攻击和影响成为可能。危害比较严重</td></tr><tr><td style="text-align:center">系统漏洞</td><td style="text-align:center">操作系统漏洞</td><td>利用操作系统的漏洞，引发系统故障或者窃取信息</td></tr><tr><td style="text-align:center">网络</td><td style="text-align:center">DDoS</td><td>流量攻击，一种针对网络带宽的攻击，即大量攻击包导致网络带宽被阻塞，合法网络包被虚假的攻击包淹没而无法到达主机；一种是为资源耗尽攻击，主要是针对服务器主机的攻击，即通过大量攻击包导致主机的内存被耗尽或CPU被内核及应用程序占完而造成无法提供网络服务</td></tr></tbody></table><h6 id="内部攻击方式"><a href="#内部攻击方式" class="headerlink" title="内部攻击方式"></a>内部攻击方式</h6><p>社会工程学：通过对人的习惯、心里和数据分析，伪装或者欺骗内部人员获取信息。</p><h4 id="检测"><a href="#检测" class="headerlink" title="检测"></a>检测</h4><p>使用专业的具有特定功能的安全扫描软件来寻找潜在的漏洞，将已经发生的缺陷纳入缺陷库，然后通过自动化测试方法来使用自动化缺陷库进行轰炸测试。</p><h5 id="安全测试工具"><a href="#安全测试工具" class="headerlink" title="安全测试工具"></a>安全测试工具</h5><ul><li><p><a href="https://www.kali.org/" target="_blank" rel="noopener">Kali Linux</a>：基于Debian的Linux发行版， 设计用于数字取证操作系统。Kali Linux预装了许多渗透测试软件，包括nmap 、Wireshark 、msfvenom、John the Ripper，以及Aircrack-ng，超过300个渗透测试工具，永久免费，开源.</p></li><li><p><a href="https://nmap.org/" target="_blank" rel="noopener">Nmap</a>:一个网络连接端扫描软件，用来扫描网上电脑开放的网络连接端。确定哪些服务运行在哪些连接端，并且推断计算机运行哪个操作系统（这是亦称 fingerprinting）。</p><ul><li><a href="https://blog.csdn.net/m0_37268841/article/details/80404613" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="http://www.openvas.org/" target="_blank" rel="noopener">msfvenom</a>:msfpayload,msfencode的结合体，可利用msfvenom生成木马程序,并在目标机上执行,在本地监听上线。</p><ul><li><a href="https://www.offensive-security.com/metasploit-unleashed/msfvenom/" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="https://www.ibm.com/supply-chain/hcl-divestiture" target="_blank" rel="noopener">AppScan</a>:一款安全漏洞扫描工具，支持Web和移动，现在安全测试做漏洞扫描非常适用，它相当于是”探索”和”测试”的过程，最终生成很直观的测试报告，有助于研发人员分析和修复通常安全测试工具用这个，扫描一些安全漏洞，用起来比较方便，网上资料比较多，适合很多测试同学用，资料广阔，大家可以尝试下。</p><ul><li><a href="https://www.cnblogs.com/benpao1314/p/8065720.html" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="https://portswigger.net/burp/" target="_blank" rel="noopener">Burp Suite</a>:一款信息安全从业人员必备的集 成型的渗透测试工具，它采用自动测试和半自动测试的方式，包含了 Proxy,Spider,Scanner,Intruder,Repeater,Sequencer,Decoder,Comparer等工具模块；Proxy功能可以拦截HTTP/S的代理服务器（手机和web）；Spide功能-智能感应的网络爬虫；Intruder功能可以对web应用程序进行自动化攻击等，非常适合做安全测试。通 过拦截HTTP/HTTPS的web数据包，充当浏览器和相关应用程序的中间人，进行拦截、修改、重放数据包进行测试，是web安全人员的一把必备的瑞士军刀。</p><ul><li><a href="https://www.cnblogs.com/nieliangcai/p/6692296.html" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="https://www.acunetix.com/" target="_blank" rel="noopener">Acunetix</a>:一款网络漏洞扫描软件，它可以检测网络的安全漏洞。</p></li><li><p><a href="http://sqlmap.org/" target="_blank" rel="noopener">sqlmap</a>:一个开源的渗透测试工具，可以用来进行自动化检测，利用SQL注入漏洞，获取数据库服务器的权限。它具有功能强大的检测引擎,针对各种不同类型数据库的渗透测试的功能选项，包括获取数据库中存储的数据，访问操作系统文件甚至可以通过外带数据连接的方式执行操作系统命令。</p><ul><li><a href="https://github.com/sqlmapproject/sqlmap/zipball/master" target="_blank" rel="noopener">下载地址</a></li><li><a href="https://asciinema.org/a/46601" target="_blank" rel="noopener">演示视频</a></li><li><a href="http://www.youtube.com/user/inquisb/videos" target="_blank" rel="noopener">教程</a></li><li><a href="https://www.freebuf.com/sectool/164608.html" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="http://www.openvas.org/" target="_blank" rel="noopener">OpenVAS</a>:一个开放式漏洞评估系统，也可以说它是一个包含着相关工具的网络扫描器。其核心部件是一个服务器，包括一套网络漏洞测试程序，可以检测远程系统和应用程序中的安全问题。OpenVas服务端只允许安装在Linux系统上，接下来我们来介绍一下使用二进制搭建OpenVas的方法以及基础的使用。</p><ul><li><a href="https://www.freebuf.com/column/158357.html" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="http://www.fortify.net/README.html" target="_blank" rel="noopener">fortify</a>:静态代码检查工具</p><ul><li><a href="https://www.freebuf.com/sectool/95683.html" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="https://www.tenable.com/downloads/nessus" target="_blank" rel="noopener">nessus</a>:一款号称是世界上最流行的漏洞扫描程序，全世界有超过75000个组织在使用它。该工具提供完整的电脑漏洞扫描服务，并随时更新其漏洞数据库。Nessus不同于传统的漏洞扫描软件，Nessus可同时在本机或远端上遥控，进行系统的漏洞分析扫描。</p><ul><li><a href="https://www.cnblogs.com/cheyunhua/p/8084459.html" target="_blank" rel="noopener">参考</a></li></ul></li><li><p><a href="https://www.fujieace.com/kali-linux/owasp-zed-zap.html" target="_blank" rel="noopener">zap</a>:OWASP Zed攻击代理（ZAP）是世界上最受欢迎的免费安全审计工具之一，由数百名国际志愿者*积极维护。它可以帮助您在开发和测试应用程序时自动查找Web应用程序中的安全漏洞。</p></li><li><p><a href="https://www.acunetix.com/vulnerability-scanner/" target="_blank" rel="noopener">Acunetix Web Vulnerability Scanner（简称AWVS）</a>:是一款知名的网络漏洞扫描工具，它通过网络爬虫测试你的网站安全，检测流行安全漏洞</p></li></ul><h5 id="测试场景设计"><a href="#测试场景设计" class="headerlink" title="测试场景设计"></a>测试场景设计</h5><ul><li><a href="正向安全测试">正向安全测试</a></li><li><a href="反向安全测试">反向安全测试</a></li></ul><p>正向测试过程是以测试空间为依据寻找缺陷和漏洞，反向测试过程则是以已知的缺陷空间为依据去寻找软件中是否会发生同样的缺陷和漏洞，两者各有其优缺点。反向测试过程主要的一个优点是成本较低，只要验证已知的可能发生的缺陷即可，但缺点是测试不完善，无法将测试空间覆盖完整，无法发现未知的攻击手段。正向测试过程的优点是测试比较充分，但工作量相对来说较大。因此，对安全性要求较低的软件，一般按反向测试过程来测试即可，对于安全性要求较高的软件，应以正向测试过程为主，反向测试过程为辅。</p><h6 id="正向安全测试"><a href="#正向安全测试" class="headerlink" title="正向安全测试"></a>正向安全测试</h6><p>为了规避反向设计原则所带来的测试不完备性，需要一种正向的测试方法来对软件进行比较完备的测试，使测试过的软件能够预防未知的攻击手段和方法。</p><ol><li>先标识测试空间。对测试空间的所有的可变数据进行标识，由于进行安全性测试的代价高昂，其中要重点对外部输入层进行标识。例如，需求分析、概要设计、详细设计、编码这几个阶段都要对测试空间进行标识，并建立测试空间跟踪矩阵。</li><li>精确定义设计空间。重点审查需求中对设计空间是否有明确定义，和需求牵涉到的数据是否都标识出了它的合法取值范围。在这个步骤中，最需要注意的是精确二字，要严格按照安全性原则来对设计空间做精确的定义。</li><li>标识安全隐患。根据找出的测试空间和设计空间以及它们之间的转换规则，标识出哪些测试空间和哪些转换规则可能存在安全隐患。例如,测试空间愈复杂，即测试空间划分越复杂或可变数据组合关系越多也越不安全。还有转换规则愈复杂，则出问题的可能性也愈大，这些都属于安全隐患。</li><li>建立和验证入侵矩阵。安全隐患标识完成后，就可以根据标识出来的安全隐患建立入侵矩阵。列出潜在安全隐患，标识出存在潜在安全隐患的可变数据，和标识出安全隐患的等级。其中对于那些安全隐患等级高的可变数据，必须进行详尽的测试用例设计。</li></ol><h6 id="反向安全测试"><a href="#反向安全测试" class="headerlink" title="反向安全测试"></a>反向安全测试</h6><p>大部分软件的安全测试都是依据缺陷空间反向设计原则来进行的，即事先检查哪些地方可能存在安全隐患，然后针对这些可能的隐患进行测试。因此，反向测试过程是从缺陷空间出发，建立缺陷威胁模型，通过威胁模型来寻找入侵点，对入侵点进行已知漏洞的扫描测试。好处是可以对已知的缺陷进行分析，避免软件里存在已知类型的缺陷，但是对未知的攻击手段和方法通常会无能为力。</p><ol><li>建立缺陷威胁模型。建立缺陷威胁模型主要是从已知的安全漏洞入手，检查软件中是否存在已知的漏洞。建立威胁模型时，需要先确定软件牵涉到哪些专业领域，再根据各个专业领域所遇到的攻击手段来进行建模。</li><li>寻找和扫描入侵点。检查威胁模型里的哪些缺陷可能在本软件中发生，再将可能发生的威胁纳入入侵点矩阵进行管理。如果有成熟的漏洞扫描工具，那么直接使用漏洞扫描工具进行扫描，然后将发现的可疑问题纳入入侵点矩阵进行管理。</li><li>入侵矩阵的验证测试。创建好入侵矩阵后，就可以针对入侵矩阵的具体条目设计对应的测试用例，然后进行测试验证。</li></ol><h5 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h5><ol><li>静态的代码安全测试：主要通过对源代码进行安全扫描，根据程序中数据流、控制流、语义等信息与其特有软件安全规则库进行匹对，从中找出代码中潜在的安全漏洞。静态的源代码安全测试是非常有用的方法，它可以在编码阶段找出所有可能存在安全风险的代码，这样开发人员可以在早期解决潜在的安全问题。而正因为如此，静态代码测试比较适用于早期的代码开发阶段，而不是测试阶段。</li><li>动态的渗透测试：渗透测试也是常用的安全测试方法。是使用自动化工具或者人工的方法模拟黑客的输入，对应用系统进行攻击性测试，从中找出运行时刻所存在的安全漏洞。这种测试的特点就是真实有效，一般找出来的问题都是正确的，也是较为严重的。但渗透测试一个致命的缺点是模拟的测试数据只能到达有限的测试点，覆盖率很低。</li><li>程序数据扫描。一个有高安全性需求的软件，在运行过程中数据是不能遭到破坏的，否则就会导致缓冲区溢出类型的攻击。数据扫描的手段通常是进行内存测试，内存测试可以发现许多诸如缓冲区溢出之类的漏洞，而这类漏洞使用除此之外的测试手段都难以发现。例如，对软件运行时的内存信息进行扫描，看是否存在一些导致隐患的信息，当然这需要专门的工具来进行验证，手工做是比较困难的。</li></ol><h5 id="如何练习"><a href="#如何练习" class="headerlink" title="如何练习"></a>如何练习</h5><ol><li>[搭建一个靶机])(<a href="https://www.freebuf.com/sectool/102661.html" target="_blank" rel="noopener">https://www.freebuf.com/sectool/102661.html</a>)</li><li><a href="https://www.freebuf.com/articles/web/123779.html" target="_blank" rel="noopener">进行攻击练习</a></li><li>修复漏洞，再次测试攻击，查看结果是否有效</li></ol><h4 id="安全性评估"><a href="#安全性评估" class="headerlink" title="安全性评估"></a>安全性评估</h4><p>当做完安全性测试后，软件是否能够达到预期的安全程度呢?这是安全性测试人员最关心的问题，因此需要建立对测试后的安全性评估机制。一般从以下两个方面进行评估。</p><ol><li>安全性缺陷数据评估。如果发现软件的安全性缺陷和漏洞越多，可能遗留的缺陷也越多。进行这类评估时，必须建立基线数据作为参照，否则评估起来没有依据就无法得到正确的结论。</li><li>采用漏洞植入法来进行评估。漏洞植入法和可靠性测试里的故障插入测试是同一道理，只不过这里是在软件里插入一些有安全隐患的问题。采用漏洞植入法时，先让不参加安全测试的特定人员在软件中预先植入一定数量的漏洞，最后测试完后看有多少植入的漏洞被发现，以此来评估软件的安全性测试做得是否充分。</li></ol><h3 id="安全建议"><a href="#安全建议" class="headerlink" title="安全建议"></a>安全建议</h3><h4 id="层面"><a href="#层面" class="headerlink" title="层面"></a>层面</h4><ul><li>管理层<ul><li>技术：建立高效统一的安全管理和权限划分，如集中授权、认证、用户和日志管理等</li><li>非技术：流程化、制度化去加强安全意识和规范</li></ul></li><li>应用层<ul><li>业务安全：防止恶意攻击</li><li>应用设计安全：认证、口令策略、访问控制和授权、加密、会话管理、日志、数据包含和运行安全等</li><li>应用编码安全：输入校验、输出编码、文件上传下载、异常处理、安全API等</li></ul></li><li>系统层：操作系统、数据库系统、中间间系统等<ul><li>安全加固：最小化安装、最小化服务、最强口令策略、内核参数优化等</li><li>恶意软件防护：防病毒、主机防火墙等</li></ul></li><li>网络层：网络设备保护、网络拓朴安全设计、网络边界保护（如防火墙）、网络数据加密（如VPN）、网络安全检测（如IDS\IPS）等</li></ul><h4 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h4><ol><li>最小授权：只授予每个用户/程序在执行操作时所必须的最小特权。这样可以限制事故、错误、攻击带来的危害，减小特权程序之间潜在的相互影响。</li><li>发生故障优先保证安全：当系统发生故障时，对任何请求默认应加以拒绝。</li><li>深入防御原则：采用多层安全机制，这个概念范围比较大。比如在表单中的字段校验不光要在页面校验，还要在后台有相应的校验机制；比如在信任区、飞信任区之间二次部署防火墙。</li><li>权限分离：比如禁止root用户远程登录、多重身份校验登陆等；</li><li>系统架构设计和代码尽可能简洁，越复杂的系统，bug越多</li><li>共享事务的数量和使用尽可能少，毕竟单独控制一个操作比并行控制两个过程更容易一些；</li><li>安全保护机制不能依赖于攻击者对系统实现过程的无知、而只依赖于像口令/密钥这样较容易改变的东西。</li><li>不信任原则：要严格限制用户、外部部件的信任度，要假设他们都是不安全的。</li><li>对受保护的对象的每一个访问都要经过检查。</li><li>心理接受程度：不能通过限制、甚至组织用户访问系统资源来阻止攻击，但可以考虑引入少量可接受的使用障碍。</li><li>不要等开发人员编码完成才开始进行安全测试，可以负责任的将，65%以上的安全漏洞都是发生在架构设计阶段，因此要积极参与到架构设计评审活动中，将一些低中级别的隐患扼杀在摇篮中。</li></ol>]]></content>
      
      
        <tags>
            
            <tag> 安全 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>App测试(四) Android Studio 连接手机进行调试</title>
      <link href="/2021/09/15/App%E6%B5%8B%E8%AF%9504/"/>
      <url>/2021/09/15/App%E6%B5%8B%E8%AF%9504/</url>
      <content type="html"><![CDATA[<p>Android Studio 是谷歌推出的一个Android集成开发工具，基于IntelliJ IDEA. 类似 Eclipse ADT，Android Studio 提供了集成的 Android 开发工具用于开发和调试。<br>文章介绍Android Studio的基本使用。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><h4 id="创建第一个项目"><a href="#创建第一个项目" class="headerlink" title="创建第一个项目"></a>创建第一个项目</h4><ul><li>进入AndroidStudio官网</li><li>点击Download进行下载</li></ul><p><img src="/image/App测试04/App测试04_001.png" alt=""></p><ul><li>创建第一个项目<br>如果用kotlin 开发就选择【Empty Compose Activity】</li></ul><p><img src="/image/App测试04/App测试04_002.png" alt=""></p><p><img src="/image/App测试04/App测试04_003.png" alt=""></p><ul><li>【tools】-&gt;【SDK Manager】-&gt;【SDK Tools】 下载Android Emulator 和Android SDK Platform-Tools</li></ul><p><img src="/image/App测试04/App测试04_004.png" alt=""></p><ul><li>可以先试试AS自带的模拟器</li></ul><p><img src="/image/App测试04/App测试04_005.png" alt=""></p><ul><li>点击create device</li></ul><p><img src="/image/App测试04/App测试04_006.png" alt=""></p><ul><li>选择一种型号的设备下载</li></ul><p><img src="/image/App测试04/App测试04_007.png" alt=""></p><ul><li>然后运行项目就可以看到效果啦</li></ul><p><img src="/image/App测试04/App测试04_008.png" alt=""></p><h4 id="连接手机进行调试"><a href="#连接手机进行调试" class="headerlink" title="连接手机进行调试"></a>连接手机进行调试</h4><h5 id="ADB环境配置"><a href="#ADB环境配置" class="headerlink" title="ADB环境配置"></a>ADB环境配置</h5><ul><li>查看自己Android Studio配置的sdk路径【tools】-&gt;【SDK Manager】比如我的路径是C:\Users\Admin\AppData\Local\Android\Sdk</li></ul><p><img src="/image/App测试04/App测试04_009.png" alt=""></p><ul><li>配置环境变量：右键【我的电脑】-&gt;【高级系统设置】-&gt;【环境变量】，新建变量【Android_Home】</li></ul><p><img src="/image/App测试04/App测试04_010.png" alt=""></p><ul><li>然后在Path变量中，新增加一项%Android_Home%(即为相对路径)：</li></ul><p><img src="/image/App测试04/App测试04_011.png" alt=""></p><ul><li>打开cmd窗口，输入adb, 出现如下图就说明安装好啦</li></ul><p><img src="/image/App测试04/App测试04_012.png" alt=""></p><h5 id="配置USB-Driver"><a href="#配置USB-Driver" class="headerlink" title="配置USB Driver"></a>配置USB Driver</h5><ul><li>下载Google USB Driver【tools】-&gt;【SDK Manager】-&gt;【SDK Tools】</li></ul><p><img src="/image/App测试04/App测试04_013.png" alt=""></p><ul><li>将手机用USB线连接到电脑，打开设备管理器，找到你的手机</li></ul><p><img src="/image/App测试04/App测试04_014.png" alt=""></p><ul><li>右键点击你的手机名称，选择【更新驱动设备】</li></ul><p><img src="/image/App测试04/App测试04_015.png" alt=""></p><ul><li>然后再选择【浏览我的电脑以查找驱动程序】</li></ul><p><img src="/image/App测试04/App测试04_016.png" alt=""></p><ul><li>找到usb_driver的安装路径(默认情况在SDK文件路径下的extras\google\usb_driver),最后点击下一页完成更新就好啦</li></ul><p><img src="/image/App测试04/App测试04_017.png" alt=""></p><ul><li><p>打开手机的开发者模式（不同手机不一样，自行百度，这里附上华为nova系列）</p><ul><li>安卓系统的参考这篇文章：<a href="https://www.iefans.net/info/v944581.html" target="_blank" rel="noopener">https://www.iefans.net/info/v944581.html</a></li><li>鸿蒙系统:【设置】-&gt; 【系统和更新】-&gt;【开发人员选项】-&gt;【USB调试】,选择允许USB调试</li></ul><p><img src="/image/App测试04/App测试04_018.png" alt=""></p></li></ul><ul><li>连接手机调试（USB线）,显示手机设备</li></ul><p><img src="/image/App测试04/App测试04_019.png" alt=""></p><ul><li>然后选择手机，点击运行，就可以在手机上调试</li></ul><p><img src="/image/App测试04/App测试04_020.png" alt=""></p><p><img src="/image/App测试04/App测试04_021.png" alt=""></p><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><h4 id="查看性能"><a href="#查看性能" class="headerlink" title="查看性能"></a>查看性能</h4><p>需要app开启debug模式</p><ul><li>根据以下操作步骤选择对应链接的手机，并且手机上启动APP</li></ul><p><img src="/image/App测试04/App测试04_022.png" alt=""></p><ul><li>此时进行app操作即可查看以下信息</li></ul><p><img src="/image/App测试04/App测试04_023.png" alt=""></p><ul><li>在页面内点击任意一个位置 进入到具体信息页面</li></ul><p><img src="/image/App测试04/App测试04_024.png" alt=""></p><h4 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h4><p>需要app开启debug模式</p><p><img src="/image/App测试04/App测试04_025.png" alt=""></p><p><img src="/image/App测试04/App测试04_026.png" alt=""></p><h4 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h4><p><img src="/image/App测试04/App测试04_027.png" alt=""></p><h4 id="设置无线连接"><a href="#设置无线连接" class="headerlink" title="设置无线连接"></a>设置无线连接</h4><ol><li>手机和电脑连入同一个无线网络</li><li>手机连接电脑，在命令行输入adb tcpip 5555</li><li>断开连接线，命令行输入adb connect 10.3.6.59(手机的IP地址)</li><li>提示连接成功后，可以进行无线调试了</li></ol><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><h4 id="Failed-to-find-Build-Tools-revision-30-0-3"><a href="#Failed-to-find-Build-Tools-revision-30-0-3" class="headerlink" title="Failed to find Build Tools revision 30.0.3"></a>Failed to find Build Tools revision 30.0.3</h4><p>取消然后再选中Show package detail，然后下载30.0.3<br><img src="/image/App测试04/App测试04_028.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> app </tag>
            
            <tag> AndroidStudio </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>App测试(三) Monkey的基本使用</title>
      <link href="/2021/08/15/App%E6%B5%8B%E8%AF%9503/"/>
      <url>/2021/08/15/App%E6%B5%8B%E8%AF%9503/</url>
      <content type="html"><![CDATA[<p>Monkey 测试是通过向系统发送伪随机的用户事件流（如按键输入、触摸屏输入、手势输入等），实现对应用程序客户端的稳定性测试；<br>通俗来说，Monkey 测试即“猴子测试”，是指像猴子一样，不知道程序的任何用户交互方面的知识，就对界面进行无目的、乱点乱按的操作；<br>Monkey 测试是一种为了测试软件的稳定性、健壮性的快速有效的方法；<br>Monkey 程序是 Android 系统自带的，由 Java 语言写成，在 Android 文件系统中的存放路径是： /system/framework/monkey.jar；<br>Monkey 程序需要通过 adb 来运行。<br>文章介绍Monkey的基本使用。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、monkey启动步骤"><a href="#一、monkey启动步骤" class="headerlink" title="一、monkey启动步骤"></a>一、monkey启动步骤</h3><ol><li>连接设备</li><li>adb shell</li><li>cd /system/bin</li><li>输入monkey</li></ol><h3 id="二、关闭monkey"><a href="#二、关闭monkey" class="headerlink" title="二、关闭monkey"></a>二、关闭monkey</h3><ol><li>adb shell ps 查看进程</li><li>查出 com.android.commands.monkey 进程ID</li><li>adb shell kill pid 杀死monkey进程</li></ol><h3 id="三、monkey-命令"><a href="#三、monkey-命令" class="headerlink" title="三、monkey 命令"></a>三、monkey 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey [options]  &lt;event-count&gt;</span><br></pre></td></tr></table></figure><ul><li>-options 指monkey传入的参数，不指定则为无反馈启动，把事件任意发送到目标环境的全部包中</li><li>-\<event-count> 指随机发送时间数。如输入100就执行100个随机事件。</event-count></li></ul><h3 id="四、操作事件"><a href="#四、操作事件" class="headerlink" title="四、操作事件"></a>四、操作事件</h3><h4 id="1-触摸事件"><a href="#1-触摸事件" class="headerlink" title="1.触摸事件"></a>1.触摸事件</h4><p>按下抬起的操作，可通过–pct–touch 配置事件百分比（是由一组ACTION_DOWN和ACTION_UP）组成</p><h4 id="2-手势事件"><a href="#2-手势事件" class="headerlink" title="2.手势事件"></a>2.手势事件</h4><p>指按下、移动、抬起、直线滑动的操作。通过–pct–motion配置百分比（由ACTION_DOWN和ACTION_MOVE和ACTION_UP组成）</p><h4 id="3-二指缩放事件"><a href="#3-二指缩放事件" class="headerlink" title="3.二指缩放事件"></a>3.二指缩放事件</h4><p>通过–pct–pinchzoom配置，</p><h4 id="4-轨迹事件"><a href="#4-轨迹事件" class="headerlink" title="4.轨迹事件"></a>4.轨迹事件</h4><p>由一个或多个随机移动组成，通过–pct-tracball</p><h4 id="5-旋转屏幕"><a href="#5-旋转屏幕" class="headerlink" title="5.旋转屏幕"></a>5.旋转屏幕</h4><p>通过–pct-rotation配置百分比</p><h4 id="6-基本导航事件"><a href="#6-基本导航事件" class="headerlink" title="6.基本导航事件"></a>6.基本导航事件</h4><p>现在基本没有</p><h4 id="7-主要导航事件"><a href="#7-主要导航事件" class="headerlink" title="7.主要导航事件"></a>7.主要导航事件</h4><p>主要是中间键、back、菜单按键。通过–pct-majornav配置</p><h4 id="8-系统按键事件"><a href="#8-系统按键事件" class="headerlink" title="8.系统按键事件"></a>8.系统按键事件</h4><p>如home、back、音量调节等，通过–pct-syskeys配置</p><h4 id="9-启动activity事件"><a href="#9-启动activity事件" class="headerlink" title="9.启动activity事件"></a>9.启动activity事件</h4><p>手机开启一个activity。随机执行一个startactivity（）方法</p><h4 id="10-键盘事件"><a href="#10-键盘事件" class="headerlink" title="10.键盘事件"></a>10.键盘事件</h4><p>通过–pct-flip配置</p><h3 id="五、monkey-参数"><a href="#五、monkey-参数" class="headerlink" title="五、monkey 参数"></a>五、monkey 参数</h3><h4 id="1-常规参数"><a href="#1-常规参数" class="headerlink" title="1.常规参数"></a>1.常规参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 帮助类参数</span></span><br><span class="line">monkey -h </span><br><span class="line">adb shell monkey -v &lt;event-count&gt;</span><br></pre></td></tr></table></figure><p>-v打印出日志。每个-v增加反馈信息级别，-v越多越详细，最多三个</p><h4 id="2-事件类参数"><a href="#2-事件类参数" class="headerlink" title="2.事件类参数"></a>2.事件类参数</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey -f /mnt/sdcard/test1  执行脚本文件</span><br><span class="line"></span><br><span class="line">adb shell monkey -s 666 100  ;   -s可以重复执行之前的随机操作。每次随机事件默认生成一个seed</span><br><span class="line"></span><br><span class="line">adb shell monkey --throttle 3000 5;   --throttle 每个指令之间增加间隔时间</span><br><span class="line"></span><br><span class="line">adb shell monkey -v -v --pct-touch 100 200;   调整触摸事件百分比等</span><br></pre></td></tr></table></figure><h3 id="六、约束类参数"><a href="#六、约束类参数" class="headerlink" title="六、约束类参数"></a>六、约束类参数</h3><h4 id="1-包约束-只访问包里的activity"><a href="#1-包约束-只访问包里的activity" class="headerlink" title="1.包约束 (只访问包里的activity)"></a>1.包约束 (只访问包里的activity)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey -p com.tal.kaoyan 500</span><br></pre></td></tr></table></figure><h4 id="2-activity约束"><a href="#2-activity约束" class="headerlink" title="2.activity约束"></a>2.activity约束</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey -c Intent.CATEGORY_LAUNCHER 1000</span><br></pre></td></tr></table></figure><h3 id="七、调试类参数"><a href="#七、调试类参数" class="headerlink" title="七、调试类参数"></a>七、调试类参数</h3><h4 id="1-程序崩溃侯继续发送事件"><a href="#1-程序崩溃侯继续发送事件" class="headerlink" title="1.程序崩溃侯继续发送事件"></a>1.程序崩溃侯继续发送事件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey --ignore-crashes &lt;event-count&gt;</span><br></pre></td></tr></table></figure><h4 id="2-超时错误继续发送事件"><a href="#2-超时错误继续发送事件" class="headerlink" title="2.超时错误继续发送事件"></a>2.超时错误继续发送事件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey --ignore-timeouts</span><br></pre></td></tr></table></figure><h4 id="3-应用程序权限错误发生后继续发送事件"><a href="#3-应用程序权限错误发生后继续发送事件" class="headerlink" title="3.应用程序权限错误发生后继续发送事件"></a>3.应用程序权限错误发生后继续发送事件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey --ignore-security-exceptions</span><br></pre></td></tr></table></figure><h3 id="八、案例"><a href="#八、案例" class="headerlink" title="八、案例"></a>八、案例</h3><ol><li>测试是指定应用，因此需要使用-p指定被测app包名：com.tal.kaoyan</li><li>这个测试的目的是希望模拟用户操作，因此需要让Monkey执行的事件尽可能地接近用户的常规操作，这样才可以最大限度地发现用户使用过程中可能出现的问题。因此需要对Monkey执行的事件百分比做一些调整:</li><li>触摸事件和手势事件是用户最常见的操作，所以通过–pct-touch和–pct-motion将这两个事件的占比调整到40%与25%；目标应用包含了多个Activity，为了能覆盖大部分的Activity，所以通过–pct-appswitch将Activity切换的事件占比调整到10%；被测应用在测试中出现过不少横竖屏之间切换的问题，这个场景也必须关注，因此通过–pct-rotation把横竖屏切换事件调整到10%。</li><li>使用-s参数来指定命令执行的seed值 Monkey会根据seed值来生成对应事件流，同一个seed生成的事件流是完全相同的。这里指定了seed值，是为了测试发现问题时，便于进行问题复现。</li><li>使用–throttle参数来控制Monkey每个操作之间的时间间隔 指定操作之间的时间间隔，一方面是希望能更接近用户的操作场景，正常用户操作都会有一定的时间间隔；另一方面也是不希望因为过于频繁的操作而导致系统崩溃，尤其是在比较低端的手机上执行测试时。因此通过–throttle设置Monkey每个操作固定延迟0.4秒。</li><li>使用–ignore-crashs和–ignore-timeouts参数使Monkey遇到意外时能继续执行 在执行Monkey测试时，会因为应用的崩溃或没有响应而意外终止，所以需要在命令中增加限制参数–ignore-crash和–ignore-timeouts，让Monkey在遇到崩溃或没有响应的时候，能在日志中记录相关信息，并继续执行后续的测试。</li><li>使用-v指定log的详细级别 Monkey的日志输出有3个级别：日志的级别越高，其详细程度也越高。为了方便问题的定位，这里将日志设为 -v -v.</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey -p com.tal.kaoyan</span><br></pre></td></tr></table></figure><ul><li>–pct-touch 40 –pct-motion 25</li><li>–pct-appswitch 10</li><li>–pct-rotation 5</li><li>-s 1666 –throttle 400</li><li>–ignore-crashes</li><li>–ignore-timeouts</li><li>-v -v  200</li></ul><h3 id="九、monkey脚本稳定性测试"><a href="#九、monkey脚本稳定性测试" class="headerlink" title="九、monkey脚本稳定性测试"></a>九、monkey脚本稳定性测试</h3><p>按照规范写好脚本，放在手机里，通过monkey -f调用脚本</p><h4 id="1-脚本api"><a href="#1-脚本api" class="headerlink" title="1.脚本api"></a>1.脚本api</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">LaunchActivity(pkg_name, cl_name)：启动应用的Activity。参数：包名和启动的Activity。</span><br><span class="line">Tap(x, y, tapDuration)： 模拟一次手指单击事件。参数：x,y为控件坐标，tapDuration为点击的持续时间，此参数可省略。</span><br><span class="line">UserWait(sleepTime)： 休眠一段时间</span><br><span class="line">DispatchPress(keyName)： 按键。参数： keycode。 RotateScreen(rotationDegree, persist)： 旋转屏幕。 参数：rotationDegree为旋转角度， e.g. 1代表90度；persist表示旋转之后是否固定，0表示旋转后恢复，非0则表示固定不变。</span><br><span class="line">DispatchString(input)： 输入字符串。</span><br><span class="line">DispatchFlip(true/false)： 打开或者关闭软键盘。</span><br><span class="line">PressAndHold(x, y, pressDuration)： 模拟长按事件。</span><br><span class="line">Drag(xStart, yStart, xEnd, yEnd, stepCount)： 用于模拟一个拖拽操作。</span><br><span class="line">PinchZoom(x1Start, y1Start, x1End, y1End, x2Start, y2Start, x2End, y2End, stepCount)： 模拟缩放手势。</span><br><span class="line">LongPress()： 长按2秒。</span><br><span class="line">DeviceWakeUp()： 唤醒屏幕。</span><br><span class="line">PowerLog(power_log_type, test_case_status)： 模拟电池电量信息。</span><br><span class="line">WriteLog()： 将电池信息写入sd卡。</span><br><span class="line">RunCmd(cmd)： 运行shell命令。</span><br><span class="line">DispatchPointer(downtime,eventTime,action,x,yxpressure,size,metastate,xPrecision,yPrecision,device,edgeFlags)： 向指定位置，发送单个手势。</span><br><span class="line">DispatchPointer(downtime,eventTime,action,x,yxpressure,size,metastate,xPrecision,yPrecision,device,edgeFilags)： 发送按键消息。</span><br><span class="line">LaunchInstrumentation(test_name,runner_name)： 运行一个instrumentation测试用例。</span><br><span class="line">DispatchTrackball： 模拟发送轨迹球事件。</span><br><span class="line">ProfileWait： 等待5秒。</span><br><span class="line">StartCaptureFramerate()： 获取帧率。</span><br><span class="line">EndCaptureFramerate(input)： 结束获取帧率。</span><br></pre></td></tr></table></figure><h4 id="2-脚本格式"><a href="#2-脚本格式" class="headerlink" title="2.脚本格式"></a>2.脚本格式</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Monkey脚本主要包含两部分，一部分是头文件信息，一部分是具体的monkey命令。</span></span><br><span class="line"><span class="built_in">type</span> = raw events</span><br><span class="line">count = 1</span><br><span class="line">speed = 1.0</span><br><span class="line"><span class="comment"># 下面为monkey命令</span></span><br><span class="line">start data &gt;&gt;</span><br><span class="line"><span class="comment"># 具体的monkey脚本内容</span></span><br></pre></td></tr></table></figure><h4 id="3-编写脚本"><a href="#3-编写脚本" class="headerlink" title="3.编写脚本"></a>3.编写脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#头文件信息</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> = raw events</span><br><span class="line"></span><br><span class="line">count = 1</span><br><span class="line"></span><br><span class="line">speed = 1.0</span><br><span class="line"></span><br><span class="line"><span class="comment">#启动测试</span></span><br><span class="line">start data &gt;&gt;</span><br><span class="line"></span><br><span class="line">LaunchActivity(com.tal.kaoyan,com.tal.kaoyan.ui.activity.SplashActivity)</span><br><span class="line">UserWait(2000)</span><br><span class="line"></span><br><span class="line">Tap(624,900,1000) <span class="comment">#点击取消升级</span></span><br><span class="line">UserWait(2000)</span><br><span class="line"></span><br><span class="line">Tap(806,64,1000) <span class="comment">#点击跳过</span></span><br><span class="line">UserWait(2000)</span><br><span class="line"></span><br><span class="line">Tap(217,378,1000) <span class="comment">#点击用户名输入框</span></span><br><span class="line">DispatchString(zxw1234)</span><br><span class="line">UserWait(2000)</span><br><span class="line"></span><br><span class="line">Tap(197,461,1000) <span class="comment">#点击密码输入框</span></span><br><span class="line">DispatchString(zxw123456)</span><br><span class="line">UserWait(2000)</span><br><span class="line"></span><br><span class="line">Tap(343,637,1000) <span class="comment">#点击登录按钮</span></span><br></pre></td></tr></table></figure><h4 id="4-执行脚本"><a href="#4-执行脚本" class="headerlink" title="4.执行脚本"></a>4.执行脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb push C:\Users\Shuqing\Desktop\kyb1.txt /sdcard</span><br><span class="line"></span><br><span class="line">adb shell monkey -f /sdcard/kyb1.txt -v 1</span><br></pre></td></tr></table></figure><h4 id="5-注意事项"><a href="#5-注意事项" class="headerlink" title="5.注意事项"></a>5.注意事项</h4><p>头文件代码书写注意“=”两边预留空格，否则会出现如下报错。</p><h3 id="十、日志管理"><a href="#十、日志管理" class="headerlink" title="十、日志管理"></a>十、日志管理</h3><h4 id="1-日志保存方式"><a href="#1-日志保存方式" class="headerlink" title="1.日志保存方式"></a>1.日志保存方式</h4><ul><li>保存pc中</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey -v -v 100 &gt;d:\monkeylog.txt</span><br></pre></td></tr></table></figure><ul><li>保存在手机上</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line">monkey -v 100 &gt;/sdcard/monkeylog.log</span><br></pre></td></tr></table></figure><ul><li>正常日志和error日志分开保存</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell monkey -v 100 1&gt;d:\monkey.log  2&gt;d:\error.log</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> app </tag>
            
            <tag> monkey </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>App测试(二) adb工具的基本使用</title>
      <link href="/2021/07/15/App%E6%B5%8B%E8%AF%9502/"/>
      <url>/2021/07/15/App%E6%B5%8B%E8%AF%9502/</url>
      <content type="html"><![CDATA[<p>adb全称Android Debug Bridge，是Android SDK中的一个工具, 使用adb可以直接操作管理Android模拟器或者真实的Andriod设备，就是起到调试桥的作用。文章介绍adb的基本使用。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="adb的安装"><a href="#adb的安装" class="headerlink" title="adb的安装"></a>adb的安装</h3><p>adb工具包一般只是一个压缩文件，不需要安装，只需要解压即可。解压后有三个必须文件，adb.exe动态链接库文件、adbWinApi.dll和adbWinUsbApi.dll，解压后即可直接使用。<br>如图：</p><p><img src="/image/App测试02/App测试02_001.png" alt=""></p><h3 id="adb的基本使用"><a href="#adb的基本使用" class="headerlink" title="adb的基本使用"></a>adb的基本使用</h3><p>进入到adb目录，cmd打开命令窗口</p><ul><li>连接上设备</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb connect ip</span><br></pre></td></tr></table></figure><p>注意：第一次链接失败，再连一次就成功了！</p><ul><li>查看当前连接的所有设备</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb devices</span><br></pre></td></tr></table></figure><ul><li>推送文件到设备</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb push 电脑文件的路径 /sdcard</span><br></pre></td></tr></table></figure><ul><li>在设备上的文件管理器找到相关.apk文件</li><li>断开连接</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb disconnect</span><br></pre></td></tr></table></figure><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><ul><li>获取设备列表和设备状态</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb devices</span><br></pre></td></tr></table></figure><ul><li>安装/卸载app</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">adb install 包信息</span><br><span class="line"></span><br><span class="line">adb install -r 包信息    //覆盖安装</span><br><span class="line"></span><br><span class="line">adb install -d 包信息    //安装的版本比手机上的版本低</span><br><span class="line"></span><br><span class="line">adb uninstall pkname    //卸载</span><br></pre></td></tr></table></figure><ul><li>将PC机上的文件push到手机上</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb push 文件 /sdcard/</span><br></pre></td></tr></table></figure><ul><li>将手机上的文件pull到PC机上</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb pull /sdcard/50.zip（文件） D:\back（路径）</span><br></pre></td></tr></table></figure><ul><li>查看adb后台进程</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell ps | findstr adbd</span><br></pre></td></tr></table></figure><ul><li>获取当前界面的包名信息</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell dumpsys window | findstr mCurrentFocus</span><br></pre></td></tr></table></figure><ul><li>app禁用命令、启用命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb shell pm <span class="built_in">disable</span>-user 包名    <span class="comment"># 禁用命令</span></span><br><span class="line"></span><br><span class="line">adb shell pm <span class="built_in">enable</span> 包名    <span class="comment"># 启用命令</span></span><br></pre></td></tr></table></figure><ul><li>内存快速填充命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 快速填充1G内存</span></span><br><span class="line">adb shell dd <span class="keyword">if</span>=/dev/zero of=/sdcard/file bs=1024000 count=1024</span><br></pre></td></tr></table></figure><ul><li>获取手机品牌</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell getprop ro.product.brand</span><br></pre></td></tr></table></figure><ul><li>截屏</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell screencap -p /sdcard/screenshot.png</span><br></pre></td></tr></table></figure><ul><li>重启手机</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb reboot</span><br></pre></td></tr></table></figure><ul><li>一般问题log的抓抓取adb LOG</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># //一般问题log的抓取</span></span><br><span class="line">adb shell -v time &gt; D:\log.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示问题log的抓取</span></span><br><span class="line">adb shell dumpsys SurfaceFlinger &gt; D:\SF.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># adb 查看所有进程信息</span></span><br><span class="line">adb shell ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># adb 查看指定关键字的进程信息 *** 为关键字 可以为包名</span></span><br><span class="line">adb shell “ps | grep ***”</span><br><span class="line"></span><br><span class="line"><span class="comment"># adb 查看所有进程的 log信息</span></span><br><span class="line">adb logcat -v process</span><br><span class="line"></span><br><span class="line"><span class="comment"># adb 查看指定PID的log信息</span></span><br><span class="line">adb logcat -v process | grep ****</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看所有的log日志</span></span><br><span class="line">adb logcat</span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤查看指定关键字的log ***为关键字</span></span><br><span class="line">adb logcat | grep ***</span><br></pre></td></tr></table></figure><h3 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h3><h4 id="安装正常"><a href="#安装正常" class="headerlink" title="安装正常"></a>安装正常</h4><ol><li>安装chrome 插件 Android Debug Bridge</li><li>手机开启调试模式，且手机的包需要时 开发包（dev），然后usb连接手机</li><li>浏览器输入 chrome://inspect ，手机进入对应h5页面，然后在浏览器就可以看到并inspect</li></ol><p><img src="/image/App测试02/App测试02_002.png" alt=""></p><h4 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h4><ul><li><a href="https://blog.csdn.net/weixin_40398599/article/details/102818136?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=1328740.50354.16170887036072893&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">Chrome DevTools 调试技巧</a></li><li><a href="https://blog.csdn.net/weixin_33863087/article/details/89132834?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&amp;dist_request_id=1328740.50354.16170887036072893&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">最新 Chrome DevTools(v57) 使用详解</a></li></ul><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><ul><li>1.不能访问404<ul><li>网络问题：看能不能访问 <a href="https://chrome-devtools-frontend.appspot.com/" target="_blank" rel="noopener">https://chrome-devtools-frontend.appspot.com/</a></li><li>浏览器版本：被调试端版本过低（调试端 的浏览器版本 是否低于 被调试）；</li></ul></li></ul>]]></content>
      
      
        <tags>
            
            <tag> app </tag>
            
            <tag> adb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>App测试(一) App测试的基本概念</title>
      <link href="/2021/06/15/App%E6%B5%8B%E8%AF%9501/"/>
      <url>/2021/06/15/App%E6%B5%8B%E8%AF%9501/</url>
      <content type="html"><![CDATA[<p>文章介绍App测试的基本概念。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="测试流程"><a href="#测试流程" class="headerlink" title="测试流程"></a>测试流程</h3><ul><li>功能测试<ul><li>冒烟测试（不符合打回）</li><li>特性测试<ul><li>ui</li><li>功能</li></ul></li><li>兼容性测试</li></ul></li><li>合版测试<ul><li>特性功能</li><li>全量功能</li></ul></li><li>渠道包测试</li><li>上线测试</li><li>版本问题跟踪</li></ul><h3 id="测试周期"><a href="#测试周期" class="headerlink" title="测试周期"></a>测试周期</h3><p>测试周期可按项目的开发周期来确定测试时间，一般测试时间为1~2周（即15个工作日），根据项目情况以及版本质量可适当缩短或延长测试时间。</p><h3 id="测试资源"><a href="#测试资源" class="headerlink" title="测试资源"></a>测试资源</h3><p>测试任务开始前，检查各项测试资源。</p><ul><li>产品功能需求文档；</li><li>产品原型图；</li><li>产品效果图；</li><li>行为统计分析定义文档；</li><li>测试设备（ios3.1.3-ios5.0.1；Android1.6-Android4.0；Winphone7.1及以上；Symbian v3/v5/Nokia Belle等）；</li><li>其他</li></ul><h3 id="日报及产品上线报告"><a href="#日报及产品上线报告" class="headerlink" title="日报及产品上线报告"></a>日报及产品上线报告</h3><ul><li>测试人员每天需对所测项目发送测试日报。</li><li>测试日报所包含的内容为：<ul><li>对当前测试版本质量进行分级；</li><li>对较严重的问题进行例举，提示开发人员优先修改；</li><li>对版本的整体情况进行评估。</li></ul></li><li>产品上线前，测试人员发送产品上线报告。</li><li>上线报告所包含的内容为：<ul><li>对当前版本质量进行分级和历史问题记录对比；</li><li>附上测试报告（功能测试报告、兼容性测试报告、性能测试报告以及app可用性能标准结果）；</li><li>总结上线版本的基本情况。若有遗留问题必须列出并记录解决方案。</li></ul></li></ul><h3 id="版本反馈收集"><a href="#版本反馈收集" class="headerlink" title="版本反馈收集"></a>版本反馈收集</h3><ul><li>应用市场</li><li>App内反馈系统</li><li>埋点技术</li></ul><h3 id="测试点"><a href="#测试点" class="headerlink" title="测试点"></a>测试点</h3><h4 id="非功能测试"><a href="#非功能测试" class="headerlink" title="非功能测试"></a>非功能测试</h4><p>针对 APP 应用的非功能性需求, 在 APP 应用开发初期, 可能需要对 APP 应用内容本身, 在线下展开针对性的实用性调研测试或者参考友商, </p><h4 id="特性测试"><a href="#特性测试" class="headerlink" title="特性测试"></a>特性测试</h4><h5 id="UI测试"><a href="#UI测试" class="headerlink" title="UI测试"></a>UI测试</h5><ul><li>确保原型图和效果图为当前最新版本，符合产品经理及用户需求；测试过程中一切以效果图为准，若有用户体验方面的建议，可以先与产品经理确认，确认通过后，可以正式向开发提出用户体验方面的问题。</li><li>在不同环境或者版本下测试出的数据差异需保留</li></ul><h5 id="功能测试"><a href="#功能测试" class="headerlink" title="功能测试"></a>功能测试</h5><ul><li>按照用户的需求(需求说明书、原型等]去检验开发的代码实现是否满足用户的功能性需求。</li><li>测试对象: 功能点(单独模块) —-》流程测试（多模块）</li><li>测试方法: 等价类与边界值组合</li></ul><h5 id="回归测试"><a href="#回归测试" class="headerlink" title="回归测试"></a>回归测试</h5><p>验证完特性后，把所有特性功能合成一个版本，对App的所有基本功能（核心功能）进行全面回归</p><h4 id="专项测试"><a href="#专项测试" class="headerlink" title="专项测试"></a>专项测试</h4><p><img src="/image/App测试01/App测试01_001.png" alt=""></p><h5 id="兼容性测试"><a href="#兼容性测试" class="headerlink" title="兼容性测试"></a>兼容性测试</h5><ul><li>硬件<ul><li>设备型号</li><li>屏幕尺寸</li><li>屏幕分辨率</li><li>网络类型</li></ul></li><li>软件<ul><li>系统版本</li><li>App版本</li><li>不同系统</li><li>与主流App是否兼容</li></ul></li></ul><h5 id="安装-卸载-升级测试"><a href="#安装-卸载-升级测试" class="headerlink" title="安装/卸载/升级测试*"></a>安装/卸载/升级测试*</h5><ul><li>安装类型<ul><li>Andriod ：.apk</li><li>ios：.lpa</li></ul></li><li>不同的安装渠道<ul><li>Andriod<ul><li>手机的应用商店</li><li>第三方软件：豌豆荚</li><li>-官网</li></ul></li><li>iOS:<ul><li>官网</li><li>APP Store</li></ul></li></ul></li><li>不同的系统版本</li><li>各种的安装方式<ul><li>正常情况<ul><li>正常安装测试,检查是否安装成功</li><li>APP版本覆盖测试</li><li>回退版本测试</li><li>在不同型号、系统、屏幕大小、分辨率上的手机进行安装·</li><li>安装完成后:能否正常启动应用程序</li><li>安装完成后,重启于机能否正常启动应用程序</li></ul></li><li>异常情况<ul><li>安装时内存不足</li><li>安装过程中的意外情况（强行断电、断网、来电话了、查看信息)等等</li><li>能否取消安装</li></ul></li></ul></li><li>各种卸载方式<ul><li>正常情况<ul><li>直接删除安装文件夹卸载是否有提示信息。</li><li>用自己的卸载程序进行卸载,检查是否卸载干净</li><li>用第三方工具,检查是否卸载干净</li><li>不同系统、硬件环境、网络环境下进行卸载</li><li>卸载后再次安装，是否正常使用</li></ul></li><li>异常情况<ul><li>卸载中出现异常情况能否恢复(比如手机关机，内存、没电等)，程序是否还能运行</li><li>卸载后是否有残留，是否能够再次进行安装</li><li>是否可以取消卸载软件恢复使用</li></ul></li></ul></li><li>各种升级方式<ul><li>更新版本需要提示用户</li><li>考虑是否进行强制升级<ul><li>否：可取消升级，但是有提示</li><li>是<ul><li>软件存在严重缺陷</li><li>软件不能够向前兼容</li></ul></li></ul></li><li>是否能够跨版本升级</li><li>断点续传</li></ul></li></ul><h5 id="交叉事件测试"><a href="#交叉事件测试" class="headerlink" title="交叉事件测试"></a>交叉事件测试</h5><p>APP 应用的交叉事件测试又称: 冲突测试或干扰测试。 一般多用于考察应用在运行过程中, 对于外界干扰的处理能力。</p><p>测试点:</p><ul><li>运行时接收来电/短信/消息推送/收取邮件</li><li>运行时出现系统弹窗, 运行时切换外部设备等。</li><li>插拔耳机</li><li>网络切换</li><li>系流自带应用(摄像头、计算器）</li><li>多个App同时运行是否影响正常功能</li><li>App运行时前/后台切换是否影响正常功能</li><li>App运行时切换网络（2G、3G、wifi）/浏览网络/使用蓝牙传送/接收数据</li></ul><h5 id="推送消息测试"><a href="#推送消息测试" class="headerlink" title="推送消息测试"></a>推送消息测试</h5><p>消息推送测试主要目的就是为了唤醒或提醒用户</p><ul><li>对象<ul><li>全部推送</li><li>部分推送</li><li>精确推送</li></ul></li><li>消息形式<ul><li>弹窗</li><li>消息通知栏</li><li>短信</li><li>邮件</li></ul></li><li>测试关注点<ul><li>push消息应该按设定规则发送特定用户</li><li>APP在后台运行时，应能正常收到push消息</li><li>设备在锁屏状态下，应能正常收到APP的Push消息</li><li>设备网络断开重连后，应能收到push消息</li><li>系统设置不接受APP通知消息时，用户应该不在收到push消息</li><li>在非免打扰时间段，用户能正常收到push。</li></ul></li></ul><h5 id="用户体验度测试"><a href="#用户体验度测试" class="headerlink" title="用户体验度测试"></a>用户体验度测试</h5><p>APP 应用用户体验度测试主要是从用户使用角度出发, 主观的感知产品或服务的可用, 易用及友好程度的测试形式. </p><p>测试点:</p><ul><li>界面设计：美观性</li><li>功能易用性：保持登录(APP) 页面层级关系在4层左右</li><li>横竖屏切换,</li><li>系统功能响应等.</li><li>是否有空数据界面设计，引导用户去执行操作。</li><li>是否滥用用户引导。</li><li>是否有不可点击的效果，如：你的按钮此时处于不可用状态，那么一定要灰掉，或者拿掉按钮，否则会给用户误导</li><li>菜单层次是否太深</li><li>交互流程分支是否太多</li><li>相关的选项是否离得很远</li><li>一次是否载入太多的数据</li><li>界面中按钮可点击范围是否适中</li><li>标签页是否跟内容没有从属关系，当切换标签的时候，内容跟着切换</li><li>操作应该有主次从属关系</li><li>是否定义Back的逻辑。涉及软硬件交互时，Back键应具体定义</li><li>是否有横屏模式的设计，应用一般需要支持横屏模式，即自适应设计</li></ul><h5 id="稳定性测试"><a href="#稳定性测试" class="headerlink" title="稳定性测试"></a>稳定性测试</h5><p>APP 应用稳定测试测试一般是通过测试工具实现在一定时间范围内的无序操作, 来检测应用的稳定运行能力,</p><p>测试点：</p><ul><li>闪退</li><li>系统崩溃</li><li>没响应</li></ul><p>常见的测试工具如下:</p><ul><li>Monkey</li><li>UICrawler</li><li>Maxim</li></ul><h5 id="客户端性能测试"><a href="#客户端性能测试" class="headerlink" title="客户端性能测试"></a>客户端性能测试</h5><p>一款 APP 应用是否优秀不仅仅体现在功能可用性上, 同时也需要关注 APP 应用在不同类型设备上的性能表现, 如果性能表现不够稳定, 则会在一定程度上影响某一部分用户的使用体验. </p><ul><li>极限测试：在各种边界压力情况下，如电池、存储、网速等，验证App是否能正确响应。<ul><li>内存满时安装App</li><li>运行App时手机断电</li><li>运行App时断掉网络</li><li>内存不足</li><li>电量不足</li></ul></li><li>响应能力测试：测试App中的各类操作是否满足用户响应时间要求 。（安装包放到云测上可以测试）<ul><li>App安装、卸载的响应时间</li><li>App各类功能性操作的影响时间</li></ul></li><li>压力测试：反复/长期操作下、系统资源是否占用异常。（itestin）<ul><li>App反复进行安装卸载，查看系统资源是否正常</li><li>其他功能反复进行操作，查看系统资源是否正常</li></ul></li><li>性能评估：评估典型用户应用场景下，系统资源的使用情况。（Jmeter）<ul><li>APP的启动时间是否过长;</li><li>AFP使用时对CPU、内存的占用情况;</li><li>APP使用时，电量流星的消耗情况;</li><li>反复长期的操作情况下,系统资源的使用情况。</li></ul></li><li><p>性能测试指标</p><ul><li>内存</li><li>CPU</li><li>流量</li><li>电量</li><li>启动速度</li><li>界面切换速度</li></ul></li><li><p>内存溢出和<em>内存泄漏</em></p><ul><li>内存溢出oul of mermory，是指程序在申清内存时，没有足够的内存空问供其使用，出现out of memory;</li><li><em>内存泄漏</em> memory leak，是指程序在申请内存后，无法释放已申请的内存空问，一次内存泄露危害可以忽略,但内存泄露堆积后果很严重,无论多少内存,迟早会被占光;memory leak会最终会导致out of memory</li></ul></li><li>冷启动与热启动<ul><li>app被后台杀死后，在这个状态打开app，这种启动方式叫做冷启动;</li><li>热启动;指app没有被后台杀死，仍然左后台运行，通常我们再次去打T开这个app，这种启动方式叫热启动。</li></ul></li></ul><h5 id="服务端性能测试"><a href="#服务端性能测试" class="headerlink" title="服务端性能测试"></a>服务端性能测试</h5><p>测试点:</p><ul><li>单机容量测试:可以检测到单机服务器在90%的响应时间和成功率都达标的前提下，能够承载多少用户量。</li><li>24小时稳定性测试:使用特定游戏模型压测24小时，服务无重启，内存无泄漏，并且各事务成功率达标。</li></ul><p>指标</p><ul><li>响应时间</li><li>吞吐量</li><li>并发数</li><li>事物通过率等</li></ul><p>测试工具: </p><ul><li>LoadRunner</li><li>JMeter</li></ul><h5 id="安全测试"><a href="#安全测试" class="headerlink" title="安全测试"></a>安全测试</h5><p>测试点: </p><ul><li>反编译性</li><li>数据安全</li><li>键盘安全</li><li>通信保密性及安全策略等方面的验证.</li></ul><h4 id="其他测试"><a href="#其他测试" class="headerlink" title="其他测试"></a>其他测试</h4><h5 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h5><ul><li>同表单编辑页面</li><li>用户名密码长度</li><li>注册后的提示页面</li><li>前台注册页面和后台的管理页面数据是否一致</li><li>注册后，在后台管理中页面提示</li></ul><h5 id="注销"><a href="#注销" class="headerlink" title="注销"></a>注销</h5><ul><li>注销原模块，新的模块系统能否正确处理。</li><li>终止注销能否返回原模块，原用户。</li><li>注销原用户，新用户系统能否正确处理。</li><li>使用错误的账号、口令、无权限的被禁用的账号进行注销</li></ul><h5 id="登录测试"><a href="#登录测试" class="headerlink" title="登录测试"></a>登录测试</h5><ul><li>登录<ul><li>登录方式</li><li>快速登录</li><li>免登录<ul><li>密码修改</li></ul></li><li>多端登录是否限制</li><li>密码修改</li></ul></li><li>离线（游客模式）<ul><li>页面权限控制</li><li>跳转登录</li></ul></li></ul><h5 id="导航测试"><a href="#导航测试" class="headerlink" title="导航测试"></a>导航测试</h5><ul><li>按钮、对话框、列表和窗口等；或在不同的连接页面之间需要导航</li><li>是否易于导航，导航是否直观</li><li>是否需要搜索引擎</li><li>导航帮助是否准确直观</li><li>导航与页面结构、菜单、连接页面的风格是否一致</li></ul><h5 id="图形测试"><a href="#图形测试" class="headerlink" title="图形测试"></a>图形测试</h5><ul><li>横向比较。各控件操作方式统一</li><li>自适应界面设计，内容根据窗口大小自适应</li><li>页面标签风格是否统一</li><li>页面是否美观</li><li>页面的图片应有其实际意义而要求整体有序美观</li><li>图片质量要高且图片尺寸在设计符合要求的情况下应尽量小</li><li>界面整体使用的颜色不宜过多</li></ul><h5 id="内容测试"><a href="#内容测试" class="headerlink" title="内容测试"></a>内容测试</h5><ul><li>输入框说明文字的内容与系统功能是否一致</li><li>文字长度是否加以限制</li><li>文字内容是否表意不明</li><li>是否有错别字</li><li>信息是否为中文显示</li><li>是否有敏感性词汇、关键词</li><li>是否有敏感性图片，如：涉及版权、专利、隐私等图片</li></ul><h5 id="弱网测试"><a href="#弱网测试" class="headerlink" title="弱网测试"></a>弱网测试</h5><ul><li>各个功能正常<ul><li>可以浏览本地数据</li><li>退出app再开启app时能正常浏览</li><li>切换到后台再切回前台可以正常浏览</li><li>锁屏后再解屏回到应用前台可以正常浏览</li><li>在对服务端的数据有更新时会给予离线的相应提示</li></ul></li><li>丢包会重试</li><li>最小原则：不能闪退</li></ul><h5 id="协议测试"><a href="#协议测试" class="headerlink" title="协议测试"></a>协议测试</h5><p>直接协议访问，服务端要做校验</p><h5 id="定位、照相机服务"><a href="#定位、照相机服务" class="headerlink" title="定位、照相机服务"></a>定位、照相机服务</h5><ul><li>App有用到相机，定位服务时，需要注意系统版本差异</li><li>有用到定位服务、照相机服务的地方，需要进行前后台的切换测试，检查应用是否正常。</li><li>当定位服务没有开启时，使用定位服务，会友好性弹出是否允许设置定位提示。当确定允许开启定位时，能自动跳转到定位设置中开启定位服务。</li><li>测试定位、照相机服务时，需要采用真机进行测试。</li></ul><h5 id="时间测试"><a href="#时间测试" class="headerlink" title="时间测试"></a>时间测试</h5><ul><li>客户端可以自行设置手机的时区、时间，因此需要校验该设置对app的影响。</li><li>中国为东8区，所以当手机设置的时间非东8区时，查看需要显示时间的地方，时间是否展示正确，应用功能是否正常。时间一般需要根据服务器时间再转换成客户端对应的时区来展示，这样的用户体验比较好。比如发表一篇微博在服务端记录的是10：00，此时，华盛顿时间为22：00，客户端去浏览时，如果设置的是华盛顿时间,则显示的发表时间即为22:00,当时间设回东8区时间时，再查看则显示为10：00。</li></ul><h3 id="测试工具"><a href="#测试工具" class="headerlink" title="测试工具"></a>测试工具</h3><h4 id="自动化工具"><a href="#自动化工具" class="headerlink" title="自动化工具"></a>自动化工具</h4><ul><li>Appium</li><li>Airtest</li><li>uiautomator2</li></ul><h4 id="稳定性测试工具"><a href="#稳定性测试工具" class="headerlink" title="稳定性测试工具"></a>稳定性测试工具</h4><ul><li>Monkey</li><li>MonkeyRunner</li><li>Maxim</li><li>UICrawler</li></ul><h4 id="性能测试工具"><a href="#性能测试工具" class="headerlink" title="性能测试工具"></a>性能测试工具</h4><ul><li>GT</li><li>Perfdog</li><li>SoloPi</li></ul><h4 id="弱网测试-amp-抓包工具"><a href="#弱网测试-amp-抓包工具" class="headerlink" title="弱网测试&amp;抓包工具"></a>弱网测试&amp;抓包工具</h4><ul><li>QNET</li><li>Fiddler</li><li>Charles</li><li>Whistle</li></ul><h4 id="兼容性测试工具"><a href="#兼容性测试工具" class="headerlink" title="兼容性测试工具"></a>兼容性测试工具</h4><ul><li>TestIn</li><li>腾讯优测</li><li>百度MTC</li><li>阿里MQC</li></ul><h4 id="安全测试工具"><a href="#安全测试工具" class="headerlink" title="安全测试工具"></a>安全测试工具</h4><ul><li>OWASP ZAP</li><li>Drozer</li><li>MobSF</li><li>QARK</li></ul>]]></content>
      
      
        <tags>
            
            <tag> app </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Golang（四）Golang的包管理</title>
      <link href="/2021/05/15/Golang04/"/>
      <url>/2021/05/15/Golang04/</url>
      <content type="html"><![CDATA[<p>　　包是管理整个工程的工具。把同类型的文件放在一个目录，称之为 “包”，多个包构成 一个工程。<br>　　本文章主要介绍 Golang 的包管理。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、包的规则"><a href="#一、包的规则" class="headerlink" title="一、包的规则"></a>一、包的规则</h3><ul><li>包名一般是小写的，使用一个简短且有意义的名称。</li><li>包名一般要和所在的目录同名，也可以不同，包名中不能包含<code></code>等特殊符号。</li><li>包一般使用域名作为目录名称，这样能保证包名的唯一性，比如 GitHub 项目的包一般会放到<code>GOPATH/src/github.com/userName/projectName</code>目录下。</li><li>包名为 main 的包为应用程序的入口包，编译不包含 main 包的源码文件时不会得到可执行文件。</li><li>一个文件夹下的所有源码文件只能属于同一个包。</li></ul><h3 id="二、自定义包"><a href="#二、自定义包" class="headerlink" title="二、自定义包"></a>二、自定义包</h3><ul><li>1.在 GOPATH 的 src 目录下创建一个文件（后缀必须是 .go）</li><li>2.文件开头都声明”package &lt;包名,一般是目录名&gt;“</li><li>3,定义包里面的函数,就完成了一个简单的包</li></ul><p><img src="/image/Golang04/Golang04_001.png" alt=""></p><h3 id="三、包的导入"><a href="#三、包的导入" class="headerlink" title="三、包的导入"></a>三、包的导入</h3><p>要在代码中引用其他包的内容，需要使用 import 关键字导入使用的包。具体语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"包的路径"</span></span><br></pre></td></tr></table></figure><ul><li>import 导入语句通常放在源码文件开头包声明语句的下面；</li><li>导入的包名需要使用双引号包裹起来；</li><li>包名是从<code>GOPATH/src/</code> 后开始计算的，使用<code>/</code> 进行路径分隔。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当行导入</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"包 1 的路径"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"包 2 的路径"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 多行导入</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"包 1 的路径"</span></span><br><span class="line">    <span class="string">"包 2 的路径"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绝对路径导入:以GOROOT/src/或GOPATH/src/的路径为起始点,计算被引用包的路径</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"database/sql"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 相对路径导入:以引用的文件为起始点,计算被引用包的路径</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"../sql"</span></span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">package main    <span class="comment">// 声明 main 包</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span>       <span class="comment">// 导入 fmt 包，打印字符串是需要用到</span></span><br><span class="line">    myfmt <span class="string">"mylib/fmt"</span>  <span class="comment">// 命名为 myfmt</span></span><br><span class="line">)</span><br><span class="line">func main() &#123;   <span class="comment">// 声明 main 主函数</span></span><br><span class="line">    fmt.Println(<span class="string">"Hello World!"</span>) <span class="comment">// 打印 Hello World!</span></span><br><span class="line">    myfmt.Println(<span class="string">"Hello World again!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="四、包的引用格式"><a href="#四、包的引用格式" class="headerlink" title="四、包的引用格式"></a>四、包的引用格式</h3><p>包的引用有四种格式，下面以 fmt 包为例来分别演示一下这四种格式。</p><ul><li>标准引用格式</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"标准引用"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>自定义别名引用格式</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> F <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    F.Println(<span class="string">"自定义别名引用"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>省略引用格式</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> . <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//不需要加前缀 fmt.</span></span><br><span class="line">    Println(<span class="string">"省略引用"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>匿名引用格式：只执行包初始化的 init 函数，而不使用包内部的数据</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    _ <span class="string">"database/sql"</span></span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"匿名引用"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="五、包的加载"><a href="#五、包的加载" class="headerlink" title="五、包的加载"></a>五、包的加载</h3><p>当使用main启动这个程序的时候，包就会加载起来，过程如下图：</p><p><img src="/image/Golang04/Golang04_002.png" alt=""></p><h3 id="六、常用的包"><a href="#六、常用的包" class="headerlink" title="六、常用的包"></a>六、常用的包</h3><p>接下来给大家列一下常用的内置包，可以方便大家使用，省的还需要自己去定义。</p><ul><li>1.fmt：格式化的标准输入输出<ul><li>Printf() ：输出后换行</li><li>Println() ：格式化输出</li></ul></li><li>2.io：提供了原始的 I/O 操作界面</li><li>3.bufio：各个组件内部都维护了一个缓冲区，数据读写操作都直接通过缓存区进行 bufio 包通过对 io 包的封装，提供了数据缓冲功能，能够一定程度减少大块数据读写带来的开销。</li><li>4.sort：提供了用于对切片和用户定义的集合进行排序的功能。</li><li>5.strconv：提供了将字符串转换成基本数据类型，或者从基本数据类型转换为字符串的功能。</li><li>6.os：提供了不依赖平台的操作系统函数接口<ul><li>Hostname():返回内核提供的主机名</li><li>Environ():返回所有的环境变量，返回值格式为“key=value”的字符串的切片拷贝。</li><li>Getenv():会检索并返回名为 key 的环境变量的值。如果不存在该环境变量则会返回空字符串。</li><li>Setenv():设置名为 key 的环境变量，如果出错会返回该错误。</li><li>Exit():当前程序以给出的状态码 code 退出。</li><li>Getwd():回一个对应当前工作目录的根路径。</li><li>Mkdir():可以使用指定的权限和名称创建一个目录。</li><li>MkdirAll():可以使用指定的权限和名称创建一个目录，包括任何必要的上级目录，并返回 nil，否则返回错误。</li><li>Remove():会删除 name 指定的文件或目录。</li><li>RemoveAll ():会递归的删除所有子目录和文件。</li></ul></li><li>7.os/exec：提供了执行自定义 linux 命令的相关实现。</li><li>8.sync：多线程中锁机制以及其他同步互斥机制<ul><li>Mutex:互斥锁</li><li>RWMutex：读写锁</li></ul></li><li>9.flag：提供命令行参数的规则定义和传入参数解析的功能</li><li>10.encoding/json：JSON的序列号和反序列化</li><li>11.html/template：web 开发中生成 html 的 template 的一些函数</li><li>12.net/http：提供 HTTP 相关服务，主要包括 http 请求、响应和 URL 的解析，以及基本的 http 客户端和扩展的 http 服务。</li><li>13.reflect：提供运行时反射，允许程序通过抽象类型操作对象。</li><li>14.strings和bytes：提供处理字符串的一些函数集合，包括合并、查找、分割、比较、后缀检查、索引、大小写处理等等。</li><li>15.log：用于在程序中输出日志<ul><li>Print(): 普通输出；</li><li>Fatal(): 在执行完 Print 后，执行 os.Exit(1)；</li><li>Panic():在执行完 Print 后调用 panic() 方法。</li></ul></li><li>16.math/big：实现了大数字的多精度计算<ul><li>Int:有符号整数</li><li>Rat:有理数</li><li>Float:浮点数</li></ul></li><li>17.regexp:正则表达式</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"regexp"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">buf := <span class="string">"abc azc a7c aac 888 a9c  tac"</span></span><br><span class="line"><span class="comment">//解析正则表达式，如果成功返回解释器</span></span><br><span class="line">reg1 := regexp.MustCompile(<span class="string">`a.c`</span>)</span><br><span class="line"><span class="keyword">if</span> reg1 == <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"regexp err"</span>)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//根据规则提取关键信息</span></span><br><span class="line">result1 := reg1.FindAllStringSubmatch(buf, <span class="number">-1</span>)</span><br><span class="line">fmt.Println(<span class="string">"result1 = "</span>, result1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>18.time：时间显示和测量等所用的函数<ul><li>Now()：当前时间</li><li>Add() :增加时间</li><li>Sub():时间相减</li><li>ParseInLocation():字符串转为本地时间</li><li>Pta</li></ul></li><li>19.flag：给命令行参数增加描述</li></ul><h3 id="七、第三方包的管理"><a href="#七、第三方包的管理" class="headerlink" title="七、第三方包的管理"></a>七、第三方包的管理</h3><p><strong>go module</strong> 是Go语言默认的依赖管理工具。除此之外,还有godep、glide和govendor，这边就不过多描述。</p><p>常用命令如下:</p><ul><li>1.准备工作，先设置代理</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Windows 下设置 GOPROXY 的命令为</span></span><br><span class="line"><span class="keyword">go</span> env -w GOPROXY=https:<span class="comment">//goproxy.cn,direct</span></span><br><span class="line"><span class="comment">// MacOS 或 Linux 下设置 GOPROXY 的命令为：</span></span><br><span class="line">export GOPROXY=https:<span class="comment">//goproxy.cn</span></span><br></pre></td></tr></table></figure><ul><li>2.在 GOPATH 目录之外新建一个工程目录，并使用go mod init初始化生成 go.mod 文件。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> mod init hello</span><br></pre></td></tr></table></figure><p>go.mod文件内容：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module go_mod</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.15</span></span><br></pre></td></tr></table></figure><ul><li>3.创建一个go文件，然后增加依赖引用，并运行它。它就会去自动下载需要的第三方包，放到 GOPATH目录下pkg/mod,并且会更新 go.mod文件。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"github.com/labstack/echo"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">e := echo.New()</span><br><span class="line">e.GET(<span class="string">"/"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c echo.Context)</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> c.String(http.StatusOK, <span class="string">"Hello World!"</span>)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>go.mod文件内容：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module go_mod</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.15</span></span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">github.com/labstack/echo v3<span class="number">.3</span><span class="number">.10</span>+incompatible</span><br><span class="line">github.com/labstack/gommon v0<span class="number">.3</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line">golang.org/x/crypto v0<span class="number">.0</span><span class="number">.0</span><span class="number">-20200820211705</span><span class="number">-5</span>c72a883971a <span class="comment">// indirect</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>go.mod 提供了 module、require、replace 和 exclude 四个命令：</p><ul><li>module 语句指定包的名字（路径）；</li><li>require 语句指定的依赖项模块；</li><li>replace 语句可以替换依赖项模块；</li><li>exclude 语句可以忽略依赖项模块。</li></ul><p>More info: <a href="http://c.biancheng.net/golang/" target="_blank" rel="noopener">Golang</a></p>]]></content>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Golang（三）Go语言的基本语法(下)</title>
      <link href="/2021/04/15/Golang03/"/>
      <url>/2021/04/15/Golang03/</url>
      <content type="html"><![CDATA[<p>　　本文章主要介绍 Golang 的基本语法。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、容器"><a href="#一、容器" class="headerlink" title="一、容器"></a>一、容器</h3><p>复杂类型的变量,具有各种形式的存储和处理数据的功能,主要用于编写复杂算法、结构和逻辑。</p><h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>数组是一个由固定长度的特定类型元素组成的序列，一个数组可以由零个或多个元素组成。</p><p>声明语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 数组变量名 [元素数量]Type</span><br></pre></td></tr></table></figure><ul><li>数组变量名：数组声明及使用时的变量名。</li><li>元素数量：数组的元素数量，可以是一个表达式，但最终通过编译期计算的结果必须是整型数值，元素数量不能含有到运行时才能确认大小的数值。</li><li>Type：可以是任意基本类型，包括数组本身，类型为数组本身时，可以实现多维数组。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> a [<span class="number">3</span>]<span class="keyword">int</span>             <span class="comment">// 定义三个整数的数组</span></span><br><span class="line">    <span class="comment">// 访问数组的每个元素可以通过索引下标，索引下标的范围是从 0 开始到数组长度减 1 的位置，内置函数 len() 可以返回数组中元素的个数。</span></span><br><span class="line">  fmt.Println(a[<span class="number">0</span>])        <span class="comment">// 打印第一个元素</span></span><br><span class="line">  fmt.Println(a[<span class="built_in">len</span>(a)<span class="number">-1</span>]) <span class="comment">// 打印最后一个元素</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 遍历数组——访问每一个数组元素，打印索引和元素</span></span><br><span class="line">  <span class="keyword">for</span> i, v := <span class="keyword">range</span> a &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"%d %d\n"</span>, i, v)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果在数组长度的位置出现“...”省略号，则表示数组的长度是根据初始化值的个数来计算</span></span><br><span class="line">    q := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    fmt.Printf(<span class="string">"%T\n"</span>, q) <span class="comment">// "[3]int"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>默认情况下，数组的每个元素都会被初始化为元素类型对应的零值。</strong></p><h5 id="数组之间的对比"><a href="#数组之间的对比" class="headerlink" title="数组之间的对比"></a>数组之间的对比</h5><p>可以直接通过较运算符 ==和!=</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a := [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">    b := [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">    c := [<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">3</span>&#125;</span><br><span class="line">    fmt.Println(a == b, a == c, b == c) <span class="comment">// "true false false"</span></span><br><span class="line">    d := [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>&#125;</span><br><span class="line">    fmt.Println(a == d) <span class="comment">// 编译错误：无法比较 [2]int == [3]int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h5><p>声明语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> array_name [size1][size2]...[sizen] array_type</span><br></pre></td></tr></table></figure><ul><li>array_name 为数组的名字</li><li>array_type 为数组的类型</li><li>size1、size2 等等为数组每一维度的长度。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 声明一个二维整型数组，两个维度的长度分别是 4 和 2</span></span><br><span class="line">    <span class="keyword">var</span> array [<span class="number">4</span>][<span class="number">2</span>]<span class="keyword">int</span></span><br><span class="line">    <span class="comment">// 使用数组字面量来声明并初始化一个二维整型数组</span></span><br><span class="line">    array = [<span class="number">4</span>][<span class="number">2</span>]<span class="keyword">int</span>&#123;&#123;<span class="number">10</span>, <span class="number">11</span>&#125;, &#123;<span class="number">20</span>, <span class="number">21</span>&#125;, &#123;<span class="number">30</span>, <span class="number">31</span>&#125;, &#123;<span class="number">40</span>, <span class="number">41</span>&#125;&#125;</span><br><span class="line">    <span class="comment">// 声明并初始化数组中索引为 1 和 3 的元素</span></span><br><span class="line">    array = [<span class="number">4</span>][<span class="number">2</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>: &#123;<span class="number">20</span>, <span class="number">21</span>&#125;, <span class="number">3</span>: &#123;<span class="number">40</span>, <span class="number">41</span>&#125;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><p>切片（slice）是对数组的一个连续片段的<strong>引用</strong>,就像切糕一样,把数组切出几块,取出其中一块.</p><p>语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slice [开始位置 : 结束位置]</span><br></pre></td></tr></table></figure><ul><li>slice：表示目标切片对象；</li><li>开始位置：对应目标切片对象的索引；</li><li>结束位置：对应目标切片的结束索引。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a  = [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">    fmt.Println(a, a[<span class="number">1</span>:<span class="number">2</span>]) <span class="comment">// 结果:[1 2 3]  [2]</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>切片规则</p><ul><li>取出的元素数量为：结束位置 - 开始位置；</li><li>取出元素不包含结束位置对应的索引，切片最后一个元素使用 slice[len(slice)] 获取；</li><li>当缺省开始位置时，表示从连续区域开头到结束位置；</li><li>当缺省结束位置时，表示从开始位置到整个连续区域末尾；</li><li>两者同时缺省时，与切片本身等效；</li><li>两者同时为 0 时，等效于空切片，一般用于切片复位。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> highRiseBuilding [<span class="number">30</span>]<span class="keyword">int</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">30</span>; i++ &#123;</span><br><span class="line">            highRiseBuilding[i] = i + <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 区间</span></span><br><span class="line">    fmt.Println(highRiseBuilding[<span class="number">10</span>:<span class="number">15</span>])</span><br><span class="line">    <span class="comment">// 中间到尾部的所有元素</span></span><br><span class="line">    fmt.Println(highRiseBuilding[<span class="number">20</span>:])</span><br><span class="line">    <span class="comment">// 开头到中间指定位置的所有元素</span></span><br><span class="line">    fmt.Println(highRiseBuilding[:<span class="number">2</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="声明切片"><a href="#声明切片" class="headerlink" title="声明切片"></a>声明切片</h5><p>声明语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name []Type</span><br><span class="line"><span class="built_in">make</span>( []Type, size, <span class="built_in">cap</span> )</span><br><span class="line"><span class="comment">// make函数用于初始化slice、chan和map</span></span><br><span class="line"><span class="comment">// 如果只用var声明，不用make初始化，变量对应的值为nil。</span></span><br><span class="line"><span class="comment">// size 元素的个数</span></span><br><span class="line"><span class="comment">// cap 从它的第一个元素开始数，到其底层数组元素末尾的个数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 例子</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 声明字符串切片</span></span><br><span class="line">    <span class="keyword">var</span> strList []<span class="keyword">string</span></span><br><span class="line">    <span class="comment">// 声明整型切片</span></span><br><span class="line">    <span class="keyword">var</span> numList []<span class="keyword">int</span></span><br><span class="line">    <span class="comment">// 声明一个空切片</span></span><br><span class="line">    <span class="keyword">var</span> numListEmpty = []<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">    <span class="comment">// 输出3个切片</span></span><br><span class="line">    fmt.Println(strList, numList, numListEmpty)</span><br><span class="line"></span><br><span class="line">a := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">2</span>)</span><br><span class="line">    b := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">2</span>, <span class="number">10</span>)</span><br><span class="line">    fmt.Println(a, b)</span><br><span class="line">    fmt.Println(<span class="built_in">len</span>(a), <span class="built_in">len</span>(b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="切片扩容"><a href="#切片扩容" class="headerlink" title="切片扩容"></a>切片扩容</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 扩展元素,cap不足,低于1000一下是翻倍扩展,大于等于1.25倍增加</span></span><br><span class="line">    <span class="keyword">var</span> a []<span class="keyword">int</span></span><br><span class="line">    a = <span class="built_in">append</span>(a, <span class="number">1</span>) <span class="comment">// 追加1个元素</span></span><br><span class="line">    fmt.Println(a)</span><br><span class="line">    a = <span class="built_in">append</span>(a, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// 追加多个元素, 手写解包方式</span></span><br><span class="line">    fmt.Println(a)</span><br><span class="line">    a = <span class="built_in">append</span>(a, []<span class="keyword">int</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;...) <span class="comment">// 追加一个切片, 切片需要解包</span></span><br><span class="line">    fmt.Println(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="切片删除元素"><a href="#切片删除元素" class="headerlink" title="切片删除元素"></a>切片删除元素</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    a = []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">a = a[<span class="number">1</span>:] <span class="comment">// 删除开头1个元素</span></span><br><span class="line">a = <span class="built_in">append</span>(a[:<span class="number">2</span>], a[<span class="number">2</span>+<span class="number">1</span>:]...) <span class="comment">// 删除中间1个元素</span></span><br><span class="line">a = a[:<span class="number">3</span><span class="number">-1</span>] <span class="comment">// 删除尾部1个元素</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="切片复制"><a href="#切片复制" class="headerlink" title="切片复制"></a>切片复制</h5><p>语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span>( destSlice, srcSlice []T) <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 例子</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    slice1 := []<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">    slice2 := []<span class="keyword">int</span>&#123;<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>&#125;</span><br><span class="line">    <span class="built_in">copy</span>(slice2, slice1) <span class="comment">// 只会复制slice1的前3个元素到slice2中</span></span><br><span class="line">    <span class="built_in">copy</span>(slice1, slice2) <span class="comment">// 只会复制slice2的3个元素到slice1的前3个位置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="多维切片"><a href="#多维切片" class="headerlink" title="多维切片"></a>多维切片</h5><p>语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sliceName [][]...[]sliceType</span><br></pre></td></tr></table></figure><p><img src="/image/Golang03/Golang03_001.png" alt=""></p><h4 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h4><p>map是一种元素对（pair）的无序集合，pair 对应一个 key（索引）和一个 value（值），所以这个结构也称为关联数组或字典。</p><p>声明语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mapname <span class="keyword">map</span>[keytype]valuetype</span><br><span class="line"><span class="built_in">make</span>(<span class="keyword">map</span>[keytype]valuetype, <span class="built_in">cap</span>)</span><br></pre></td></tr></table></figure><ul><li>mapname 为 map 的变量名。</li><li>keytype 为键类型。</li><li>valuetype 是键对应的值类型。</li><li>cap 预设的容量。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">mapLit := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>&#123;<span class="string">"one"</span>: <span class="number">1</span>, <span class="string">"two"</span>: <span class="number">2</span>&#125;</span><br><span class="line">mapCreated := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">float32</span>)</span><br><span class="line">mapCreated[<span class="string">"key1"</span>] = <span class="number">4.5</span></span><br><span class="line">mapCreated[<span class="string">"key2"</span>] = <span class="number">3.14159</span></span><br><span class="line">mapLit[<span class="string">"two"</span>] = <span class="number">3</span></span><br><span class="line">fmt.Printf(<span class="string">"Map literal at \"one\" is: %d\n"</span>, mapLit[<span class="string">"one"</span>])</span><br><span class="line">fmt.Printf(<span class="string">"Map created at \"key2\" is: %f\n"</span>, mapCreated[<span class="string">"key2"</span>])</span><br><span class="line">fmt.Printf(<span class="string">"Map assigned at \"two\" is: %d\n"</span>, mapLit[<span class="string">"two"</span>])</span><br><span class="line">fmt.Printf(<span class="string">"Map literal at \"ten\" is: %d\n"</span>, mapLit[<span class="string">"ten"</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="map的高级用法"><a href="#map的高级用法" class="headerlink" title="map的高级用法"></a>map的高级用法</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 声明</span></span><br><span class="line">scene := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line"><span class="comment">// 初始化</span></span><br><span class="line">  scene[<span class="string">"route"</span>] = <span class="number">66</span></span><br><span class="line">  scene[<span class="string">"brazil"</span>] = <span class="number">4</span></span><br><span class="line">scene[<span class="string">"china"</span>] = <span class="number">960</span></span><br><span class="line"><span class="comment">// 遍历</span></span><br><span class="line">  <span class="keyword">for</span> k, v := <span class="keyword">range</span> scene &#123;</span><br><span class="line">        fmt.Println(k, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除指定key</span></span><br><span class="line"><span class="built_in">delete</span>(scene, <span class="string">"brazil"</span>)</span><br><span class="line">fmt.Println(scene)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><p>list是一种非连续的存储容器，由多个节点组成，节点通过变量记录彼此之间的关系，列表有多种实现方法，如单链表、双链表等。</p><p>列表的原理可以这样理解：假设 A、B、C 三个人都有电话号码，如果 A 把号码告诉给 B，B 把号码告诉给 C，这个过程就建立了一个单链表结构，如下图所示。</p><p><img src="/image/Golang03/Golang03_002.png" alt=""></p><p>如果在这个基础上，再从 C 开始将自己的号码告诉给自己所知道号码的主人，这样就形成了双链表结构，如下图所示。</p><p><img src="/image/Golang03/Golang03_003.png" alt=""></p><p>那么如果需要获得所有人的号码，只需要从 A 或者 C 开始，要求他们将自己的号码发出来，然后再通知下一个人如此循环，这样就构成了一个列表遍历的过程。</p><p>如果 B 换号码了，他需要通知 A 和 C，将自己的号码移除，这个过程就是列表元素的删除操作，如下图所示。</p><p><img src="/image/Golang03/Golang03_004.png" alt=""></p><h5 id="列表的初始化"><a href="#列表的初始化" class="headerlink" title="列表的初始化"></a>列表的初始化</h5><ul><li>1.通过 container/list 包的 New() 函数初始化 list</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 := list.New()</span><br></pre></td></tr></table></figure><ul><li>2.通过 var 关键字声明初始化 list</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 变量名 list.List</span><br></pre></td></tr></table></figure><h5 id="遍历列表"><a href="#遍历列表" class="headerlink" title="遍历列表"></a>遍历列表</h5><p>遍历双链表需要配合 Front() 函数获取头元素，遍历时只要元素不为空就可以继续进行，每一次遍历都会调用元素的 Next() 函数</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"container/list"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 创建一个 list</span></span><br><span class="line">l := list.New()</span><br><span class="line"><span class="comment">//把4元素放在最后</span></span><br><span class="line">e4 := l.PushBack(<span class="number">4</span>)</span><br><span class="line"><span class="comment">//把1元素放在最前</span></span><br><span class="line">e1 := l.PushFront(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// 遍历所有元素并打印其内容</span></span><br><span class="line"><span class="keyword">for</span> e := l.Front(); e != <span class="literal">nil</span>; e = e.Next() &#123;</span><br><span class="line">fmt.Println(e.Value)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="在列表中插入元素"><a href="#在列表中插入元素" class="headerlink" title="在列表中插入元素"></a>在列表中插入元素</h5><table><thead><tr><th>方 法</th><th>功 能</th></tr></thead><tbody><tr><td>InsertAfter(v interface {}, mark <em> Element) </em> Element</td><td>在 mark 点之后插入元素，mark 点由其他插入函数提供</td></tr><tr><td>InsertBefore(v interface {}, mark <em> Element) </em>Element</td><td>在 mark 点之前插入元素，mark 点由其他插入函数提供</td></tr><tr><td>PushBackList(other *List)</td><td>添加 other 列表元素到尾部</td></tr><tr><td>PushFrontList(other *List)</td><td>添加 other 列表元素到头部</td></tr></tbody></table><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"container/list"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 创建一个 list</span></span><br><span class="line">l := list.New()</span><br><span class="line"><span class="comment">//把4元素放在最后</span></span><br><span class="line">e4 := l.PushBack(<span class="number">4</span>)</span><br><span class="line"><span class="comment">//把1元素放在最前</span></span><br><span class="line">e1 := l.PushFront(<span class="number">1</span>)</span><br><span class="line"><span class="comment">//在e4元素前面插入3</span></span><br><span class="line">l.InsertBefore(<span class="number">3</span>, e4)</span><br><span class="line"><span class="comment">//在e1后面插入2</span></span><br><span class="line">l.InsertAfter(<span class="number">2</span>, e1)</span><br><span class="line"><span class="comment">// 遍历所有元素并打印其内容</span></span><br><span class="line"><span class="keyword">for</span> e := l.Front(); e != <span class="literal">nil</span>; e = e.Next() &#123;</span><br><span class="line">fmt.Println(e.Value)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="从列表中删除元素"><a href="#从列表中删除元素" class="headerlink" title="从列表中删除元素"></a>从列表中删除元素</h5><p>列表插入函数的返回值会提供一个 *list.Element 结构，这个结构记录着列表元素的值以及与其他节点之间的关系等信息，从列表中删除元素时，需要用到这个结构进行快速删除。</p><p>直接看例子:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"container/list"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">l := list.New()</span><br><span class="line"><span class="comment">// 尾部添加</span></span><br><span class="line">l.PushBack(<span class="string">"canon"</span>)</span><br><span class="line"><span class="comment">// 头部添加</span></span><br><span class="line">l.PushFront(<span class="number">67</span>)</span><br><span class="line"><span class="comment">// 尾部添加后保存元素句柄</span></span><br><span class="line">element := l.PushBack(<span class="string">"fist"</span>)</span><br><span class="line"><span class="comment">// 在fist之后添加high</span></span><br><span class="line">l.InsertAfter(<span class="string">"high"</span>, element)</span><br><span class="line"><span class="comment">// 在fist之前添加noon</span></span><br><span class="line">l.InsertBefore(<span class="string">"noon"</span>, element)</span><br><span class="line"><span class="comment">// 遍历所有元素并打印其内容</span></span><br><span class="line"><span class="keyword">for</span> e := l.Front(); e != <span class="literal">nil</span>; e = e.Next() &#123;</span><br><span class="line">fmt.Println(e.Value)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用</span></span><br><span class="line">l.Remove(element)</span><br><span class="line">fmt.Println(<span class="string">"删除后"</span>)</span><br><span class="line"><span class="comment">// 遍历所有元素并打印其内容</span></span><br><span class="line"><span class="keyword">for</span> e := l.Front(); e != <span class="literal">nil</span>; e = e.Next() &#123;</span><br><span class="line">fmt.Println(e.Value)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="二、结构体"><a href="#二、结构体" class="headerlink" title="二、结构体"></a>二、结构体</h3><p>结构体是一种复合类型，由零个或多个任意类型的值聚合成的实体，每个值都可以称为结构体的成员。</p><p>定义如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> 类型名 <span class="keyword">struct</span> &#123;</span><br><span class="line">    字段<span class="number">1</span> 字段<span class="number">1</span>类型</span><br><span class="line">    字段<span class="number">2</span> 字段<span class="number">2</span>类型</span><br><span class="line">    …</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>类型名：标识自定义结构体的名称，在同一个包内不能重复。</li><li>struct{}：表示结构体类型</li><li>字段1、字段2……：表示结构体字段名，结构体中的字段名必须唯一。</li><li>字段1类型、字段2类型……：表示结构体各个字段的类型,可以是结构体。</li></ul><h4 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 定义只是一种内存布局的描述，只有当实例化时，才会真正地分配内存</span></span><br><span class="line"><span class="keyword">type</span> Point <span class="keyword">struct</span> &#123;</span><br><span class="line">X <span class="keyword">int</span></span><br><span class="line">Y <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">// 实例化</span></span><br><span class="line"><span class="keyword">var</span> p Point</span><br><span class="line"><span class="comment">// 用.访问</span></span><br><span class="line">p.X = <span class="number">10</span></span><br><span class="line">p.Y = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">fmt.Println(p.X)</span><br><span class="line">fmt.Println(p.Y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还可以通过以下两种方式实例化：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ins := <span class="built_in">new</span>(T)</span><br><span class="line">ins := &amp;T&#123;&#125;</span><br></pre></td></tr></table></figure><ul><li>T 表示结构体类型</li><li>ins：T 类型被实例化后保存到 ins 变量中，ins 的类型为 *T，属于指针。</li></ul><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ins := 结构体类型名&#123;</span><br><span class="line">    字段<span class="number">1</span>: 字段<span class="number">1</span>的值,</span><br><span class="line">    字段<span class="number">2</span>: 字段<span class="number">2</span>的值,</span><br><span class="line">    …</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ins := 结构体类型名&#123;</span><br><span class="line">    字段<span class="number">1</span>的值,</span><br><span class="line">    字段<span class="number">2</span>的值,</span><br><span class="line">    …</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">type</span> People <span class="keyword">struct</span> &#123;</span><br><span class="line">name  <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line">relation := &amp;People&#123;</span><br><span class="line">name: <span class="string">"爷爷"</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Address <span class="keyword">struct</span> &#123;</span><br><span class="line">Province    <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line">addr := Address&#123;</span><br><span class="line"><span class="string">"四川"</span>,</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(relation.name)</span><br><span class="line">fmt.Println(addr.Province)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="匿名结构体"><a href="#匿名结构体" class="headerlink" title="匿名结构体"></a>匿名结构体</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ins := <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">// 匿名结构体字段定义</span></span><br><span class="line">    字段<span class="number">1</span> 字段类型<span class="number">1</span></span><br><span class="line">    字段<span class="number">2</span> 字段类型<span class="number">2</span></span><br><span class="line">    …</span><br><span class="line">&#125;&#123;</span><br><span class="line">    <span class="comment">// 字段值初始化</span></span><br><span class="line">    初始化字段<span class="number">1</span>: 字段<span class="number">1</span>的值,</span><br><span class="line">    初始化字段<span class="number">2</span>: 字段<span class="number">2</span>的值,</span><br><span class="line">    …</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 实例化一个匿名结构体</span></span><br><span class="line">msg := &amp;<span class="keyword">struct</span> &#123;  <span class="comment">// 定义部分</span></span><br><span class="line">id   <span class="keyword">int</span></span><br><span class="line">data <span class="keyword">string</span></span><br><span class="line">&#125;&#123;  <span class="comment">// 值初始化部分</span></span><br><span class="line"><span class="number">1024</span>,</span><br><span class="line"><span class="string">"hello"</span>,</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(msg.id)</span><br><span class="line">fmt.Println(msg.data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="三、接口"><a href="#三、接口" class="headerlink" title="三、接口"></a>三、接口</h3><p>接口是一组方法的集合，可以理解为抽象的类型。它提供了一种非侵入式的接口。任何类型只要实现了该接口中方法集，那么就属于这个类型。</p><p>接口声明的格式:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> 接口类型名 <span class="keyword">interface</span>&#123;</span><br><span class="line">    方法名<span class="number">1</span>( 参数列表<span class="number">1</span> ) 返回值列表<span class="number">1</span></span><br><span class="line">    方法名<span class="number">2</span>( 参数列表<span class="number">2</span> ) 返回值列表<span class="number">2</span></span><br><span class="line">    …</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>接口类型名：使用 type 将接口定义为自定义的类型名。Go语言的接口在命名时，一般会在单词后面添加 er，如有写操作的接口叫 Writer</li><li>方法名：当方法名首字母是大写时，且这个接口类型名首字母也是大写时，这个方法可以被接口所在的包（package）之外的代码访问。（小写屏蔽隐藏机制）</li><li>参数列表、返回值列表：参数列表和返回值列表中的参数变量名可以被忽略</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个鸭子接口</span></span><br><span class="line"><span class="keyword">type</span> Duck <span class="keyword">interface</span> &#123;</span><br><span class="line">Quack()   <span class="comment">// 鸭子叫</span></span><br><span class="line">DuckGo()  <span class="comment">// 鸭子走</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 现在有只鸡类型</span></span><br><span class="line"><span class="keyword">type</span> Chicken <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span> <span class="title">IsChicken</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"我是小鸡"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这只鸡会鸭子叫和鸭子走</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span> <span class="title">Quack</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"嘎嘎"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Chicken)</span> <span class="title">DuckGo</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"大摇大摆的走"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个函数，负责执行鸭子能做的事情</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DoDuck</span><span class="params">(d Duck)</span></span> &#123;</span><br><span class="line">d.Quack()</span><br><span class="line">d.DuckGo()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">c := Chicken&#123;&#125;</span><br><span class="line">DoDuck(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>接口的方法 与 实现接口的类型方法格式一致</li><li>接口中所有方法均被实现</li></ul><h4 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h4><p>如果想判断 一个使用在接口值上的操作，用于检查接口类型变量所持有的值是否实现了期望的接口或者具体的类型。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value, ok := x.(T)</span><br></pre></td></tr></table></figure><ul><li>x 表示一个接口的类型</li><li>T 表示一个具体的类型（也可为接口类型）</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="comment">// 可以接受任何类型的数据</span></span><br><span class="line"><span class="keyword">var</span> x <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">x = <span class="number">10</span></span><br><span class="line">value1, ok1 := x.(<span class="keyword">int</span>)</span><br><span class="line">fmt.Print(value1, <span class="string">","</span>, ok1, <span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line">x = <span class="literal">nil</span></span><br><span class="line">value2, ok2 := x.(<span class="keyword">int</span>)</span><br><span class="line">fmt.Print(value2, <span class="string">","</span>, ok2, <span class="string">"\n"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getType</span><span class="params">(a <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> a.(<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">int</span>:</span><br><span class="line">        fmt.Println(<span class="string">"the type of a is int"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">string</span>:</span><br><span class="line">        fmt.Println(<span class="string">"the type of a is string"</span>)</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">float64</span>:</span><br><span class="line">        fmt.Println(<span class="string">"the type of a is float"</span>)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        fmt.Println(<span class="string">"unknown type"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> a <span class="keyword">int</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line">    getType(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="接口排序"><a href="#接口排序" class="headerlink" title="接口排序"></a>接口排序</h4><p>其实可以用来排序。内置接口 sort.Interface,它需要知道三个东西：序列的长度，表示两个元素比较的结果，一种交换两个元素的方式,它就会给你排序</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"sort"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将[]string定义为MyStringList类型</span></span><br><span class="line"><span class="keyword">type</span> MyStringList []<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现sort.Interface接口的获取元素数量方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m MyStringList)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">len</span>(m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现sort.Interface接口的比较元素方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m MyStringList)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> m[i] &lt; m[j]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现sort.Interface接口的交换元素方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m MyStringList)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">m[i], m[j] = m[j], m[i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 准备一个内容被打乱顺序的字符串切片</span></span><br><span class="line">names := MyStringList&#123;</span><br><span class="line"><span class="string">"3. Triple Kill"</span>,</span><br><span class="line"><span class="string">"5. Penta Kill"</span>,</span><br><span class="line"><span class="string">"2. Double Kill"</span>,</span><br><span class="line"><span class="string">"4. Quadra Kill"</span>,</span><br><span class="line"><span class="string">"1. First Blood"</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用sort包进行排序</span></span><br><span class="line">sort.Sort(names)</span><br><span class="line"><span class="comment">// 遍历打印结果</span></span><br><span class="line"><span class="keyword">for</span> _, v := <span class="keyword">range</span> names &#123;</span><br><span class="line">fmt.Printf(<span class="string">"%s\n"</span>, v)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="四、进程"><a href="#四、进程" class="headerlink" title="四、进程"></a>四、进程</h3><p><strong>进程</strong>：是程序在操作系统中的一次执行过程，系统进行资源分配和调度的一个独立单位。 </p><p><strong>线程</strong>：是进程的一个执行实体，是 CPU 调度和分派的基本单位，它是比进程更小的能独立运行的基本单位。 一个进程可以创建和撤销多个线程，同一个进程中的多个线程之间可以并发执行。</p><p><img src="/image/Golang03/Golang03_005.png" alt=""></p><p><strong>协程</strong>：协程是一种用户态的轻量级线程，由用户控制协程的调度。线程进程都是同步机制，而协程则是异步，只不过协程能保留上一次调用时的状态，每次切换回来时，就相当于进入上一次调用的状态。</p><p><img src="/image/Golang03/Golang03_006.png" alt=""></p><p><strong>并发</strong>： 多线程程序在单核心的 cpu 上运行，取得多个任务，利用时序切换不同任务执行.请看下图：</p><p><img src="/image/Golang03/Golang03_007.png" alt=""></p><p><strong>并行</strong>： 多线程程序在多核心的 cpu 上运行.取得多个任务，并同时去执行所取得的这些任务。相当于将长长的一条队列，划分成了多条短队列，所以并行缩短了任务队列的长度。请看下图：</p><p><img src="/image/Golang03/Golang03_008.png" alt=""></p><h4 id="goroutine"><a href="#goroutine" class="headerlink" title="goroutine"></a>goroutine</h4><p>go 并发是 让某个函数独立运行的能力，这个核心就是goroutine。goroutine有点类似协程，一个goroutine就是一个独立的工作单元，运行时通过算法调度这些goroutine来运行，在单个进程里执行成千上万的并发任务。</p><p>语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> 函数名( 参数列表 )</span><br></pre></td></tr></table></figure><ul><li>函数名：要调用的函数名。</li><li>参数列表：调用函数需要传入的参数。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">running</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> times <span class="keyword">int</span></span><br><span class="line"><span class="comment">// 构建一个无限循环</span></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">times++</span><br><span class="line">fmt.Println(<span class="string">"tick"</span>, times)</span><br><span class="line"><span class="comment">// 延时1秒</span></span><br><span class="line">time.Sleep(time.Second)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 并发执行程序</span></span><br><span class="line"><span class="keyword">go</span> running()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 接受命令行输入, 不做任何事情</span></span><br><span class="line">    <span class="keyword">var</span> input <span class="keyword">string</span></span><br><span class="line">    fmt.Scanln(&amp;input)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用匿名函数创建goroutine"><a href="#使用匿名函数创建goroutine" class="headerlink" title="使用匿名函数创建goroutine"></a>使用匿名函数创建goroutine</h4><p>语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">( 参数列表 )</span></span>&#123;</span><br><span class="line">    函数体</span><br><span class="line">&#125;( 调用参数列表 )</span><br></pre></td></tr></table></figure><ul><li>参数列表：函数体内的参数变量列表。</li><li>函数体：匿名函数的代码。</li><li>调用参数列表：启动 goroutine 时，需要向匿名函数传递的调用参数。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> times <span class="keyword">int</span></span><br><span class="line">        <span class="keyword">for</span> &#123;</span><br><span class="line">            times++</span><br><span class="line">            fmt.Println(<span class="string">"tick"</span>, times)</span><br><span class="line">            time.Sleep(time.Second)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="keyword">var</span> input <span class="keyword">string</span></span><br><span class="line">    fmt.Scanln(&amp;input)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>1.一个是主进程执行过快，导致其他协程没有执行；</li><li>2.多个协程之间用到相同的数据；</li></ul><h4 id="等待组"><a href="#等待组" class="headerlink" title="等待组"></a>等待组</h4><table><thead><tr><th>方法名</th><th>功能</th></tr></thead><tbody><tr><td>(wg * WaitGroup) Add(delta int)</td><td>等待组的计数器 +1</td></tr><tr><td>(wg * WaitGroup) Done()</td><td>等待组的计数器 -1</td></tr><tr><td>(wg * WaitGroup) Wait()</td><td>当等待组计数器不等于 0 时阻塞直到变 0。</td></tr></tbody></table><p>使用步骤：</p><ul><li>1.利用wg.Add(delta)先增加计数器的个数</li><li>2.再利用wg.Done()减少计数器的个数，最后让计数器等于0</li><li>3.当等待组计数器等于0，才会执行wg.Wait()后面的代码，不然就一直阻塞</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"net/http"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 声明一个等待组</span></span><br><span class="line"><span class="keyword">var</span> wg sync.WaitGroup</span><br><span class="line"><span class="comment">// 准备一系列的网站地址</span></span><br><span class="line"><span class="keyword">var</span> urls = []<span class="keyword">string</span>&#123;</span><br><span class="line"><span class="string">"https://www.baidu.com/"</span>,</span><br><span class="line"><span class="string">"https://www.sougou.com/"</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 遍历这些地址</span></span><br><span class="line"><span class="keyword">for</span> _, url := <span class="keyword">range</span> urls &#123;</span><br><span class="line"><span class="comment">// 每一个任务开始时, 将等待组增加1</span></span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// 开启一个并发</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(url <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="comment">// 使用defer, 表示函数完成时将等待组值减1</span></span><br><span class="line"><span class="keyword">defer</span> wg.Done()</span><br><span class="line"><span class="comment">// 使用http访问提供的地址</span></span><br><span class="line">_, err := http.Get(url)</span><br><span class="line"><span class="comment">// 访问完成后, 打印地址和可能发生的错误</span></span><br><span class="line">fmt.Println(url, err)</span><br><span class="line"><span class="comment">// 通过参数传递url地址</span></span><br><span class="line">&#125;(url)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 等待所有的任务完成</span></span><br><span class="line">wg.Wait()</span><br><span class="line">fmt.Println(<span class="string">"over"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="资源竞争"><a href="#资源竞争" class="headerlink" title="资源竞争"></a>资源竞争</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">count <span class="keyword">int32</span></span><br><span class="line">wg    sync.WaitGroup</span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">wg.Add(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">go</span> incCount()</span><br><span class="line"><span class="keyword">go</span> incCount()</span><br><span class="line">wg.Wait()</span><br><span class="line">fmt.Println(count)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">incCount</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">defer</span> wg.Done()</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">2</span>; i++ &#123;</span><br><span class="line">fmt.Println(<span class="string">"count:"</span>,count)</span><br><span class="line">value := count</span><br><span class="line"><span class="comment">// 是让当前 goroutine 暂停的意思，退回执行队列，让其他等待的 goroutine 运行，目的是为了使资源竞争的结果更明显。</span></span><br><span class="line">runtime.Gosched()</span><br><span class="line">value++</span><br><span class="line">count = value</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>预期是4,实际结果 2/3/4之间随机出现. 因为 count 变量没有任何同步保护，所以两个 goroutine 都会对其进行读写，会导致对已经计算好的结果被覆盖，以至于产生错误结果。</p><h5 id="锁住共享资源"><a href="#锁住共享资源" class="headerlink" title="锁住共享资源"></a>锁住共享资源</h5><p>解决方案1:锁住共享资源</p><ul><li>原子函数: 以很底层的加锁机制来同步访问整型变量和指针<ul><li>atomic.AddInt64 : 安全地加一个整型值的方式</li><li>atomic.LoadInt64 : 安全地读一个整型值的方式</li><li>atomic.StoreInt64 : 安全地写一个整型值的方式</li></ul></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line"><span class="string">"sync/atomic"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">counter <span class="keyword">int64</span></span><br><span class="line">wg      sync.WaitGroup</span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">wg.Add(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">go</span> incCounter(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> incCounter(<span class="number">2</span>)</span><br><span class="line">wg.Wait() <span class="comment">//等待goroutine结束</span></span><br><span class="line">fmt.Println(counter)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">incCounter</span><span class="params">(id <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">defer</span> wg.Done()</span><br><span class="line"><span class="keyword">for</span> count := <span class="number">0</span>; count &lt; <span class="number">2</span>; count++ &#123;</span><br><span class="line"><span class="comment">//安全的对counter加1</span></span><br><span class="line">atomic.AddInt64(&amp;counter, <span class="number">1</span>) </span><br><span class="line">fmt.Println(<span class="string">"counter:"</span>,counter)</span><br><span class="line">runtime.Gosched()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="互斥锁"><a href="#互斥锁" class="headerlink" title="互斥锁"></a>互斥锁</h5><p>方案2:使用互斥锁。</p><ul><li>互斥锁:在代码上创建一个临界区，保证同一时间只有一个 goroutine 可以执行这个临界代码。<ul><li>sync.Mutex：暴力锁， 当一个 goroutine 获得了 Mutex 后，其他 goroutine 就只能乖乖等到这个 goroutine 释放该 Mutex。<ul><li>Lock() 加锁</li><li>Unlock() 解锁</li></ul></li><li>sync.RWMutex： 基于sync.Mutex产生的单写多读模型，运行多个 goroutine 读，读的时候不允许写入，写的时候不允许读。<ul><li>Lock()和Unlock()用于申请和释放写锁</li><li>RLock()和RUnlock()用于申请和释放读锁</li></ul></li></ul></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"runtime"</span></span><br><span class="line"><span class="string">"sync"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">counter <span class="keyword">int64</span></span><br><span class="line">wg      sync.WaitGroup</span><br><span class="line">mutex   sync.Mutex</span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">wg.Add(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">go</span> incCounter(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> incCounter(<span class="number">2</span>)</span><br><span class="line">wg.Wait()</span><br><span class="line">fmt.Println(counter)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">incCounter</span><span class="params">(id <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">defer</span> wg.Done()</span><br><span class="line"><span class="keyword">for</span> count := <span class="number">0</span>; count &lt; <span class="number">2</span>; count++ &#123;</span><br><span class="line"><span class="comment">//同一时刻只允许一个goroutine进入这个临界区</span></span><br><span class="line">mutex.Lock()</span><br><span class="line">&#123;</span><br><span class="line">value := counter</span><br><span class="line">runtime.Gosched()</span><br><span class="line">value++</span><br><span class="line">counter = value</span><br><span class="line">&#125;</span><br><span class="line">mutex.Unlock() <span class="comment">//释放锁，允许其他正在等待的goroutine进入临界区</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="channel"><a href="#channel" class="headerlink" title="channel"></a>channel</h4><p><img src="/image/Golang03/Golang03_009.png" alt=""></p><p>通道（channel）是一种特殊的类型。在任何时候，同时只能有一个 goroutine 访问通道进行发送和获取数据。goroutine 间通过通道就可以通信。</p><p>通道像一个传送带或者队列，总是遵循先入先出（First In First Out）的规则，保证收发数据的顺序。</p><p>声明语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 通道变量 <span class="keyword">chan</span> 通道类型</span><br></pre></td></tr></table></figure><ul><li>通道类型：通道内的数据类型。</li><li>通道变量：保存通道的变量。</li></ul><p>创建语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通道实例 := <span class="built_in">make</span>(<span class="keyword">chan</span>类型 通道类型, 缓冲大小)</span><br></pre></td></tr></table></figure><ul><li>chan类型：<ul><li>chan&lt;- 只能用来发送</li><li>&lt;-chan 只能用来接收</li><li>chan 用来发送和接收</li></ul></li><li>通道类型：和无缓冲通道用法一致，影响通道发送和接收的数据类型。</li><li>缓冲大小：决定通道最多可以保存的元素数量。<ul><li><strong>无缓冲通道</strong>：不设置。进行发送 goroutine 需要被接收后才可以继续发送。接收的goroutine 也同理。</li><li><strong>缓冲通道</strong>：设置大小，缓存大小为设置个数。进行发送goroutine 可以在发送元素达到缓存上限之前，继续发。接收的goroutine 需要通道元素不为零，就可以一直接收。</li></ul></li><li>通道实例：被创建出的通道实例。</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">senderOnly := <span class="built_in">make</span>(<span class="keyword">chan</span>&lt;- <span class="keyword">int</span>)   <span class="comment">// 只能用来发送（管道的入口，只进不出）</span></span><br><span class="line">receiverOnly := <span class="built_in">make</span>(&lt;-<span class="keyword">chan</span> <span class="keyword">int</span>) <span class="comment">// 只能用来接收（管道的出口，只出不进）</span></span><br><span class="line">unbuffer := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)       <span class="comment">// 无缓冲可收发</span></span><br><span class="line">buffer := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">2</span>)      <span class="comment">// 无缓冲可收发</span></span><br><span class="line">fmt.Println(senderOnly, receiverOnly, unbuffer, buffer)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>使用通道收发数据:</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通道变量 &lt;- 值</span><br><span class="line">收到的值 := &lt;-通道变量</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"start main"</span>)</span><br><span class="line">    <span class="comment">// 创建通道</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result <span class="keyword">int</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(<span class="string">"come into goroutine1"</span>)</span><br><span class="line"><span class="keyword">var</span> r <span class="keyword">int</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++ &#123;</span><br><span class="line">r += i</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发送数据到通道</span></span><br><span class="line">ch &lt;- r</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(<span class="string">"come into goroutine2"</span>)</span><br><span class="line"><span class="keyword">var</span> r <span class="keyword">int</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++ &#123;</span><br><span class="line">r *= i</span><br><span class="line">&#125;</span><br><span class="line">        <span class="comment">// 发送数据到通道</span></span><br><span class="line">ch &lt;- r</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="built_in">println</span>(<span class="string">"come into goroutine3"</span>)</span><br><span class="line">        <span class="comment">// 发送数据到通道</span></span><br><span class="line">ch &lt;- <span class="number">11</span></span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">3</span>; i++ &#123;</span><br><span class="line">        <span class="comment">// 接受数据并累加</span></span><br><span class="line">result += &lt;-ch</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">close</span>(ch)</span><br><span class="line">fmt.Println(<span class="string">"result is:"</span>, result)</span><br><span class="line">fmt.Println(<span class="string">"end main"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"start main"</span>)</span><br><span class="line"><span class="comment">// 创建一个3个元素缓冲大小的整型通道</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment">// 查看当前通道的大小</span></span><br><span class="line">fmt.Println(<span class="string">"通道的大小:"</span>,<span class="built_in">len</span>(ch))</span><br><span class="line"><span class="comment">// 开启一个并发匿名函数</span></span><br><span class="line"><span class="comment">// 开启一个并发匿名函数</span></span><br><span class="line">ch &lt;- <span class="number">1</span></span><br><span class="line">ch &lt;- <span class="number">2</span></span><br><span class="line">ch &lt;- <span class="number">3</span></span><br><span class="line">fmt.Println(<span class="string">"通道的大小:"</span>,<span class="built_in">len</span>(ch))</span><br><span class="line"><span class="comment">// 遍历接收通道数据</span></span><br><span class="line"><span class="keyword">for</span> data := <span class="keyword">range</span> ch &#123;</span><br><span class="line"><span class="comment">// 打印通道数据</span></span><br><span class="line">fmt.Println(data)</span><br><span class="line"><span class="comment">// 当遇到数据0时, 退出接收循环</span></span><br><span class="line"><span class="keyword">if</span> data == <span class="number">3</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">"end main"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="超时通道"><a href="#超时通道" class="headerlink" title="超时通道"></a>超时通道</h5><p>因为发送元素到通道,如果没有及时被接收,就会造成阻塞.所以我们可以结合select进行超时判断:</p><p>语法结构如下:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> &lt;-chan1:</span><br><span class="line">    <span class="comment">// 如果chan1成功读到数据，则进行该case处理语句</span></span><br><span class="line">    <span class="keyword">case</span> chan2 &lt;- <span class="number">1</span>:</span><br><span class="line">    <span class="comment">// 如果成功向chan2写入数据，则进行该case处理语句</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">    <span class="comment">// 如果上面都没有成功，则进入default处理流程</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 创建普通通道</span></span><br><span class="line">ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>)</span><br><span class="line"><span class="comment">// 创建超时通道</span></span><br><span class="line">quit := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"><span class="comment">//新开一个协程</span></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"><span class="keyword">case</span> num := &lt;-ch:</span><br><span class="line">fmt.Println(<span class="string">"num = "</span>, num)</span><br><span class="line"><span class="keyword">case</span> &lt;-time.After(<span class="number">3</span> * time.Second):</span><br><span class="line"><span class="comment">// 经过了3秒</span></span><br><span class="line">fmt.Println(<span class="string">"超时"</span>)</span><br><span class="line">quit &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">ch &lt;- i</span><br><span class="line"><span class="comment">// 等待1秒再读取</span></span><br><span class="line">time.Sleep(time.Second)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 从超时通道获取到信息，退出进程</span></span><br><span class="line">&lt;-quit</span><br><span class="line">fmt.Println(<span class="string">"程序结束"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="控制性能"><a href="#控制性能" class="headerlink" title="控制性能"></a>控制性能</h4><p>使用下面命令设置程序运行占用的cpu核数。（默认使用机器的最大核数）</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 程序运行占用的cpu核数</span></span><br><span class="line">runtime.GOMAXPROCS(逻辑CPU数量)</span><br><span class="line"><span class="comment">// 查询机器的cpu核数</span></span><br><span class="line">runtime.NumCPU()</span><br></pre></td></tr></table></figure><p>逻辑CPU的数量：</p><ul><li>&lt;1：不修改任何数值。</li><li>=1：单核心执行。</li><li><blockquote><p>1：多核并发执行。</p></blockquote></li></ul><h3 id="五、reflect"><a href="#五、reflect" class="headerlink" title="五、reflect"></a>五、reflect</h3><p>程序在编译时变量被转换为内存地址，变量名不会被编译器写入到可执行部分，所以在运行程序时程序无法获取自身的信息。但是 <strong>反射</strong> 可以在程序运行期对程序本身进行访问和修改。</p><table><thead><tr><th>类型</th><th>作用</th></tr></thead><tbody><tr><td>reflect.ValueOf()</td><td>获取输入参数接口中的数据的值，如果为空则返回0 &lt;- 注意是0</td></tr><tr><td>reflect.TypeOf()</td><td>动态获取输入参数接口中的值的类型，如果为空则返回nil &lt;- 注意是nil</td></tr></tbody></table><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 定义一个Enum类型</span></span><br><span class="line"><span class="keyword">type</span> Enum <span class="keyword">float32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name Enum = <span class="number">3.1415926</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TypeOf会返回目标数据的类型，比如int/float/struct/指针等</span></span><br><span class="line">reflectType := reflect.TypeOf(name)</span><br><span class="line"></span><br><span class="line"><span class="comment">// valueOf返回目标数据的的值，比如上文的 3.1415926</span></span><br><span class="line">reflectValue := reflect.ValueOf(name)</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">"类型: "</span>, reflectType)</span><br><span class="line">fmt.Println(<span class="string">"类型的名称: "</span>, reflectType.Name())</span><br><span class="line">fmt.Println(<span class="string">"类型的种类: "</span>, reflectType.Kind())</span><br><span class="line">fmt.Println(<span class="string">"变量值: "</span>, reflectValue)</span><br><span class="line">fmt.Println(<span class="string">"变量值的种类: "</span>, reflectValue.Kind())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>变量类型是指针与指针指向的元素：需要使用Elem方法。</li></ul><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td>Field(i int) StructField</td><td>根据索引返回索引对应的结构体字段的信息，当值不是结构体或索引超界时发生宕机</td></tr><tr><td>NumField() int</td><td>返回结构体成员字段数量，当类型不是结构体或索引超界时发生宕机</td></tr><tr><td>FieldByName(name string) (StructField, bool)</td><td>根据给定字符串返回字符串对应的结构体字段的信息，没有找到时 bool 返回 false，当类型不是结构体或索引超界时发生宕机</td></tr><tr><td>FieldByIndex(index []int) StructField</td><td>多层成员访问时，根据 []int 提供的每个结构体的字段索引，返回字段的信息，没有找到时返回零值。当类型不是结构体或索引超界时发生宕机</td></tr><tr><td>FieldByNameFunc(match func(string) bool) (StructField,bool)</td><td>根据匹配函数匹配需要的字段，当值不是结构体或索引超界时发生宕机</td></tr></tbody></table><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 声明一个空结构体</span></span><br><span class="line"><span class="keyword">type</span> cat <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建cat的实例</span></span><br><span class="line">ins := &amp;cat&#123;&#125;</span><br><span class="line"><span class="comment">// 获取结构体实例的反射类型对象</span></span><br><span class="line">typeOfCat := reflect.TypeOf(ins)</span><br><span class="line"><span class="comment">// 显示反射类型对象的名称和种类</span></span><br><span class="line">fmt.Printf(<span class="string">"name:'%v' kind:'%v'\n"</span>, typeOfCat.Name(), typeOfCat.Kind())</span><br><span class="line"><span class="comment">// 取类型的元素</span></span><br><span class="line">typeOfCat = typeOfCat.Elem()</span><br><span class="line"><span class="comment">// 显示反射类型对象的名称和种类</span></span><br><span class="line">fmt.Printf(<span class="string">"element name: '%v', element kind: '%v'\n"</span>, typeOfCat.Name(), typeOfCat.Kind())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用 reflect.Type 的 Field() 方法会返回 StructField 结构，这个结构描述结构体的成员信息：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> StructField <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span>          <span class="comment">// 字段名</span></span><br><span class="line">    PkgPath <span class="keyword">string</span>       <span class="comment">// 字段路径</span></span><br><span class="line">    Type      Type       <span class="comment">// 字段反射类型对象</span></span><br><span class="line">    Tag       StructTag  <span class="comment">// 字段的结构体标签</span></span><br><span class="line">    Offset    <span class="keyword">uintptr</span>    <span class="comment">// 字段在结构体中的相对偏移</span></span><br><span class="line">    Index     []<span class="keyword">int</span>      <span class="comment">// Type.FieldByIndex中的返回的索引值</span></span><br><span class="line">    Anonymous <span class="keyword">bool</span>       <span class="comment">// 是否为匿名字段</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 声明一个空结构体</span></span><br><span class="line">    <span class="keyword">type</span> cat <span class="keyword">struct</span> &#123;</span><br><span class="line">        Name <span class="keyword">string</span></span><br><span class="line">        <span class="comment">// 带有结构体tag的字段。tag：类似添加的注解，格式 `key1:"value1" key2:"value2"`</span></span><br><span class="line">        Type <span class="keyword">int</span> <span class="string">`json:"type" id:"100"`</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 创建cat的实例</span></span><br><span class="line">    ins := cat&#123;Name: <span class="string">"mimi"</span>, Type: <span class="number">1</span>&#125;</span><br><span class="line">    <span class="comment">// 获取结构体实例的反射类型对象</span></span><br><span class="line">    typeOfCat := reflect.TypeOf(ins)</span><br><span class="line">    <span class="comment">// 遍历结构体所有成员</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; typeOfCat.NumField(); i++ &#123;</span><br><span class="line">        <span class="comment">// 获取每个成员的结构体字段类型</span></span><br><span class="line">        fieldType := typeOfCat.Field(i)</span><br><span class="line">        <span class="comment">// 输出成员名和tag</span></span><br><span class="line">        fmt.Printf(<span class="string">"name: %v  tag: '%v'\n"</span>, fieldType.Name, fieldType.Tag)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 通过字段名, 找到字段类型信息</span></span><br><span class="line">    <span class="keyword">if</span> catType, ok := typeOfCat.FieldByName(<span class="string">"Type"</span>); ok &#123;</span><br><span class="line">        <span class="comment">// 从tag中取出需要的tag</span></span><br><span class="line">        fmt.Println(catType.Tag.Get(<span class="string">"json"</span>), catType.Tag.Get(<span class="string">"id"</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="反射三大定律"><a href="#反射三大定律" class="headerlink" title="反射三大定律"></a>反射三大定律</h4><ul><li>定律一：反射可以将“接口类型变量”转换为“反射类型对象” ：普通变量 -&gt; 接口变量 -&gt; 反射对象：<br>•</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TypeOf</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">Type</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">ValueOf</span><span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">Value</span></span></span><br></pre></td></tr></table></figure><h5 id="1-反射可以将“接口类型变量”转换为“反射类型对象"><a href="#1-反射可以将“接口类型变量”转换为“反射类型对象" class="headerlink" title="1.反射可以将“接口类型变量”转换为“反射类型对象"></a>1.反射可以将“接口类型变量”转换为“反射类型对象</h5><p>普通变量 -&gt; 接口变量 -&gt; 反射对象：</p><ul><li>1.我们调用 reflect.TypeOf(name) 时，name被存储在一个空接口变量中,然后被传递过去；</li></ul><p><img src="/image/Golang03/Golang03_010.png" alt=""></p><ul><li>2.接着<strong>reflect.TypeOf</strong> 或者 <strong>ValueOf</strong> 对空接口变量转换为 <strong>reflect.Type</strong> 或 <strong>reflect.Value</strong>。打个断点看看，如下图所示：</li></ul><p><img src="/image/Golang03/Golang03_011.png" alt=""></p><h5 id="2-反射可以将“反射类型对象”转换为“接口类型变量”"><a href="#2-反射可以将“反射类型对象”转换为“接口类型变量”" class="headerlink" title="2.反射可以将“反射类型对象”转换为“接口类型变量”"></a>2.反射可以将“反射类型对象”转换为“接口类型变量”</h5><p>反射对象 -&gt; 接口变量：使用的是Value 的Interface函数，是把实际的值赋值给空接口变量，它的声明如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(v Value)</span> <span class="title">Interface</span><span class="params">()</span> <span class="params">(i <span class="keyword">interface</span>&#123;&#125;)</span></span></span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">type</span> MyInt <span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> x MyInt = <span class="number">7</span></span><br><span class="line">v := reflect.ValueOf(x)</span><br><span class="line"><span class="comment">// 通过 Interface 方法恢复其接口类型，然后再通过 接口断言获取值</span></span><br><span class="line">y := v.Interface().(MyInt)</span><br><span class="line">fmt.Printf(<span class="string">"类型：%T\n"</span>, y)</span><br><span class="line">fmt.Println(<span class="string">"值："</span>, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-要修改“反射类型对象”其值必须是“可写的”"><a href="#3-要修改“反射类型对象”其值必须是“可写的”" class="headerlink" title="3.要修改“反射类型对象”其值必须是“可写的”"></a>3.要修改“反射类型对象”其值必须是“可写的”</h5><ul><li>通过 CanSet 方法判断 reflect.Value 类型变量的“可写性”,看一下下面的例子：</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 声明整型变量a并赋初值</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">int</span> = <span class="number">1024</span></span><br><span class="line"><span class="comment">// 获取变量a的反射值对象</span></span><br><span class="line">valueOfA := reflect.ValueOf(a)</span><br><span class="line">fmt.Println(<span class="string">"可写性:"</span>, valueOfA.CanSet())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>可写性</strong>，其实就是 <strong>可以被寻址</strong> 。</p><h4 id="通过反射修改变量的值"><a href="#通过反射修改变量的值" class="headerlink" title="通过反射修改变量的值"></a>通过反射修改变量的值</h4><ul><li>1.获取元素的地址，获取其反射值对象</li><li>2.获取其反射值对象的元素，修改值</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 声明整型变量a并赋初值</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">int</span> = <span class="number">1024</span></span><br><span class="line"><span class="comment">// 获取变量a的反射值对象(a的地址)</span></span><br><span class="line">valueOfA := reflect.ValueOf(&amp;a)</span><br><span class="line"><span class="comment">// 取出a地址的元素(a的值)</span></span><br><span class="line">valueOfA = valueOfA.Elem()</span><br><span class="line"><span class="comment">// 修改a的值为1</span></span><br><span class="line">valueOfA.SetInt(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// 打印a的值</span></span><br><span class="line">fmt.Println(valueOfA.Int())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果变量类型是结构体，需要考虑字段是否可以被导出。（首字符大写，小写会被隐蔽）</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">type</span> dog <span class="keyword">struct</span> &#123;</span><br><span class="line">LegCount <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 获取dog实例地址的反射值对象</span></span><br><span class="line">valueOfDog := reflect.ValueOf(&amp;dog&#123;&#125;)</span><br><span class="line"><span class="comment">// 取出dog实例地址的元素</span></span><br><span class="line">valueOfDog = valueOfDog.Elem()</span><br><span class="line"><span class="comment">// 获取LegCount字段的值</span></span><br><span class="line">vLegCount := valueOfDog.FieldByName(<span class="string">"LegCount"</span>)</span><br><span class="line"><span class="comment">// 设置LegCount的值</span></span><br><span class="line">vLegCount.SetInt(<span class="number">4</span>)</span><br><span class="line">fmt.Println(vLegCount.Int())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><ul><li>取元素、取地址及修改值的属性方法请参考下表：</li></ul><table><thead><tr><th>方法名</th><th>备 注</th></tr></thead><tbody><tr><td>Elem() Value</td><td>取值指向的元素值，类似于语言层*操作。当值类型不是指针或接口时发生宕 机，空指针时返回 nil 的 Value</td></tr><tr><td>Addr() Value</td><td>对可寻址的值返回其地址，类似于语言层&amp;操作。当值不可寻址时发生宕机</td></tr><tr><td>CanAddr() bool</td><td>表示值是否可寻址</td></tr><tr><td>CanSet() bool</td><td>返回值能否被修改。要求值可寻址且是导出的字段</td></tr><tr><td>Set(x Value)</td><td>将值设置为传入的反射值对象的值</td></tr></tbody></table><ul><li>值修改相关方法如下表所示：</li></ul><table><thead><tr><th>Set(x Value)</th><th>将值设置为传入的反射值对象的值</th></tr></thead><tbody><tr><td>Setlnt(x int64)</td><td>使用 int64 设置值。当值的类型不是 int、int8、int16、 int32、int64 时会发生宕机</td></tr><tr><td>SetUint(x uint64)</td><td>使用 uint64 设置值。当值的类型不是 uint、uint8、uint16、uint32、uint64 时会发生宕机</td></tr><tr><td>SetFloat(x float64)</td><td>使用 float64 设置值。当值的类型不是 float32、float64 时会发生宕机</td></tr><tr><td>SetBool(x bool)</td><td>使用 bool 设置值。当值的类型不是 bod 时会发生宕机</td></tr><tr><td>SetBytes(x []byte)</td><td>设置字节数组 []bytes值。当值的类型不是 []byte 时会发生宕机</td></tr><tr><td>SetString(x string)</td><td>设置字符串值。当值的类型不是 string 时会发生宕机</td></tr></tbody></table><h3 id="六、文件读写"><a href="#六、文件读写" class="headerlink" title="六、文件读写"></a>六、文件读写</h3><p>使用语法如下所示：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">OpenFile</span><span class="params">(name <span class="keyword">string</span>, flag <span class="keyword">int</span>, perm FileMode)</span> <span class="params">(file *File, err error)</span></span></span><br></pre></td></tr></table></figure><ul><li>name :文件的文件名，如果不是在当前路径下需要加上具体路径</li><li>flag：文件的处理参数，表面上是int，实际上是枚举值。,如果要使用多个参数,需要用’|’连接<ul><li>O_RDONLY：只读模式打开文件；</li><li>O_WRONLY：只写模式打开文件；</li><li>O_RDWR：读写模式打开文件；</li><li>O_APPEND：写操作时将数据附加到文件尾部（追加）；</li><li>O_CREATE：如果不存在将创建一个新文件；</li><li>O_EXCL：和 O_CREATE 配合使用，文件必须不存在，否则返回一个错误；</li><li>O_SYNC：当进行一系列写操作时，每次都要等待上次的 I/O 操作完成再进行；</li><li>O_TRUNC：如果可能，在打开时清空文件。</li></ul></li><li>perm：文件读/写/执行权限，同unix，有四位。<ul><li>第一位：<ul><li>4 ： set uid，设置使文件在执行阶段具有文件所有者的权限.</li><li>2 ： set gid，目录被设置该位后, 任何用户在此目录下创建的文件都具有和该目录所属的组相同的组.</li><li>1 ： sticky bit，防删除位.</li></ul></li><li>第二位：文件的所有者拥有的权限，如果同时拥有多种权限，把数字累加<ul><li>4：读</li><li>2：写</li><li>1：执行</li></ul></li><li>第三位：文件属组成员拥有的权限，如果同时拥有多种权限，把数字累加<ul><li>4：读</li><li>2：写</li><li>1：执行</li></ul></li><li>第四位：其他用户拥有的权限，如果同时拥有多种权限，把数字累加<ul><li>4：读</li><li>2：写</li><li>1：执行</li></ul></li></ul></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"bufio"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 创建一个新文件，</span></span><br><span class="line">filePath := <span class="string">"golang.txt"</span></span><br><span class="line"><span class="comment">// 设置创建和可写</span></span><br><span class="line">file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_CREATE, <span class="number">0666</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件打开失败"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//及时关闭file句柄</span></span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br><span class="line"><span class="comment">//使用带缓存的 *Writer 写入文件，内容为 5 句 “Hello World”</span></span><br><span class="line">write := bufio.NewWriter(file)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">write.WriteString(<span class="string">"Hello World \n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Flush将缓存的文件真正写入到文件中</span></span><br><span class="line">write.Flush()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"bufio"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">filePath := <span class="string">"golang.txt"</span></span><br><span class="line"><span class="comment">// 设置读写权限和追加模式</span></span><br><span class="line">file, err := os.OpenFile(filePath, os.O_RDWR|os.O_APPEND, <span class="number">0666</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件打开失败"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//及时关闭file句柄</span></span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br><span class="line"><span class="comment">//读原来文件的内容，并且显示在终端</span></span><br><span class="line">reader := bufio.NewReader(file)</span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">str, err := reader.ReadString(<span class="string">'\n'</span>)</span><br><span class="line"><span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Print(str)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//写入文件时，使用带缓存的 *Writer</span></span><br><span class="line">write := bufio.NewWriter(file)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">write.WriteString(<span class="string">"Hello Golang \n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Flush将缓存的文件真正写入到文件中</span></span><br><span class="line">write.Flush()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="各种格式文件处理"><a href="#各种格式文件处理" class="headerlink" title="各种格式文件处理"></a>各种格式文件处理</h4><h5 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h5><p>JSON 文件内容一般是这样子：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"key1"</span>:<span class="string">"value1"</span>,<span class="attr">"key2"</span>:<span class="string">"value2"</span>,<span class="attr">"key3"</span>:[<span class="string">"value3"</span>,<span class="string">"value4"</span>,<span class="string">"value5"</span>]&#125;</span><br></pre></td></tr></table></figure><p>我们可以使用内置的 encoding/json 标准库去处理</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/json"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Website <span class="keyword">struct</span> &#123;</span><br><span class="line">Name   <span class="keyword">string</span> <span class="string">`xml:"name,attr"`</span></span><br><span class="line">Url    <span class="keyword">string</span></span><br><span class="line">Course []<span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 1.写入文件</span></span><br><span class="line"><span class="comment">// 定义了写个文件内容</span></span><br><span class="line">infoWrite := []Website&#123;&#123;<span class="string">"Golang"</span>, <span class="string">"https://golang.org/"</span>, []<span class="keyword">string</span>&#123;<span class="string">"http://www.baidu.com/"</span>&#125;&#125;,</span><br><span class="line">&#123;<span class="string">"Java"</span>, <span class="string">"https://www.java.com/zh_CN/"</span>, []<span class="keyword">string</span>&#123;<span class="string">"http://www.google.com/java/"</span>&#125;&#125;&#125;</span><br><span class="line"><span class="comment">// 创建文件</span></span><br><span class="line">filePtrWrite, err := os.Create(<span class="string">"info.json"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件创建失败"</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建Json编码器</span></span><br><span class="line">encoder := json.NewEncoder(filePtrWrite)</span><br><span class="line">err = encoder.Encode(infoWrite)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"编码错误"</span>, err.Error())</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"编码成功"</span>)</span><br><span class="line">&#125;</span><br><span class="line">filePtrWrite.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.读取文件</span></span><br><span class="line">filePtrRead, err := os.Open(<span class="string">"./info.json"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件打开失败 [Err:%s]"</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> filePtrRead.Close()</span><br><span class="line"><span class="keyword">var</span> infoRead []Website</span><br><span class="line"><span class="comment">// 创建json解码器</span></span><br><span class="line">decoder := json.NewDecoder(filePtrRead)</span><br><span class="line">err = decoder.Decode(&amp;infoRead)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"解码失败"</span>, err.Error())</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"解码成功"</span>)</span><br><span class="line">fmt.Println(infoRead)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h5><p>对于XML，我们可以使用 encoidng/xml 包</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/xml"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> Website <span class="keyword">struct</span> &#123;</span><br><span class="line">Name   <span class="keyword">string</span> <span class="string">`xml:"name,attr"`</span></span><br><span class="line">Url    <span class="keyword">string</span></span><br><span class="line">Course []<span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 1.写入文件</span></span><br><span class="line"><span class="comment">// 定义写入信息</span></span><br><span class="line">infoWrite := Website&#123;<span class="string">"Golang"</span>, <span class="string">"https://golang.org/"</span>, []<span class="keyword">string</span>&#123;<span class="string">"http://www.baidu.com/"</span>&#125;&#125;</span><br><span class="line">f1, err := os.Create(<span class="string">"./info.xml"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件创建失败"</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 序列化到文件中</span></span><br><span class="line">encoder := xml.NewEncoder(f1)</span><br><span class="line">err = encoder.Encode(infoWrite)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"编码错误："</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"编码成功"</span>)</span><br><span class="line">&#125;</span><br><span class="line">f1.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.读取文件</span></span><br><span class="line"><span class="comment">// 打开xml文件</span></span><br><span class="line">f2, err := os.Open(<span class="string">"./info.xml"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"文件打开失败：%v"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> f2.Close()</span><br><span class="line">infoRead := Website&#123;&#125;</span><br><span class="line"><span class="comment">//创建 xml 解码器</span></span><br><span class="line">decoder := xml.NewDecoder(f2)</span><br><span class="line">err = decoder.Decode(&amp;infoRead)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"解码失败：%v"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"解码成功"</span>)</span><br><span class="line">fmt.Println(infoRead)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Gob"><a href="#Gob" class="headerlink" title="Gob"></a>Gob</h5><p>Gob（即 Go binary 的缩写），Go语言自己以二进制形式序列化和反序列化程序数据的格式。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"encoding/gob"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 1.写入文件</span></span><br><span class="line">info := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line"><span class="string">"name"</span>:    <span class="string">"Golang"</span>,</span><br><span class="line"><span class="string">"website"</span>: <span class="string">"https://golang.org/"</span>,</span><br><span class="line">&#125;</span><br><span class="line">name := <span class="string">"demo.gob"</span></span><br><span class="line">File1, _ := os.OpenFile(name, os.O_RDWR|os.O_CREATE, <span class="number">0777</span>)</span><br><span class="line">enc := gob.NewEncoder(File1)</span><br><span class="line"><span class="keyword">if</span> err := enc.Encode(info); err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">File1.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.读取文件</span></span><br><span class="line"><span class="keyword">var</span> M <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">File2, _ := os.Open(<span class="string">"demo.gob"</span>)</span><br><span class="line">D := gob.NewDecoder(File2)</span><br><span class="line">D.Decode(&amp;M)</span><br><span class="line">fmt.Println(M)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="bin"><a href="#bin" class="headerlink" title="bin"></a>bin</h5><p>关于其他二进制文件，可以使用 encoding/binary处理。</p><p>语法如下：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Write</span><span class="params">(w io.Writer, order ByteOrder, data <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">Read</span><span class="params">(r io.Reader, order ByteOrder, data <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">error</span></span></span><br></pre></td></tr></table></figure><ul><li>w:可以读出字节流的数据源</li><li>r:可以写入字节流的数据源</li><li>order:指定写入/读取数据的字节序<ul><li>binary.LittleEndian:小端模式,按照从低地址到高地址的顺序,存放据的低位字节到高位字节</li><li>binary.BigEndian:大端模式,按照从低地址到高地址的顺序,存放数据的高位字节到低位字节</li></ul></li><li>data:必须是定长值、定长值的切片、定长值的指针</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"bytes"</span></span><br><span class="line"><span class="string">"encoding/binary"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> Website <span class="keyword">struct</span> &#123;</span><br><span class="line">Url <span class="keyword">int32</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取文件</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readNextBytes</span><span class="params">(file *os.File, number <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">bytes := <span class="built_in">make</span>([]<span class="keyword">byte</span>, number)</span><br><span class="line">_, err := file.Read(bytes)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"解码失败"</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> bytes</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 1.写入文件</span></span><br><span class="line">file1, err := os.Create(<span class="string">"output.bin"</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">info := Website&#123;</span><br><span class="line"><span class="keyword">int32</span>(i),</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件创建失败 "</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> binBuf bytes.Buffer</span><br><span class="line">binary.Write(&amp;binBuf, binary.LittleEndian, info)</span><br><span class="line">b := binBuf.Bytes()</span><br><span class="line">_, err = file1.Write(b)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"编码失败"</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">"编码成功"</span>)</span><br><span class="line">file1.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.读取文件</span></span><br><span class="line"><span class="comment">// 打开文件</span></span><br><span class="line">file2, err := os.Open(<span class="string">"output.bin"</span>)</span><br><span class="line"><span class="keyword">defer</span> file2.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件打开失败"</span>, err.Error())</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">m := Website&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">data := readNextBytes(file2, <span class="number">4</span>)</span><br><span class="line">buffer := bytes.NewBuffer(data)</span><br><span class="line">err = binary.Read(buffer, binary.LittleEndian, &amp;m)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"二进制文件读取失败"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">"第"</span>, i, <span class="string">"个值为："</span>, m)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"archive/zip"</span></span><br><span class="line"><span class="string">"bytes"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 1.压缩文件</span></span><br><span class="line"><span class="comment">// 创建一个缓冲区用来保存压缩文件内容</span></span><br><span class="line">buf := <span class="built_in">new</span>(bytes.Buffer)</span><br><span class="line"><span class="comment">// 创建一个压缩文档</span></span><br><span class="line">w := zip.NewWriter(buf)</span><br><span class="line"><span class="comment">// 将文件加入压缩文档</span></span><br><span class="line"><span class="keyword">var</span> files = []<span class="keyword">struct</span> &#123;</span><br><span class="line">Name, Body <span class="keyword">string</span></span><br><span class="line">&#125;&#123;</span><br><span class="line">&#123;<span class="string">"Golang.txt"</span>, <span class="string">"https://golang.org/"</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line">f, err := w.Create(file.Name)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">_, err = f.Write([]<span class="keyword">byte</span>(file.Body))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 关闭压缩文档</span></span><br><span class="line">err := w.Close()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 将压缩文档内容写入文件</span></span><br><span class="line">f, err := os.OpenFile(<span class="string">"file.zip"</span>, os.O_CREATE|os.O_WRONLY, <span class="number">0666</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">buf.WriteTo(f)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.解压文件</span></span><br><span class="line"><span class="comment">// 打开一个zip格式文件</span></span><br><span class="line">r, err := zip.OpenReader(<span class="string">"file.zip"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> r.Close()</span><br><span class="line"><span class="comment">// 迭代压缩文件中的文件，打印出文件中的内容</span></span><br><span class="line"><span class="keyword">for</span> _, f := <span class="keyword">range</span> r.File &#123;</span><br><span class="line">fmt.Printf(<span class="string">"文件名: %s\n"</span>, f.Name)</span><br><span class="line">rc, err := f.Open()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 创建文件</span></span><br><span class="line">w, err := os.Create(f.Name)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 写入文件</span></span><br><span class="line">_, err = io.CopyN(w, rc, <span class="keyword">int64</span>(f.UncompressedSize64))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(err.Error())</span><br><span class="line">&#125;</span><br><span class="line">w.Close()</span><br><span class="line">rc.Close()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h5><ul><li>压缩的步骤如下：<ul><li>1.创建一个文件 x.tar，然后向 x.tar 写入 tar 头部信息；</li><li>2.打开要被 tar 的文件，向 x.tar 写入头部信息，然后向 x.tar 写入文件信息；</li><li>3.当有多个文件需要被 tar 时，重复第二步直到所有文件都被写入到 x.tar 中；</li><li>4.关闭 x.tar，完成打包。</li></ul></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"archive/tar"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">f, err := os.Create(<span class="string">"./output.tar"</span>) <span class="comment">//创建一个 tar 文件</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line">tw := tar.NewWriter(f)</span><br><span class="line"><span class="keyword">defer</span> tw.Close()</span><br><span class="line">fileinfo, err := os.Stat(<span class="string">"Golang.txt"</span>) <span class="comment">//获取文件相关信息</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">hdr, err := tar.FileInfoHeader(fileinfo, <span class="string">""</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">err = tw.WriteHeader(hdr) <span class="comment">//写入头文件信息</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">f1, err := os.Open(<span class="string">"Golang.txt"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">m, err := io.Copy(tw, f1) <span class="comment">//将Golang.txt文件中的信息写入压缩包中</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(m)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>解压的步骤如下：<ul><li>1.打开文件 x.tar，然后从这个 tar 头部中循环读取存储在这个归档文件内的文件头信息；</li><li>2.从这个文件头里读取文件名，以这个文件名创建文件，然后向这个文件里写入数据即可；</li></ul></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"archive/tar"</span></span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"io"</span></span><br><span class="line"><span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">f, err := os.Open(<span class="string">"output.tar"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"文件打开失败"</span>, err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line">r := tar.NewReader(f)</span><br><span class="line"><span class="keyword">for</span> hdr, err := r.Next(); err != io.EOF; hdr, err = r.Next() &#123;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fileinfo := hdr.FileInfo()</span><br><span class="line">fmt.Println(fileinfo.Name())</span><br><span class="line">f, err := os.Create(fileinfo.Name()+<span class="string">"2"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> f.Close()</span><br><span class="line">_, err = io.Copy(f, r)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="各种格式的速度以及大小对比"><a href="#各种格式的速度以及大小对比" class="headerlink" title="各种格式的速度以及大小对比"></a>各种格式的速度以及大小对比</h4><table><thead><tr><th>后缀</th><th>读取</th><th>写入</th><th>大小(KiB)</th><th>读/写LOC</th><th>格式</th></tr></thead><tbody><tr><td>.gob</td><td>0.3</td><td>0.2</td><td>7948</td><td>21 + 11 =32</td><td>Go二进制</td></tr><tr><td>.gob.gz</td><td>0.5</td><td>1.5</td><td>2589</td><td></td><td></td></tr><tr><td>json</td><td>4.5</td><td>2.2</td><td>16283</td><td>32+17 = 49</td><td>JSON</td></tr><tr><td>.json.gz</td><td>4.5</td><td>3.4</td><td>2678</td><td></td><td></td></tr><tr><td>.xml</td><td>6.7</td><td>1.2</td><td>18917</td><td>45 + 30 = 75</td><td>XML</td></tr><tr><td>.xml.gz</td><td>6.9</td><td>2.7</td><td>2730</td><td></td><td></td></tr><tr><td>.txt</td><td>1.9</td><td>1.0</td><td>12375</td><td>86 + 53 = 139</td><td>纯文本（UTF-8）</td></tr><tr><td>.txt.gz</td><td>2.2</td><td>2.2</td><td>2514</td><td></td><td></td></tr><tr><td>.bin</td><td>1.7</td><td>3.5</td><td>7250</td><td>128 + 87 = 215</td><td>自定义二进制</td></tr><tr><td>.bin.gz</td><td>1.6</td><td>2.6</td><td>2400</td><td></td></tr></tbody></table><p>More info: <a href="http://c.biancheng.net/golang/" target="_blank" rel="noopener">Golang</a></p>]]></content>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Golang（二）Go语言的基本语法(上)</title>
      <link href="/2021/03/15/Golang02/"/>
      <url>/2021/03/15/Golang02/</url>
      <content type="html"><![CDATA[<p>　　本文章主要介绍 Golang 的基本语法。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、变量"><a href="#一、变量" class="headerlink" title="一、变量"></a>一、变量</h3><h4 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h4><ul><li>基本<ul><li>布尔型</li><li>数值<ul><li>整型</li><li>浮点</li><li>复数</li></ul></li><li>字符串</li></ul></li><li>派生<ul><li>指针</li><li>数值</li><li>结构</li><li>管道</li><li>函数</li><li>切片</li></ul></li></ul><h4 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h4><h5 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 标准格式</span></span><br><span class="line"><span class="keyword">var</span> 变量名(命名规则遵循骆驼命名法,例如:aBit) 变量类型</span><br><span class="line"></span><br><span class="line"><span class="comment">// 批量格式</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    a <span class="keyword">int</span></span><br><span class="line">    b <span class="keyword">string</span></span><br><span class="line">    c []<span class="keyword">float32</span></span><br><span class="line">    d <span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function">    <span class="title">e</span> <span class="title">struct</span></span> &#123;</span><br><span class="line">        x <span class="keyword">int</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h5 id="样例"><a href="#样例" class="headerlink" title="样例"></a>样例</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// c++</span></span><br><span class="line"><span class="keyword">int</span>* a,b; <span class="comment">//a 是指针而 b 不是</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// go</span></span><br><span class="line"><span class="keyword">var</span> a, b *<span class="keyword">int</span> <span class="comment">//a b 都是指针</span></span><br></pre></td></tr></table></figure><h5 id="简短格式"><a href="#简短格式" class="headerlink" title="简短格式"></a>简短格式</h5><ul><li>定义变量,同时显式初始化</li><li>不能提供数据类型</li><li>只能用在函数内部</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">名字 := 表达式</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main    <span class="comment">// 声明 main 包</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span>       <span class="comment">// 导入 fmt 包，打印字符串是需要用到</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;   <span class="comment">// 声明 main 主函数</span></span><br><span class="line">i, j := <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    fmt.Println(i,j) <span class="comment">// 打印 Hello World!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="匿名变量"><a href="#匿名变量" class="headerlink" title="匿名变量"></a>匿名变量</h5><p>匿名变量是一个下画线”_”(空白标识符),仅用于声明,不能存储值.</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main    <span class="comment">// 声明 main 包</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span>       <span class="comment">// 导入 fmt 包，打印字符串是需要用到</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetData</span><span class="params">()</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">100</span>, <span class="number">200</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    a, _ := GetData()</span><br><span class="line">    _, b := GetData()</span><br><span class="line">    fmt.Println(a, b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="变量同时赋值"><a href="#变量同时赋值" class="headerlink" title="变量同时赋值"></a>变量同时赋值</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main    <span class="comment">// 声明 main 包</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span>       <span class="comment">// 导入 fmt 包，打印字符串是需要用到</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;   <span class="comment">// 声明 main 主函数</span></span><br><span class="line">    <span class="keyword">var</span> a <span class="keyword">int</span> = <span class="number">100</span></span><br><span class="line">    <span class="keyword">var</span> b <span class="keyword">int</span> = <span class="number">200</span></span><br><span class="line">    b, a = a, b</span><br><span class="line">    fmt.Println(a, b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h4><ul><li>函数内定义的变量称为局部变量</li><li>函数外定义的变量称为全局变量</li><li>函数定义中的变量称为形式参数</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">//全局变量 a</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    num := a + b</span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//局部变量 a 和 b</span></span><br><span class="line">    c,d := <span class="number">3</span>,<span class="number">4</span></span><br><span class="line">    f := sum(c, d)</span><br><span class="line">    fmt.Printf(<span class="string">"%d\n"</span>, f)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="数据类型转换"><a href="#数据类型转换" class="headerlink" title="数据类型转换"></a>数据类型转换</h4><ul><li>Go语言不存在隐式类型转换,所以类型转换都必须显式声明</li><li><em>只有相同底层类型的变量之间才可以进行转换（例如 int16 转换成 int32）.不同将引起编译错误（例如 bool 转换为 int）</em></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类型 B 的值 = 类型 B(类型 A 的值)</span></span><br><span class="line">valueOfTypeB = typeB(valueOfTypeA)</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">        <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 初始化一个32位整型值</span></span><br><span class="line">        <span class="keyword">var</span> a <span class="keyword">int32</span> = <span class="number">1008600</span></span><br><span class="line">        <span class="comment">// 输出变量的十六进制形式和十进制值</span></span><br><span class="line">        fmt.Printf(<span class="string">"int32: 0x%x %d\n"</span>, a, a)</span><br><span class="line">        <span class="comment">// 将a变量数值转换为十六进制, 发生数值截断</span></span><br><span class="line">        b := <span class="keyword">int16</span>(a)</span><br><span class="line">        <span class="comment">// 输出变量的十六进制形式和十进制值</span></span><br><span class="line">        fmt.Printf(<span class="string">"int16: 0x%x %d\n"</span>, b, b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><strong><strong>字符串和数值类型的相互转换</strong></strong></p><p>  Go中的 strconv 包( Atoi()、Itia()、parse 系列函数、format 系列函数、append 系列函数等)为我们提供了字符串和基本数据类型之间的转换功能.</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">"fmt"</span></span><br><span class="line"><span class="string">"strconv"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str1 := <span class="string">"10010"</span></span><br><span class="line">str2 := <span class="string">"t"</span></span><br><span class="line">    <span class="comment">// 字符串转换数字</span></span><br><span class="line">num1, err := strconv.Atoi(str1)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"%v 转换失败！"</span>, str1)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"type:%T value:%#v\n"</span>, num1, num1)</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// 字符串转换数字</span></span><br><span class="line">num2, err := strconv.Atoi(str2)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"%v 转换失败！"</span>, str2)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"type:%T value:%#v\n"</span>, num2, num2)</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// 字符串转换布尔型</span></span><br><span class="line">boo1, err := strconv.ParseBool(str1)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"str1: %v\n"</span>, err)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(boo1)</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">// 字符串转换布尔型</span></span><br><span class="line">boo2, err := strconv.ParseBool(str2)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"str2: %v\n"</span>, err)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(boo2)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="特殊的变量"><a href="#特殊的变量" class="headerlink" title="特殊的变量"></a>特殊的变量</h4><p>一个变量存储一个值的内存地址</p><ul><li>声明指针变量</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> var_name var_type = var_value</span><br><span class="line"><span class="keyword">var</span> ptr *var_type</span><br></pre></td></tr></table></figure><ul><li>为指针变量赋值变量的存储地址</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ptr := &amp;var_name</span><br></pre></td></tr></table></figure><ul><li>访问指针变量中指向地址的值</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*ptr</span><br></pre></td></tr></table></figure><ul><li><em>当一个指针被定义后没有分配到任何变量时,它的值为 nil</em></li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="keyword">var</span> a <span class="keyword">int</span>= <span class="number">10</span>   <span class="comment">/* 声明实际变量 */</span></span><br><span class="line">   <span class="keyword">var</span> ak *<span class="keyword">int</span>  <span class="comment">/* 1.声明指针变量 */</span></span><br><span class="line"></span><br><span class="line">   ak = &amp;a  <span class="comment">/* 2.为指针变量赋值变量的存储地址 */</span></span><br><span class="line"></span><br><span class="line">   fmt.Printf(<span class="string">"a 变量的地址是: %x\n"</span>, &amp;a  )</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* 指针变量的存储地址 */</span></span><br><span class="line">   fmt.Printf(<span class="string">"ak 变量储存的指针地址: %x\n"</span>, ak )</span><br><span class="line"></span><br><span class="line">   <span class="comment">/* 3.使用指针访问值 */</span></span><br><span class="line">   fmt.Printf(<span class="string">"*ak 变量的值: %d\n"</span>, *ak )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><p>Go语言中的常量使用关键字 const 定义，用于存储不会改变的数据，常量是在编译时被创建的，即使定义在函数内部也是如此，并且只能是布尔型、数字型（整数型、浮点型和复数）和字符串型。由于编译时的限制，定义常量的表达式必须为能被编译器求值的常量表达式。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pi = <span class="number">3.14159</span> <span class="comment">// 相当于 math.Pi 的近似值</span></span><br></pre></td></tr></table></figure><h6 id="iota-常量生成器"><a href="#iota-常量生成器" class="headerlink" title="iota 常量生成器"></a>iota 常量生成器</h6><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Weekday <span class="keyword">int</span></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">    Sunday Weekday = <span class="literal">iota</span></span><br><span class="line">    Monday</span><br><span class="line">    Tuesday</span><br><span class="line">    Wednesday</span><br><span class="line">    Thursday</span><br><span class="line">    Friday</span><br><span class="line">    Saturday</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h6 id="无类型常量"><a href="#无类型常量" class="headerlink" title="无类型常量"></a>无类型常量</h6><ul><li>常量并没有一个明确的基础类型</li><li>编译器为这些没有明确的基础类型的数字常量提供比基础类型更高精度的算术运算</li></ul><h4 id="变量的生命周期"><a href="#变量的生命周期" class="headerlink" title="变量的生命周期"></a>变量的生命周期</h4><p>变量的生命周期指的是在程序运行期间变量有效存在的时间间隔。</p><ul><li>函数内定义的变量称为局部变量:从声明语句直到该变量不再被引用为止</li><li>函数外定义的变量称为全局变量:程序的运行周期一致</li><li>函数定义中的变量称为形式参数:函数被调用的时候创建</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="keyword">var</span> num <span class="keyword">int</span> <span class="comment">// 全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    num = <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> t := <span class="number">0</span>; t &lt; num; t += <span class="number">1</span> &#123;</span><br><span class="line">x := <span class="keyword">int</span>(t) <span class="comment">// t 形式参数 x 局部变量</span></span><br><span class="line">fmt.Printf(<span class="string">"x: %d\n"</span>, x)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="类型别名"><a href="#类型别名" class="headerlink" title="类型别名"></a>类型别名</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> TypeAlias = Type</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将NewInt定义为int类型</span></span><br><span class="line"><span class="keyword">type</span> NewInt <span class="keyword">int</span></span><br><span class="line"><span class="comment">// 将int取一个别名叫IntAlias</span></span><br><span class="line"><span class="keyword">type</span> IntAlias = <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义商标结构</span></span><br><span class="line"><span class="keyword">type</span> Brand <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 为Brand定义一个别名FakeBrand</span></span><br><span class="line"><span class="keyword">type</span> FakeBrand = Brand</span><br></pre></td></tr></table></figure><ul><li>TypeAlias 只是 Type 的别名，本质上 TypeAlias 与 Type 是同一个类型，</li></ul><h4 id="关键字与标识符"><a href="#关键字与标识符" class="headerlink" title="关键字与标识符"></a>关键字与标识符</h4><h5 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h5><p>关键字即是被Go语言赋予了特殊含义的单词，也可以称为保留字。</p><table><thead><tr><th>break</th><th>default</th><th>func</th><th>interface</th><th>select</th></tr></thead><tbody><tr><td>case</td><td>defer</td><td>go</td><td>map</td><td>struct</td></tr><tr><td>chan</td><td>else</td><td>goto</td><td>package</td><td>switch</td></tr><tr><td>const</td><td>fallthrough</td><td>if</td><td>range</td><td>type</td></tr><tr><td>continue</td><td>for</td><td>import</td><td>return</td><td>var</td></tr></tbody></table><h5 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h5><p>标识符是指Go语言对各种变量、方法、函数等命名时使用的字符序列，标识符由若干个字母、下划线<code>_</code><br>、和数字组成，且第一个字符必须是字母。通俗的讲就是凡可以自己定义的名称都可以叫做标识符。</p><ul><li>由 26 个英文字母、0~9、<code>_</code>组成；</li><li>不能以数字开头，例如 var 1num int 是错误的；</li><li>Go语言中严格区分大小写；</li><li>标识符不能包含空格；</li><li>不能以系统保留关键字作为标识符，比如 break，if 等等。</li></ul><h3 id="二、注释"><a href="#二、注释" class="headerlink" title="二、注释"></a>二、注释</h3><p><strong>注释的定义及使用</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">第一行注释</span></span><br><span class="line"><span class="comment">第二行注释</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="三、语句"><a href="#三、语句" class="headerlink" title="三、语句"></a>三、语句</h3><h4 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h4><h5 id="if"><a href="#if" class="headerlink" title="if"></a>if</h5><p>语法如下:</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 布尔表达式 &#123;</span><br><span class="line">   <span class="comment">/* 在布尔表达式为 true 时执行 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> 布尔表达式 &#123;</span><br><span class="line">   <span class="comment">/* 在布尔表达式为 true 时执行 */</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="comment">/* 在布尔表达式为 false 时执行 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> 布尔表达式<span class="number">1</span> &#123;</span><br><span class="line">   <span class="comment">/* 在布尔表达式1为 true 时执行 */</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> 布尔表达式<span class="number">2</span>&#123;</span><br><span class="line">   <span class="comment">/* 在布尔表达式2为 true 时执行 */</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">   <span class="comment">/* 在布尔表达式1 2都为 false 时执行 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="literal">true</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"在布尔表达式为 true 时执行\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="literal">false</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"在布尔表达式为 true 时执行\n"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"在布尔表达式为 false 时执行\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="literal">false</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"在布尔表达式1为 true 时执行\n"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="literal">false</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"在布尔表达式2为 true 时执行\n"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Printf(<span class="string">"在布尔表达式1和2都为 false 时执行\n"</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><em>关键字if和左边的大括号{必须同一行,关键字else必须和右边的大括号}在同一行,这两条规则都是被编译器强制规定的。</em></strong></p><h5 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h5><p>switch 用于基于不同条件执行不同动作，每一个 case 最后自带 break 语句,匹配成功后就不会执行其他 case,如果需要执行后面的 case,可以使用 fallthrough.</p><p>语法如下:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> <span class="keyword">var</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> val1:</span><br><span class="line">    <span class="comment">/* var 为 val1 时执行 */</span></span><br><span class="line">    <span class="keyword">case</span> val2:</span><br><span class="line">    <span class="comment">/* var 为 val2 时执行 */</span></span><br><span class="line">    <span class="keyword">case</span> val3,val4,val5:</span><br><span class="line">    <span class="comment">/* var 为 val3或val4或val5 时执行 */</span></span><br><span class="line">    <span class="comment">/* 你可以定义任意数量的 case */</span></span><br><span class="line">    <span class="keyword">default</span>:<span class="comment">//可选</span></span><br><span class="line">    <span class="comment">/* var 都不满足上面的值执行 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> 布尔表达式<span class="number">1</span>:</span><br><span class="line">    <span class="comment">/* 在布尔表达式1为 true 时执行 */</span></span><br><span class="line">    <span class="keyword">case</span> 布尔表达式<span class="number">2</span>:</span><br><span class="line">    <span class="comment">/* 在布尔表达式2为 true 时执行 */</span></span><br><span class="line">    <span class="keyword">case</span> 布尔表达式<span class="number">3</span>,布尔表达式<span class="number">4</span>,布尔表达式<span class="number">5</span>:</span><br><span class="line">    <span class="comment">/* 在布尔表达式3或者4或者5为 true 时执行 */</span></span><br><span class="line">    <span class="comment">/* 你可以定义任意数量的 case */</span></span><br><span class="line">    <span class="keyword">default</span>:<span class="comment">//可选</span></span><br><span class="line">    <span class="comment">/* var 都不满足上面的条件执行 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h4><h5 id="for"><a href="#for" class="headerlink" title="for"></a>for</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 控制变量赋初值; 循环控制条件; 控制变量增量或减量 &#123; </span><br><span class="line">   <span class="comment">/* 循环控制条件为 true 时执行 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">   <span class="comment">/* 无限循环执行 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//类似while</span></span><br><span class="line"><span class="keyword">for</span> 循环控制条件 &#123; </span><br><span class="line">   <span class="comment">/* 循环控制条件为 true 时执行 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> inedex,value:= <span class="keyword">range</span> (字符串/数组/切片)&#123; </span><br><span class="line">   <span class="comment">/* 对字符串、数组、切片等进行迭代输出元素 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">sum := <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">sum += i</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(sum)</span><br><span class="line"><span class="keyword">for</span> j := <span class="number">10</span>; j &lt;= <span class="number">0</span>; j-- &#123;</span><br><span class="line">sum += j</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(sum)</span><br><span class="line"><span class="keyword">for</span> sum &lt;= <span class="number">10</span> &#123;</span><br><span class="line">sum += sum</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(sum)</span><br><span class="line"><span class="keyword">for</span> sum &lt;= <span class="number">10</span> &#123;</span><br><span class="line">sum += sum</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(sum)</span><br><span class="line"><span class="comment">// for &#123;</span></span><br><span class="line"><span class="comment">// sum++ // 无限循环下去</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="comment">// fmt.Println(sum) // 无法输出</span></span><br><span class="line">strings := []<span class="keyword">string</span>&#123;<span class="string">"google"</span>, <span class="string">"alibaba"</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i, s := <span class="keyword">range</span> strings &#123;</span><br><span class="line">fmt.Println(i, s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">numbers := [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i, x := <span class="keyword">range</span> numbers &#123;</span><br><span class="line">fmt.Printf(<span class="string">"第 %d 位的值 = %d\n"</span>, i, x)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="控制语句"><a href="#控制语句" class="headerlink" title="控制语句"></a>控制语句</h4><p>可以控制语句的执行过程.</p><ul><li>break:用于中断当前 for 循环或跳出 switch 语句</li><li>continue:跳过当前循环剩余的语句,进行下一轮循环</li><li>goto:将跳转到被标记的语句</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> == <span class="number">1</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">"this is break."</span>)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> == <span class="number">1</span> &#123;</span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line">fmt.Println(<span class="string">"this is skip statement."</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">LOOP:</span><br><span class="line"><span class="keyword">for</span> i &lt;= <span class="number">10</span> &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line"><span class="keyword">if</span> i == <span class="number">5</span> &#123;</span><br><span class="line"><span class="comment">// 跳过迭代</span></span><br><span class="line">i += <span class="number">1</span></span><br><span class="line"><span class="keyword">goto</span> LOOP</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">"i的值为 : %d\n"</span>, i)</span><br><span class="line">i++</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="四、函数"><a href="#四、函数" class="headerlink" title="四、函数"></a>四、函数</h3><h4 id="普通函数"><a href="#普通函数" class="headerlink" title="普通函数"></a>普通函数</h4><ul><li><p>函数声明:包括函数名、形式参数列表、返回值列表（可省略）以及函数体,语法如下:</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> 函数名<span class="params">(形式参数列表)</span><span class="params">(返回值列表)</span></span>&#123;</span><br><span class="line">    函数体</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><pre><code>- 形式参数列表:函数的参数名以及类型,这些参数作为局部变量,其值由参数调用者提供- 返回值列表:函数返回值的变量名以及类型,如果函数返回一个无名变量或者没有返回值,则返回值列表的括号是可以省略的</code></pre><ul><li><p>调用函数</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">返回值变量列表 = 函数名(参数列表)</span><br></pre></td></tr></table></figure></li></ul><pre><code>- 函数名：需要调用的函数名。- 参数列表：参数变量以逗号分隔，尾部无须以分号结尾。- 返回值变量列表：多个返回值使用逗号分隔。<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(x <span class="keyword">int</span>, y <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123; <span class="keyword">return</span> x + y &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sub</span><span class="params">(x, y <span class="keyword">int</span>)</span> <span class="params">(z <span class="keyword">int</span>)</span></span> &#123; z = x - y; <span class="keyword">return</span> &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zero</span><span class="params">(x <span class="keyword">int</span>, y <span class="keyword">int</span>)</span></span>    &#123; fmt.Printf(<span class="string">"0"</span>) &#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zero</span><span class="params">(args ...<span class="keyword">int</span>)</span></span>    &#123; fmt.Printf(<span class="string">"0"</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    fmt.Printf(<span class="string">"%v\n"</span>, add(<span class="number">2</span>, <span class="number">1</span>)) <span class="comment">// 不带有变量名的返回值</span></span><br><span class="line">    fmt.Printf(<span class="string">"%v\n"</span>, sub(<span class="number">2</span>, <span class="number">1</span>)) <span class="comment">// 带有变量名的返回值</span></span><br><span class="line">    fmt.Printf(<span class="string">"%T\n"</span>, zero)      <span class="comment">// 没有返回值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h4 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h4><ul><li><p>声明 语法如下:</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(参数列表)</span><span class="params">(返回参数列表)</span></span>&#123;</span><br><span class="line">    函数体</span><br><span class="line">&#125;</span><br><span class="line">调用</span><br></pre></td></tr></table></figure></li></ul><pre><code>- 在定义时调用匿名函数- 作为回调函数:把函数作为值保存到变量中,然后调用函数变量<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在定义时调用匿名函数,传递参数为 10086</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span><span class="params">(phone <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"hello"</span>, phone)</span><br><span class="line">    &#125;(<span class="number">10086</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 匿名将匿名函数体保存到f()中</span></span><br><span class="line">    f := <span class="function"><span class="keyword">func</span><span class="params">(phone <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"hello"</span>, phone)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 使用f()调用</span></span><br><span class="line">    f(<span class="number">10086</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre><h5 id="引用了外部变量的匿名函数–闭包"><a href="#引用了外部变量的匿名函数–闭包" class="headerlink" title="引用了外部变量的匿名函数–闭包"></a>引用了外部变量的匿名函数–闭包</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 准备一个字符串</span></span><br><span class="line">  str := <span class="string">"hello world"</span></span><br><span class="line">  <span class="comment">// 创建一个匿名函数</span></span><br><span class="line">  foo := <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 匿名函数中访问str</span></span><br><span class="line">    str = <span class="string">"hello dude"</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 调用匿名函数</span></span><br><span class="line">  foo()</span><br><span class="line">  fmt.Printf(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p>一种作用 于特定类型变量 的函数 。这种特定类型变量叫做接收器（ Receiver ） 。<br>如果将特定类型理解为结构体或“类”时，接收器的概念就类似于其他语言中的 this 或 者 self。<br>在 Go 语言中，接收器的类型可以是任何类型，不仅仅是结构体，任何类型都可以拥有方法。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(variable_name variable_data_type)</span> <span class="title">function_name</span><span class="params">()</span> [<span class="title">return_type</span>]</span>&#123;</span><br><span class="line">    <span class="comment">/* 函数体*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 定义结构体 */</span></span><br><span class="line"><span class="keyword">type</span> Circle <span class="keyword">struct</span> &#123;</span><br><span class="line">  radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//该 method 属于 Circle 类型对象中的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Circle)</span> <span class="title">getArea</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">  <span class="comment">//c.radius 即为 Circle 类型对象中的属性</span></span><br><span class="line">  <span class="keyword">return</span> <span class="number">3.14</span> * c.radius * c.radius</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> c1 Circle</span><br><span class="line">  c1.radius = <span class="number">10.00</span></span><br><span class="line">  fmt.Println(<span class="string">"圆的面积 = "</span>, c1.getArea())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">function_name</span><span class="params">(args ...variable_data_type)</span> [<span class="title">return_type</span>]</span>&#123;</span><br><span class="line">    <span class="comment">/* 函数体*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">myArgs</span><span class="params">(args ...<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">  <span class="keyword">for</span> _, arg := <span class="keyword">range</span> args &#123;</span><br><span class="line">    fmt.Println(arg)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  myArgs(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="延迟执行语句–defer"><a href="#延迟执行语句–defer" class="headerlink" title="延迟执行语句–defer"></a>延迟执行语句–defer</h4><p>将其后面跟随的语句进行延迟处理,在 defer 归属的函数即将返回时,将延迟处理的语句按 defer 的逆序执行</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">  <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  fmt.Println(<span class="string">"defer begin"</span>)</span><br><span class="line">  <span class="comment">// 将defer放入延迟调用栈</span></span><br><span class="line">  <span class="keyword">defer</span> fmt.Println(<span class="number">1</span>)</span><br><span class="line">  <span class="keyword">defer</span> fmt.Println(<span class="number">2</span>)</span><br><span class="line">  <span class="comment">// 最后一个放入, 位于栈顶, 最先调用</span></span><br><span class="line">  <span class="keyword">defer</span> fmt.Println(<span class="number">3</span>)</span><br><span class="line">  fmt.Println(<span class="string">"defer end"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>More info: <a href="http://c.biancheng.net/golang/" target="_blank" rel="noopener">Golang</a></p>]]></content>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Golang（一）Golang的基本概念</title>
      <link href="/2021/02/15/Golang01/"/>
      <url>/2021/02/15/Golang01/</url>
      <content type="html"><![CDATA[<p>　　Go语言（或 Golang）起源于 2007 年，并在 2009 年正式对外发布。Go 是 Google的 Robert Griesemer，Rob Pike 及 Ken Thompson 开发的一种静态强类型、编译型语言。它的主要目标是“兼具<a href="http://c.biancheng.net/python/" target="_blank" rel="noopener">Python</a>等动态语言的开发速度和 C/<a href="http://c.biancheng.net/cplus/" target="_blank" rel="noopener">C++</a>等编译型语言的性能与安全性”。<br>　　本文章主要介绍 Golang 的特点和部署使用。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、特点"><a href="#一、特点" class="headerlink" title="一、特点"></a>一、特点</h3><ul><li>类C语言：相似的表达式语法、控制流结构、基础数据类型、调用参数传值、指针等思想，还有编译后机器码的运行效率以及和现有操作系统的无缝适配。</li><li>不损失应用程序性能的情况下降低代码的复杂性，具有“部署简单、并发性好、语言设计良好、执行性能好”等优势</li><li>强大的网络编程和并发编程支持</li><li>没有类和继承的概念，通过接口（interface）的概念来实现多态性</li></ul><h3 id="二、优势"><a href="#二、优势" class="headerlink" title="二、优势"></a>二、优势</h3><ul><li><a href="https://www.tiobe.com/tiobe-index/" target="_blank" rel="noopener">编程热度</a></li><li>开发和运行效率兼得:Go拥有接近C的运行效率和接近PHP的开发效率</li></ul><p><img src="/image/Golang01/Golang01_001.png" alt=""></p><ul><li>简洁强大的并发:</li></ul><p><img src="/image/Golang01/Golang01_002.png" alt=""></p><ul><li>学习难度低：类C的语法,如果熟悉C语言及其派生语言,一周就可以写出高性能的应用</li></ul><h3 id="三、安装部署"><a href="#三、安装部署" class="headerlink" title="三、安装部署"></a>三、安装部署</h3><h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><p>例如window用户：</p><ul><li>1.点击<a href="https://golang.google.cn/dl/" target="_blank" rel="noopener">官网</a>，选择对应系统包安装，点击下载</li></ul><p><img src="/image/Golang01/Golang01_003.png" alt=""></p><ul><li>2.下载完一路点击安装就可以了。安装完成后，在安装目录下将生成一些目录和文件</li><li>3.设置环境变量<ul><li>win+E,然后右键<strong>这台电脑</strong>→<strong>属性</strong>→<strong>高级系统设置</strong>→<strong>环境变量</strong>，如下图所示。</li><li>在弹出的菜单里点击新建三个变量并配置到<strong>Path</strong>上。<ul><li><strong>GOROOT</strong>:刚才go的安装路径</li><li><strong>GOBIN</strong>:go的执行程序路径</li><li><strong>GOPATH</strong>:准备使用go进行开发的工程路径,</li></ul></li></ul></li></ul><p><img src="/image/Golang01/Golang01_004.png" alt=""><br><img src="/image/Golang01/Golang01_005.png" alt=""></p><h3 id="四、开发工具"><a href="#四、开发工具" class="headerlink" title="四、开发工具"></a>四、开发工具</h3><ol><li>Goland:是由 JetBrains 公司专门为开发者提供的一个符合人体工程学的商业 IDE。</li><li>LiteIDE:一款专门针对 Go 开发的集成开发环境，在编辑、编译和运行 Go 程序和项目方面都有非常好的支持。</li><li>Sublime Text:是一个革命性的跨平台（Linux、Mac OS X、Windows）文本编辑器，它支持编写非常多的编程语言代码。对于 Go 而言，它有一个插件叫做 GoSublime 来支持代码补全和代码模版。</li><li>GoClipse: Eclipse 的插件，拥有非常多的特性以及通过 GoCode 来实现代码补全功能。</li><li>VS Code: 是一款由微软公司开发的，能运行在 Mac OS X、Windows 和 Linux 上的跨平台开源代码编辑器</li></ol><h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><ul><li>1.在自己建好的<strong>GOPATH</strong>下，新建三个目录<ul><li>src 目录：放置项目和库的源文件；</li><li>pkg 目录：放置编译后生成的包/库的归档文件；</li><li>bin 目录：放置编译后生成的可执行文件</li></ul></li><li><p>2.在src下面创建main目录,然后再目录下新建main.go,然后进行语言入门打卡操作</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main    <span class="comment">// 声明 main 包</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span>       <span class="comment">// 导入 fmt 包，打印字符串是需要用到</span></span><br><span class="line">)</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;   <span class="comment">// 声明 main 主函数</span></span><br><span class="line">    fmt.Println(<span class="string">"Hello World!"</span>) <span class="comment">// 打印 Hello World!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li>3.编译和运行代码:如果是Goland使用ctrl+shift+F10,也可以使用下面命令:<ul><li>go build fileName :将代码编译成二进制的可执行文件，但是需要手动运行该二进制文件</li><li>go run fileName :在编译后直接运行程序，编译过程中会产生一个临时文件，但不会生成可执行文件</li></ul></li></ul><h3 id="五、命令工具"><a href="#五、命令工具" class="headerlink" title="五、命令工具"></a>五、命令工具</h3><ul><li>go build：编译命令<ul><li>-v: 编译时显示包名</li><li>-p n 开启并发编译，默认情况下该值为 CPU 逻辑核数</li><li>-a 强制重新构建</li><li>-n 打印编译时会用到的所有命令，但不真正执行</li><li>-x 打印编译时会用到的所有命令</li><li>-race 开启竞态检测</li></ul></li><li>go clean：清除编译文件<ul><li>i 清除关联的安装的包和可运行文件，也就是通过go install安装的文件；</li><li>n 把需要执行的清除命令打印出来，但是不执行，这样就可以很容易的知道底层是如何运行的；</li><li>r 循环的清除在 import 中引入的包；</li><li>x 打印出来执行的详细命令，其实就是 -n 打印的执行版本；</li><li>cache 删除所有go build命令的缓存</li><li>testcache 删除当前包所有的测试结果</li></ul></li><li>go run：编译并运行</li><li>go install：编译并安装</li><li>go get：一键获取代码、编译并安装<ul><li>-v 显示操作流程的日志及信息，方便检查错误</li><li>-u 下载丢失的包，但不会更新已经存在的包</li><li>-d 只下载，不安装</li><li>-insecure 允许使用不安全的 HTTP 方式进行下载操作</li></ul></li><li>go generate：在编译前自动化生成某类代码<ul><li>run 正则表达式匹配命令行，仅执行匹配的命令；</li><li>v 输出被处理的包名和源文件名；</li><li>n 显示不执行命令；</li><li>x 显示并执行命令；</li></ul></li><li>go test：单元测试命令</li><li>go fmt：格式化代码文件<ul><li>-l 仅把那些不符合格式化规范的、需要被命令程序改写的源码文件的绝对路径打印到标准输出。而不是把改写后的全部内容都打印到标准输出。</li><li>-w 把改写后的内容直接写入到文件中，而不是作为结果打印到标准输出。</li><li>-r 添加形如“a[b:len(a)] -&gt; a[b:]”的重写规则。如果我们需要自定义某些额外的格式化规则，就需要用到它。</li><li>-s 简化文件中的代码。</li><li>-d 只把改写前后内容的对比信息作为结果打印到标准输出。而不是把改写后的全部内容都打印到标准输出。 命令程序将使用 diff 命令对内容进行比对。在 Windows 操作系统下可能没有 diff 命令，需要另行 安装。</li><li>-e 打印所有的语法错误到标准输出。如果不使用此标记，则只会打印每行的第 1 个错误且只打印前 10 个错误。</li><li>-comments 是否保留源码文件中的注释。在默认情况下，此标记会被隐式的使用，并且值为 true。</li><li>-tabwidth 此标记用于设置代码中缩进所使用的空格数量，默认值为 8。要使此标记生效，需要使用“-tabs”标记并把值设置为 false。</li><li>-tabs 是否使用 tab（’\t’）来代替空格表示缩进。在默认情况下，此标记会被隐式的使用，并且值为 true。</li><li>-cpuprofile 是否开启 CPU 使用情况记录，并将记录内容保存在此标记值所指的文件中。</li></ul></li><li>go pprof：性能分析工具<em>**</em></li></ul><h3 id="六、外部工具"><a href="#六、外部工具" class="headerlink" title="六、外部工具"></a>六、外部工具</h3><h4 id="godoc"><a href="#godoc" class="headerlink" title="godoc"></a><strong>godoc</strong></h4><p>godoc 工具会从 Go 程序和包文件中提取顶级声明的首行注释以及每个对象的相关注释，并生成相关文档，也可以作为一个提供在线文档浏览的 web 服务器，Go语言官网（<a href="https://golang.google.cn/" target="_blank" rel="noopener">https://golang.google.cn/</a><br>）就是通过这种形式实现的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get golang.org/x/tools/cmd/godoc</span><br></pre></td></tr></table></figure><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><p>由于防火墙的原因，国内的用户可能无法通过go get 命令来获取 godoc 工具，这时候就需要大家来手动操作了。</p><ul><li>首先从 GitHub（<a href="https://github.com/golang/tools.git" target="_blank" rel="noopener">https://github.com/golang/tools.git</a>） 下载 golang.org/x/tools 包；</li><li>然后将下载得到的文件解压到 GOPATH 下的 src\golang.org\x\tools 目录中，没有的话可以手动创建；</li><li>打开 GOPATH 下的 src\golang.org\x\tools\cmd\godoc 目录，在该目录下打开命令行工具，并执行<code>go build</code> 命令，生成 godoc.exe 可执行文件；</li><li>最后，将生成的 godoc.exe 文件移动到 GOPATH 下的 bin 目录中。（需要把 GOPATH 下的 bin 目录添加到环境变量 Path 中）</li></ul><h5 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h5><p>完成上述操作后就可以使用 godoc 工具了，godoc 工具一般有以下几种用法：</p><ul><li>go doc package：获取包的文档注释，例如<code>go doc fmt</code> 会显示使用 godoc 生成的 fmt 包的文档注释；</li><li>go doc package/subpackage：获取子包的文档注释，例如<code>go doc container/list</code>；</li><li>go doc package function：获取某个函数在某个包中的文档注释，例如<code>go doc fmt Printf</code> 会显示有关 fmt.Printf() 的使用说明。</li></ul><h4 id="gofmt：go-fmt的升级版"><a href="#gofmt：go-fmt的升级版" class="headerlink" title="gofmt：go fmt的升级版"></a>gofmt：go fmt的升级版</h4><h4 id="golint：代码质量的检查"><a href="#golint：代码质量的检查" class="headerlink" title="golint：代码质量的检查"></a>golint：代码质量的检查</h4><p>More info: <a href="http://c.biancheng.net/golang/" target="_blank" rel="noopener">Golang</a></p>]]></content>
      
      
        <tags>
            
            <tag> golang </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署Rap2</title>
      <link href="/2021/01/15/%E9%83%A8%E7%BD%B2Rap2/"/>
      <url>/2021/01/15/%E9%83%A8%E7%BD%B2Rap2/</url>
      <content type="html"><![CDATA[<p>Rap2是一个可视化接口管理工具,通过分析接口结构，动态生成模拟数据，校验真实接口正确性.本文章介绍如何在Centos7.5下面使用dokcer部署Rap2。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/部署Rap2_001.jpg" alt=""></p><h3 id="直接使用"><a href="#直接使用" class="headerlink" title="直接使用"></a>直接使用</h3><p>如果想直接使用，可以点击<a href="http://rap2.taobao.org/" target="_blank" rel="noopener">taobao</a>通过申请一个账号后，即可在里面进行接口的编写、测试。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h4><ul><li>安装docker</li><li>安装docker-compose</li></ul><h4 id="后端部署"><a href="#后端部署" class="headerlink" title="后端部署"></a>后端部署</h4><p>rap2-delos: 后端数据API服务器，基于Koa + MySQL</p><ul><li>1.部署  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir rap2</span><br><span class="line"><span class="built_in">cd</span> rap2</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/thx/rap2-delos.git</span><br><span class="line"><span class="built_in">cd</span> rap2-delos</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/部署Rap2_002.png" alt=""></p><ul><li>2.初始化数据库  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it rap2-delos sh </span><br><span class="line">node scripts/init</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/部署Rap2_003.png" alt=""></p><ul><li>3.重新启动服务  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker-compose down</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/部署Rap2_004.png" alt=""></p><ul><li>4.测试  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost:38080</span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/部署Rap2_005.png" alt=""></p><h4 id="前端部署"><a href="#前端部署" class="headerlink" title="前端部署"></a>前端部署</h4><p>rap2-dolores: 前端静态资源，基于React</p><ul><li><p>1.拉取代码</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ..</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/thx/rap2-dolores.git</span><br><span class="line"><span class="built_in">cd</span> rap2-dolores</span><br></pre></td></tr></table></figure></li><li><p>2.创建Dockerfile,复制下面内容到里面</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi Dockerfile</span><br></pre></td></tr></table></figure><p>  Dockerfile中的内容为：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取10.1.0版本的node镜像</span></span><br><span class="line">FROM node:10.1.0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 维护人</span></span><br><span class="line">MAINTAINER ryn</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建工作目录</span></span><br><span class="line">RUN mkdir -p /home/rap2-dolores</span><br><span class="line">WORKDIR /home/rap2-dolores</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将代码拷贝至工作目录</span></span><br><span class="line">COPY . /home/rap2-dolores</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局安装http-server服务器</span></span><br><span class="line">RUN npm install -g http-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 全局安装node-sass(一定要带--unsafe-perm，否则会报错)</span></span><br><span class="line">RUN npm install --unsafe-perm -g node-sass</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">RUN npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包</span></span><br><span class="line">RUN npm run build</span><br></pre></td></tr></table></figure></li><li><p>3.创建docker-compose,把下面内容拷贝进去</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi docker-compose.yml</span><br></pre></td></tr></table></figure><p>  docker-compose.yml中的内容为：</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'2.2'</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  delores:</span></span><br><span class="line">    <span class="comment"># 容器名称</span></span><br><span class="line"><span class="attr">    container_name:</span> <span class="string">rap2-dolores</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 通过Dockerfile来构建本地镜像</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">.</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 通过images来构建，这里的地址暂不适用，因为src/config中的配置需要根据自己的服务器来动态构建</span></span><br><span class="line">    <span class="comment"># image rynxiao/rap2-dolores-nodejs</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 指定工作目录</span></span><br><span class="line"><span class="attr">    working_dir:</span> <span class="string">/home/rap2-dolores</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 指定生产环境</span></span><br><span class="line"><span class="attr">    environment:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">NODE_ENV=production</span></span><br><span class="line">      </span><br><span class="line">    <span class="comment"># 启动http-server，并映射端口到容器内部8081上</span></span><br><span class="line"><span class="attr">    command:</span> <span class="string">/bin/sh</span> <span class="bullet">-c</span> <span class="string">'http-server ./build -s -p 8081'</span></span><br><span class="line"><span class="attr">    privileged:</span> <span class="literal">true</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># expose port 38081</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"38081:8081"</span></span><br></pre></td></tr></table></figure></li><li><p>4.更改src/config/config.prod.js中的配置，将接口请求地址指向你的后端服务器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi src/config/config.prod.js</span><br></pre></td></tr></table></figure>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  serve: <span class="string">'http://&lt;后端服务器ip&gt;:38080'</span>,</span><br><span class="line">  keys: [<span class="string">'some secret hurr'</span>],</span><br><span class="line">  session: &#123;</span><br><span class="line">    key: <span class="string">'koa:sess'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>5.启动服务</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li><li><p>6.使用浏览器访问访问http://{前端地址}:38081</p></li></ul><p><img src="/image/部署Rap2_006.png" alt=""></p><h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><ul><li><p>1.注册帐号<br>  <img src="/image/部署Rap2_007.png" alt=""></p></li><li><p>2.注册成功后，进去创建一个项目仓库<br>  <img src="/image/部署Rap2_008.png" alt=""><br>  <img src="/image/部署Rap2_009.png" alt=""></p></li><li><p>3.仓库建好以后，我们进入仓库，点击新建接口<br>  <img src="/image/部署Rap2_010.png" alt=""><br>  <img src="/image/部署Rap2_011.png" alt=""></p></li><li><p>4.选择新建接口编辑参数，参数语法参考<a href="https://github.com/nuysoft/Mock/wiki/Syntax-Specification" target="_blank" rel="noopener">mock.js语法规范文档</a><br>  <img src="/image/部署Rap2_012.png" alt=""><br>  <img src="/image/部署Rap2_013.png" alt=""></p></li><li><p>5.点击测试<br>  <img src="/image/部署Rap2_014.png" alt=""></p></li></ul><p>More info: <a href="https://github.com/thx/rap2-delos" target="_blank" rel="noopener">Github</a></p>]]></content>
      
      
        <tags>
            
            <tag> 环境部署 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>接口工具HttpRunner</title>
      <link href="/2020/12/15/%E6%8E%A5%E5%8F%A3%E5%B7%A5%E5%85%B7HttpRunner/"/>
      <url>/2020/12/15/%E6%8E%A5%E5%8F%A3%E5%B7%A5%E5%85%B7HttpRunner/</url>
      <content type="html"><![CDATA[<p>HttpRunner 是一款面向 HTTP(S) 协议的通用测试框架，只需编写维护一份 YAML/JSON 脚本，即可实现自动化测试、性能测试、线上监控、持续集成等多种测试需求。本文章介绍在Windows7如何安装和使用HttpRunner。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/接口工具HttpRunner_001.png" alt=""></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li><p>1.使用pip安装</p>  <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install httprunner</span><br></pre></td></tr></table></figure></li><li><p>2.验证安装</p>  <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hrun -V</span><br></pre></td></tr></table></figure></li></ul><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><ul><li><p>1.新建测试项目</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hrun --startproject NewApiTest</span><br></pre></td></tr></table></figure><p><img src="/image/接口工具HttpRunner_002.png" alt=""></p></li></ul><ul><li>2.目录结构说明<ul><li>debugtalk.py：该文件所在目录将作为项目工程的根目录，api 文件夹都必须与其放置在相同目录</li><li>api 文件夹：存储接口定义描述</li><li>reports 文件夹：存储 HTML 测试报告</li><li>testcases 文件夹（非必须）：存储测试用例，文件夹也可以使用其它名称</li><li>testsuite 文件夹（非必须）：测试测试场景，文件夹也可以使用其它名称</li></ul></li></ul><ul><li>3.文件类型说明<ul><li>YAML/JSON（必须）：测试用例文件，存储接口测试相关信息</li><li>debugtalk.py（可选）：存储项目中逻辑运算辅助函数<ul><li>该文件存在时，将作为项目根目录定位标记，其所在目录即被视为项目工程根目录</li><li>该文件不存在时，运行测试的所在路径（CWD）将被视为项目工程根目录</li><li>测试用例文件中的相对路径（例如.csv）均需基于项目工程根目录</li><li>运行测试后，测试报告文件夹（reports）会生成在项目工程根目录</li></ul></li><li>.env（可选）：存储项目环境变量，通常用于存储项目敏感信息</li><li>.csv（可选）：项目数据文件，用于进行数据驱动</li><li>reports：默认生成测试报告的存储文件夹</li></ul></li></ul><ul><li>4.测试用例结构<ul><li>测试用例集（testsuite）：对应一个文件夹，包含单个或多个测试用例（YAML/JSON）文件</li><li>测试用例（testcase）：对应一个 YAML/JSON 文件，包含单个或多个测试步骤</li><li>测试步骤（teststep）：对应 YAML/JSON 文件中的一个 test，描述单次接口测试的全部内容，包括发起接口请求、解析响应结果、校验结果等</li></ul></li></ul><ul><li><p>5.测试用例文件结构（YAML/JSON）</p><ul><li>config：作为整个测试用例的全局配置项</li><li>test：对应单个测试步骤（teststep），测试用例存在顺序关系，运行时将从前往后依次运行各个测试步骤。各个测试步骤（test）的变量空间相互独立，互不影响。需在多个测试步骤（test）中传递参数值，则需要使用 extract 关键字，并且只能从前往后传递。<ul><li>若某变量在 config 中定义了，在某 test 中没有定义，则该 test 会继承该变量</li><li>若某变量在 config 和某 test 中都定义了，则该 test 中使用自己定义的变量值</li></ul></li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    "config": &#123;...&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    "test": &#123;...&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    "test": &#123;...&#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><ul><li><p>config参数说明</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">"config": &#123;</span><br><span class="line">    "name": "testcase description",</span><br><span class="line">    "parameters": [</span><br><span class="line">        &#123;"user_agent": ["iOS/10.1", "iOS/10.2", "iOS/10.3"]&#125;,</span><br><span class="line">        &#123;"app_version": "$&#123;P(app_version.csv)&#125;"&#125;,</span><br><span class="line">        &#123;<span class="attr">"os_platform"</span>: <span class="string">"$&#123;get_os_platform()&#125;"</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    "variables": [</span><br><span class="line">        &#123;"user_agent": "iOS/10.3"&#125;,</span><br><span class="line">        &#123;"device_sn": "$&#123;gen_random_string(15)&#125;"&#125;,</span><br><span class="line">        &#123;<span class="attr">"os_platform"</span>: <span class="string">"ios"</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    "request": &#123;</span><br><span class="line">        "base_url": "http://127.0.0.1:5000",</span><br><span class="line">        "headers": &#123;</span><br><span class="line">            "Content-Type": "application/json",</span><br><span class="line">            "device_sn": "$device_sn"</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    "output": [</span><br><span class="line">        <span class="string">"token"</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><table><thead><tr><th>Key</th><th>required</th><th>format</th><th>descrption</th></tr></thead><tbody><tr><td>name</td><td>Yes</td><td>string</td><td>测试用例的名称，在测试报告中将作为标题</td></tr><tr><td>variables</td><td>No</td><td>list of dict</td><td>定义的全局变量，作用域为整个用例</td></tr><tr><td>parameters</td><td>No</td><td>list of dict</td><td>全局参数，用于实现数据化驱动，作用域为整个用例</td></tr><tr><td>request</td><td>No</td><td>dict</td><td>request 的公共参数，作用域为整个用例；常用参数包括 base_url 和 headers</td></tr><tr><td>base_url</td><td>No</td><td>string</td><td>测试用例请求 URL 的公共 host，指定该参数后，test 中的 url 可以只描述 path 部分</td></tr><tr><td>headers</td><td>No</td><td>dict</td><td>request 中 headers 的公共参数，作用域为整个用例</td></tr><tr><td>output</td><td>No</td><td>list</td><td>整个用例输出的参数列表，可输出的参数包括公共的 variable 和 extract 的参数; 在 log-level 为 debug 模式下，会在 terminal 中打印出参数内容</td></tr></tbody></table><ul><li><p>test参数说明</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">"test": &#123;</span><br><span class="line">    "name": "get token with $user_agent, $os_platform, $app_version",</span><br><span class="line">    "request": &#123;</span><br><span class="line">        "url": "/api/get-token",</span><br><span class="line">        "method": "POST",</span><br><span class="line">        "headers": &#123;</span><br><span class="line">            "app_version": "$app_version",</span><br><span class="line">            "os_platform": "$os_platform",</span><br><span class="line">            "user_agent": "$user_agent"</span><br><span class="line">        &#125;,</span><br><span class="line">        "json": &#123;</span><br><span class="line">            "sign": "$&#123;get_sign($user_agent, $device_sn, $os_platform, $app_version)&#125;"</span><br><span class="line">        &#125;,</span><br><span class="line">        "extract": [</span><br><span class="line">            &#123;<span class="attr">"token"</span>: <span class="string">"content.token"</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        "validate": [</span><br><span class="line">            &#123;"eq": ["status_code", 200]&#125;,</span><br><span class="line">            &#123;"eq": ["headers.Content-Type", "application/json"]&#125;,</span><br><span class="line">            &#123;<span class="attr">"eq"</span>: [<span class="string">"content.success"</span>, <span class="literal">true</span>]&#125;</span><br><span class="line">        ],</span><br><span class="line">        "setup_hooks": [],</span><br><span class="line">        "teardown_hooks": []</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><table><thead><tr><th>Key</th><th>required</th><th>format</th><th>descrption</th></tr></thead><tbody><tr><td>name</td><td>Yes</td><td>string</td><td>测试步骤的名称，在测试报告中将作为测试步骤的名称</td></tr><tr><td>request</td><td>Yes</td><td>dict</td><td>HTTP 请求的详细内容；可用参数详见 python-requests 官方文档</td></tr><tr><td>variables</td><td>No</td><td>list of dict</td><td>测试步骤中定义的变量，作用域为当前测试步骤</td></tr><tr><td>extract</td><td>No</td><td>list</td><td>从当前 HTTP 请求的响应结果中提取参数，并保存到参数变量中（例如token），后续测试用例可通过$token的形式进行引用</td></tr><tr><td>validate</td><td>No</td><td>list</td><td>测试用例中定义的结果校验项，作用域为当前测试用例，用于实现对当前测试用例运行结果的校验</td></tr><tr><td>setup_hooks</td><td>No</td><td>list</td><td>在 HTTP 请求发送前执行 hook 函数，主要用于准备工作</td></tr><tr><td>teardown_hooks</td><td>No</td><td>list</td><td>在 HTTP 请求发送后执行 hook 函数，主要用户测试后的清理工作</td></tr></tbody></table><ul><li><p>6.创建测试用例文件</p><p><img src="/image/接口工具HttpRunner_003.png" alt=""></p></li></ul><ul><li><p>7.运行</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hrun test_demo.yaml</span><br></pre></td></tr></table></figure><p><img src="/image/接口工具HttpRunner_004.png" alt=""></p></li><li><p>8.报告</p><p><img src="/image/接口工具HttpRunner_005.png" alt=""></p></li></ul><h3 id="HttpRunnerManager"><a href="#HttpRunnerManager" class="headerlink" title="HttpRunnerManager"></a>HttpRunnerManager</h3><p>HttpRunnerManager是基于HttpRunner的接口自动化测试平台,该工具是对 HttpRunner的包装和Web图形化, 另外还增加了一些新概念(项目/模块)用来组织用例</p><ul><li>1.前置<ul><li>安装mysql(推荐5.7+),并设置为utf-8编码，创建相应HttpRunner数据库，设置好相应用户名、密码，启动mysql</li><li>安装rabbitmq,需要先安装erlang</li></ul></li></ul><ul><li><p>2.下载</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/HttpRunner/HttpRunnerManager.git</span><br></pre></td></tr></table></figure></li><li><p>3.修改配置</p><p>打开HttpRunnerManager/HttpRunnerManager/settings.py配置对应mysql和rabbitmq信息</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改DATABASES字典为创建的mysql数据库信息和邮件发送账号</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    DATABASES = &#123;</span><br><span class="line">        <span class="string">'default'</span>: &#123;</span><br><span class="line">            <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">            <span class="string">'NAME'</span>: <span class="string">'HttpRunnerManager'</span>,  <span class="comment"># 新建数据库名</span></span><br><span class="line">            <span class="string">'USER'</span>: <span class="string">'root'</span>,  <span class="comment"># 数据库登录名</span></span><br><span class="line">            <span class="string">'PASSWORD'</span>: <span class="string">''</span>,  <span class="comment"># 数据库登录密码</span></span><br><span class="line">            <span class="string">'HOST'</span>: <span class="string">'127.0.0.1'</span>,  <span class="comment"># 数据库所在服务器ip地址</span></span><br><span class="line">            <span class="string">'PORT'</span>: <span class="string">'3306'</span>,  <span class="comment"># 监听端口 默认3306即可</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    STATICFILES_DIRS = (</span><br><span class="line">        os.path.join(BASE_DIR, <span class="string">'static'</span>),  <span class="comment"># 静态文件额外目录</span></span><br><span class="line">    )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    DATABASES = &#123;</span><br><span class="line">        <span class="string">'default'</span>: &#123;</span><br><span class="line">            <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">            <span class="string">'NAME'</span>: <span class="string">'HttpRunnerManager'</span>,  <span class="comment"># 新建数据库名</span></span><br><span class="line">            <span class="string">'USER'</span>: <span class="string">'root'</span>,  <span class="comment"># 数据库登录名</span></span><br><span class="line">            <span class="string">'PASSWORD'</span>: <span class="string">''</span>,  <span class="comment"># 数据库登录密码</span></span><br><span class="line">            <span class="string">'HOST'</span>: <span class="string">'127.0.0.1'</span>,  <span class="comment"># 数据库所在服务器ip地址</span></span><br><span class="line">            <span class="string">'PORT'</span>: <span class="string">'3306'</span>,  <span class="comment"># 监听端口 默认3306即可</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    STATIC_ROOT = os.path.join(BASE_DIR, <span class="string">'static'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改worker配置为搭建rabbitmq的信息</span></span><br><span class="line">djcelery.setup_loader()</span><br><span class="line">CELERY_ENABLE_UTC = <span class="keyword">True</span></span><br><span class="line">CELERY_TIMEZONE = <span class="string">'Asia/Shanghai'</span></span><br><span class="line">BROKER_URL = <span class="string">'amqp://guest:guest@127.0.0.1:5672//'</span>  <span class="comment"># 127.0.0.1即为rabbitmq-server所在服务器ip地址</span></span><br><span class="line">CELERYBEAT_SCHEDULER = <span class="string">'djcelery.schedulers.DatabaseScheduler'</span></span><br><span class="line">CELERY_RESULT_BACKEND = <span class="string">'djcelery.backends.database:DatabaseBackend'</span></span><br><span class="line">CELERY_ACCEPT_CONTENT = [<span class="string">'application/json'</span>]</span><br><span class="line">CELERY_TASK_SERIALIZER = <span class="string">'json'</span></span><br><span class="line">CELERY_RESULT_SERIALIZER = <span class="string">'json'</span></span><br><span class="line"></span><br><span class="line">CELERY_TASK_RESULT_EXPIRES = <span class="number">7200</span>  <span class="comment"># celery任务执行结果的超时时间，</span></span><br><span class="line">CELERYD_CONCURRENCY = <span class="number">10</span>  <span class="comment"># celery worker的并发数 也是命令行-c指定的数目 根据服务器配置实际更改 默认10</span></span><br><span class="line">CELERYD_MAX_TASKS_PER_CHILD = <span class="number">100</span>  <span class="comment"># 每个worker执行了多少任务就会死掉，我建议数量可以大一些，默认100</span></span><br></pre></td></tr></table></figure></li><li><p>4.安装依赖</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure></li><li><p>5.生成表结构</p><p>切换到HttpRunnerManager目录 生成数据库迁移脚本,并生成表结构</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations ApiManager #生成数据迁移脚本</span><br><span class="line">python manage.py migrate  #应用到db生成数据表</span><br></pre></td></tr></table></figure></li><li><p>6.创建用户</p><p>创建超级用户，用户后台管理数据库，并按提示输入相应用户名，密码，邮箱。 如不需用，可跳过此步骤</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure></li><li><p>7.启动服务</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">8000</span></span><br></pre></td></tr></table></figure></li><li><p>8.访问</p><ul><li>注册和登录:浏览器输入 <a href="http://127.0.0.1:8000/api/register/" target="_blank" rel="noopener">http://127.0.0.1:8000/api/register/</a> ,平台的使用可以参考<a href="https://github.com/HttpRunner/HttpRunnerManager#新手入门指导" target="_blank" rel="noopener">新手入门指导</a></li></ul><p><img src="/image/接口工具HttpRunner_006.png" alt=""><br><img src="/image/接口工具HttpRunner_007.png" alt=""><br><img src="/image/接口工具HttpRunner_008.png" alt=""></p><ul><li>运维:浏览器输入 <a href="http://127.0.0.1:8000/admin/" target="_blank" rel="noopener">http://127.0.0.1:8000/admin/</a> 输入之前创建的超级用户名、密码，登录后台运维管理系统，可后台管理数据<br><img src="/image/接口工具HttpRunner_009.png" alt=""></li></ul></li></ul><h3 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h3><ul><li><p>httprunner可以复用python的开源测试框架locust,locust的安装与使用可以看 <a href="/2017/07/15/性能工具Locust/" title="这里">这里</a> ，使用locust对yaml/json用例文件中的接口进行压测</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locusts -f D://testcases//test_demo.yaml</span><br></pre></td></tr></table></figure><p><img src="/image/接口工具HttpRunner_010.png" alt=""></p></li><li><p>web监控器启动成功，我们点击转到locust的<a href="http://localhost:8089/" target="_blank" rel="noopener">web页面</a>,配置压测参数：</p><p><img src="/image/接口工具HttpRunner_011.png" alt=""></p></li><li><p>观察结果<br><img src="/image/接口工具HttpRunner_012.png" alt=""></p></li></ul><p>More info: <a href="https://cn.httprunner.org/" target="_blank" rel="noopener">中文文档</a></p>]]></content>
      
      
        <tags>
            
            <tag> 接口 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署OpenResty</title>
      <link href="/2020/11/15/%E9%83%A8%E7%BD%B2OpenResty/"/>
      <url>/2020/11/15/%E9%83%A8%E7%BD%B2OpenResty/</url>
      <content type="html"><![CDATA[<p>OpenResty是一个基于Nginx的可伸缩的Web平台，默认集成了Lua开发环境。文章介绍如何在居于Centos7.5安装OpenResty。<br><a id="more"></a></p><h2 id="Quick-Deploy"><a href="#Quick-Deploy" class="headerlink" title="Quick Deploy"></a>Quick Deploy</h2><h3 id="部署准备"><a href="#部署准备" class="headerlink" title="部署准备"></a>部署准备</h3><ul><li>1.检查依赖库(perl 5.6.1+, libreadline, libpcre, libssl, gcc, curl)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ldconfig  -v | grep -E <span class="string">'readline|pcre|openssl'</span></span><br><span class="line">yum list installed | grep -E <span class="string">'perl|gcc|curl'</span></span><br></pre></td></tr></table></figure><ul><li>2.安装依赖库(也可以不检查,直接使用下面命令安装)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install readline-devel pcre-devel openssl-devel perl gcc curl</span><br></pre></td></tr></table></figure><h3 id="安装和配置"><a href="#安装和配置" class="headerlink" title="安装和配置"></a>安装和配置</h3><ul><li>1.下载安装包</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://openresty.org/download/openresty-1.13.6.2.tar.gz</span><br></pre></td></tr></table></figure><ul><li>2.解压安装包</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf openresty-1.13.6.2.tar.gz</span><br></pre></td></tr></table></figure><ul><li>3.编译(默认情况下程序会安装到 /usr/local/openresty 目录,你可以使用 ./configure –help 查看更多的配置选项)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> openresty-1.13.6.2</span><br><span class="line">./configure</span><br><span class="line">make </span><br><span class="line">make install</span><br></pre></td></tr></table></figure><h3 id="重要目录说明"><a href="#重要目录说明" class="headerlink" title="重要目录说明"></a>重要目录说明</h3><ul><li>nginx <ul><li>sbin<ul><li>nignx 启动程序</li></ul></li><li>logs<ul><li>access.log 访问日志</li><li>error.log 错误日志</li></ul></li><li>conf<ul><li>nginx.con 配置文件</li></ul></li></ul></li></ul><h3 id="简单实例"><a href="#简单实例" class="headerlink" title="简单实例"></a>简单实例</h3><ul><li>1.创建日志和配置目录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir  /home/<span class="built_in">test</span>/logs/conf/</span><br><span class="line"><span class="built_in">cd</span> /home/<span class="built_in">test</span>/</span><br><span class="line">mkdir  logs/ conf/</span><br></pre></td></tr></table></figure><ul><li>2.打开配置文件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi  conf/nginx.conf</span><br></pre></td></tr></table></figure><ul><li>3.新增配置</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#启动一个进程</span><br><span class="line">worker_processes  <span class="number">1</span>; </span><br><span class="line">#设置错误日志目录</span><br><span class="line">error_log logs/<span class="built_in">error</span>.<span class="built_in">log</span>;</span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">    server &#123;</span><br><span class="line">        #设置端口</span><br><span class="line">        listen <span class="number">9000</span>;</span><br><span class="line">        #设置访问路径</span><br><span class="line">        location / &#123;</span><br><span class="line">            default_type text/html;</span><br><span class="line">            #设置返回内容</span><br><span class="line">            content_by_lua <span class="string">'</span></span><br><span class="line"><span class="string">                ngx.say("&lt;p&gt;Hello, World!&lt;/p&gt;")</span></span><br><span class="line"><span class="string">            '</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>3.启动 OpenResty (如果没有任何输出，说明启动成功，-p 指定我们的项目目录，-c 指定配置文件)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/openresty/nginx/sbin/nginx -p /home/<span class="built_in">test</span>/ -c /home/<span class="built_in">test</span>/conf/nginx.conf</span><br></pre></td></tr></table></figure><ul><li>4.访问OpenResty(通过curl或者浏览器访问,返回 Hello World为启动成功)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:9000/</span><br></pre></td></tr></table></figure><p>More info: <a href="https://openresty.org/cn/installation.html" target="_blank" rel="noopener">新手上路</a></p>]]></content>
      
      
        <tags>
            
            <tag> 环境部署 </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ELK（三）Kibana</title>
      <link href="/2020/10/15/ELK03/"/>
      <url>/2020/10/15/ELK03/</url>
      <content type="html"><![CDATA[<p>　　Kibana 是一个针对Elasticsearch的开源分析及可视化平台，用来搜索、查看交互存储在Elasticsearch索引中的数据。使用 Kibana，可以通过各种图表进行高级数据分析及展示。<br>　　本文章主要介绍 Kibana 的入门知识。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>　　Kibana架构为Elasticsearch定制，可以将任何结构化和非结构化数据加入Elasticsearch索引。Kibana还充分利用了Elasticsearch强大的搜索和分析功能。</p><h3 id="一、优点"><a href="#一、优点" class="headerlink" title="一、优点"></a>一、优点</h3><ul><li>整合你的数据：Kibana能够更好地处理海量数据，并据此创建柱形图、折线图、散点图、直方图、饼图和地图。</li><li>复杂数据分析：Kibana提升了Elasticsearch分析能力，能够更加智能地分析数据，执行数学转换并且根据要求对数据切割分块。</li><li>让更多团队成员受益：强大的数据库可视化接口让各业务岗位都能够从数据集合受益。</li><li>接口灵活，分享更容易：使用Kibana可以更加方便地创建、保存、分享数据，并将可视化数据快速交流。</li><li>配置简单：Kibana的配置和启用非常简单，用户体验非常友好。Kibana 4自带Web服务器，可以快速启动运行。</li><li>可视化多数据源： Kibana可以非常方便地把来自<a href="https://www.elastic.co/products/logstash" target="_blank" rel="noopener">Logstash</a>、<a href="https://www.elastic.co/products/hadoop" target="_blank" rel="noopener">ES-Hadoop</a>、<a href="https://www.elastic.co/products/beats" target="_blank" rel="noopener">Beats</a>或第三方技术的数据整合到Elasticsearch，支持的第三方技术包括<a href="http://flume.apache.org/" target="_blank" rel="noopener">Apache Flume</a>、<a href="http://www.fluentd.org/" target="_blank" rel="noopener">Fluentd</a>等。 </li><li>简单数据导出： Kibana可以方便地导出感兴趣的数据，与其它数据集合并融合后快速建模分析，发现新结果。 </li></ul><h3 id="二、安装部署"><a href="#二、安装部署" class="headerlink" title="二、安装部署"></a>二、安装部署</h3><ul><li>1.已经安装Elasticsearch</li><li>2.从<a href="https://www.elastic.co/downloads/kibana" target="_blank" rel="noopener">官网</a>下载解压(与ES相同的版本)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget https://artifacts.elastic.co/downloads/kibana/kibana-5.5.1-linux-x86_64.tar.gz</span><br><span class="line">tar -zxvf kibana-5.5.1-linux-x86_64.tar.gz -C /hadoop/install</span><br><span class="line">mv kibana-5.5.1-linux-x86_64 kibana</span><br></pre></td></tr></table></figure><ul><li>3.安装 x-pack</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kibana-plugin install x-pack</span><br></pre></td></tr></table></figure><ul><li>3.配置</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/kibana/</span><br><span class="line">vi config/kibana.yml</span><br><span class="line"></span><br><span class="line">添加内容：</span><br><span class="line">server.host: <span class="string">"master"</span></span><br><span class="line">elasticsearch.url: <span class="string">"http://master:9200"</span></span><br><span class="line">kibana.index: <span class="string">".kibana"</span></span><br></pre></td></tr></table></figure><ul><li>4.启动kibana</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先启动ES，必须是在root下运行，否则会报错，启动失败</span></span><br><span class="line">bin/kibana</span><br></pre></td></tr></table></figure><ul><li>5.访问：打开 <a href="http://localhost:5601" target="_blank" rel="noopener">http://localhost:5601</a> （默认的用户名：elastic，密码：changeme）</li></ul><p><img src="/image//ELK03/ELK03_001.png" alt=""></p><ul><li>6.修改密码</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT -u elastic <span class="string">'localhost:9200/_xpack/security/user/kibana/_password'</span> -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">  "password" : "123456"</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>7.单击侧面导航中的 Discover 进入 Kibana 的数据探索功能：</li></ul><p><img src="/image//ELK03/ELK03_002.png" alt=""></p><ul><li>8.使用查询栏编写语句查询</li></ul><p><img src="/image//ELK03/ELK03_003.png" alt=""></p><h3 id="三、加载自定义索引"><a href="#三、加载自定义索引" class="headerlink" title="三、加载自定义索引"></a>三、加载自定义索引</h3><ul><li>1.单击 Management 选项<br><img src="/image//ELK03/ELK03_004.png" alt=""></li><li>2.然后单击 Index Patterns 选项。<br><img src="/image//ELK03/ELK03_005.png" alt=""></li><li>3.点击Create index pattern定义一个新的索引模式。<br><img src="/image//ELK03/ELK03_006.png" alt=""></li><li>4.点击Next step<br><img src="/image//ELK03/ELK03_007.png" alt=""></li><li>5.点击Create index pattern<br><img src="/image//ELK03/ELK03_008.png" alt=""></li><li>6.出来如下界面，列出了所有index中的字段<br><img src="/image//ELK03/ELK03_009.png" alt=""></li><li>7.接下来，我们再来使用一下kibana查看已经导入的索引数据<br><img src="/image//ELK03/ELK03_010.png" alt=""><br><img src="/image//ELK03/ELK03_011.png" alt=""></li></ul><h3 id="四、搜索数据"><a href="#四、搜索数据" class="headerlink" title="四、搜索数据"></a>四、搜索数据</h3><p>　　左上方是 填入条件过滤，右上方是数据的时间范围，左侧栏是 搜索结果的展示字段（具体参考<a href="https://www.elastic.co/guide/cn/kibana/current/discover.html" target="_blank" rel="noopener">官方文档</a>）</p><p><img src="/image//ELK03/ELK03_012.png" alt=""></p><p>More info: <a href="https://www.cnblogs.com/chenqionghe/p/12503181.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="noopener">Kibana</a></p>]]></content>
      
      
        <tags>
            
            <tag> elk </tag>
            
            <tag> kibana </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ELK（二）Logstash</title>
      <link href="/2020/09/15/ELK02/"/>
      <url>/2020/09/15/ELK02/</url>
      <content type="html"><![CDATA[<p>　　Logstash 是一个开源数据收集引擎，具有实时管道功能。Logstash 可以动态地将来自不同数据源的数据统一起来，并将数据标准化到你所选择的目的地。<br>　　本文章主要介绍 Logstash 的入门知识。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>　　<strong>Logstash</strong>是一个开源的服务器端数据处理管道，可以同时从多个数据源获取数据，并对其进行转换，然后将其发送到你最喜欢的“存储”。（Elasticsearch）</p><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><h4 id="1-输入：采集各种样式、大小和来源的数据"><a href="#1-输入：采集各种样式、大小和来源的数据" class="headerlink" title="1.输入：采集各种样式、大小和来源的数据"></a>1.输入：采集各种样式、大小和来源的数据</h4><p>　　数据往往以各种各样的形式，或分散或集中地存在于很多系统中。Logstash 支持各种输入选择 ，可以在同一时间从众多常用来源捕捉事件。能够以连续的流式传输方式，轻松地从您的日志、指标、Web 应用、数据存储以及各种 AWS 服务采集数据。</p><p><img src="/image/ELK02/ELK02_001.png" alt=""></p><h4 id="2-过滤器：实时解析和转换数据"><a href="#2-过滤器：实时解析和转换数据" class="headerlink" title="2.过滤器：实时解析和转换数据"></a>2.过滤器：实时解析和转换数据</h4><p>　　数据从源传输到存储库的过程中，Logstash 过滤器能够解析各个事件，识别已命名的字段以构建结构，并将它们转换成通用格式，以便更轻松、更快速地分析和实现商业价值。Logstash 能够动态地转换和解析数据，不受格式或复杂度的影响：</p><ul><li>利用 Grok 从非结构化数据中派生出结构</li><li>从 IP 地址破译出地理坐标</li><li>将 PII 数据匿名化，完全排除敏感字段</li><li>整体处理不受数据源、格式或架构的影响</li></ul><p><img src="/image/ELK02/ELK02_002.png" alt=""></p><h4 id="3-输出：选择你的存储，导出你的数据"><a href="#3-输出：选择你的存储，导出你的数据" class="headerlink" title="3.输出：选择你的存储，导出你的数据"></a>3.输出：选择你的存储，导出你的数据</h4><p>　　尽管 Elasticsearch 是我们的首选输出方向，能够为我们的搜索和分析带来无限可能，但它并非唯一选择。<br>　　Logstash 提供众多输出选择，您可以将数据发送到您要指定的地方，并且能够灵活地解锁众多下游用例。</p><p><img src="/image/ELK02/ELK02_003.png" alt=""></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="1-前置"><a href="#1-前置" class="headerlink" title="1.前置"></a>1.前置</h4><p>安装 java 8 以上版本（包含）</p><h4 id="2-官网下载解压"><a href="#2-官网下载解压" class="headerlink" title="2.官网下载解压"></a>2.<a href="https://www.elastic.co/downloads/logstash" target="_blank" rel="noopener">官网</a>下载解压</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://artifacts.elastic.co/downloads/logstash/logstash-5.6.1.tar.gz -o /hadoop/software</span><br><span class="line">tar -zxvf /hadoop/software/logstash-5.6.1.tar.gz -C /hadoop/install</span><br><span class="line">mv /hadoop/install/logstash-5.6.1 /hadoop/install/logstash</span><br></pre></td></tr></table></figure><h4 id="3-测试"><a href="#3-测试" class="headerlink" title="3.测试"></a>3.测试</h4><ul><li>1.简单输出到控制台</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">cd</span> <span class="string">/hadoop/install/logstash</span></span><br><span class="line"><span class="string">bin/logstash</span> <span class="bullet">-e</span> <span class="string">'input &#123; stdin &#123; &#125; &#125; output &#123; stdout &#123;&#125; &#125;'</span></span><br></pre></td></tr></table></figure><ul><li>2.新建配置文件：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi logstash.conf</span><br></pre></td></tr></table></figure><p>配置内容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">input &#123; </span><br><span class="line">   file &#123;</span><br><span class="line">    <span class="built_in">type</span> =&gt; <span class="string">"server"</span></span><br><span class="line">    codec =&gt;json</span><br><span class="line">    <span class="comment">#读取文件的位置，一定准确，否则elasticsearch读取不到</span></span><br><span class="line">    path  =&gt;<span class="string">"/logs/finance/1.log</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string"> &#125;</span></span><br><span class="line"><span class="string"> filter &#123;</span></span><br><span class="line"><span class="string">       grok &#123;</span></span><br><span class="line"><span class="string">              match =&gt; &#123; "</span>message<span class="string">" =&gt; "</span>^%&#123;TIMESTAMP_ISO8601&#125;<span class="string">" &#125;</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">output &#123;</span></span><br><span class="line"><span class="string">  elasticsearch &#123; </span></span><br><span class="line"><span class="string">       hosts =&gt; ["</span>localhost:9200<span class="string">"]  #写入到elasticsearch中的地址信息</span></span><br><span class="line"><span class="string">   index =&gt; "</span>trace_test_log<span class="string">"    #文档索引</span></span><br><span class="line"><span class="string">   &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>3.使用配置</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/logstash -f logstash.conf</span><br></pre></td></tr></table></figure><ul><li>4.访问<a href="http://localhost:9600/" target="_blank" rel="noopener">http://localhost:9600/</a> </li></ul>]]></content>
      
      
        <tags>
            
            <tag> elk </tag>
            
            <tag> logstash </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ELK（一）Elasticsearch</title>
      <link href="/2020/08/15/ELK01/"/>
      <url>/2020/08/15/ELK01/</url>
      <content type="html"><![CDATA[<p>　　Elasticsearch（ 数据搜索引擎持久化 ）、Logstash （ 数据收集 ） 、 Kibana （ 数据分析工具 ）的分析和可视化平台一起开发的。这三个产品被设计成一个集成解决方案，称为“Elastic Stack”（以前称为“ELK stack”）。<br>　　本文章主要介绍 Elasticsearch 的入门知识。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>  Elasticsearch是一个开源的分布式. RESTful 风格的搜索和数据分析引擎，它的底层是开源库Apache Lucene。<br>  <a href="https://lucene.apache.org/" target="_blank" rel="noopener">Lucene</a> 可以说是当下最先进. 高性能. 全功能的搜索引擎库——无论是开源还是私有，但它也仅仅只是一个库。为了充分发挥其功能，你需要使用 Java 把 Lucene 集成到应用程序中，使用比较复杂。<br>  为了解决Lucene使用时的繁复性，于是Elasticsearch便应运而生。它使用 Java 对Lucene 做了一层封装，提供了一套简单一致的 RESTful API 来帮助我们实现存储和检索。</p><h3 id="一、基本概念"><a href="#一、基本概念" class="headerlink" title="一、基本概念"></a>一、基本概念</h3><p>　　Elasticsearch 本质上是一个分布式数据库，允许多台服务器协同工作，每台服务器可以运行多个 Elastic 实例。单个 Elastic 实例称为一个节点（node）。一组节点构成一个集群（cluster）。</p><table><thead><tr><th>关系型数据库（MySQL）</th><th>Elasticsearch</th></tr></thead><tbody><tr><td>数据库database</td><td>索引 index</td></tr><tr><td>表 table</td><td>类型 type</td></tr><tr><td>数据行 row</td><td>文档 document</td></tr><tr><td>数据列 column</td><td>字段 field</td></tr></tbody></table><p>　　Elasticsearch 的文件存储是面向文档型数据库，一条数据在这里就是一个文档，用JSON作为文档序列化的格式，比如下面这条用户数据：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span> :     <span class="string">"John"</span>,</span><br><span class="line">    <span class="attr">"sex"</span> :      <span class="string">"Male"</span>,</span><br><span class="line">    <span class="attr">"age"</span> :      <span class="number">25</span>,</span><br><span class="line">    <span class="attr">"birthDate"</span>: <span class="string">"1990/05/01"</span>,</span><br><span class="line">    <span class="attr">"about"</span> :    <span class="string">"I love to go rock climbing"</span>,</span><br><span class="line">    <span class="attr">"interests"</span>: [ <span class="string">"sports"</span>, <span class="string">"music"</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>　　用Mysql这样的数据库存储就会容易想到建立一张User表，有name、sex等字段，在 Elasticsearch 里这就是一个属于User的类型，各种各样的类型存在于一个索引当中。<br>　　一个 Elasticsearch 集群可以包含多个索引(数据库)，也就是说其中包含了很多类型(表)。这些类型中包含了很多的文档(行)，然后每个文档中又包含了很多的字段(列)。Elasticsearch的交互，可以使用Java API，也可以直接使用HTTP的Restful API方式。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 插入一条记录，可以简单发送一个HTTP的请求</span><br><span class="line">PUT /megacorp/employee/1  ( /&lt;索引名称&gt;/&lt;类型名称&gt;/&lt;指定id&gt; )</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span> :     <span class="string">"John"</span>,</span><br><span class="line">    <span class="attr">"sex"</span> :      <span class="string">"Male"</span>,</span><br><span class="line">    <span class="attr">"age"</span> :      <span class="number">25</span>,</span><br><span class="line">    <span class="attr">"about"</span> :    <span class="string">"I love to go rock climbing"</span>,</span><br><span class="line">    <span class="attr">"interests"</span>: [ <span class="string">"sports"</span>, <span class="string">"music"</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>更新、查询也是类似这样的操作，具体操作手册可以参考 <a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/index.html" target="_blank" rel="noopener">Elasticsearch权威指南</a></p><h3 id="二、Elasticsearch-模块结构"><a href="#二、Elasticsearch-模块结构" class="headerlink" title="二、Elasticsearch 模块结构"></a>二、Elasticsearch 模块结构</h3><p><img src="/image/ELK01/ELK01_001.png" alt=""></p><ol><li>第一层：Gateway层：Elasticsearch  索引的持久化存储方式 。 ElasticSearch 默认先把索引存储在内存中，然后当内存满的时候，再持久化到Gateway里。当ES集群关闭或重启的时候，它就会从Gateway里去读取索引数据。比如LocalFileSystem和HDFS、AS3等。 </li><li>第二层：Distributed lucene directory层： Lucene里的一些列索引文件组成的目录。它负责管理这些索引文件。包括数据的读取、写入，以及索引的添加和合并等。 </li><li>第三层：Elasticsearch 对数据的加工处理方式，mapping：定义索引下面type字段的处理规则，比如：索引如何建立数据类型等等，相当于关系型数据里面的schema。River是一个运行在 Elasticsearch 集群内部的一个插件，主要是用来从外部获取异构数据，然后在 Elasticsearch 里创建索引，常见的插件有rabbitmq. twitter river。</li><li>第四层：是 Elasticsearch 自动发现节点的机制。Zen是用来实现节点自动发现，还有master节点选取用的，假如maste出现了故障，不能工作了，那么其它节点会自动选举，然后产生一个新的master。Elasticsearch 是基于P2P的系统，它首先头通过广播机制寻找存在的节点，然后再通过多播协议来进行节点间的通信，同时也支持点对点交互。</li><li>第五层：是 Elasticsearch 的脚本执行功能，有了这个功能很方便的对查询出来的数据进行加工处理，脚本类型：mvel. js. python等。</li><li>第六层：3rd plugins：意思是 Elasticsearch 支持安装很多第三方插件。</li><li>第七层：是 Elasticsearch 的交互方式，支持三种协议：thrift. memcached. http，其中 Elasticsearch 是默认用http协议传输的。</li><li>Restful Style API：是 Elasticsearch 的API支持模式，现在这个RESTFUL这样的API接口的标准是非常流行的</li><li>java(Netty)：Elasticsearch 采用了java语言，同时java语言也是对 Elasticsearch 支持度最好的语言，因为这个lucene是基于java开发的。</li></ol><h3 id="三、安装部署"><a href="#三、安装部署" class="headerlink" title="三、安装部署"></a>三、安装部署</h3><ul><li><p>0.安装 java 8 以上版本（包含）</p></li><li><p>1.下载安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-5.5.1.zip</span><br><span class="line">unzip elasticsearch-5.5.1.zip</span><br><span class="line">cd elasticsearch-5.5.1/</span><br></pre></td></tr></table></figure></li><li><p>2.启动 Elasticsearch</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/elasticsearch</span><br></pre></td></tr></table></figure><p><strong>如果这时报错”max virtual memory areas vm.maxmapcount [65530] is too low”，要运行命令（ sudo sysctl -w vm.max_map_count=262144 ）。</strong></p><ul><li>3.验证</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost:9200</span><br></pre></td></tr></table></figure><h3 id="四、使用"><a href="#四、使用" class="headerlink" title="四、使用"></a>四、使用</h3><p>　　Elasticsearch提供了多种交互使用方式，包括Java API和RESTful API 。现在主要介绍RESTful API ，所有其他语言可以使用RESTful API 通过端口 9200 和 Elasticsearch 进行通信，你可以用你最喜爱的 web 客户端访问 Elasticsearch ，也可以使用 curl 命令来和 Elasticsearch 交互。<br>　　一个Elasticsearch请求和任何 HTTP 请求一样，都由若干相同的部件组成：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X &lt;VERB&gt;  <span class="string">'&lt;PROTOCOL&gt;://&lt;HOST&gt;:&lt;PORT&gt;/&lt;PATH&gt;?&lt;QUERY_STRING&gt;'</span>  -d  <span class="string">'&lt;BODY&gt;'</span></span><br></pre></td></tr></table></figure><p>　　返回的数据格式为JSON，因为Elasticsearch中的文档以JSON格式储存。其中被 &lt; &gt; 标记的部件：</p><table><thead><tr><th>部件</th><th>说明</th></tr></thead><tbody><tr><td>VERB</td><td>适当的 HTTP <em>方法</em> 或 <em>谓词</em> : <code>GET</code>、 <code>POST</code>、 <code>PUT</code>、 <code>HEAD</code> 或者 <code>DELETE</code>。</td></tr><tr><td>PROTOCOL</td><td><code>http</code> 或者 <code>https</code>（如果你在 Elasticsearch 前面有一个 <code>https</code> 代理）</td></tr><tr><td>HOST</td><td>Elasticsearch 集群中任意节点的主机名，或者用 <code>localhost</code> 代表本地机器上的节点。</td></tr><tr><td>PORT</td><td>运行 Elasticsearch HTTP 服务的端口号，默认是 <code>9200</code> 。</td></tr><tr><td>PATH</td><td>API 的终端路径（例如 <code>_count</code> 将返回集群中文档数量）。Path 可能包含多个组件，例如：<code>_cluster/stats</code> 和 <code>_nodes/stats/jvm</code> 。</td></tr><tr><td>QUERY_STRING</td><td>任意可选的查询字符串参数 (例如 <code>?pretty</code> 将格式化地输出 JSON 返回值，使其更容易阅读)</td></tr><tr><td>BODY</td><td>一个 JSON 格式的请求体 (如果请求需要的话)</td></tr></tbody></table><h4 id="1-基本操作"><a href="#1-基本操作" class="headerlink" title="1.基本操作"></a>1.基本操作</h4><ul><li><p>1.插入数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/&lt;id&gt;'</span>  -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "user": "xiaoming",</span></span><br><span class="line"><span class="string">  "position": "engineer"</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure></li><li><p>2.删除数据</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X DELETE <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/&lt;id&gt;'</span></span><br></pre></td></tr></table></figure><ul><li><p>3.修改数据（使用插入方式也可以修改数据）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/&lt;id&gt;/_update'</span>  -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "user": "daming",</span></span><br><span class="line"><span class="string">  "position": "engineer"</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure></li><li><p>4.查询数据</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pretty 代表易读格式</span></span><br><span class="line">curl -X GET <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/&lt;id&gt;?pretty=true'</span></span><br></pre></td></tr></table></figure><h4 id="2-高级查询"><a href="#2-高级查询" class="headerlink" title="2.高级查询"></a>2.高级查询</h4><ul><li><p>1.返回所有记录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/_search'</span></span><br></pre></td></tr></table></figure></li><li><p>2.条件搜索</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询user等于daming的记录，每次从位置1开始（默认是从位置0开始），只返回一条结果。</span></span><br><span class="line">curl <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/_search'</span>  -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "query" : &#123; "match" : &#123; "user" : "daming" &#125;&#125;,</span></span><br><span class="line"><span class="string">  "size": 1,</span></span><br><span class="line"><span class="string">  "from": 1,</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询user等于daming或者xiaoming的记录</span></span><br><span class="line">curl <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/_search'</span>  -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "query" : &#123; "match" : &#123; "user" : "daming xiaoming" &#125;&#125;,</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询user等于daming且position等于engineer的记录</span></span><br><span class="line">curl <span class="string">'localhost:9200/&lt;index_name&gt;/&lt;type_name&gt;/_search'</span>  -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "query": &#123;</span></span><br><span class="line"><span class="string">    "bool": &#123;</span></span><br><span class="line"><span class="string">      "must": [</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "user": "daming" &#125; &#125;,</span></span><br><span class="line"><span class="string">        &#123; "match": &#123; "position": "engineer" &#125; &#125;</span></span><br><span class="line"><span class="string">      ]</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started.html" target="_blank" rel="noopener">ElasticSearch 官方手册</a> </p>]]></content>
      
      
        <tags>
            
            <tag> elk </tag>
            
            <tag> elasticsearch </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十六）Hue</title>
      <link href="/2020/07/15/%E5%A4%A7%E6%95%B0%E6%8D%AE16/"/>
      <url>/2020/07/15/%E5%A4%A7%E6%95%B0%E6%8D%AE16/</url>
      <content type="html"><![CDATA[<p>Hue （Hadoop User Experience Hadoop用户体验）是一个开源的 Apache Hadoop UI系统，由Cloudera Desktop演化而来，最后Cloudera公司将其贡献给Apache基金会的Hadoop社区，它是基于Python Web框架Django实现的。通过使用HUE我们可以在浏览器端的Web控制台上与Hadoop集群进行交互，来分析处理数据。</p><p>本文章主要介绍 Hue 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、用途"><a href="#一、用途" class="headerlink" title="一、用途"></a>一、用途</h3><ul><li>访问HDFS和文件浏览</li><li>通过web调试和开发hive以及数据结果展示</li><li>查询solr和结果展示，报表生成</li><li>通过web调试和开发impala交互式SQL Query</li><li>spark调试和开发</li><li>Pig开发和调试</li><li>oozie任务的开发，监控，和工作流协调调度</li><li>Hbase数据查询和修改，数据展示</li><li>Hive的元数据（metastore）查询</li><li>MapReduce任务进度查看，日志追踪</li><li>创建和提交MapReduce，Streaming，Java job任务</li><li>Sqoop2的开发和调试</li><li>Zookeeper的浏览和编辑</li><li>数据库（MySQL，PostGres，SQlite，Oracle）的查询和展示</li></ul><h3 id="二、架构"><a href="#二、架构" class="headerlink" title="二、架构"></a>二、架构</h3><p>从总体上来讲，Hue应用采用的是B/S架构，该web应用的后台采用python编程语言别写的。大体上可以分为三层，分别是前端view层、Web服务层和Backend服务层。Web服务层和Backend服务层之间使用RPC的方式调用。</p><p><img src="/image/大数据16/大数据16_001.png" alt=""></p><h3 id="三、安装"><a href="#三、安装" class="headerlink" title="三、安装"></a>三、安装</h3><h4 id="1-前置"><a href="#1-前置" class="headerlink" title="1.前置"></a>1.前置</h4><ul><li>1.安装 <code>python</code> 和 <code>maven</code></li><li>2.安装 <code>hadoop</code> 和 <code>hive</code> </li><li>3.创建应用类服务专有用户</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -g hadoop hue</span><br></pre></td></tr></table></figure><ul><li>4.安装依赖包</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install ant asciidoc cyrus-sasl-devel cyrus-sasl-gssapi gcc gcc-c++ krb5-devel libtidy libxml2-devel libxslt-devel openldap-devel python-devel sqlite-devel openssl-devel mysql-devel gmp-devel</span><br></pre></td></tr></table></figure><h4 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h4><ul><li>2.1.下载安装包(<a href="http://gethue.com" target="_blank" rel="noopener">官网</a>或者github)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install git -y</span><br><span class="line"><span class="built_in">cd</span> /hadoop/install</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/cloudera/hue.git branch-4.7</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名</span></span><br><span class="line">mv branch-4.7 hue</span><br></pre></td></tr></table></figure><ul><li><p>2.2.切换用户 hue</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chown -R  hue:hadoop hue</span><br><span class="line">su hue</span><br></pre></td></tr></table></figure></li><li><p>2.3.编译</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> hue</span><br><span class="line">make apps</span><br></pre></td></tr></table></figure></li><li><p>2.4.修改 <code>/usr/local/hue/desktop/conf/pseudo-distributed.ini</code></p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[desktop]</span><br><span class="line">    # 安全秘钥，存储session的加密处理</span><br><span class="line">    secret_key=dfsahjfhflsajdhfljahl</span><br><span class="line">    # Time zone name</span><br><span class="line">    time_zone=Asia/Shanghai</span><br><span class="line">    # Enable or disable debug mode.</span><br><span class="line">    django_debug_mode=false</span><br><span class="line">    # Enable or disable backtrace for server error</span><br><span class="line">    http_500_debug_mode=false</span><br><span class="line">    # This should be the hadoop cluster admin</span><br><span class="line">    ## default_hdfs_superuser=hdfs</span><br><span class="line">    default_hdfs_superuser=root</span><br><span class="line">    # 不启用的模块</span><br><span class="line">    # app_blacklist=impala,security,rdbms,jobsub,pig,hbase,sqoop,zookeeper,metastore,indexer</span><br><span class="line">[[database]]</span><br><span class="line">       # 数据库引擎类型</span><br><span class="line">       engine=mysql</span><br><span class="line">       # 数据库主机地址</span><br><span class="line">       host=master</span><br><span class="line">       # 数据库端口</span><br><span class="line">       port=3306</span><br><span class="line">       # 数据库用户名</span><br><span class="line">       user=root</span><br><span class="line">       # 数据库密码</span><br><span class="line">       password=123456</span><br><span class="line">       # 数据库库名</span><br><span class="line">       name=hue</span><br></pre></td></tr></table></figure><h4 id="3-hue集成hadoop"><a href="#3-hue集成hadoop" class="headerlink" title="3.hue集成hadoop"></a>3.hue集成hadoop</h4><ul><li>3.1.修改配置文件，增加代理用户hue<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="variable">$HADOOP_HOME</span>/etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure></li></ul><p>新增内容：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.hue.hosts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.proxyuser.hue.groups<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></p><ul><li>3.2.配置hue:修改 desktop/conf/pseudo-distributed.ini文件</li></ul><p>修改标签 <code>[[hdfs_clusters]]</code> 如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[hadoop]</span><br><span class="line"></span><br><span class="line">  # Configuration for HDFS NameNode</span><br><span class="line">  # ------------------------------------------------------------------------</span><br><span class="line">  [[hdfs_clusters]]</span><br><span class="line">    # HA support by using HttpFs</span><br><span class="line"></span><br><span class="line">    [[[default]]]</span><br><span class="line">      # Enter the filesystem uri</span><br><span class="line">      fs_defaultfs=hdfs://master:54310</span><br><span class="line"></span><br><span class="line">      # NameNode logical name.</span><br><span class="line">      logical_name=master</span><br><span class="line"></span><br><span class="line">      # Use WebHdfs/HttpFs as the communication mechanism.</span><br><span class="line">      # Domain should be the NameNode or HttpFs host.</span><br><span class="line">      # Default port is 14000 for HttpFs.</span><br><span class="line">      ## webhdfs_url=http://localhost:50070/webhdfs/v1</span><br><span class="line">      webhdfs_url=http://master:9870/webhdfs/v1</span><br><span class="line"></span><br><span class="line">      # Change this if your HDFS cluster is Kerberos-secured</span><br><span class="line">      ## security_enabled=false</span><br><span class="line"></span><br><span class="line">      # In secure mode (HTTPS), if SSL certificates from YARN Rest APIs</span><br><span class="line">      # have to be verified against certificate authority</span><br><span class="line">      ## ssl_cert_ca_verify=True</span><br><span class="line"></span><br><span class="line">      # Directory of the Hadoop configuration</span><br><span class="line">      ## hadoop_conf_dir=$HADOOP_CONF_DIR when set or &apos;/etc/hadoop/conf&apos;</span><br><span class="line">      hadoop_conf_dir=$HADOOP_CONF_DIR</span><br></pre></td></tr></table></figure></p><p>修改标签 <code>[[yarn_clusters]]</code> 如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"># Configuration for YARN (MR2)</span><br><span class="line">  # ------------------------------------------------------------------------</span><br><span class="line">  [[yarn_clusters]]</span><br><span class="line"></span><br><span class="line">    [[[default]]]</span><br><span class="line">      # Enter the host on which you are running the ResourceManager</span><br><span class="line">      ## resourcemanager_host=localhost</span><br><span class="line">      resourcemanager_host=master</span><br><span class="line"></span><br><span class="line">      # The port where the ResourceManager IPC listens on</span><br><span class="line">      ## resourcemanager_port=8032</span><br><span class="line"></span><br><span class="line">      # Whether to submit jobs to this cluster</span><br><span class="line">      submit_to=True</span><br><span class="line"></span><br><span class="line">      # Resource Manager logical name (required for HA)</span><br><span class="line">      ## logical_name=</span><br><span class="line"></span><br><span class="line">      # Change this if your YARN cluster is Kerberos-secured</span><br><span class="line">      ## security_enabled=false</span><br><span class="line"></span><br><span class="line">      # URL of the ResourceManager API</span><br><span class="line">      ## resourcemanager_api_url=http://localhost:8088</span><br><span class="line">      resourcemanager_api_url=http://master:8088</span><br><span class="line"></span><br><span class="line">      # URL of the ProxyServer API</span><br><span class="line">      ## proxy_api_url=http://localhost:8088</span><br><span class="line">      proxy_api_url=http://master:8088</span><br><span class="line"></span><br><span class="line">      # URL of the HistoryServer API</span><br><span class="line">      ## history_server_api_url=http://localhost:19888</span><br><span class="line">      history_server_api_url=http://master:19888</span><br><span class="line"></span><br><span class="line">      # URL of the Spark History Server</span><br><span class="line">      ## spark_history_server_url=http://localhost:18088</span><br><span class="line">      spark_history_server_url=http://master:18080</span><br><span class="line"></span><br><span class="line">      # Change this if your Spark History Server is Kerberos-secured</span><br><span class="line">      ## spark_history_server_security_enabled=false</span><br><span class="line"></span><br><span class="line">      # In secure mode (HTTPS), if SSL certificates from YARN Rest APIs</span><br><span class="line">      # have to be verified against certificate authority</span><br><span class="line">      ## ssl_cert_ca_verify=True</span><br></pre></td></tr></table></figure></p><h4 id="4-hue集成hive配置"><a href="#4-hue集成hive配置" class="headerlink" title="4.hue集成hive配置"></a>4.hue集成hive配置</h4><ul><li><p>4.1.拷贝配置 <code>hive-site.xml</code> 到目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/<span class="built_in">local</span>/hue/hive/conf</span><br><span class="line">cp /hadoop/install/apache-hive-3.1.2/conf/hive-site.xml /usr/<span class="built_in">local</span>/hue/hive</span><br><span class="line">/conf/</span><br></pre></td></tr></table></figure></li><li><p>4.2.修改<code>desktop/conf/pseudo-distributed.ini</code>的标签<code>[beeswax]</code></p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[beeswax]</span><br><span class="line">    # hiveServer2 服务地址(填主机名，kerberos要用)</span><br><span class="line">    hive_server_host=master</span><br><span class="line">    # hiveServer2服务端口</span><br><span class="line">    hive_server_port=10000</span><br><span class="line">    # hiveServer2 hive-site.xml配置文件存放位置</span><br><span class="line">    hive_conf_dir=/usr/local/hue/hive/conf</span><br></pre></td></tr></table></figure><h4 id="5-hue集成spark配置"><a href="#5-hue集成spark配置" class="headerlink" title="5.hue集成spark配置"></a>5.hue集成spark配置</h4><ul><li><p>5.1.启动spark的thrift server</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/spark/sbin</span><br><span class="line">start-thriftserver.sh --master yarn --deploy-mode client</span><br></pre></td></tr></table></figure></li><li><p>5.2.安装livy</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget http://livy.incubator.apache.org/download/apache-livy-0.6.0-incubating-bin</span><br><span class="line">.zip</span><br><span class="line">unzip apache-livy-0.6.0-incubating-bin.zip -C </span><br><span class="line">mv apache-livy-0.6.0-incubating-bin /hadoop/install/livy-0.6.0</span><br></pre></td></tr></table></figure></li><li><p>5.3.创建livy的 <code>livy-env.sh</code> 配置文件和<code>log</code>目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd livy-0.6.0/conf/</span><br><span class="line">cp livy-env.sh.template livy-env.sh</span><br><span class="line">mkdir -p /data/livy/logs</span><br></pre></td></tr></table></figure></li><li><p>5.4.在 <code>livy-env.sh</code> 新建配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_CONF_DIR=/hadoop/install/hadoop/etc/hadoop</span><br><span class="line">export SPARK_HOME=/hadoop/install/spark</span><br><span class="line">export LIVY_LOG_DIR=/data/livy/logs</span><br><span class="line">export LIVY_PID_DIR=/data/livy/pid</span><br></pre></td></tr></table></figure></li><li><p>5.5.配置 <code>livy.conf</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp livy.conf.template livy.conf</span><br></pre></td></tr></table></figure></li><li><p>5.6.在<code>livy.conf</code>文件中加入以下内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># What port to start the server on.</span><br><span class="line">livy.server.port = 8998</span><br><span class="line"># What spark master Livy sessions should use.</span><br><span class="line">livy.spark.master = yarn</span><br><span class="line"># What spark deploy mode Livy sessions should use.</span><br><span class="line">livy.spark.deploy-mode = client</span><br></pre></td></tr></table></figure></li><li><p>5.7.启动livy</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/hadoop/install/livy-0.6.0/bin/livy-server start</span><br></pre></td></tr></table></figure></li><li><p>5.8.修改 <code>desktop/conf/pseudo-distributed.ini</code> 文件的标签<code>[spark]</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">###########################################################################</span><br><span class="line"># Settings to configure the Spark application.</span><br><span class="line">###########################################################################</span><br><span class="line"></span><br><span class="line">[spark]</span><br><span class="line">  # The Livy Server URL.</span><br><span class="line">  ## livy_server_url=http://localhost:8998</span><br><span class="line">  livy_server_url=http://master:8998</span><br><span class="line"></span><br><span class="line">  # Configure Livy to start in local &apos;process&apos; mode, or &apos;yarn&apos; workers.</span><br><span class="line">  ## livy_server_session_kind=yarn</span><br><span class="line">  livy_server_session_kind=yarn</span><br><span class="line"></span><br><span class="line">  # Whether Livy requires client to perform Kerberos authentication.</span><br><span class="line">  ## security_enabled=false</span><br><span class="line"></span><br><span class="line">  # Whether Livy requires client to use csrf protection.</span><br><span class="line">  ## csrf_enabled=false</span><br><span class="line"></span><br><span class="line">  # Host of the Sql Server</span><br><span class="line">  ## sql_server_host=localhost</span><br><span class="line">  sql_server_host=master</span><br><span class="line"></span><br><span class="line">  # Port of the Sql Server</span><br><span class="line">  ## sql_server_port=10000</span><br><span class="line">  sql_server_port=10000</span><br><span class="line"></span><br><span class="line">  # Choose whether Hue should validate certificates received from the server.</span><br><span class="line">  ## ssl_cert_ca_verify=true</span><br><span class="line"></span><br><span class="line">###########################################################################</span><br></pre></td></tr></table></figure></li></ul><h4 id="6-MySql初始化"><a href="#6-MySql初始化" class="headerlink" title="6.MySql初始化"></a>6.MySql初始化</h4><ul><li><p>1.建一个名为hue的库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 登录mysql数据库</span></span><br><span class="line">mysql -u root -p</span><br><span class="line"><span class="comment"># 创建数据库hue</span></span><br><span class="line">create database hue;</span><br><span class="line"><span class="comment"># 创建用户</span></span><br><span class="line">create user <span class="string">'hue'</span>@<span class="string">'%'</span> identified by <span class="string">'123456'</span>;</span><br><span class="line"><span class="comment"># 授权</span></span><br><span class="line">grant all privileges on hue.* to <span class="string">'hue'</span>@<span class="string">'%'</span>;</span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></li><li><p>2.生成表</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">build/env/bin/hue syncdb</span><br><span class="line">build/env/bin/hue migrate</span><br></pre></td></tr></table></figure></li></ul><h4 id="7-启动hue"><a href="#7-启动hue" class="headerlink" title="7.启动hue"></a>7.启动hue</h4><ol><li>启动hue<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">build/env/bin/supervisor &amp;</span><br></pre></td></tr></table></figure></li></ol><ul><li>2.验证:访问 <a href="http://master:8000" target="_blank" rel="noopener">http://master:8000</a></li></ul>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> hue </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十五）Flink</title>
      <link href="/2020/06/15/%E5%A4%A7%E6%95%B0%E6%8D%AE15/"/>
      <url>/2020/06/15/%E5%A4%A7%E6%95%B0%E6%8D%AE15/</url>
      <content type="html"><![CDATA[<p>这几年大数据的飞速发展，出现了很多热门的开源社区，其中著名的有 Hadoop、Storm，以及后来的 Spark，他们都有着各自专注的应用场景。</p><p>Spark 掀开了内存计算的先河，也以内存为赌注，赢得了内存计算的飞速发展。Spark 的火热地掩盖了其他分布式计算的系统身影，例如 Flink在这个时候默默地发展着。在国外一些社区，有很多人将大数据的计算引擎分成了 4 代，当然也有很多人不会认同,我们先姑且这么认为和讨论。</p><p>首先第一代的计算引擎，无疑就是 Hadoop 承载的 MapReduce。这里大家应该都不会对 MapReduce 陌生，它将计算分为两个阶段，分别为 Map 和 Reduce。对于上层应用来说，就不得不想方设法去拆分算法，甚至于不得不在上层应用实现多个 Job 的串联，以完成一个完整的算法，例如迭代计算。<br>由于这样的弊端，催生了支持 DAG 框架的产生,因此支持 DAG 的框架被划分为第二代计算引擎，如 Tez 以及更上层的 Oozie。这里我们不去细究各种 DAG 实现之间的区别，不过对于当时的 Tez 和 Oozie 来说，大多还是批处理的任务。</p><p>接下来就是以 Spark 为代表的第三代的计算引擎。第三代计算引擎的特点主要是 Job 内部的 DAG 支持（不跨越 Job），以及强调的实时计算。在这里，很多人也会认为第三代计算引擎也能够很好的运行批处理的 Job。随着第三代计算引擎的出现，促进了上层应用快速发展，例如各种迭代计算的性能以及对流计算和 SQL 等的支持。Flink 的诞生就被归在了第四代。这应该主要表现在 Flink 对流计算的支持，以及更一步的实时性上面。当然 Flink 也可以支持 Batch 的任务，以及 DAG 的运算。</p><p>本文章主要介绍 Flink 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Flink-介绍"><a href="#Flink-介绍" class="headerlink" title="Flink 介绍"></a>Flink 介绍</h3><p>Apache Flink是一个框架和分布式处理引擎，用于对无界和有界数据流进行有状态计算。Flink设计为在所有常见的集群环境中运行，以内存速度和任何规模执行计算。</p><h4 id="1-批处理和流处理"><a href="#1-批处理和流处理" class="headerlink" title="1. 批处理和流处理"></a>1. 批处理和流处理</h4><p>数据集分为有界数据集和无界数据集：</p><ul><li>有界数据集：有界数据流就是指输入的数据有始有终。例如数据可能是一分钟或者一天的交易数据等等。处理这种有界数据流的方式也被称之为批处理；</li><li>无界数据集：有界数据流就是指有始无终的数据，数据一旦开始生成就会持续不断的产生新的数据，即数据没有时间边界源源不断（比如日志），处理这种有界数据流的方式也被称之为流处理。</li></ul><p><strong>我们一般所说的数据流是指数据集，而流数据则是指数据流中的数据。流处理更复杂，因为需要考虑到数据的顺序错乱和系统容错等。</strong></p><p><img src="/image/大数据15/大数据15_001.png" alt=""></p><h4 id="二、架构的演变"><a href="#二、架构的演变" class="headerlink" title="二、架构的演变"></a>二、架构的演变</h4><ul><li>1.传统单体数据架构<br>传统单体数据架构中，数据集中存储，架构分成计算层和存储层。这种架构初期效率很高，但是随着 业务种类越来越多，系统越来越难以维护升级，此外 database 是唯一准确的数据源，每个 application 都需要访问 database 来获取对应的数据，一旦 database 发生改变或者出现问题，将会对整个业务系统产生影响。</li></ul><p><img src="/image/大数据15/大数据15_002.png" alt=""></p><ul><li>2.微服务架构<br>微服务架构的核心是：1个 application 由多个小的且相互独立的微型服务组成，各服务的开发和发布不存在依赖关系，这样整个系统相比于之前的传统单体数据架构就更加灵活。</li></ul><p><img src="/image/大数据15/大数据15_003.png" alt=""></p><ul><li>3.大数据 lambada 架构<br>lambada 架构分两种处理途径，Speed layer 负责批处理（比如 Hadoop MapReduce），Batch layer 则负责流处理（比如 Storm）。这种架构存在问题：框架较多会导致平台复杂度高、运维成本高。虽说后面 Spark 框架能够同时支持批计算和流计算，但是Spark Streaming 的流计算本质上依旧是微批处理并非实时流计算。</li></ul><p><img src="/image/大数据15/大数据15_004.png" alt=""></p><ul><li><p>4.Flink</p><p>相比于 Spark Streaming的微批处理模式，Flink 通过 Google Dataflow 模型实现了实时流计算框架，<strong>将有界数据集转换成无界数据集统一进行流式处理</strong>。Flink 具有如下优势：</p><ul><li>流处理特性<ul><li><strong>高吞吐、低延时、高性能</strong>；</li><li>支持事件时间（Event Time）概念：大多数框架中<strong>窗口计算</strong>采用<strong>系统时间</strong>（即Event 到达计算框架是 host 的当前时刻），而 Flink 则能够基于<strong>事件时间</strong>（即 Event 本身产生的时刻，当然也可以基于其他类型）语义进行窗口计算。基于事件驱动的优势在于即使 Event 到达的顺序乱了，框架也能够准确知道<strong>事件的时序性</strong>；</li><li>支持高度灵活的窗口计算操作：流处理中，数据就像stream 一样源源不断地进入到框架中进行处理。有时需要通过窗口的方式对 stream 进行一定范围内的聚合计算。比如统计某网页在过去1分钟内的点击数。这种情况下就需要定义一个窗口，收集最近1分钟内的数据，并对这些数据进行计算。Flink 的窗口计算包括Time、Count、Session、Data-driven 等类型的窗口操作，可以灵活使用<strong>触发条件定制化来达到复杂的计算需求</strong>；</li><li>基于轻量级分布式<strong>快照（Snapshot）实现容错</strong>机制：Flink 可以分布运行在多达上千个节点上，将一个大型计算任务流程分解成多个小的计算stage，再分布到节点上并行处理。任务执行过程中，分布式Snapshot（通过 Save points 实现） 的 Checkpoints能够将状态信息进行持久化到存储介质中（比如磁盘），一旦某些任务出现异常，就能够<strong>从Checkpoints 中恢复任务</strong>，从而确保数据处理过程中的一致性；</li><li>基于 JVM 实现独立的内存管理：大数据处理中内存管理是非常重要的部分，Flink 实现了<strong>自身管理内存</strong>的机制，且通过 <strong>序列化/反序列化</strong>方法将所有数据对象转换成二进制存储在内存中，降低数据存储 size 的同时，更高效地利用内存，<strong>降低 JVM GC 对框架性能的影响</strong>。</li></ul></li><li>API支持<ul><li>对Streaming数据类应用，提供DataStream API</li><li>对批处理类应用，提供DataSet API（支持Java/Scala）</li></ul></li><li>Libraries支持<ul><li>支持机器学习（FlinkML）</li><li>支持图分析（Gelly）</li><li>支持关系数据处理（Table）</li><li>支持复杂事件处理（CEP）</li></ul></li><li>整合支持<ul><li>支持Flink on YARN</li><li>支持HDFS</li><li>支持来自Kafka的输入数据</li><li>支持Apache HBase</li><li>支持Hadoop程序</li><li>支持Tachyon</li><li>支持ElasticSearch</li><li>支持RabbitMQ</li><li>支持Apache Storm</li><li>支持S3</li><li>支持XtreemFS</li></ul></li><li>生态圈<br><img src="/image/大数据15/大数据15_005.png" alt=""></li></ul></li></ul><h3 id="三、Flink应用场景"><a href="#三、Flink应用场景" class="headerlink" title="三、Flink应用场景"></a>三、Flink应用场景</h3><ul><li>实时智能推荐；</li><li>复杂事件处理；</li><li>实时欺诈检测；</li><li>实时数仓与 ETL；</li><li>流数据分析；</li><li>实时报表分析。</li></ul><h3 id="四、Flink运行架构"><a href="#四、Flink运行架构" class="headerlink" title="四、Flink运行架构"></a>四、Flink运行架构</h3><ul><li><p>1.术语</p><ul><li><strong>Client</strong>：用来提交任务给 JobManage</li><li><strong>JobManager（指挥者，JVM 进程）</strong>：JobManagers是在Flink主服务器中运行的组件之一。用于任务调度（分发任务给 TaskManager 去执行）、协调检查点和协调故障恢复；</li><li><strong>Task</strong>：基本的工作单元，由Flink的运行时执行任务。任务是封装运算符或运算符链的一个并行实例。</li><li><strong>TaskManager（一个对应一个 JVM 进程）</strong>：worker节点执行任务的数据流，缓冲器以及交换数据流；</li><li><strong>TaskManager Slots</strong> ：用来分割资源，控制worker可以接受多少个任务。</li><li><strong>Akka</strong>：所有组件之间的通信，包括任务状态、Checkpoint 触发等消息。</li><li><strong>Netty</strong>：数据的传输</li><li><strong>Parallelism</strong>： 并行度 </li></ul></li><li><p>2.任务提交和处理流程</p><ul><li>Client 将 application（任务） 提交到 Flink cluster，并于 JobManager 创建 Akka 连接，然后将application 提交给 JobManager；提交方式包括：</li><li>CLI（类似 Spark-submit）；</li><li>Flink WebUI 提交；</li><li>应用程序中指定 JobManager 的 RPC 网络端口构建 Execution Environment 提交 Flink 应用；</li><li>根据 Flink 集群中 TaskManager 上 TaskSlot 的使用情况，为提交的 application `分配 TaskSlots 资源 并命令 TaskManager 启动 application；</li><li>TaskManager 从 JobManager 接收计算任务，然后使用 Slot 资源启动 application，建立数据接入的网络连接、接收数据、处理数据；各 TaskManaer 之间的数据交互通过数据流进行；</li><li>JobManager 和 TaskManager 之间通过 Actor System 进行通信，application 的执行进度会发送给 client 端；在执行 application 过程中，JobManager 会触发 Checkpoints 操作，每个 TaskManager 收到 Checkpoints 触发指令后，会完成 Checkpoint 操作；</li><li>application 执行完成后，执行状态将会反馈给 client 端，并释放掉 TaskManager 中的资源供下一次提交任务使用。</li></ul></li></ul><p><img src="/image/大数据15/大数据15_006.png" alt=""></p><h3 id="五、Flink中的编程模型"><a href="#五、Flink中的编程模型" class="headerlink" title="五、Flink中的编程模型"></a>五、Flink中的编程模型</h3><h4 id="1-编程模型"><a href="#1-编程模型" class="headerlink" title="1.编程模型"></a>1.编程模型</h4><p>在Flink，编程模型的抽象层级主要分为以下4种，越往下抽象度越低，编程越复杂，灵活度越高。</p><p><img src="/image/大数据15/大数据15_007.png" alt=""></p><p>这4层中，一般用于开发的是第二层，即DataStrem/DataSetAPI。用户可以使用DataStream API处理无界数据流，使用DataSet API处理有界数据流。同时这两个API都提供了各种各样的接口来处理数据。例如常见的map、filter、flatMap等等，而且支持python，scala，java等编程语言，后面的demo主要以scala为主。</p><ol><li>Stateful Stream Processiing<ol><li>位于最底层，是core API的底层实现</li><li>process Function</li><li>利用低阶，构建一些新组件（比如：利用其定时做一定情况下的匹配和缓存）</li><li>灵活度高，但看法比较复杂</li></ol></li><li>Core APIS<ol><li>DataStream 流式处理</li><li>DataSet 批量处理</li></ol></li><li>Table &amp; SQL<ol><li>SQL构建在Table之上，都需要构建Table环境。</li><li>不同类型的Table构建不同的Table环境。</li><li>Table可以与DataStream或者DataSet进行相互转换。</li><li>Streaming SQL不同存储的SQL， 最终会转化为流式执行计划</li></ol></li></ol><h4 id="2-构建流程"><a href="#2-构建流程" class="headerlink" title="2.构建流程"></a>2.构建流程</h4><ol><li>构建计算环境（决定采用哪种计算执行方式）</li><li>创建Source（可以多个数据源）</li><li>对数据进行不同方式的转换（提供丰富的算子）</li><li>对结果的数据进行Sink（可以输出到多个地方）</li></ol><p><img src="/image/大数据15/大数据15_008.png" alt=""></p><h3 id="六、安装"><a href="#六、安装" class="headerlink" title="六、安装"></a>六、安装</h3><ul><li>0.前置<ul><li>安装java</li><li>Hadoop</li><li>scala</li></ul></li><li><p>1.Flink的下载：：从<a href="http://flink.apache.org/downloads.html" target="_blank" rel="noopener">官网</a>选择对应Flink版本下载</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget http://mirrors.tuna.tsinghua.edu.cn/apache/flink/flink/flink-1.11.1/flink-1.11.1-bin-scala_2.11.tgz</span><br></pre></td></tr></table></figure></li><li><p>2.解压安装：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zvxf flink-1.11.1-bin-scala_2.11.tgz -C /hadoop/install</span><br><span class="line"><span class="built_in">cd</span> /hadoop/install</span><br><span class="line">mv flink-1.11.1-bin-scala_2.11 flink</span><br></pre></td></tr></table></figure></li><li><p>3.配置环境变量：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 追加内容：</span></span><br><span class="line"><span class="built_in">export</span> FLINK_HOME=/hadoop/install/flink</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$FLINK_HOME</span>/bin</span><br></pre></td></tr></table></figure></li><li><p>4.使环境变量生效</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></li></ul><h3 id="七、部署"><a href="#七、部署" class="headerlink" title="七、部署"></a>七、部署</h3><p>Flink 有三种部署模式，分别是 Local、Standalone Cluster（ 依赖于 Zookeeper 来实现 JobManager 的 HA ） 和 Yarn Cluster（ 依靠 Yarn 本身来对 JobManager 做 HA  ）。</p><h4 id="1-Local-模式"><a href="#1-Local-模式" class="headerlink" title="1.Local 模式"></a>1.Local 模式</h4><p>对于 Local 模式来说，JobManager 和 TaskManager 会公用一个 JVM 来完成 Workload。如果要验证一个简单的应用，Local 模式是最方便的。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-local.sh</span><br></pre></td></tr></table></figure><h4 id="2-Standalone-模式"><a href="#2-Standalone-模式" class="headerlink" title="2.Standalone 模式"></a>2.Standalone 模式</h4><p>参考<a href="https://ci.apache.org/projects/flink/flink-docs-release-1.6/quickstart/setup_quickstart.html" target="_blank" rel="noopener">入门教程</a></p><ul><li><p>1.<strong>部署规划</strong></p><p>  | 节点名称 | master | worker | zookeeper |<br>  | ——– | —— | —— | ——— |<br>  | master   | master |        | zookeeper |<br>  | node1    |        | worker | zookeeper |<br>  | node2    |        | worker | zookeeper |<br>  | node3    |        | worker | zookeeper |</p></li><li><p>2.<strong>修改配置文件</strong></p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> flink/conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.修改masters</span></span><br><span class="line">vi masters</span><br><span class="line"></span><br><span class="line">修改内容如下：</span><br><span class="line">master:8081</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.修改slaves</span></span><br><span class="line">vi slaves</span><br><span class="line"></span><br><span class="line">修改内容如下：</span><br><span class="line">node1</span><br><span class="line">node2</span><br><span class="line">node3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.修改flink-conf.yaml </span></span><br><span class="line">vi flink-conf.yaml </span><br><span class="line"></span><br><span class="line">修改内容如下：</span><br><span class="line">taskmanager.numberOfTaskSlots：2</span><br><span class="line">jobmanager.rpc.address: master</span><br></pre></td></tr></table></figure><p>  可选配置:</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">每个JobManager（jobmanager.heap.mb）的可用内存量</span><br><span class="line">每个TaskManager（taskmanager.heap.mb）的可用内存量</span><br><span class="line">每台机器的可用CPU数量（taskmanager.numberOfTaskSlots）</span><br><span class="line">集群中的CPU总数（parallelism.default）</span><br><span class="line">临时目录（taskmanager.tmp.dirs</span><br></pre></td></tr></table></figure></li></ul><ul><li>3.<strong>拷贝安装包到各节点</strong>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp -r flink/ hadoop@node1:`<span class="built_in">pwd</span>`</span><br><span class="line">scp -r flink/ hadoop@node2:`<span class="built_in">pwd</span>`</span><br><span class="line">scp -r flink/ hadoop@node3:`<span class="built_in">pwd</span>`</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>4.<strong>启动flink</strong></p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-cluster.sh</span><br></pre></td></tr></table></figure></li><li><p>5.WebUI查看:访问<a href="http://master:8081" target="_blank" rel="noopener">http://master:8081</a></p></li></ul><p><strong>注：这里只是集群模式而已，在实际场景中，我们一般需要配置为HA，防止Jobmanager突然挂掉，导致整个集群或者任务执行失败的情况发生。下面介绍一下Standalone HA模式的搭建安装</strong></p><h4 id="3-Standalone-HA模式"><a href="#3-Standalone-HA模式" class="headerlink" title="3.Standalone HA模式"></a>3.Standalone HA模式</h4><p>依赖于 Zookeeper 来实现 JobManager 的 HA。在 Zookeeper 的帮助下，一个 Standalone 的 Flink 集群会同时有多个活着的 JobManager，其中只有一个处于工作状态，其他处于 Standby 状态。当工作中的 JobManager 失去连接后（如宕机或 Crash），Zookeeper 会从 Standby 中选举新的 JobManager 来接管 Flink 集群。 </p><ul><li><p>1.更改conf/flink-conf.yaml配置文件 </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#jobmanager.rpc.address: master</span></span><br><span class="line">high-availability:zookeeper                             <span class="comment">#指定高可用模式（必须）</span></span><br><span class="line">high-availability.zookeeper.quorum:master:2181,node1:2181,node2:2181,node3:2181 <span class="comment"># ZooKeeper仲裁是ZooKeeper服务器的复制组，它提供分布式协调服务（必须）</span></span><br><span class="line">high-availability.storageDir:hdfs:///flink/ha/       <span class="comment">#JobManager元数据保存在文件系统storageDir中，只有指向此状态的指针存储在ZooKeeper中（必须）</span></span><br><span class="line">high-availability.zookeeper.path.root:/flink         <span class="comment">#根ZooKeeper节点，在该节点下放置所有集群节点（推荐） </span></span><br><span class="line">high-availability.cluster-id:/flinkCluster           ＃自定义集群（推荐）</span><br><span class="line">state.backend: filesystem</span><br><span class="line">state.checkpoints.dir: hdfs:///flink/checkpoints</span><br><span class="line">state.savepoints.dir: hdfs:///flink/checkpoints</span><br></pre></td></tr></table></figure></li><li><p>2.修改conf/masters</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">master:8081</span><br><span class="line">node1:8081</span><br></pre></td></tr></table></figure></li><li><p>3.分发配置文件，将刚刚修改的配置文件 masters 和 flink-conf.yaml 分发至另外三个节点。</p></li><li>4.重启flink集群：start-cluster.sh</li></ul><h4 id="4-Yarn-Cluster"><a href="#4-Yarn-Cluster" class="headerlink" title="4.Yarn Cluster"></a>4.Yarn Cluster</h4><p>Yarn Cluaster 模式来说，Flink 就要依靠 Yarn 本身来对 JobManager 做 HA 了。</p><p><img src="/image/大数据15/大数据15_009.png" alt=""></p><p>在图中可以看出，Flink 与 Yarn 的关系与 MapReduce 和 Yarn 的关系是一样的。Flink 通过 Yarn 的接口实现了自己的 App Master。当在 Yarn 中部署了 Flink，Yarn 就会用自己的 Container 来启动 Flink 的 JobManager（也就是 App Master）和 TaskManager。</p><p>启动新的Flink YARN会话时，客户端首先检查所请求的资源（容器和内存）是否可用。之后，它将包含Flink和配置的jar上传到HDFS（步骤1）。</p><p>客户端的下一步是请求（步骤2）YARN容器以启动<em>ApplicationMaster</em>（步骤3）。由于客户端将配置和jar文件注册为容器的资源，因此在该特定机器上运行的YARN的NodeManager将负责准备容器（例如，下载文件）。完成后，将启动<em>ApplicationMaster</em>（AM）。</p><p>该<em>JobManager</em>和AM在同一容器中运行。一旦它们成功启动，AM就知道JobManager（它自己的主机）的地址。它正在为TaskManagers生成一个新的Flink配置文件（以便它们可以连接到JobManager）。该文件也上传到HDFS。此外，<em>AM</em>容器还提供Flink的Web界面。YARN代码分配的所有端口都是<em>临时端口</em>。这允许用户并行执行多个Flink YARN会话。</p><p>之后，AM开始为Flink的TaskManagers分配容器，这将从HDFS下载jar文件和修改后的配置。完成这些步骤后，即可建立Flink并准备接受作业。</p><ul><li><p>1.修改环境变量</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span>  HADOOP_CONF_DIR=/hadoop/install/hadoop/etc/hadoop</span><br></pre></td></tr></table></figure></li><li><p>2.部署启动 </p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn-session.sh -d -s 2 -tm 800 -n 2</span><br></pre></td></tr></table></figure>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-n : TaskManager的数量，相当于executor的数量</span><br><span class="line">-s : 每个JobManager的core的数量，executor-cores。建议将slot的数量设置每台机器的处理器数量</span><br><span class="line">-tm : 每个TaskManager的内存大小，executor-memory</span><br><span class="line">-jm : JobManager的内存大小，driver-memory</span><br></pre></td></tr></table></figure></li><li><p>3.Yarn 模式的HA:修改 yarn-site.xml文件（$HADOOP_HOME/etc/hadoop/yarn-site.xml）的 应用最大尝试次数（max-attempts）</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&lt;property&gt;</span></span><br><span class="line">  <span class="string">&lt;name&gt;yarn.resourcemanager.am.max-attempts&lt;/name&gt;</span></span><br><span class="line">  <span class="string">&lt;value&gt;4&lt;/value&gt;</span></span><br><span class="line">  <span class="string">&lt;description&gt;The</span> <span class="string">maximum</span> <span class="string">number</span> <span class="string">of</span> <span class="string">application</span> <span class="string">master</span> <span class="string">execution</span> <span class="string">attempts&lt;/description&gt;</span></span><br><span class="line"><span class="string">&lt;/property&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>More info: <a href="https://www.jianshu.com/p/3b1bccbfa322" target="_blank" rel="noopener">flink</a></p>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> flink </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十四）Spark</title>
      <link href="/2020/05/15/%E5%A4%A7%E6%95%B0%E6%8D%AE14/"/>
      <url>/2020/05/15/%E5%A4%A7%E6%95%B0%E6%8D%AE14/</url>
      <content type="html"><![CDATA[<p>Apache Spark 是专为大规模数据处理而设计的快速通用的计算引擎。</p><p>本文章主要介绍 Spark 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、Hadoop-和-Spark-的关系"><a href="#一、Hadoop-和-Spark-的关系" class="headerlink" title="一、Hadoop 和 Spark 的关系"></a>一、Hadoop 和 Spark 的关系</h3><ul><li><p>Hadoop有两个核心模块，分布式存储模块HDFS和分布式计算模块Mapreduce</p></li><li><p>spark本身并没有提供分布式文件系统，因此spark的分析大多依赖于Hadoop的分布式文件系统HDFS</p></li><li><p>Hadoop的Mapreduce与spark都可以进行数据计算，而相比于Mapreduce，spark的速度更快并且提供的功能更加丰富</p></li></ul><p><img src="/image/大数据14/大数据14_001.jpg" alt=""></p><p><img src="/image/大数据14/大数据14_002.jpg" alt=""><br><img src="/image/大数据14/大数据14_003.jpg" alt=""></p><h3 id="二、-Spark-的特点"><a href="#二、-Spark-的特点" class="headerlink" title="二、 Spark 的特点"></a>二、 Spark 的特点</h3><p>Spark具有如下几个主要特点：</p><ul><li>运行速度快：Spark使用先进的DAG（Directed Acyclic Graph，有向无环图）执行引擎，以支持循环数据流与内存计算，基于内存的执行速度可比Hadoop MapReduce快上百倍，基于磁盘的执行速度也能快十倍；</li><li>容易使用：Spark支持使用Scala、Java、Python和R语言进行编程，简洁的API设计有助于用户轻松构建并行程序，并且可以通过Spark Shell进行交互式编程；</li><li>通用性：Spark提供了完整而强大的技术栈，包括SQL查询、流式计算、机器学习和图算法组件，这些组件可以无缝整合在同一个应用中，足以应对复杂的计算；</li><li>运行模式多样：Spark可运行于独立的集群模式中，或者运行于Hadoop中，也可运行于Amazon EC2等云环境中，并且可以访问HDFS、Cassandra、HBase、Hive等多种数据源。</li></ul><h3 id="三、Spark-架构"><a href="#三、Spark-架构" class="headerlink" title="三、Spark 架构"></a>三、Spark 架构</h3><h4 id="1-Spark生态系统"><a href="#1-Spark生态系统" class="headerlink" title="1.Spark生态系统"></a>1.Spark生态系统</h4><p><img src="/image/大数据14/大数据14_004.jpg" alt=""></p><ul><li>Spark Core：包含Spark的基本功能，尤其是定义RDD的API、操作以及这两者上的动作。其他Spark的库都是构建在RDD和Spark Core之上的</li><li>Spark SQL：提供通过Apache Hive的SQL变体Hive查询语言（HiveQL）与Spark进行交互的API。每个数据库表被当做一个RDD，Spark SQL查询被转换为Spark操作。</li><li>Spark Streaming：对实时数据流进行处理和控制。Spark Streaming允许程序能够像普通RDD一样处理实时数据</li><li>MLlib：一个常用机器学习算法库，算法被实现为对RDD的Spark操作。这个库包含可扩展的学习算法，比如分类、回归等需要对大量数据集进行迭代的操作。</li><li>GraphX：控制图、并行图操作和计算的一组算法和工具的集合。GraphX扩展了RDD API，包含控制图、创建子图、访问路径上所有顶点的操作</li></ul><h4 id="2-架构"><a href="#2-架构" class="headerlink" title="2.架构"></a>2.架构</h4><p><img src="/image/大数据14/大数据14_005.jpg" alt=""></p><h4 id="3-基本概念"><a href="#3-基本概念" class="headerlink" title="3.基本概念"></a>3.基本概念</h4><table><thead><tr><th>Term（术语）</th><th>Meaning（含义）</th></tr></thead><tbody><tr><td>Cluster manager</td><td>一个外部的用于获取集群上资源的服务。（在standalone模式中即为Master主节点，控制整个集群，监控worker;在YARN模式中为资源管理器。</td></tr><tr><td>Driver program</td><td>该进程运行应用的 main() 方法并且创建了 SparkContext。</td></tr><tr><td>RDD</td><td>是弹性分布式数据集（Resilient Distributed Dataset）的简称，是分布式内存的一个抽象概念，提供了一种高度受限的共享内存模型</td></tr><tr><td>DAG</td><td>是Directed Acyclic Graph（有向无环图）的简称，反映RDD之间的依赖关系</td></tr><tr><td>Application</td><td>用户构建在 Spark 上的程序。由集群上的一个 driver 程序和多个 executor 组成。</td></tr><tr><td>Worker node</td><td>任何在集群中可以运行应用代码的节点。</td></tr><tr><td>Executor</td><td>一个为了在 worker 节点上的应用而启动的进程，它运行 task 并且将数据保持在内存中或者硬盘存储。每个应用有它自己的 Executor。</td></tr><tr><td>Task</td><td>一个将要被发送到 Executor 中的工作单元。</td></tr><tr><td>Job</td><td>一个由多个任务组成的并行计算，并且能从 Spark action 中获取响应（例如 save，collect）; 您将在 driver 的日志中看到这个术语。</td></tr><tr><td>Stage</td><td>每个 Job 被拆分成更小的被称作 stage（阶段）的 task（任务）组，stage 彼此之间是相互依赖的（与 MapReduce 中的 map 和 reduce stage 相似）。您将在 driver 的日志中看到这个术语。</td></tr></tbody></table><p>在Spark中，一个应用（Application）由一个任务控制节点（Driver）和若干个作业（Job）构成，一个作业由多个阶段（Stage）构成，一个阶段由多个任务（Task）组成。当执行一个应用时，任务控制节点会向集群管理器（Cluster Manager）申请资源，启动Executor，并向Executor发送应用程序代码和文件，然后在Executor上执行任务，运行结束后，执行结果会返回给任务控制节点，或者写到HDFS或者其他数据库中。</p><p><img src="/image/大数据14/大数据14_006.jpg" alt=""></p><h4 id="4-运行流程"><a href="#4-运行流程" class="headerlink" title="4.运行流程"></a>4.运行流程</h4><p><img src="/image/大数据14/大数据14_007.jpg" alt=""></p><ol><li>构建Spark Application的运行环境，启动SparkContext</li><li>SparkContext向资源管理器（可以是Standalone，Mesos，Yarn）申请运行Executor资源，并启动StandaloneExecutorbackend，</li><li>Executor向SparkContext申请Task</li><li>SparkContext将应用程序分发给Executor</li><li>SparkContext构建成DAG图，将DAG图分解成Stage、将Taskset发送给Task Scheduler，最后由Task Scheduler将Task发送给Executor运行</li><li>Task在Executor上运行，运行完释放所有资源</li></ol><h3 id="四、Spark的部署模式"><a href="#四、Spark的部署模式" class="headerlink" title="四、Spark的部署模式"></a>四、Spark的部署模式</h3><ul><li><p>1.standalone模式<br>与MapReduce1.0框架类似，Spark框架本身也自带了完整的资源调度管理服务，可以独立部署到一个集群中，而不需要依赖其他系统来为其提供资源管理调度服务。在架构的设计上，Spark与MapReduce1.0完全一致，都是由一个Master和若干个Slave构成，并且以槽（slot）作为资源分配单位。不同的是，Spark中的槽不再像MapReduce1.0那样分为Map 槽和Reduce槽，而是只设计了统一的一种槽提供给各种任务来使用。</p></li><li><p>2.Spark on Mesos模式<br>Mesos是一种资源调度管理框架，可以为运行在它上面的Spark提供服务。Spark on Mesos模式中，Spark程序所需要的各种资源，都由Mesos负责调度。由于Mesos和Spark存在一定的血缘关系，因此，Spark这个框架在进行设计开发的时候，就充分考虑到了对Mesos的充分支持，因此，相对而言，Spark运行在Mesos上，要比运行在YARN上更加灵活、自然。目前，Spark官方推荐采用这种模式，所以，许多公司在实际应用中也采用该模式。</p></li><li><p>3.Spark on YARN模式<br>Spark可运行于YARN之上，与Hadoop进行统一部署，即“Spark on YARN”，资源管理和调度依赖YARN，分布式存储则依赖HDFS。</p></li></ul><h3 id="五、部署安装"><a href="#五、部署安装" class="headerlink" title="五、部署安装"></a>五、部署安装</h3><h4 id="0-前置"><a href="#0-前置" class="headerlink" title="0.前置"></a>0.前置</h4><ul><li>安装java</li><li>安装hadoop</li></ul><h4 id="1-安装Scala"><a href="#1-安装Scala" class="headerlink" title="1.安装Scala"></a>1.安装Scala</h4><ul><li><p>0.从<a href="https://www.scala-lang.org/download/" target="_blank" rel="noopener">官网</a>下载安装包到 /hadoop/software</p></li><li><p>1.解压到指定文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">tar -zxvf scala-2.11.8.tgz -C  /haddop/install</span><br></pre></td></tr></table></figure></li><li><p>2.修改环境变量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在末尾追加内容</span></span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=/haddop/install/scala-2.11.8</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$SCALA_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></li><li><p>3.使环境变量生效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>4.检查安装是否成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scala -version</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-安装Spark"><a href="#2-安装Spark" class="headerlink" title="2.安装Spark"></a>2.安装Spark</h4><ul><li><p>0.从<a href="http://spark.apache.org/downloads.html" target="_blank" rel="noopener">官网</a>下载安装包到/hadoop/software</p></li><li><p>1.解压到指定文件</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">tar -zxvf spark-2.3.3-bin-hadoop2.7.tgz -C  /haddop/install</span><br><span class="line"><span class="built_in">cd</span> /haddop/install</span><br><span class="line">mv spark-2.3.3-bin-hadoop2.7 spark</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>2.修改环境变量</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在末尾追加内容</span></span><br><span class="line"><span class="built_in">export</span> SPARK_HOME=/hadoop/install/spark</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$SPARK_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></li><li><p>3.使环境变量生效</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-设置部署模式"><a href="#3-设置部署模式" class="headerlink" title="3.设置部署模式"></a>3.设置部署模式</h4><ul><li><p>local模式</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark-shell</span><br></pre></td></tr></table></figure></li><li><p>Standalone模式</p><ul><li><p>1.配置文件slaves.template</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /haddop/install/spark/conf</span><br><span class="line">cp slaves.template slaves</span><br><span class="line">vi slaves</span><br></pre></td></tr></table></figure><p>添加以下内容 slavexx(看节点数量)：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Master</span><br><span class="line">Slave1</span><br><span class="line">Slave2</span><br><span class="line">Slave3</span><br></pre></td></tr></table></figure></li><li><p>2.配置spark-env.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp spark-env.sh.template spark-env.sh</span><br><span class="line">vi spark-env.sh</span><br></pre></td></tr></table></figure><p>添加以下内容 ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JAVA的路径</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=<span class="variable">$&#123;JAVA_HOMRE&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># SCALA的路径</span></span><br><span class="line"><span class="built_in">export</span> SCALA_HOME=<span class="variable">$&#123;SCALA_HOME&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HADOOP的路径</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_CONF_DIR=<span class="variable">$&#123;HADOOP_HOME&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># master的ip或host</span></span><br><span class="line"><span class="built_in">export</span> SPARK_MASTER_IP=master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交任务的端口</span></span><br><span class="line"><span class="built_in">export</span> SPARK_MASTER_PORT=7077</span><br><span class="line"></span><br><span class="line"><span class="comment"># 浏览器访问master的端口</span></span><br><span class="line"><span class="built_in">export</span> SPARK_MASTER_WEBUI_PORT=8080</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个worker从节点能够支配的core的个数</span></span><br><span class="line"><span class="built_in">export</span> SPARK_WORKER_CORES=2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个worker从节点能够支配的内存数</span></span><br><span class="line"><span class="built_in">export</span> SPARK_WORKER_MEMORY=内存大小</span><br><span class="line"></span><br><span class="line"><span class="comment">#每个worker</span></span><br><span class="line"><span class="built_in">export</span> SPARK_WORKER_PORT=7078</span><br><span class="line"><span class="built_in">export</span> SPARK_WORKER_WEBUI_PORT=8081</span><br><span class="line"><span class="built_in">export</span> SPARK_WORKER_INSTANCES=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每个worker的数据存放</span></span><br><span class="line"><span class="built_in">export</span> SPARK_WORKER_DIR=<span class="variable">$&#123;SPARK_HOME&#125;</span>/data/tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定Spark executor的内存大小</span></span><br><span class="line"><span class="built_in">export</span> SPARK_EXECUTOR_MEMORY=1G</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定Spark executor 使用的cpu的核的数量</span></span><br><span class="line"><span class="built_in">export</span> SPARK_EXECUTOR_CORES=1</span><br></pre></td></tr></table></figure></li><li><p>3.配置修改Spark-defaults.conf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp spark-defaults.conf.template spark-defaults.conf</span><br><span class="line">vi spark-defaults.conf</span><br></pre></td></tr></table></figure><p>添加以下内容 ：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置事件日志为true</span></span><br><span class="line">spark.eventlog.enabled=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置记录删除时间</span></span><br><span class="line">spark.history.fs.cleaner.interval=1d</span><br><span class="line">spark.history.fs.cleaner.maxAge=7d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定事件日志目录</span></span><br><span class="line">spark.eventlog.dir hdfs://nn/user/spark/<span class="built_in">history</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定Driver的内存大小</span></span><br><span class="line">spark.driver.memory 1g</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定历史操作日志操作保存路径</span></span><br><span class="line">spark.history.fs.logDirectory hdfs://nn/usr/spark/<span class="built_in">history</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设定仓库目录</span></span><br><span class="line">spark.sql.warehouse.dir /user/spark/warehouse</span><br></pre></td></tr></table></figure></li></ul></li><li><p>Yarn模式:在standalone模式的基础上，在客户端的spark-env.sh文件中配置</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HADOOP_CONF_DIR=<span class="variable">$HADOOP_HOME</span>/etc/hadoop</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> spark </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十三）Sqoop</title>
      <link href="/2020/04/15/%E5%A4%A7%E6%95%B0%E6%8D%AE13/"/>
      <url>/2020/04/15/%E5%A4%A7%E6%95%B0%E6%8D%AE13/</url>
      <content type="html"><![CDATA[<p>传统的应用程序管理系统，即应用程序与使用RDBMS的关系数据库的交互，是产生大数据的来源之一。由RDBMS生成的这种大数据存储在关系数据库结构中的关系数据库服务器中。</p><p>当大数据存储和Hadoop生态系统的MapReduce，Hive，HBase，Cassandra，Pig等分析器出现时，他们需要一种工具来与关系数据库服务器进行交互，以导入和导出驻留在其中的大数据。在这里，Sqoop在Hadoop生态系统中占据一席之地，以便在关系数据库服务器和Hadoop的HDFS之间提供可行的交互。</p><p>Sqoop(“SQL到Hadoop和Hadoop到SQL):是一个用于在Hadoop和关系数据库服务器之间传输数据的工具。它用于从关系数据库（如MySQL，Oracle）导入数据到Hadoop HDFS，并从Hadoop文件系统导出到关系数据库。它由Apache软件基金会提供。</p><p>本文章主要介绍 Sqoop 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、流程"><a href="#一、流程" class="headerlink" title="一、流程"></a>一、流程</h3><p><img src="/image/大数据13/大数据13_001.png" alt=""></p><ul><li>Sqoop导入：导入工具从RDBMS向HDFS导入单独的表。表中的每一行都被视为HDFS中的记录。所有记录都以文本文件的形式存储在文本文件中或作为Avro和Sequence文件中的二进制数据存储。</li><li>Sqoop导出：导出工具将一组文件从HDFS导出回RDBMS。给Sqoop输入的文件包含记录，这些记录在表中被称为行。这些被读取并解析成一组记录并用用户指定的分隔符分隔。</li></ul><h3 id="二、工作机制"><a href="#二、工作机制" class="headerlink" title="二、工作机制"></a>二、工作机制</h3><p>将导入或导出命令翻译成 MapReduce 程序来实现 在翻译出的 MapReduce 中主要是对 InputFormat 和 OutputFormat 进行定制</p><h3 id="三、Sqoop版本"><a href="#三、Sqoop版本" class="headerlink" title="三、Sqoop版本"></a>三、Sqoop版本</h3><ul><li>1.sqoop的版本sqoop1和sqoop2是两个不同的版本，它们是完全不兼容的</li><li>2.版本划分方式: apache1.4.X之后的版本是1,1.99.0之上的版本是2</li><li>3.Sqoop2相比sqoop1的优势有：<ul><li>1.它引入的sqoop Server，便于集中化的管理Connector或者其它的第三方插件；</li><li>2.多种访问方式：CLI、Web UI、REST API；</li><li>3.它引入了基于角色的安全机制，管理员可以在sqoop Server上配置不同的角色。</li></ul></li><li>4.Sqoop2和sqoop1的功能性对比：<ul><li>1.它引入的sqoop Server，便于集中化的管理Connector或者其它的第三方插件；</li><li>2.多种访问方式：CLI、Web UI、REST API；</li><li><ol start="3"><li>它引入了基于角色的安全机制，管理员可以在sqoop Server上配置不同的角色。</li></ol></li></ul></li><li>5.Sqoop2和sqoop1的功能性对比：</li></ul><p><img src="/image/大数据13/大数据13_002.png" alt=""></p><ul><li><p>6.Sqoop1和Sqoop2的架构区别：</p><ul><li><p>1.Sqoop1的架构图：</p><p><img src="/image/大数据13/大数据13_003.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">版本号：1.4.X以后的Sqoop1</span><br><span class="line">在架构上：Sqoop1使用Sqoop客户端直接提交代码方式</span><br><span class="line">访问方式：CLI命令行控制台方式访问</span><br><span class="line">安全性：命令或者脚本指定用户数据库名和密码</span><br><span class="line">原理：Sqoop工具接收到客户端的shell命令或者Java api命令后，通过Sqoop中的任务翻译器(Task Translator)将命令转换为对应的MapReduce任务，而后将关系型数据库和Hadoop中的数据进行相互转移，进而完成数据的拷贝</span><br></pre></td></tr></table></figure></li><li><p>2.Sqoop2架构图：<br><img src="/image/大数据13/大数据13_004.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">版本号：1.99.X以上的版本Sqoop2   </span><br><span class="line">在架构上：Sqoop2引入了 Sqoop server,对对connector实现了集中的管理访问方式：REST API、 JAVA API、 WEB UI以及CLI控制台方式进行访问    </span><br><span class="line">   CLI方式访问，会通过交互过程界面，输入的密码信息会被看到，同时Sqoop2引入基亍角色的安全机制，Sqoop2比Sqoop多了一个Server端。</span><br></pre></td></tr></table></figure></li><li><p>3.Sqoop1和Sqoop2优缺点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sqoop1优点：架构部署简单</span><br><span class="line">Sqoop1缺点：命令行方式容易出错，格式紧耦合，无法支持所有数据类型，安全机制不够完善，例如密码暴漏，安装需要root权限，connector必须符合JDBC模型</span><br><span class="line">Sqoop2优点：多种交互方式，命令行，web UI，rest API，conncetor集中化管理，所有的链接安装在Sqoop server上，完善权限管理机制，connector规范化，仅仅负责数据的读写</span><br><span class="line">Sqoop2缺点：Sqoop2的缺点，架构稍复杂，配置部署更繁琐</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="四、Sqoop1的安装"><a href="#四、Sqoop1的安装" class="headerlink" title="四、Sqoop1的安装"></a>四、Sqoop1的安装</h3><p>因为绝大部分企业所使用的sqoop的版本都是 Sqoop1，这边介绍 Sqoop1 的安装。</p><ul><li>1.前提概述<ul><li>1.sqoop就是一个工具,只需要在一个节点上进行安装即可。</li><li>2.需要跟那个组件打交道，就需要安装的节点上有对应组件。</li></ul></li><li>2.下载<ul><li>1.从<a href="http://sqoop.apache.org/" target="_blank" rel="noopener">官网</a>下载,选择 sqoop-1.4.7 下载。</li></ul></li><li><p>3.上传并解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">tar -zxvf sqoop-1.4.7.bin__hadoop-2.6.0.tar.gz  -C /hadopp/install/</span><br></pre></td></tr></table></figure></li><li><p>4.配置环境变量</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/hadoop/.bashrc</span><br><span class="line">vi .bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将下面两行添加到末尾</span></span><br><span class="line"><span class="built_in">export</span> SQOOP_HOME=/hadoop/install/sqoop-1.4.7</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$SQOOP_HOME</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使环境变量生效</span></span><br><span class="line">. .bashrc</span><br></pre></td></tr></table></figure></li><li><p>5.修改配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/sqoop-1.4.7/conf/</span><br><span class="line">mv sqoop-env-template.sh sqoop-env.sh</span><br><span class="line">vi sqoop-env.sh</span><br></pre></td></tr></table></figure></li></ul><p>修改配置内容<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HADOOP_COMMON_HOME=/install/hadoop/hadoop</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set path to where hadoop-*-core.jar is available</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_MAPRED_HOME=/install/hadoop/hadoop</span><br><span class="line"></span><br><span class="line"><span class="comment">#set the path to where bin/hbase is available</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/hadoop/install/hbase-2.0.5</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set the path to where bin/hive is available</span></span><br><span class="line"><span class="built_in">export</span> HIVE_HOME=/hadoop/install/apache-hive-3.1.2</span><br><span class="line"></span><br><span class="line"><span class="comment">#Set the path for where zookeper config dir is</span></span><br><span class="line"><span class="built_in">export</span> ZOOCFGDIR=/hadoop/install/zookeeper-3.4.12/conf</span><br></pre></td></tr></table></figure></p><ul><li><p>6.增加驱动</p><ul><li>1.从<a href="https://downloads.mysql.com/archives/c-j/" target="_blank" rel="noopener">mysql官网</a>下载对于版本驱动</li><li>2.把驱动放入sqoop1.4.7/lib 目录下<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /hadoop/software/mysql-connector-java-5.1.38-bin.jar /hadoop/install/sqoop1.4.7/lib/</span><br></pre></td></tr></table></figure></li></ul></li><li><p>7.验证安装是否成功</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop-version</span><br></pre></td></tr></table></figure></li></ul><h3 id="五、Sqoop的基本命令"><a href="#五、Sqoop的基本命令" class="headerlink" title="五、Sqoop的基本命令"></a>五、Sqoop的基本命令</h3><ul><li>1.列出MySQL数据有哪些数据库</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-databases --connect jdbc:mysql://master:3306/ --username root --password root</span><br></pre></td></tr></table></figure><ul><li><p>2.列出MySQL中的某个数据库有哪些数据表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop list-tables --connect jdbc:mysql://master:3306/ --username root --password root</span><br></pre></td></tr></table></figure></li><li><p>3.创建一张跟mysql中的tbl_test表一样的hive表tbl_hive：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop create-hive-table --connect jdbc:mysql://master:3306/ --username root --password root  --table tbl_test  --hive-table tbl_hive</span><br></pre></td></tr></table></figure><ul><li>4.从RDBMS导入到HDFS中</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop import (generic-args) (import-args)</span><br></pre></td></tr></table></figure><p>常用参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--connect &lt;jdbc-uri&gt; jdbc 连接地址</span><br><span class="line">--connection-manager &lt;class-name&gt; 连接管理者</span><br><span class="line">--connection-param-file &lt;filename&gt; 可选参数</span><br><span class="line">--column-family：列族</span><br><span class="line">--driver &lt;class-name&gt; 驱动类</span><br><span class="line">--hadoop-mapred-home &lt;dir&gt; $HADOOP_MAPRED_HOME</span><br><span class="line">--hbase-table：hbase中的table</span><br><span class="line">--hbase-row-key：指定rowkey</span><br><span class="line">--help help 信息</span><br><span class="line">--password &lt;password&gt; 密码</span><br><span class="line">-P 从命令行输入密码</span><br><span class="line">--table ：需要sqoop的表</span><br><span class="line">--username &lt;username&gt; 账号</span><br><span class="line">--verbose 打印流程信息</span><br></pre></td></tr></table></figure></p><p>例子: 导入mysql库中的 tbl_test 的数据到HDFS上</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop import  --connect jdbc:mysql://master:3306/ --username root --password root  --table tbl_test  -m 1</span><br></pre></td></tr></table></figure><ul><li>5.把MySQL数据库中的表数据导入到Hive中</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqoop import  --connect jdbc:mysql://master:3306/ --username root --password root  --table tbl_test --hive-import -m 1</span><br></pre></td></tr></table></figure><p>导入过程:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一步：导入mysql.tbl_test的数据到hdfs的默认路径</span><br><span class="line">第二步：自动仿造mysql.help_keyword去创建一张hive表, 创建在默认的default库中</span><br><span class="line">第三步：把临时目录中的数据导入到hive表中</span><br></pre></td></tr></table></figure><ul><li>6.把MySQL数据库中的表数据导入到hbase</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 需要先创建Hbase里面的表</span></span><br><span class="line">sqoop import  --connect jdbc:mysql://master:3306/ --username root --password root  --table tbl_test --hbase-table tbl_hbase --column-family person --hbase-row-key tbl_hbase_key</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> sqoop </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十二）Flume</title>
      <link href="/2020/03/15/%E5%A4%A7%E6%95%B0%E6%8D%AE12/"/>
      <url>/2020/03/15/%E5%A4%A7%E6%95%B0%E6%8D%AE12/</url>
      <content type="html"><![CDATA[<p>Flume是一个分布式、可靠、高可用的海量日志聚合系统，支持在系统中定制各类数据发送方，用于收集数据；同时Flume提供对数据的简单处理，并写到各种数据接收方的能力。</p><p>本文章主要介绍 Flume 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h3><p>Hadoop业务的整体开发流程：</p><p><img src="/image/大数据12/大数据12_001.png" alt=""></p><p>　　从Hadoop的业务开发流程图中可以看出，在大数据的业务处理过程中，对于数据的采集是十分重要的一步，也是不可避免的一步.<br>　　许多公司的平台每天会产生大量的日志（一般为流式数据，如搜索引擎的pv和查询等），处理这些日志需要特定的日志系统，一般而言，这些系统需要具有以下特征：</p><ol><li>构建应用系统和分析系统的桥梁，并将它们之间的关联解耦；</li><li>支持近实时的在线分析系统和类似于Hadoop之类的离线分析系统；</li><li>具有高可扩展性。即：当数据量增加时，可以通过增加节点进行水平扩展。</li></ol><p>开源的日志系统，包括facebook的scribe，apache的chukwa，linkedin的kafka和cloudera的flume等。</p><h3 id="二、Flume的简介"><a href="#二、Flume的简介" class="headerlink" title="二、Flume的简介"></a>二、Flume的简介</h3><p>　　flume 作为 cloudera 开发的实时日志收集系统，受到了业界的认可与广泛应用。Flume 初始的发行版本目前被统称为 Flume OG（original generation），属于 cloudera。<br>　　但随着 FLume 功能的扩展，Flume OG 代码工程臃肿、核心组件设计不合理、核心配置不标准等缺点暴露出来，尤其是在 Flume OG 的最后一个发行版本 0.9.4. 中，日志传输不稳定的现象尤为严重，为了解决这些问题，2011 年 10 月 22 号，cloudera 完成了 Flume-728，对 Flume 进行了里程碑式的改动：重构核心组件、核心配置以及代码架构，重构后的版本统称为 Flume NG（next generation）；改动的另一原因是将 Flume 纳入 apache 旗下，cloudera Flume 改名为 Apache Flume。<br>　　Flume 在0.9.x and 1.x之间有较大的架构调整，1.x版本之后的改称Flume NG，0.9.x的称为Flume OG。<br>　　Flume目前只有Linux系统的启动脚本，没有Windows环境的启动脚本。　　</p><h3 id="三、Flume-NG的介绍"><a href="#三、Flume-NG的介绍" class="headerlink" title="三、Flume NG的介绍"></a>三、Flume NG的介绍</h3><h4 id="3-1-flume特点"><a href="#3-1-flume特点" class="headerlink" title="3.1 flume特点"></a>3.1 flume特点</h4><p>　　flume的数据流由事件(Event)贯穿始终。事件是Flume的基本数据单位，它携带日志数据(字节数组形式)并且携带有头信息，这些Event由Agent外部的Source生成，当Source捕获事件后会进行特定的格式化，然后Source会把事件推入(单个或多个)Channel中。你可以把Channel看作是一个缓冲区，它将保存事件直到Sink处理完该事件。Sink负责持久化日志或者把事件推向另一个Source。</p><p>　（1）flume的可靠性<br>　　当节点出现故障时，日志能够被传送到其他节点上而不会丢失。Flume提供了三种级别的可靠性保障，从强到弱依次分别为：end-to-end（收到数据agent首先将event写到磁盘上，当数据传送成功后，再删除；如果数据发送失败，可以重新发送。），Store on failure（这也是scribe采用的策略，当数据接收方crash时，将数据写到本地，待恢复后，继续发送），Besteffort（数据发送到接收方后，不会进行确认）。</p><p>　（2）flume的可恢复性<br>　　依靠Channel，推荐使用FileChannel，事件持久化在本地文件系统里(性能较差)。</p><h4 id="3-2-Flume的核心概念"><a href="#3-2-Flume的核心概念" class="headerlink" title="3.2 Flume的核心概念"></a>3.2 Flume的核心概念</h4><ul><li>Client：Client生产数据，运行在一个独立的线程。</li><li>Event： 一个数据单元，消息头和消息体组成。（Events可以是日志记录、 avro 对象等。）</li><li>Flow： Event从源点到达目的点的迁移的抽象。</li><li>Agent： 一个独立的Flume进程，包含组件Source、 Channel、 Sink。（Agent使用JVM 运行Flume。每台机器运行一个agent，但是可以在一个agent中包含多个sources和sinks。）</li><li>Source(源端数据采集)： 数据收集组件。（source从Client收集数据，传递给Channel）</li><li>Channel(临时存储聚合数据)：中转Event的一个临时存储，保存由Source组件传递过来的Event。（Channel连接 sources 和 sinks ，这个有点像一个队列。）</li><li>Sink（移动数据到目标端）： 从Channel中读取并移除Event， 将Event传递到FlowPipeline中的下一个Agent（如果有的话）（Sink从Channel收集数据，运行在一个独立线程。）</li></ul><h4 id="3-3-Flume-NG的体系结构"><a href="#3-3-Flume-NG的体系结构" class="headerlink" title="3.3 Flume NG的体系结构"></a>3.3 Flume NG的体系结构</h4><p>Flume 运行的核心是 Agent。Flume以agent为最小的独立运行单位。一个agent就是一个JVM。它是一个完整的数据收集工具，含有三个核心组件，分别是source、 channel、 sink。通过这些组件， Event 可以从一个地方流向另一个地方，如下图所示。<br>　<br><img src="/image/大数据12/大数据12_002.png" alt=""></p><h4 id="3-4-Source"><a href="#3-4-Source" class="headerlink" title="3.4 Source"></a>3.4 Source</h4><p>　　Source是数据的收集端，负责将数据捕获后进行特殊的格式化，将数据封装到事件（event） 里，然后将事件推入Channel中。<br>　　Flume提供了各种source的实现，包括Avro Source、Exce Source、Spooling Directory Source、NetCat Source、Syslog Source、Syslog TCP Source、Syslog UDP Source、HTTP Source、HDFS Source，etc。如果内置的Source无法满足需要， Flume还支持自定义Source。<br>　　<br><img src="/image/大数据12/大数据12_003.png" alt=""></p><h4 id="3-5-Channel"><a href="#3-5-Channel" class="headerlink" title="3.5 Channel"></a>3.5 Channel</h4><p>　　Channel是连接Source和Sink的组件，大家可以将它看做一个数据的缓冲区（数据队列），它可以将事件暂存到内存中也可以持久化到本地磁盘上， 直到Sink处理完该事件。<br>　　Flume对于Channel，则提供了Memory Channel、JDBC Chanel、File Channel，etc。<br>　　MemoryChannel可以实现高速的吞吐，但是无法保证数据的完整性。<br>　　MemoryRecoverChannel在官方文档的建议上已经建义使用FileChannel来替换。<br>　　FileChannel保证数据的完整性与一致性。在具体配置不现的FileChannel时，建议FileChannel设置的目录和程序日志文件保存的目录设成不同的磁盘，以便提高效率。　　</p><h4 id="3-6-Sink"><a href="#3-6-Sink" class="headerlink" title="3.6 Sink"></a>3.6 Sink</h4><p>　　Flume Sink取出Channel中的数据，进行相应的存储文件系统，数据库，或者提交到远程服务器。<br>　　Flume也提供了各种sink的实现，包括HDFS sink、Logger sink、Avro sink、File Roll sink、Null sink、HBase sink，etc。<br>　　Flume Sink在设置存储数据时，可以向文件系统中，数据库中，hadoop中储数据，在日志数据较少时，可以将数据存储在文件系中，并且设定一定的时间间隔保存数据。在日志数据较多时，可以将相应的日志数据存储到Hadoop中，便于日后进行相应的数据分析。<br>　　<br><img src="/image/大数据12/大数据12_004.png" alt=""></p><h3 id="四、Flume的部署类型"><a href="#四、Flume的部署类型" class="headerlink" title="四、Flume的部署类型"></a>四、Flume的部署类型</h3><p>单一流程：</p><p><img src="/image/大数据12/大数据12_005.png" alt=""></p><p>多代理流程（多个agent顺序连接）：</p><p><img src="/image/大数据12/大数据12_006.png" alt=""></p><p>流的合并（多个Agent的数据汇聚到同一个Agent ）：</p><p><img src="/image/大数据12/大数据12_007.png" alt=""></p><p>多路复用流（多级流）：</p><p><img src="/image/大数据12/大数据12_008.png" alt=""></p><p>load balance功能:</p><p><img src="/image/大数据12/大数据12_009.png" alt=""></p><h3 id="五、Flume的安装"><a href="#五、Flume的安装" class="headerlink" title="五、Flume的安装"></a>五、Flume的安装</h3><ul><li>0 .从<a href="http://flume.apache.org/download.html" target="_blank" rel="noopener">官网</a>下载或者使用下面的命令下载</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget http://mirrors.hust.edu.cn/apache/flume/1.8.0/apache-flume-1.8.0-bin.tar.gz</span><br></pre></td></tr></table></figure><ul><li>1.解压并重命名</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-flume-1.8.0-bin.tar.gz -C /hadoop/install/</span><br><span class="line"><span class="built_in">cd</span> /hadoop/install</span><br><span class="line">mv apache-flume-1.8.0-bin apache-flume-1.8.0</span><br></pre></td></tr></table></figure><ul><li>2.配置环境变量</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/profile</span><br></pre></td></tr></table></figure><p>添加内容:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> FLUME_HOME=/hadoop/install/apache-flume-1.8.0</span><br><span class="line"><span class="built_in">export</span> FLUME_CONF_DIR=<span class="variable">$FLUME_HOME</span>/conf</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HIVE_HOME</span>/bin:<span class="variable">$ZK_HOME</span>/bin:<span class="variable">$HBASE_HOME</span>/bin:<span class="variable">$FLUME_HOME</span>/bin</span><br></pre></td></tr></table></figure></p><ul><li><p>3.修改配置文件</p><ul><li><p>3.1.修改flume-env.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/apache-flume-1.8.0/conf</span><br><span class="line"><span class="comment"># 拷贝出模板</span></span><br><span class="line">cp flume-env.sh.template flume-env.sh</span><br><span class="line"><span class="comment"># 修改配置文件</span></span><br><span class="line">vi flume-env.sh</span><br></pre></td></tr></table></figure></li><li><p>3.2.修改flume-conf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp flume-conf.properties.template flume-conf.properties</span><br><span class="line">vi flume-conf.properties</span><br></pre></td></tr></table></figure><p>添加agent、source、channel和sink的相关信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The configuration file needs to define the sources, the channels and the sinks.</span></span><br><span class="line"><span class="comment"># Sources, channels and sinks are defined per agent, in this case called 'a1'</span></span><br><span class="line">a1.sources=r1</span><br><span class="line">a1.channels=c1</span><br><span class="line">a1.sinks=k1</span><br><span class="line"> </span><br><span class="line"><span class="comment">#Describe/configure the source</span></span><br><span class="line">a1.sources.r1.type=netcat</span><br><span class="line">a1.sources.r1.bind=192.168.52.110</span><br><span class="line">a1.sources.r1.port=44444</span><br><span class="line">a1.sources.r1.channels=c1</span><br><span class="line"></span><br><span class="line"><span class="comment">#Describe the sink</span></span><br><span class="line">a1.sinks.k1.type=logger</span><br><span class="line">a1.sinks.k1.channel=c1</span><br><span class="line"> </span><br><span class="line"><span class="comment">#Describe the channel</span></span><br><span class="line">a1.channels.c1.type=memory</span><br><span class="line">a1.channels.c1.capacity=1000</span><br><span class="line">a1.channels.c1.transcationCapacity=100</span><br></pre></td></tr></table></figure></li></ul></li></ul><pre><code>配置文件说明：| 配置项名称                 | 作用                                                         | 举例                                                      || ---------------- | ------------------------ | ------------------ || agent1                     | flume节点名称，启动时通过参数命令-name指定                   |                                                           || agent1.sources             | 监听的源,可以有多个，空格隔开即可，用于收集数据并发送到channel | agent1.sources=s1 s2                                      || agent1.channels            | 临时通道，可以有多个，空格隔开，存放source收集的数据，sink从这里读取数据 | agent1.channels=c1                                        || agent1.sinks               | 接收器，可以有多个，空格隔开，从channel读取数据，并发送给目标 （比如kafka 或者hdfs或者另一个flume） | agent1.sinks=k1                                           || agent.sources.s1.type      | 源的类型，s1是源名称，可以是目录、日志文件、或者监听端口等。 常用的source的类型包括avro、exec、netcat、spooldir和syslog等. 具体请参考官网[http://flume.apache.org/Flume...](http://flume.apache.org/FlumeUserGuide.html#flume-sources) | agent.sources.s1.type=spooldir agent.sources.s2.type=avro || agent1.sources.s1.channels | 监听数据要写入的channel名称                                  | agent1.sources.s1.channels=c1                             || agent1.channels.c1.type    | 通道的类型，c1为通道名称，此处memory表示为常用的memory-channel， 同时也有其他类型的channel，如JDBC、file-channel、custom-channel等， 具体请参考官网[http://flume.apache.org/Flume...](http://flume.apache.org/FlumeUserGuide.html#flume-channels) | agent1.channels.c1.type=memory                            || agent1.sinks.k1.type       | 接收器类型，k1为接收器名称，此处logger表示直接写入日志， 常用的包括avro、logger、HDFS、Hbase以及file-roll等， 具体参考官网[http://flume.apache.org/Flume...](http://flume.apache.org/FlumeUserGuide.html#flume-sinks) | agent1.sinks.k1.type=logger                               |</code></pre><ul><li><p>4.启动</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/flume-ng agent --conf &lt;conf路径&gt; --conf-file &lt;flume-conf.properties路径&gt; --name &lt;agent名称&gt; -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><p>启动命令参数说明：</p></li></ul><table><thead><tr><th>参数</th><th>作用</th><th>举例</th></tr></thead><tbody><tr><td>–conf 或 -c</td><td>指定配置文件夹，包含flume-env.sh和log4j的配置文件</td><td>–conf conf</td></tr><tr><td>–conf-file 或 -f</td><td>配置文件地址</td><td>–conf-file conf/flume.conf</td></tr><tr><td>–name 或 -n</td><td>agent(flume节点)名称</td><td>–name agent1</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/apache-flume-1.8.0</span><br><span class="line"><span class="comment"># 启动命令:</span></span><br><span class="line">./bin/flume-ng agent --conf ./conf --conf-file ./conf/flume-conf.properties --name a1 -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><ul><li>5.测试是否运行成功：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.52.110 44444</span><br></pre></td></tr></table></figure><h3 id="六、测试收集日志到HDFS"><a href="#六、测试收集日志到HDFS" class="headerlink" title="六、测试收集日志到HDFS"></a>六、测试收集日志到HDFS</h3><ul><li>1.新建配置2</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/apache-flume-1.8.0/conf</span><br><span class="line">cp flume-conf.properties.template flume-conf2.properties</span><br><span class="line">vi flume-conf2.properties</span><br></pre></td></tr></table></figure><ul><li><p>2.配置2内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line">a1.sources.r1.type = exec</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sources.r1.command = tail -F /hadoop/install/hadoop/logs/hadoop-namenode-b393a04554e1.log</span><br><span class="line">a1.sinks.k1.type = hdfs</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k1.hdfs.path = hdfs://master:54310/class12/out_flume</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = events-</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 10</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = minute</span><br><span class="line">a1.sinks.k1.hdfs.rollSize = 4000000</span><br><span class="line">a1.sinks.k1.hdfs.rollCount = 0</span><br><span class="line">a1.sinks.k1.hdfs.writeFormat = Text</span><br><span class="line">a1.sinks.k1.hdfs.fileType = DataStream</span><br><span class="line">a1.sinks.k1.hdfs.batchSize = 10</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br></pre></td></tr></table></figure></li><li><p>3.使用配置2启动</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/apache-flume-1.8.0</span><br><span class="line"></span><br><span class="line">./bin/flume-ng agent --conf ./conf/ --conf-file ./conf/flume-conf2.properties --name a1 -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> flume </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十一）Hbase</title>
      <link href="/2020/02/15/%E5%A4%A7%E6%95%B0%E6%8D%AE11/"/>
      <url>/2020/02/15/%E5%A4%A7%E6%95%B0%E6%8D%AE11/</url>
      <content type="html"><![CDATA[<p>Hbase 是一个分布式的、面向列的开源数据库，该技术来源于 Fay Chang 所撰写的Google论文“Bigtable：一个结构化数据的分布式存储系统”。</p><p>就像Bigtable利用了Google文件系统（File System）所提供的分布式数据存储一样，HBase在Hadoop之上提供了类似于Bigtable的能力。</p><p>HBase是Apache的Hadoop项目的子项目。<br>HBase不同于一般的关系数据库，它是一个适合于非结构化数据存储的数据库。<br>另一个不同的是HBase基于列的而不是基于行的模式。</p><p>本文章主要介绍 Hbase 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Hbase架构"><a href="#Hbase架构" class="headerlink" title="Hbase架构"></a>Hbase架构</h3><p><img src="/image/大数据11/大数据11_001.png" alt=""></p><ul><li>Zookeeper，作为分布式的协调。RegionServer也会把自己的信息写到ZooKeeper中。</li><li>HDFS是Hbase运行的底层文件系统</li><li>RegionServer，理解为数据节点，存储数据的。</li><li>Master RegionServer要实时的向Master报告信息。Master知道全局的RegionServer运行情况，可以控制RegionServer的故障转移和Region的切分。</li></ul><h3 id="Hbase数据模型"><a href="#Hbase数据模型" class="headerlink" title="Hbase数据模型"></a>Hbase数据模型</h3><p>HBase 是一个稀疏的、分布式、持久、多维、排序的映射，它以行键（row key），列键（column key）和时间戳（timestamp）为索引。有以下特点：</p><ul><li>Table：Hbase的table由多个行组成</li><li>Row：一个行在Hbase中由一个或多个有值的列组成。Row按照字母进行排序，因此行健的设计非常重要。这种设计方式可以让有关系的行非常的近，通常行健的设计是网站的域名反转，比如(org.apache.www, org.apache.mail, org.apache.jira)，这样的话所有的Apache的域名就很接近。</li><li>Column：列由列簇加上列的标识组成，一般是“列簇：列标识”，创建表的时候不用指定列标识</li><li>Column Family：列簇在物理上包含了许多的列与列的值，每个列簇都有一些存储的属性可配置。例如是否使用缓存，压缩类型，存储版本数等。在表中，每一行都有相同的列簇，尽管有些列簇什么东西也没有存。</li><li>Column Qualifier：列簇的限定词，理解为列的唯一标识。但是列标识是可以改变的，因此每一行可能有不同的列标识</li><li>Cell：Cell是由row，column family,column qualifier包含时间戳与值组成的，一般表达某个值的版本</li><li>Timestamp：时间戳一般写在value的旁边，代表某个值的版本号，默认的时间戳是你写入数据的那一刻，但是你也可以在写入数据的时候指定不同的时间戳</li></ul><h3 id="Hbase与关系型数据库对比"><a href="#Hbase与关系型数据库对比" class="headerlink" title="Hbase与关系型数据库对比"></a>Hbase与关系型数据库对比</h3><table><thead><tr><th>属性</th><th>Hbase</th><th>RDBMS</th></tr></thead><tbody><tr><td>数据类型</td><td>只有字符串</td><td>丰富的数据类型</td></tr><tr><td>数据操作</td><td>增删改查，不支持join</td><td>各种各样的函数与表连接</td></tr><tr><td>存储模式</td><td>基于列式存储</td><td>基于表结构和行式存储</td></tr><tr><td>数据保护</td><td>更新后仍然保留旧版本</td><td>替换</td></tr><tr><td>可伸缩性</td><td>轻易增加节点</td><td>需要中间层，牺牲性能</td></tr></tbody></table><h3 id="Hbase安装部署"><a href="#Hbase安装部署" class="headerlink" title="Hbase安装部署"></a>Hbase安装部署</h3><ul><li><p>0.前置条件</p><ul><li>java</li><li>hadoop</li><li>zookeeper</li></ul></li><li><p>1.下载安装包</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget http://mirror.bit.edu.cn/apache/hbase/2.0.5/hbase-2.0.5-bin.tar.gz</span><br></pre></td></tr></table></figure><ul><li>2.解压</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf hbase-2.0.5-bin.tar.gz  -C /hadoop/install</span><br></pre></td></tr></table></figure><ul><li>3.把hadoop的hdfs-site.xml和core-site.xml 放到hbase/conf下</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/hadoop/etc/hadoop</span><br><span class="line">cp hdfs-site.xml /hadoop/install/hbase-2.0.5/conf/</span><br><span class="line">cp core-site.xml /hadoop/install/hbase-2.0.5/conf/</span><br></pre></td></tr></table></figure><ul><li><p>4.修改hbase配置文件</p><ul><li><p>1.修改hbase-env.sh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/hbase-2.0.5/conf/</span><br><span class="line">vi hbase-env.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置内容</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/hadoop/install/jdk1.8.0_141</span><br><span class="line"> <span class="built_in">export</span> HBASE_MANAGES_ZK=<span class="literal">false</span></span><br><span class="line"> <span class="built_in">export</span> HBASE_HEAPSIZE=8G</span><br></pre></td></tr></table></figure></li><li><p>2.修改hbase-site.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 指定hbase在HDFS上存储的路径 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.rootdir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000/hbase<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 指定hbase是分布式的 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.cluster.distributed<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 指定zk的地址，多个用“,”分割 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>master,node1,node2,node3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- zookerper日志 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.zookeeper.property.dataDir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>/hadoop/install/hadoop/zookeeper-3.4.12<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- todo --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.master.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>16000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- hbase master web界面绑定端口 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.master.info.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>16010<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- regionserver 信息 web界面接口 --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>hbase.regionserver.info.port<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">value</span>&gt;</span>16030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>3.修改regionservers文件，从节点的主机名 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">master</span><br><span class="line">node01</span><br><span class="line">node02</span><br><span class="line">node03</span><br></pre></td></tr></table></figure></li></ul></li><li><p>5.将配置好的HBase拷贝到cd 其他机器里</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install</span><br><span class="line">scp -r hbase-2.0.5 node01:/hadoop/install/</span><br><span class="line">scp -r hbase-2.0.5 node02:/hadoop/install/</span><br><span class="line">scp -r hbase-2.0.5 node03:/hadoop/install/</span><br></pre></td></tr></table></figure><ul><li>6.配置环境变量</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /home/hadoop/.bashrc</span><br><span class="line">vi .bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将下面两行添加到末尾</span></span><br><span class="line"><span class="built_in">export</span> HBASE_HOME=/hadoop/install/hbase-2.0.5</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$HBASE_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使环境变量生效</span></span><br><span class="line">. .bashrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制.bashrc文件给其他节点</span></span><br><span class="line">scp -r .bashrc node01:/home/hadoop/</span><br><span class="line">scp -r .bashrc node02:/home/hadoop/</span><br><span class="line">scp -r .bashrc node03:/home/hadoop/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他节点环境变量生效</span></span><br><span class="line">. .bashrc</span><br></pre></td></tr></table></figure><ul><li>7.master启动hbase</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-hbase.sh</span><br></pre></td></tr></table></figure><ul><li>8.使用jps查看:都有HRegionServer,master多个HMaster</li></ul><ul><li>9.通过网页查看启动是否正常:打开浏览器，访问<a href="http://192.168.52.100:16010/，检查hbase是否正常" target="_blank" rel="noopener">http://192.168.52.100:16010/，检查hbase是否正常</a></li></ul><h3 id="Hbase基本命令"><a href="#Hbase基本命令" class="headerlink" title="Hbase基本命令"></a>Hbase基本命令</h3><table><thead><tr><th>hbase shell命令</th><th>描述</th></tr></thead><tbody><tr><td>alter</td><td>修改列族（column family）模式</td></tr><tr><td>count</td><td>统计表中行的数量</td></tr><tr><td>create</td><td>创建表</td></tr><tr><td>describe</td><td>显示表相关的详细信息</td></tr><tr><td>delete</td><td>删除指定对象的值（可以为表，行，列对应的值，另外也可以指定时间戳的值）</td></tr><tr><td>deleteall</td><td>删除指定行的所有元素值</td></tr><tr><td>disable</td><td>使表无效</td></tr><tr><td>drop</td><td>删除表</td></tr><tr><td>enable</td><td>使表有效</td></tr><tr><td>exists</td><td>测试表是否存在</td></tr><tr><td>exit</td><td>退出hbase shell</td></tr><tr><td>get</td><td>获取行或单元（cell）的值</td></tr><tr><td>incr</td><td>增加指定表，行或列的值</td></tr><tr><td>list</td><td>列出hbase中存在的所有表</td></tr><tr><td>put</td><td>向指向的表单元添加值</td></tr><tr><td>tools</td><td>列出hbase所支持的工具</td></tr><tr><td>scan</td><td>通过对表的扫描来获取对用的值</td></tr><tr><td>status</td><td>返回hbase集群的状态信息</td></tr><tr><td>shutdown</td><td>关闭hbase集群（与exit不同）</td></tr><tr><td>truncate</td><td>重新创建指定表</td></tr><tr><td>version</td><td>返回hbase版本信息</td></tr></tbody></table><h4 id="1-进入hbase"><a href="#1-进入hbase" class="headerlink" title="1. 进入hbase"></a>1. 进入hbase</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./hbase shell</span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>进入到hbase目录并进入hbase</li></ol></li></ul><h4 id="2-浏览所有表"><a href="#2-浏览所有表" class="headerlink" title="2. 浏览所有表"></a>2. 浏览所有表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list</span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>查看表列表</li></ol></li></ul><h4 id="3-查看表结构"><a href="#3-查看表结构" class="headerlink" title="3. 查看表结构"></a>3. 查看表结构</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">describe <span class="string">'BizvaneV2.VipSearch'</span></span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>describe 动作命令，BizvaneV2.VipSearch 为要查看表结构的表名</li></ol></li></ul><h4 id="4-创建表"><a href="#4-创建表" class="headerlink" title="4. 创建表"></a>4. 创建表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create <span class="string">'UserInfo'</span>, &#123; NAME =&gt; <span class="string">'info'</span>, REPLICATION_SCOPE =&gt; <span class="string">'1'</span> &#125;</span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>create 动作命令，UserInfo 为要创建的表名</li><li>NAME 列族名，info 为列族名称</li><li>REPLICATION_SCOPE 是否复制，0为不复制，1为复制</li></ol></li></ul><h4 id="5-修改表结构"><a href="#5-修改表结构" class="headerlink" title="5. 修改表结构"></a>5. 修改表结构</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">disable</span> <span class="string">'UserInfo'</span></span><br><span class="line">alter <span class="string">'UserInfo'</span>, &#123;NAME =&gt; <span class="string">'extendInfo'</span>, REPLICATION_SCOPE =&gt; <span class="string">'1'</span>&#125;</span><br><span class="line">describe <span class="string">'UserInfo'</span></span><br></pre></td></tr></table></figure><ul><li><p>参数说明</p><ul><li>修改表结构要使表不启用状态</li></ul><ol><li>disable 动作命令,使要修改结构的表无效，UserInfo 为表名</li><li>修改命令<ol><li>alter 动作命令</li><li>UserInfo 要修改的表名称</li><li>{NAME =&gt; ‘extendInfo’, REPLICATION_SCOPE =&gt; ‘1’} 要修改的结构体</li></ol></li><li>describe 动作命令，查看表结构描述，验证是否修改成功</li></ol></li></ul><h4 id="6-添加数据"><a href="#6-添加数据" class="headerlink" title="6. 添加数据"></a>6. 添加数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">put <span class="string">'UserInfo'</span>,<span class="string">'row_1'</span>,<span class="string">'info:firstname'</span>,<span class="string">'liu'</span></span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>添加命令<ol><li>put 动作命令，</li><li>UserInfo 要添加数据的表名称</li><li>row_1 数据行</li><li>info:firstname 列及列名字</li><li>liu 要添加的值</li></ol></li></ol></li></ul><h4 id="7-查看数据"><a href="#7-查看数据" class="headerlink" title="7. 查看数据"></a>7. 查看数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan <span class="string">'UserInfo'</span></span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>scan 动作命令<ol><li>要查看表的名称</li></ol></li></ol></li></ul><h4 id="8-修改数据"><a href="#8-修改数据" class="headerlink" title="8. 修改数据"></a>8. 修改数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">put <span class="string">'UserInfo'</span>,<span class="string">'row_1'</span>,<span class="string">'info:firstname'</span>,<span class="string">'liu_copy'</span></span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>添加命令<ol><li>put 动作命令，</li><li>UserInfo 要修改数据的表名称</li><li>row_1 数据行</li><li>info:firstname 列及列名字</li><li>liu 新数据值</li></ol></li></ol></li></ul><h4 id="9-删除数据"><a href="#9-删除数据" class="headerlink" title="9. 删除数据"></a>9. 删除数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete <span class="string">'UserInfo'</span>,<span class="string">'row_1'</span>,<span class="string">'info:firstname'</span>参数说明</span><br></pre></td></tr></table></figure><ul><li><ol><li>删除命令<ol><li>delete 动作命令，</li><li>UserInfo 要修改数据的表名称</li><li>row_1 数据行</li><li>info:firstname 列及列名字</li></ol></li></ol></li></ul><h4 id="10-删除表"><a href="#10-删除表" class="headerlink" title="10. 删除表"></a>10. 删除表</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">disable</span> <span class="string">'UserInfo'</span></span><br><span class="line">drop <span class="string">'UserInfo'</span></span><br></pre></td></tr></table></figure><ul><li><p>参数说明</p><ul><li>修改表结构要使表不启用状态</li></ul><ol><li>删除命令<ol><li>disable 使表不启用，UserInfo 要不启用的表名称</li><li>drop 删除命令 UserInfo 要删除的表名称</li></ol></li></ol></li></ul><h4 id="11-帮助"><a href="#11-帮助" class="headerlink" title="11. 帮助"></a>11. 帮助</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span></span><br></pre></td></tr></table></figure><ul><li>参数说明<ol><li>help 帮助命令，可以查看Hbase提供的命令清单</li></ol></li></ul><p>More info: <a href="https://www.jianshu.com/p/b23800d9b227" target="_blank" rel="noopener">Hbase</a></p>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> hbase </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（十）impala</title>
      <link href="/2020/01/15/%E5%A4%A7%E6%95%B0%E6%8D%AE10/"/>
      <url>/2020/01/15/%E5%A4%A7%E6%95%B0%E6%8D%AE10/</url>
      <content type="html"><![CDATA[<p>Impala 是cloudera提供的一款高效率的sql查询工具，提供实时的查询效果，官方测试性能比hive快10到100倍，其sql查询比sparkSQL还要更加快速，号称是当前大数据领域最快的查询sql工具，impala是参照谷歌的新三篇论文（Caffeine、Pregel、Dremel）当中的Dremel实现而来，其中旧三篇论文分别是（BigTable，GFS，MapReduce）分别对应HBase和HDFS以及MapReduce。</p><p>本文章主要介绍 Impala 和 在centos环境下如何安装 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="impala与hive的关系"><a href="#impala与hive的关系" class="headerlink" title="impala与hive的关系"></a>impala与hive的关系</h3><p>Impala 是基于 hive 的大数据分析查询引擎，直接使用hive的元数据库metadata，意味着impala元数据都存储在hive的metastore当中，并且impala兼容hive的绝大多数sql语法。所以需要安装impala的话，必须先安装hive，保证hive安装成功，并且还需要启动hive的metastore服务。</p><h3 id="impala的优点"><a href="#impala的优点" class="headerlink" title="impala的优点"></a>impala的优点</h3><ul><li>1.impala比较快，非常快，特别快，因为所有的计算都可以放入内存当中进行完成，只要你内存足够大</li><li>2.摈弃了MR的计算，改用C++来实现，有针对性的硬件优化</li><li>3.具有数据仓库的特性，对hive的原有数据做数据分析</li><li>4.支持ODBC，jdbc远程访问</li></ul><h3 id="impala的缺点"><a href="#impala的缺点" class="headerlink" title="impala的缺点"></a>impala的缺点</h3><ul><li>1.基于内存计算，对内存依赖性较大</li><li>2.改用C++编写，意味着维护难度增大</li><li>3.基于hive，与hive共存亡，紧耦合</li><li>4.稳定性不如hive，不存在数据丢失的情况</li></ul><h3 id="impala的架构"><a href="#impala的架构" class="headerlink" title="impala的架构"></a>impala的架构</h3><p><img src="/image/大数据10/大数据10_001.png" alt=""></p><ul><li><p>Impala的架构模块：</p><ul><li>impala-server ==&gt;启动的守护进程，执行我们的查询计划 从节点，官方建议与所有的datanode装在一起，可以通过hadoop的短路读取特性实现数据的快速查询</li><li>impala-statestore ==》 状态存储区 主节点</li><li>impalas-catalog ==》元数据管理区 主节点</li></ul></li><li><p>frontend生成查询计划分为两个阶段：</p><ul><li>1.生成单机查询计划，单机执行计划与关系数据库执行计划相同，所用查询优化方法也类似。</li><li>2.生成分布式查询计划。 根据单机执行计划， 生成真正可执行的分布式执行计划，降低数据移动， 尽量把数据和计算放在一起。</li></ul></li><li><p>例如：SQL查询， 该SQL的目标是在三表join的基础上算聚集， 并按照聚集列排序取topN。</p></li></ul><p><img src="/image/大数据10/大数据10_002.png" alt=""></p><h3 id="impala的安装"><a href="#impala的安装" class="headerlink" title="impala的安装"></a>impala的安装</h3><ul><li>0.安装规划</li></ul><table><thead><tr><th>服务名称</th><th>master</th><th>node01</th><th>node02</th><th>node03</th></tr></thead><tbody><tr><td>impala-catalog</td><td>安装</td><td>不安装</td><td>不安装</td><td>不安装</td></tr><tr><td>impala-state-store</td><td>安装</td><td>不安装</td><td>不安装</td><td>不安装</td></tr><tr><td>impala-server</td><td>安装</td><td>安装</td><td>安装</td><td>安装</td></tr></tbody></table><ul><li>1.前置<ul><li>已经安装hadoop</li><li>已经安装hive</li></ul></li></ul><ul><li>2.可以在<a href="http://archive.cloudera.com/cdh5/redhat/7/x86_64/cdh/5.8.3/RPMS/x86_64/" target="_blank" rel="noopener">页面</a>下载以下RPM包。由于包太多，推荐使用在线yum安装。</li><li>3.master执行以下命令进行安装 </li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install impala -y</span><br><span class="line">yum install impala-server -y</span><br><span class="line">yum install impala-state-store  -y</span><br><span class="line">yum install impala-catalog  -y</span><br><span class="line">yum install impala-shell -y</span><br></pre></td></tr></table></figure><ul><li>4.其他节点安装以下服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install impala-server -y</span><br></pre></td></tr></table></figure><ul><li>5.所有节点配置hive-site.xml</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /hadoop/install/apache-hive-3.1.2/conf/hive-site.xml</span><br></pre></td></tr></table></figure><p>修改内容为：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml-stylesheet type=<span class="string">"text/xsl"</span> href=<span class="string">"configuration.xsl"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.current.db<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.header<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.server2.thrift.bind.host<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>master<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>thrift://master:9083<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.client.socket.timeout<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>3600<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>5.master机器启动hive的metastore服务</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /hadoop/install/apache-hive-3.1.2</span><br><span class="line">nohup bin/hive --service metastore &amp;</span><br><span class="line">nohup bin/hive -- service hiveserver2 &amp;</span><br></pre></td></tr></table></figure><ul><li><p>6.在master机器使用jps查看，有两个 RunJar 表示启动成功</p></li><li><p>7.所有hadoop节点修改hdfs-site.xml添加以下内容</p><ul><li><p>1.所有节点创建文件夹，并给予权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/run/hdfs-sockets</span><br><span class="line">chown  -R  hadoop:hadoop   /var/run/hdfs-sockets/</span><br></pre></td></tr></table></figure></li></ul></li></ul><pre><code>- 2.修改所有节点的hdfs-site.xml添加以下配置，修改完之后重启hdfs集群生效<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim  /hadoop/install/hadoop/etc/hadoop/hdfs-site.xml</span><br></pre></td></tr></table></figure>添加到文件末尾：<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.read.shortcircuit<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.domain.socket.path<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/var/run/hdfs-sockets/dn<span class="tag">&lt;/<span class="name">value</span>&gt;</span>     <span class="comment">&lt;!--/var/run/hdfs-socket为目录，dn为文件--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.file-block-storage-locations.timeout.millis<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.hdfs-blocks-metadata.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></code></pre><ul><li>8.重启hdfs</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/hadoop/</span><br><span class="line">sbin/stop-dfs.sh</span><br><span class="line">sbin/start-dfs.sh</span><br></pre></td></tr></table></figure><ul><li>9.创建hadoop与hive的配置文件的连接</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有节点 执行以下命令创建链接到impala配置目录下来</span></span><br><span class="line">ln -s /hadoop/install/hadoop/etc/hadoop/core-site.xml /etc/impala/conf/core-site.xml</span><br><span class="line">ln -s /hadoop/install/hadoop/etc/hadoop/hdfs-site.xml /etc/impala/conf/hdfs-site.xml</span><br><span class="line">ln -s /hadoop/install/apache-hive-3.1.2/conf/hive-site.xml /etc/impala/conf/hive-site.xml</span><br></pre></td></tr></table></figure><ul><li>10.修改impala的配置文件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有节点更改impala默认配置文件以及添加mysql的连接驱动包</span></span><br><span class="line">vim /etc/default/impala</span><br><span class="line">IMPALA_CATALOG_SERVICE_HOST=master</span><br><span class="line">IMPALA_STATE_STORE_HOST=master</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有节点创建mysql的驱动包的软连接</span></span><br><span class="line">ln -s /hadoop/install/apache-hive-3.1.2/lib/mysql-connector-java-5.1.38.jar</span><br><span class="line">/usr/share/java/mysql-connector-java.jar</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有节点修改bigtop的java_home路径</span></span><br><span class="line">vim /etc/default/bigtop-utils</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/hadoop/install/jdk1.8.0_141</span><br></pre></td></tr></table></figure><ul><li>11.master节点启动impala服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">service impala-state-store start</span><br><span class="line">service impala-catalog start</span><br><span class="line">service impala-server start</span><br></pre></td></tr></table></figure><ul><li>12.其他节点启动impala-server</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service  impala-server  start</span><br></pre></td></tr></table></figure><ul><li>13.查看impala进程是否存在</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep impala</span><br></pre></td></tr></table></figure><ul><li>14.浏览器页面访问</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">访问impalad的管理界面: http://master:25000/</span><br><span class="line">访问statestored的管理界面: http://master:25010/</span><br><span class="line">访问catalog的管理界面: http://master:25020</span><br></pre></td></tr></table></figure><p><strong>注意：启动之后所有关于impala的日志默认都在/var/log/impala 这个路径下</strong></p><p>More info: <a href="https://www.cnblogs.com/-xiaoyu-/p/11186670.html" target="_blank" rel="noopener">Impala</a></p>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> impala </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（九）ZooKeeper</title>
      <link href="/2019/12/15/%E5%A4%A7%E6%95%B0%E6%8D%AE09/"/>
      <url>/2019/12/15/%E5%A4%A7%E6%95%B0%E6%8D%AE09/</url>
      <content type="html"><![CDATA[<p>ZooKeeper 是一个分布式的、开放源码的分布式应用程序协调服务，是Hadoop和Hbase的重要组件。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等。</p><p>本文章主要介绍在centos环境下如何安装 ZooKeeper。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>zookeeper=文件系统+监听通知机制</p><ul><li>1.文件系统<br><img src="/image/大数据09/大数据09_001.png" alt=""></li></ul><p>每个子目录项如 NameService 都被称作为 znode(目录节点)，和文件系统一样，我们能够自由的增加、删除znode或者在一个znode下增加和删除子znode，唯一的不同在于znode是可以存储数据的。</p><ul><li>2.监听通知机制</li></ul><p>客户端注册监听它关心的目录节点，当目录节点发生变化（数据改变、被删除、子目录节点增加删除）时，zookeeper会通知客户端。</p><p>假设我们的程序是分布式部署在多台机器上，如果我们要改变程序的配置文件，需要逐台机器去修改，非常麻烦，现在把这些配置全部放到zookeeper上去，保存在 zookeeper 的某个目录节点中，然后所有相关应用程序对这个目录节点进行监听，一旦配置信息发生变化，每个应用程序就会收到 zookeeper 的通知，然后从 zookeeper 获取新的配置信息应用到系统中。<br><img src="/image/大数据09/大数据09_002.png" alt=""></p><h3 id="单机安装"><a href="#单机安装" class="headerlink" title="单机安装"></a>单机安装</h3><ul><li>1.配置JAVA环境，检验环境：java -version</li><li>2.下载并解压zookeeper</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget http://mirror.bit.edu.cn/apache/zookeeper/stable/zookeeper-3.4.12.tar.gz</span><br><span class="line">tar -zxvf zookeeper-3.4.12.tar.gz -C /usr/install</span><br></pre></td></tr></table></figure><ul><li>3.重命名配置文件zoo_sample.cfg</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/zookeeper-3.4.12</span><br><span class="line">cp conf/zoo_sample.cfg conf/zoo.cfg</span><br></pre></td></tr></table></figure><ul><li>4.启动zookeeper</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkServer.sh start</span><br></pre></td></tr></table></figure><ul><li>5.测是否成功启动，用zookeeper客户端连接下服务端</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/zkCli.sh</span><br></pre></td></tr></table></figure><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><ul><li>1.基本命令</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动ZK服务:       </span></span><br><span class="line">sh bin/zkServer.sh start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看ZK服务状态: </span></span><br><span class="line">sh bin/zkServer.sh status</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止ZK服务:       </span></span><br><span class="line">sh bin/zkServer.sh stop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启ZK服务:       </span></span><br><span class="line">sh bin/zkServer.sh restart</span><br></pre></td></tr></table></figure><ul><li>2.使用客户端命令操作zookeeper</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前 ZooKeeper 中所包含的内容</span></span><br><span class="line">ls</span><br><span class="line"><span class="comment"># 创建一个新的 znode</span></span><br><span class="line">create /zkPro myData</span><br><span class="line"><span class="comment"># 获取节点数据和更新信息</span></span><br><span class="line">get /zkPro</span><br><span class="line"><span class="comment"># 对 zk 所关联的字符串进行设置</span></span><br><span class="line"><span class="built_in">set</span> /zkPro myData123</span><br><span class="line"><span class="comment"># 将刚才创建的 znode 删除</span></span><br><span class="line">delete /zkPro</span><br></pre></td></tr></table></figure><h3 id="集群模式安装"><a href="#集群模式安装" class="headerlink" title="集群模式安装"></a>集群模式安装</h3><ul><li>1.配置JAVA环境，检验环境：java -version</li><li>2.下载并解压zookeeper</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/software</span><br><span class="line">wget http://mirror.bit.edu.cn/apache/zookeeper/stable/zookeeper-3.4.12.tar.gz</span><br><span class="line">tar -zxvf zookeeper-3.4.12.tar.gz -C /usr/install</span><br></pre></td></tr></table></figure><ul><li>3.重命名配置文件zoo_sample.cfg,并创建目录 zkdatas</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/zookeeper-3.4.12</span><br><span class="line">cp conf/zoo_sample.cfg conf/zoo.cfg</span><br><span class="line">mkdir zkdatas</span><br></pre></td></tr></table></figure><ul><li>4.修改配置文件zoo.cfg，原配置文件里有的，修改成下面的值，没有的则加上</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vim conf/zoo.cfg</span><br><span class="line">dataDir=/hadoop/install/zookeeper-3.4.12/zkdatas</span><br><span class="line">clientPort=2181</span><br><span class="line">server.1=master:2887:3887</span><br><span class="line">server.2=node1:2888:3888</span><br><span class="line">server.3=node2:2889:3889</span><br><span class="line">server.4=node3:2890:3890</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">配置说明</span><br><span class="line"></span><br><span class="line">tickTime：这个时间是作为 Zookeeper 服务器之间或客户端与服务器之间维持心跳的时间间隔，也就是每个 tickTime 时间就会发送一个心跳。</span><br><span class="line">initLimit：这个配置项是用来配置 Zookeeper 接受客户端（这里所说的客户端不是用户连接 Zookeeper 服务器的客户端，而是 Zookeeper 服务器集群中连接到 Leader 的 Follower 服务器）初始化连接时最长能忍受多少个心跳时间间隔数。当已经超过 10个心跳的时间（也就是 tickTime）长度后 Zookeeper 服务器还没有收到客户端的返回信息，那么表明这个客户端连接失败。总的时间长度就是 10*2000=20 秒</span><br><span class="line">syncLimit：这个配置项标识 Leader 与 Follower 之间发送消息，请求和应答时间长度，最长不能超过多少个 tickTime 的时间长度，总的时间长度就是 5*2000=10秒</span><br><span class="line">dataDir：顾名思义就是 Zookeeper 保存数据的目录，默认情况下，Zookeeper 将写数据的日志文件也保存在这个目录里。</span><br><span class="line">clientPort：这个端口就是客户端连接 Zookeeper 服务器的端口，Zookeeper 会监听这个端口，接受客户端的访问请求。</span><br><span class="line">server.A=B：C：D：其中 A 是一个数字，表示这个是第几号服务器；B 是这个服务器的 ip 地址；C 表示的是这个服务器与集群中的 Leader 服务器交换信息的端口；D 表示的是万一集群中的 Leader 服务器挂了，需要一个端口来重新进行选举，选出一个新的 Leader，而这个端口就是用来执行选举时服务器相互通信的端口。如果是伪集群的配置方式，由于 B 都是一样，所以不同的 Zookeeper 实例通信端口号不能一样，所以要给它们分配不同的端口号。</span><br></pre></td></tr></table></figure><ul><li>5.标识Server ID:在目录中创建文件myid 文件，写入当前实例的server id，即1</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/zookeeper-3.4.12/zkdatas</span><br><span class="line">vim myid</span><br><span class="line">1</span><br></pre></td></tr></table></figure><ul><li>6.复制安装目录到其他节点</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp /hadoop/install/zookeeper-3.4.12 node01:<span class="variable">$PWD</span></span><br><span class="line">scp /hadoop/install/zookeeper-3.4.12 node02:<span class="variable">$PWD</span></span><br><span class="line">scp /hadoop/install/zookeeper-3.4.12 node03:<span class="variable">$PWD</span></span><br></pre></td></tr></table></figure><ul><li>7.修改其他节点的server id为其他数字</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 节点1</span></span><br><span class="line">vim myid</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 节点2</span></span><br><span class="line">vim myid</span><br><span class="line">3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 节点3</span></span><br><span class="line">vim myid</span><br><span class="line">4</span><br></pre></td></tr></table></figure><ul><li>8.检测集群状态，也可以直接用命令“zkCli.sh -server IP:PORT”连接zookeeper服务端检测</li></ul>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> zookeeper </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（八）hive的开窗函数</title>
      <link href="/2019/11/15/%E5%A4%A7%E6%95%B0%E6%8D%AE08/"/>
      <url>/2019/11/15/%E5%A4%A7%E6%95%B0%E6%8D%AE08/</url>
      <content type="html"><![CDATA[<p>我们使用 hive或者 mysql时，一般聚合函数用的比较多。但对于某些偏分析的需求，group by可能很费力，这个时候就需要使用窗口分析函数。</p><p>本文章主要介绍hive的开窗函数和自定义函数。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>分析函数用于计算基于组的某种聚合值，它和单纯聚合函数的不同之处是：对于每个组返回多行，而聚合函数对于每个组只返回一行。</p><p>开窗函数指定了分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变化而变化。</p><ul><li><p>1.基础结构</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">分析函数（如:sum(),max(),row_number()...） + 窗口子句（over函数）</span><br></pre></td></tr></table></figure></li><li><p>2.over函数写法</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 先根据cookieid字段分区，相同的cookieid分为一区，每个分区内根据createtime字段排序（默认升序）</span><br><span class="line">over（partition by cookieid order by createtime）</span><br></pre></td></tr></table></figure><h3 id="基础函数"><a href="#基础函数" class="headerlink" title="基础函数"></a>基础函数</h3><p>基础函数：SUM、AVG、MIN、MAX 用于实现分组内所有和连续累积的统计。</p><ul><li>1.测试数据</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE EXTERNAL TABLE lxw1234 (</span><br><span class="line">cookieid string,</span><br><span class="line">createtime string,   --day </span><br><span class="line">pv INT</span><br><span class="line">) ROW FORMAT DELIMITED </span><br><span class="line">FIELDS TERMINATED BY &apos;,&apos; </span><br><span class="line">stored as textfile location &apos;/tmp/lxw11/&apos;;</span><br><span class="line"> </span><br><span class="line">DESC lxw1234;</span><br><span class="line">cookieid                STRING </span><br><span class="line">createtime              STRING </span><br><span class="line">pv INT </span><br><span class="line"> </span><br><span class="line">hive&gt; select * from lxw1234;</span><br><span class="line">OK</span><br><span class="line">cookie1 2015-04-10      1</span><br><span class="line">cookie1 2015-04-11      5</span><br><span class="line">cookie1 2015-04-12      7</span><br><span class="line">cookie1 2015-04-13      3</span><br><span class="line">cookie1 2015-04-14      2</span><br><span class="line">cookie1 2015-04-15      4</span><br><span class="line">cookie1 2015-04-16      4</span><br></pre></td></tr></table></figure><ul><li>2.设置开窗的窗口范围</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime) AS pv1, -- 默认为从起点到当前行</span><br><span class="line">SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS pv2, --从起点到当前行，结果同pv1 </span><br><span class="line">SUM(pv) OVER(PARTITION BY cookieid) AS pv3,--分组内所有行</span><br><span class="line">SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS pv4,   --当前行+往前3行</span><br><span class="line">SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND 1 FOLLOWING) AS pv5,    --当前行+往前3行+往后1行</span><br><span class="line">SUM(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS pv6   ---当前行+往后所有行  </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">cookieid createtime     pv      pv1     pv2     pv3     pv4     pv5      pv6 </span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">cookie1  2015-04-10      1       1       1       26      1       6       26</span><br><span class="line">cookie1  2015-04-11      5       6       6       26      6       13      25</span><br><span class="line">cookie1  2015-04-12      7       13      13      26      13      16      20</span><br><span class="line">cookie1  2015-04-13      3       16      16      26      16      18      13</span><br><span class="line">cookie1  2015-04-14      2       18      18      26      17      21      10</span><br><span class="line">cookie1  2015-04-15      4       22      22      26      16      20      8</span><br><span class="line">cookie1  2015-04-16      4       26      26      26      13      13      4</span><br></pre></td></tr></table></figure><p>结果解析：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pv1: 分组内从起点到当前行的pv累积，如，11号的pv1=10号的pv+11号的pv, 12号=10号+11号+12号</span><br><span class="line">pv2: 同pv1</span><br><span class="line">pv3: 分组内(cookie1)所有的pv累加</span><br><span class="line">pv4: 分组内当前行+往前3行，如，11号=10号+11号， 12号=10号+11号+12号， 13号=10号+11号+12号+13号， 14号=11号+12号+13号+14号</span><br><span class="line">pv5: 分组内当前行+往前3行+往后1行，如，14号=11号+12号+13号+14号+15号=5+7+3+2+4=21</span><br><span class="line">pv6: 分组内当前行+往后所有行，如，13号=13号+14号+15号+16号=3+2+4+4=13，14号=14号+15号+16号=2+4+4=10</span><br></pre></td></tr></table></figure><p>ROWS BETWEEN 叫做window子句，如果不指定ROWS BETWEEN,默认统计窗口为从起点到当前行<br>：</p><ul><li>PRECEDING：往前</li><li>FOLLOWING：往后</li><li>CURRENT ROW：当前行</li><li>UNBOUNDED：无边界，UNBOUNDED PRECEDING 表示从最前面的起点开始， UNBOUNDED – FOLLOWING：表示到最后面的终点</li></ul><p>– 3.AVG，MIN，MAX，和SUM用法一样</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">-- AVG</span><br><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">AVG(pv) OVER(PARTITION BY cookieid ORDER BY createtime) AS pv1, -- 默认为从起点到当前行</span><br><span class="line">AVG(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS pv2, --从起点到当前行，结果同pv1 </span><br><span class="line">AVG(pv) OVER(PARTITION BY cookieid) AS pv3,--分组内所有行</span><br><span class="line">AVG(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS pv4,   --当前行+往前3行</span><br><span class="line">AVG(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND 1 FOLLOWING) AS pv5,    --当前行+往前3行+往后1行</span><br><span class="line">AVG(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS pv6   ---当前行+往后所有行  </span><br><span class="line">FROM lxw1234; </span><br><span class="line">cookieid createtime     pv      pv1     pv2     pv3     pv4     pv5      pv6 </span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10      1       1.0     1.0     3.7142857142857144      1.0     3.0     3.7142857142857144</span><br><span class="line">cookie1 2015-04-11      5       3.0     3.0     3.7142857142857144      3.0     4.333333333333333       4.166666666666667</span><br><span class="line">cookie1 2015-04-12      7       4.333333333333333       4.333333333333333       3.7142857142857144      4.333333333333333       4.0     4.0</span><br><span class="line">cookie1 2015-04-13      3       4.0     4.0     3.7142857142857144      4.0     3.6     3.25</span><br><span class="line">cookie1 2015-04-14      2       3.6     3.6     3.7142857142857144      4.25    4.2     3.3333333333333335</span><br><span class="line">cookie1 2015-04-15      4       3.6666666666666665      3.6666666666666665      3.7142857142857144      4.0     4.0     4.0</span><br><span class="line">cookie1 2015-04-16      4       3.7142857142857144      3.7142857142857144      3.7142857142857144      3.25    3.25    4.0</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- MIN</span><br><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">MIN(pv) OVER(PARTITION BY cookieid ORDER BY createtime) AS pv1, -- 默认为从起点到当前行</span><br><span class="line">MIN(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS pv2, --从起点到当前行，结果同pv1 </span><br><span class="line">MIN(pv) OVER(PARTITION BY cookieid) AS pv3,--分组内所有行</span><br><span class="line">MIN(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS pv4,   --当前行+往前3行</span><br><span class="line">MIN(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND 1 FOLLOWING) AS pv5,    --当前行+往前3行+往后1行</span><br><span class="line">MIN(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS pv6   ---当前行+往后所有行  </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">cookieid createtime     pv      pv1     pv2     pv3     pv4     pv5      pv6 </span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10      1       1       1       1       1       1       1</span><br><span class="line">cookie1 2015-04-11      5       1       1       1       1       1       2</span><br><span class="line">cookie1 2015-04-12      7       1       1       1       1       1       2</span><br><span class="line">cookie1 2015-04-13      3       1       1       1       1       1       2</span><br><span class="line">cookie1 2015-04-14      2       1       1       1       2       2       2</span><br><span class="line">cookie1 2015-04-15      4       1       1       1       2       2       4</span><br><span class="line">cookie1 2015-04-16      4       1       1       1       2       2       4</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">-- MAX</span><br><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">MAX(pv) OVER(PARTITION BY cookieid ORDER BY createtime) AS pv1, -- 默认为从起点到当前行</span><br><span class="line">MAX(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS pv2, --从起点到当前行，结果同pv1 </span><br><span class="line">MAX(pv) OVER(PARTITION BY cookieid) AS pv3,--分组内所有行</span><br><span class="line">MAX(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS pv4,   --当前行+往前3行</span><br><span class="line">MAX(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN 3 PRECEDING AND 1 FOLLOWING) AS pv5,    --当前行+往前3行+往后1行</span><br><span class="line">MAX(pv) OVER(PARTITION BY cookieid ORDER BY createtime ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS pv6   ---当前行+往后所有行  </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">cookieid createtime     pv      pv1     pv2     pv3     pv4     pv5      pv6 </span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10      1       1       1       7       1       5       7</span><br><span class="line">cookie1 2015-04-11      5       5       5       7       5       7       7</span><br><span class="line">cookie1 2015-04-12      7       7       7       7       7       7       7</span><br><span class="line">cookie1 2015-04-13      3       7       7       7       7       7       4</span><br><span class="line">cookie1 2015-04-14      2       7       7       7       7       7       4</span><br><span class="line">cookie1 2015-04-15      4       7       7       7       7       7       4</span><br><span class="line">cookie1 2015-04-16      4       7       7       7       4       4       4</span><br></pre></td></tr></table></figure><h3 id="序列函数"><a href="#序列函数" class="headerlink" title="序列函数"></a>序列函数</h3><p>序列函数:NTILE、ROW_NUMBER、RANK、DENSE_RANK、CUME_DIST和PERCENT_RANK，不支持WINDOW子句.</p><ul><li>1.数据准备</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">cookie1,2015-04-10,1</span><br><span class="line">cookie1,2015-04-11,5</span><br><span class="line">cookie1,2015-04-12,7</span><br><span class="line">cookie1,2015-04-13,3</span><br><span class="line">cookie1,2015-04-14,2</span><br><span class="line">cookie1,2015-04-15,4</span><br><span class="line">cookie1,2015-04-16,4</span><br><span class="line">cookie2,2015-04-10,2</span><br><span class="line">cookie2,2015-04-11,3</span><br><span class="line">cookie2,2015-04-12,5</span><br><span class="line">cookie2,2015-04-13,6</span><br><span class="line">cookie2,2015-04-14,3</span><br><span class="line">cookie2,2015-04-15,9</span><br><span class="line">cookie2,2015-04-16,7</span><br><span class="line"> </span><br><span class="line">CREATE EXTERNAL TABLE lxw1234 (</span><br><span class="line">cookieid string,</span><br><span class="line">createtime string,   --day </span><br><span class="line">pv INT</span><br><span class="line">) ROW FORMAT DELIMITED </span><br><span class="line">FIELDS TERMINATED BY &apos;,&apos; </span><br><span class="line">stored as textfile location &apos;/tmp/lxw11/&apos;;</span><br><span class="line"> </span><br><span class="line">DESC lxw1234;</span><br><span class="line">cookieid                STRING </span><br><span class="line">createtime              STRING </span><br><span class="line">pv INT </span><br><span class="line"> </span><br><span class="line">hive&gt; select * from lxw1234;</span><br><span class="line">OK</span><br><span class="line">cookie1 2015-04-10      1</span><br><span class="line">cookie1 2015-04-11      5</span><br><span class="line">cookie1 2015-04-12      7</span><br><span class="line">cookie1 2015-04-13      3</span><br><span class="line">cookie1 2015-04-14      2</span><br><span class="line">cookie1 2015-04-15      4</span><br><span class="line">cookie1 2015-04-16      4</span><br><span class="line">cookie2 2015-04-10      2</span><br><span class="line">cookie2 2015-04-11      3</span><br><span class="line">cookie2 2015-04-12      5</span><br><span class="line">cookie2 2015-04-13      6</span><br><span class="line">cookie2 2015-04-14      3</span><br><span class="line">cookie2 2015-04-15      9</span><br><span class="line">cookie2 2015-04-16      7</span><br></pre></td></tr></table></figure><ul><li>2.NTILE: NTILE(n)，用于将分组数据按照顺序切分成n片，返回当前切片值<ul><li>如果切片不均匀，默认增加第一个切片的分布</li><li>NTILE不支持ROWS BETWEEN</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">NTILE(2) OVER(PARTITION BY cookieid ORDER BY createtime) AS rn1,--分组内将数据分成2片</span><br><span class="line">NTILE(3) OVER(PARTITION BY cookieid ORDER BY createtime) AS rn2,  --分组内将数据分成3片</span><br><span class="line">NTILE(4) OVER(ORDER BY createtime) AS rn3        --将所有数据分成4片</span><br><span class="line">FROM lxw1234 </span><br><span class="line">ORDER BY cookieid,createtime;</span><br><span class="line"> </span><br><span class="line">cookieid day           pv       rn1     rn2     rn3</span><br><span class="line">-------------------------------------------------</span><br><span class="line">cookie1 2015-04-10      1       1       1       1</span><br><span class="line">cookie1 2015-04-11      5       1       1       1</span><br><span class="line">cookie1 2015-04-12      7       1       1       2</span><br><span class="line">cookie1 2015-04-13      3       1       2       2</span><br><span class="line">cookie1 2015-04-14      2       2       2       3</span><br><span class="line">cookie1 2015-04-15      4       2       3       3</span><br><span class="line">cookie1 2015-04-16      4       2       3       4</span><br><span class="line">cookie2 2015-04-10      2       1       1       1</span><br><span class="line">cookie2 2015-04-11      3       1       1       1</span><br><span class="line">cookie2 2015-04-12      5       1       1       2</span><br><span class="line">cookie2 2015-04-13      6       1       2       2</span><br><span class="line">cookie2 2015-04-14      3       2       2       3</span><br><span class="line">cookie2 2015-04-15      9       2       3       4</span><br><span class="line">cookie2 2015-04-16      7       2       3       4</span><br></pre></td></tr></table></figure><ul><li>3.ROW_NUMBER：从1开始，按照顺序，生成分组内记录的序列</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-- 按照pv降序排列，生成分组内每天的pv名次</span><br><span class="line">SELECT </span><br><span class="line">cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">ROW_NUMBER() OVER(PARTITION BY cookieid ORDER BY pv desc) AS rn </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">cookieid day           pv       rn</span><br><span class="line">------------------------------------------- </span><br><span class="line">cookie1 2015-04-12      7       1</span><br><span class="line">cookie1 2015-04-11      5       2</span><br><span class="line">cookie1 2015-04-15      4       3</span><br><span class="line">cookie1 2015-04-16      4       4</span><br><span class="line">cookie1 2015-04-13      3       5</span><br><span class="line">cookie1 2015-04-14      2       6</span><br><span class="line">cookie1 2015-04-10      1       7</span><br><span class="line">cookie2 2015-04-15      9       1</span><br><span class="line">cookie2 2015-04-16      7       2</span><br><span class="line">cookie2 2015-04-13      6       3</span><br><span class="line">cookie2 2015-04-12      5       4</span><br><span class="line">cookie2 2015-04-14      3       5</span><br><span class="line">cookie2 2015-04-11      3       6</span><br><span class="line">cookie2 2015-04-10      2       7</span><br></pre></td></tr></table></figure><ul><li>4.RANK 和 DENSE_RANK<ul><li>RANK() :生成数据项在分组中的排名，排名相等会在名次中留下空位</li><li>DENSE_RANK()  :生成数据项在分组中的排名，排名相等会在名次中不会留下空位</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">cookieid,</span><br><span class="line">createtime,</span><br><span class="line">pv,</span><br><span class="line">RANK() OVER(PARTITION BY cookieid ORDER BY pv desc) AS rn1,</span><br><span class="line">DENSE_RANK() OVER(PARTITION BY cookieid ORDER BY pv desc) AS rn2,</span><br><span class="line">ROW_NUMBER() OVER(PARTITION BY cookieid ORDER BY pv DESC) AS rn3 </span><br><span class="line">FROM lxw1234 </span><br><span class="line">WHERE cookieid = &apos;cookie1&apos;;</span><br><span class="line"> </span><br><span class="line">cookieid day           pv       rn1     rn2     rn3 </span><br><span class="line">-------------------------------------------------- </span><br><span class="line">cookie1 2015-04-12      7       1       1       1</span><br><span class="line">cookie1 2015-04-11      5       2       2       2</span><br><span class="line">cookie1 2015-04-15      4       3       3       3</span><br><span class="line">cookie1 2015-04-16      4       3       3       4</span><br><span class="line">cookie1 2015-04-13      3       5       4       5</span><br><span class="line">cookie1 2015-04-14      2       6       5       6</span><br><span class="line">cookie1 2015-04-10      1       7       6       7</span><br><span class="line"> </span><br><span class="line">rn1: 15号和16号并列第3, 13号排第5</span><br><span class="line">rn2: 15号和16号并列第3, 13号排第4</span><br><span class="line">rn3: 如果相等，则按记录值排序，生成唯一的次序，如果所有记录值都相等，或许会随机排吧。</span><br></pre></td></tr></table></figure><ul><li><p>5.数据准备</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">d1,user1,1000</span><br><span class="line">d1,user2,2000</span><br><span class="line">d1,user3,3000</span><br><span class="line">d2,user4,4000</span><br><span class="line">d2,user5,5000</span><br><span class="line"> </span><br><span class="line">CREATE EXTERNAL TABLE lxw1234 (</span><br><span class="line">dept STRING,</span><br><span class="line">userid string,</span><br><span class="line">sal INT</span><br><span class="line">) ROW FORMAT DELIMITED </span><br><span class="line">FIELDS TERMINATED BY &apos;,&apos; </span><br><span class="line">stored as textfile location &apos;/tmp/lxw11/&apos;;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">hive&gt; select * from lxw1234;</span><br><span class="line">OK</span><br><span class="line">d1      user1   1000</span><br><span class="line">d1      user2   2000</span><br><span class="line">d1      user3   3000</span><br><span class="line">d2      user4   4000</span><br><span class="line">d2      user5   5000</span><br></pre></td></tr></table></figure></li><li><p>6.CUME_DIST: 小于等于当前值的行数/分组内总行数</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">dept,</span><br><span class="line">userid,</span><br><span class="line">sal,</span><br><span class="line">CUME_DIST() OVER(ORDER BY sal) AS rn1,</span><br><span class="line">CUME_DIST() OVER(PARTITION BY dept ORDER BY sal) AS rn2 </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">dept    userid   sal   rn1       rn2 </span><br><span class="line">-------------------------------------------</span><br><span class="line">d1      user1   1000    0.2     0.3333333333333333</span><br><span class="line">d1      user2   2000    0.4     0.6666666666666666</span><br><span class="line">d1      user3   3000    0.6     1.0</span><br><span class="line">d2      user4   4000    0.8     0.5</span><br><span class="line">d2      user5   5000    1.0     1.0</span><br><span class="line"> </span><br><span class="line">rn1: 没有partition,所有数据均为1组，总行数为5，</span><br><span class="line">     第一行：小于等于1000的行数为1，因此，1/5=0.2</span><br><span class="line">     第三行：小于等于3000的行数为3，因此，3/5=0.6</span><br><span class="line">rn2: 按照部门分组，dpet=d1的行数为3,</span><br><span class="line">     第二行：小于等于2000的行数为2，因此，2/3=0.6666666666666666</span><br></pre></td></tr></table></figure><ul><li>7.PERCENT_RANK:分组内当前行的RANK值-1/分组内总行数-1</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">dept,</span><br><span class="line">userid,</span><br><span class="line">sal,</span><br><span class="line">PERCENT_RANK() OVER(ORDER BY sal) AS rn1,   --分组内</span><br><span class="line">RANK() OVER(ORDER BY sal) AS rn11,          --分组内RANK值</span><br><span class="line">SUM(1) OVER(PARTITION BY NULL) AS rn12,     --分组内总行数</span><br><span class="line">PERCENT_RANK() OVER(PARTITION BY dept ORDER BY sal) AS rn2 </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">dept    userid   sal    rn1    rn11     rn12    rn2</span><br><span class="line">---------------------------------------------------</span><br><span class="line">d1      user1   1000    0.0     1       5       0.0</span><br><span class="line">d1      user2   2000    0.25    2       5       0.5</span><br><span class="line">d1      user3   3000    0.5     3       5       1.0</span><br><span class="line">d2      user4   4000    0.75    4       5       0.0</span><br><span class="line">d2      user5   5000    1.0     5       5       1.0</span><br><span class="line"> </span><br><span class="line">rn1: rn1 = (rn11-1) / (rn12-1) </span><br><span class="line">   第一行,(1-1)/(5-1)=0/4=0</span><br><span class="line">   第二行,(2-1)/(5-1)=1/4=0.25</span><br><span class="line">   第四行,(4-1)/(5-1)=3/4=0.75</span><br><span class="line">rn2: 按照dept分组，</span><br><span class="line">     dept=d1的总行数为3</span><br><span class="line">     第一行，(1-1)/(3-1)=0</span><br><span class="line">     第三行，(3-1)/(3-1)=1</span><br></pre></td></tr></table></figure><h3 id="位置函数"><a href="#位置函数" class="headerlink" title="位置函数"></a>位置函数</h3><p>位置函数:LAG 、LEAD、FIRST_VALUE和LAST_VALUE,不支持WINDOW子句</p><ul><li>1.数据准备</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">cookie1,2015-04-10 10:00:02,url2</span><br><span class="line">cookie1,2015-04-10 10:00:00,url1</span><br><span class="line">cookie1,2015-04-10 10:03:04,1url3</span><br><span class="line">cookie1,2015-04-10 10:50:05,url6</span><br><span class="line">cookie1,2015-04-10 11:00:00,url7</span><br><span class="line">cookie1,2015-04-10 10:10:00,url4</span><br><span class="line">cookie1,2015-04-10 10:50:01,url5</span><br><span class="line">cookie2,2015-04-10 10:00:02,url22</span><br><span class="line">cookie2,2015-04-10 10:00:00,url11</span><br><span class="line">cookie2,2015-04-10 10:03:04,1url33</span><br><span class="line">cookie2,2015-04-10 10:50:05,url66</span><br><span class="line">cookie2,2015-04-10 11:00:00,url77</span><br><span class="line">cookie2,2015-04-10 10:10:00,url44</span><br><span class="line">cookie2,2015-04-10 10:50:01,url55</span><br><span class="line"> </span><br><span class="line">CREATE EXTERNAL TABLE lxw1234 (</span><br><span class="line">cookieid string,</span><br><span class="line">createtime string,  --页面访问时间</span><br><span class="line">url STRING       --被访问页面</span><br><span class="line">) ROW FORMAT DELIMITED </span><br><span class="line">FIELDS TERMINATED BY &apos;,&apos; </span><br><span class="line">stored as textfile location &apos;/tmp/lxw11/&apos;;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">hive&gt; select * from lxw1234;</span><br><span class="line">OK</span><br><span class="line">cookie1 2015-04-10 10:00:02     url2</span><br><span class="line">cookie1 2015-04-10 10:00:00     url1</span><br><span class="line">cookie1 2015-04-10 10:03:04     1url3</span><br><span class="line">cookie1 2015-04-10 10:50:05     url6</span><br><span class="line">cookie1 2015-04-10 11:00:00     url7</span><br><span class="line">cookie1 2015-04-10 10:10:00     url4</span><br><span class="line">cookie1 2015-04-10 10:50:01     url5</span><br><span class="line">cookie2 2015-04-10 10:00:02     url22</span><br><span class="line">cookie2 2015-04-10 10:00:00     url11</span><br><span class="line">cookie2 2015-04-10 10:03:04     1url33</span><br><span class="line">cookie2 2015-04-10 10:50:05     url66</span><br><span class="line">cookie2 2015-04-10 11:00:00     url77</span><br><span class="line">cookie2 2015-04-10 10:10:00     url44</span><br><span class="line">cookie2 2015-04-10 10:50:01     url55</span><br></pre></td></tr></table></figure><ul><li>2.LAG:LAG(col,n,DEFAULT) 用于统计窗口内往上第n行值    <ul><li>第一个参数为列名</li><li>第二个参数为往上第n行（可选，默认为1）</li><li>第三个参数为默认值（当往上第n行为NULL时候，取默认值，如不指定，则为NULL） </li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">url,</span><br><span class="line">ROW_NUMBER() OVER(PARTITION BY cookieid ORDER BY createtime) AS rn,</span><br><span class="line">LAG(createtime,1,&apos;1970-01-01 00:00:00&apos;) OVER(PARTITION BY cookieid ORDER BY createtime) AS last_1_time,</span><br><span class="line">LAG(createtime,2) OVER(PARTITION BY cookieid ORDER BY createtime) AS last_2_time </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">cookieid createtime             url    rn       last_1_time             last_2_time</span><br><span class="line">-------------------------------------------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10 10:00:00     url1    1       1970-01-01 00:00:00     NULL</span><br><span class="line">cookie1 2015-04-10 10:00:02     url2    2       2015-04-10 10:00:00     NULL</span><br><span class="line">cookie1 2015-04-10 10:03:04     1url3   3       2015-04-10 10:00:02     2015-04-10 10:00:00</span><br><span class="line">cookie1 2015-04-10 10:10:00     url4    4       2015-04-10 10:03:04     2015-04-10 10:00:02</span><br><span class="line">cookie1 2015-04-10 10:50:01     url5    5       2015-04-10 10:10:00     2015-04-10 10:03:04</span><br><span class="line">cookie1 2015-04-10 10:50:05     url6    6       2015-04-10 10:50:01     2015-04-10 10:10:00</span><br><span class="line">cookie1 2015-04-10 11:00:00     url7    7       2015-04-10 10:50:05     2015-04-10 10:50:01</span><br><span class="line">cookie2 2015-04-10 10:00:00     url11   1       1970-01-01 00:00:00     NULL</span><br><span class="line">cookie2 2015-04-10 10:00:02     url22   2       2015-04-10 10:00:00     NULL</span><br><span class="line">cookie2 2015-04-10 10:03:04     1url33  3       2015-04-10 10:00:02     2015-04-10 10:00:00</span><br><span class="line">cookie2 2015-04-10 10:10:00     url44   4       2015-04-10 10:03:04     2015-04-10 10:00:02</span><br><span class="line">cookie2 2015-04-10 10:50:01     url55   5       2015-04-10 10:10:00     2015-04-10 10:03:04</span><br><span class="line">cookie2 2015-04-10 10:50:05     url66   6       2015-04-10 10:50:01     2015-04-10 10:10:00</span><br><span class="line">cookie2 2015-04-10 11:00:00     url77   7       2015-04-10 10:50:05     2015-04-10 10:50:01</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">last_1_time: 指定了往上第1行的值，default为&apos;1970-01-01 00:00:00&apos;  </span><br><span class="line">             cookie1第一行，往上1行为NULL,因此取默认值 1970-01-01 00:00:00</span><br><span class="line">             cookie1第三行，往上1行值为第二行值，2015-04-10 10:00:02</span><br><span class="line">             cookie1第六行，往上1行值为第五行值，2015-04-10 10:50:01</span><br><span class="line">last_2_time: 指定了往上第2行的值，为指定默认值</span><br><span class="line"> cookie1第一行，往上2行为NULL</span><br><span class="line"> cookie1第二行，往上2行为NULL</span><br><span class="line"> cookie1第四行，往上2行为第二行值，2015-04-10 10:00:02</span><br><span class="line"> cookie1第七行，往上2行为第五行值，2015-04-10 10:50:01</span><br></pre></td></tr></table></figure><ul><li>3.LEAD:LEAD(col,n,DEFAULT) 用于统计窗口内往下第n行值<ul><li>第一个参数为列名</li><li>第二个参数为往下第n行（可选，默认为1）</li><li>第三个参数为默认值（当往下第n行为NULL时候，取默认值，如不指定，则为NULL） </li></ul></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">url,</span><br><span class="line">ROW_NUMBER() OVER(PARTITION BY cookieid ORDER BY createtime) AS rn,</span><br><span class="line">LEAD(createtime,1,&apos;1970-01-01 00:00:00&apos;) OVER(PARTITION BY cookieid ORDER BY createtime) AS next_1_time,</span><br><span class="line">LEAD(createtime,2) OVER(PARTITION BY cookieid ORDER BY createtime) AS next_2_time </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">cookieid createtime             url    rn       next_1_time             next_2_time </span><br><span class="line">-------------------------------------------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10 10:00:00     url1    1       2015-04-10 10:00:02     2015-04-10 10:03:04</span><br><span class="line">cookie1 2015-04-10 10:00:02     url2    2       2015-04-10 10:03:04     2015-04-10 10:10:00</span><br><span class="line">cookie1 2015-04-10 10:03:04     1url3   3       2015-04-10 10:10:00     2015-04-10 10:50:01</span><br><span class="line">cookie1 2015-04-10 10:10:00     url4    4       2015-04-10 10:50:01     2015-04-10 10:50:05</span><br><span class="line">cookie1 2015-04-10 10:50:01     url5    5       2015-04-10 10:50:05     2015-04-10 11:00:00</span><br><span class="line">cookie1 2015-04-10 10:50:05     url6    6       2015-04-10 11:00:00     NULL</span><br><span class="line">cookie1 2015-04-10 11:00:00     url7    7       1970-01-01 00:00:00     NULL</span><br><span class="line">cookie2 2015-04-10 10:00:00     url11   1       2015-04-10 10:00:02     2015-04-10 10:03:04</span><br><span class="line">cookie2 2015-04-10 10:00:02     url22   2       2015-04-10 10:03:04     2015-04-10 10:10:00</span><br><span class="line">cookie2 2015-04-10 10:03:04     1url33  3       2015-04-10 10:10:00     2015-04-10 10:50:01</span><br><span class="line">cookie2 2015-04-10 10:10:00     url44   4       2015-04-10 10:50:01     2015-04-10 10:50:05</span><br><span class="line">cookie2 2015-04-10 10:50:01     url55   5       2015-04-10 10:50:05     2015-04-10 11:00:00</span><br><span class="line">cookie2 2015-04-10 10:50:05     url66   6       2015-04-10 11:00:00     NULL</span><br><span class="line">cookie2 2015-04-10 11:00:00     url77   7       1970-01-01 00:00:00     NULL</span><br><span class="line"> </span><br><span class="line">--逻辑与LAG一样，只不过LAG是往上，LEAD是往下。</span><br></pre></td></tr></table></figure><ul><li>4.FIRST_VALUE:取分组内排序后，截止到当前行，第一个值</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">url,</span><br><span class="line">ROW_NUMBER() OVER(PARTITION BY cookieid ORDER BY createtime) AS rn,</span><br><span class="line">FIRST_VALUE(url) OVER(PARTITION BY cookieid ORDER BY createtime) AS first1 </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line">cookieid  createtime            url     rn      first1</span><br><span class="line">---------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10 10:00:00     url1    1       url1</span><br><span class="line">cookie1 2015-04-10 10:00:02     url2    2       url1</span><br><span class="line">cookie1 2015-04-10 10:03:04     1url3   3       url1</span><br><span class="line">cookie1 2015-04-10 10:10:00     url4    4       url1</span><br><span class="line">cookie1 2015-04-10 10:50:01     url5    5       url1</span><br><span class="line">cookie1 2015-04-10 10:50:05     url6    6       url1</span><br><span class="line">cookie1 2015-04-10 11:00:00     url7    7       url1</span><br><span class="line">cookie2 2015-04-10 10:00:00     url11   1       url11</span><br><span class="line">cookie2 2015-04-10 10:00:02     url22   2       url11</span><br><span class="line">cookie2 2015-04-10 10:03:04     1url33  3       url11</span><br><span class="line">cookie2 2015-04-10 10:10:00     url44   4       url11</span><br><span class="line">cookie2 2015-04-10 10:50:01     url55   5       url11</span><br><span class="line">cookie2 2015-04-10 10:50:05     url66   6       url11</span><br><span class="line">cookie2 2015-04-10 11:00:00     url77   7       url11</span><br></pre></td></tr></table></figure><ul><li>5.LAST_VALUE:取分组内排序后，截止到当前行，最后一个值</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SELECT cookieid,</span><br><span class="line">createtime,</span><br><span class="line">url,</span><br><span class="line">ROW_NUMBER() OVER(PARTITION BY cookieid ORDER BY createtime) AS rn,</span><br><span class="line">LAST_VALUE(url) OVER(PARTITION BY cookieid ORDER BY createtime) AS last1 </span><br><span class="line">FROM lxw1234;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">cookieid  createtime            url    rn       last1  </span><br><span class="line">-----------------------------------------------------------------</span><br><span class="line">cookie1 2015-04-10 10:00:00     url1    1       url1</span><br><span class="line">cookie1 2015-04-10 10:00:02     url2    2       url2</span><br><span class="line">cookie1 2015-04-10 10:03:04     1url3   3       1url3</span><br><span class="line">cookie1 2015-04-10 10:10:00     url4    4       url4</span><br><span class="line">cookie1 2015-04-10 10:50:01     url5    5       url5</span><br><span class="line">cookie1 2015-04-10 10:50:05     url6    6       url6</span><br><span class="line">cookie1 2015-04-10 11:00:00     url7    7       url7</span><br><span class="line">cookie2 2015-04-10 10:00:00     url11   1       url11</span><br><span class="line">cookie2 2015-04-10 10:00:02     url22   2       url22</span><br><span class="line">cookie2 2015-04-10 10:03:04     1url33  3       1url33</span><br><span class="line">cookie2 2015-04-10 10:10:00     url44   4       url44</span><br><span class="line">cookie2 2015-04-10 10:50:01     url55   5       url55</span><br><span class="line">cookie2 2015-04-10 10:50:05     url66   6       url66</span><br></pre></td></tr></table></figure><h3 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h3><p>聚合函数：GROUPING SETS、CUBE和ROLLUP</p><ul><li>1.数据准备</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">2015-03,2015-03-10,cookie1</span><br><span class="line">2015-03,2015-03-10,cookie5</span><br><span class="line">2015-03,2015-03-12,cookie7</span><br><span class="line">2015-04,2015-04-12,cookie3</span><br><span class="line">2015-04,2015-04-13,cookie2</span><br><span class="line">2015-04,2015-04-13,cookie4</span><br><span class="line">2015-04,2015-04-16,cookie4</span><br><span class="line">2015-03,2015-03-10,cookie2</span><br><span class="line">2015-03,2015-03-10,cookie3</span><br><span class="line">2015-04,2015-04-12,cookie5</span><br><span class="line">2015-04,2015-04-13,cookie6</span><br><span class="line">2015-04,2015-04-15,cookie3</span><br><span class="line">2015-04,2015-04-15,cookie2</span><br><span class="line">2015-04,2015-04-16,cookie1</span><br><span class="line"> </span><br><span class="line">CREATE EXTERNAL TABLE lxw1234 (</span><br><span class="line">month STRING,</span><br><span class="line">day STRING, </span><br><span class="line">cookieid STRING </span><br><span class="line">) ROW FORMAT DELIMITED </span><br><span class="line">FIELDS TERMINATED BY &apos;,&apos; </span><br><span class="line">stored as textfile location &apos;/tmp/lxw11/&apos;;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">hive&gt; select * from lxw1234;</span><br><span class="line">OK</span><br><span class="line">2015-03 2015-03-10      cookie1</span><br><span class="line">2015-03 2015-03-10      cookie5</span><br><span class="line">2015-03 2015-03-12      cookie7</span><br><span class="line">2015-04 2015-04-12      cookie3</span><br><span class="line">2015-04 2015-04-13      cookie2</span><br><span class="line">2015-04 2015-04-13      cookie4</span><br><span class="line">2015-04 2015-04-16      cookie4</span><br><span class="line">2015-03 2015-03-10      cookie2</span><br><span class="line">2015-03 2015-03-10      cookie3</span><br><span class="line">2015-04 2015-04-12      cookie5</span><br><span class="line">2015-04 2015-04-13      cookie6</span><br><span class="line">2015-04 2015-04-15      cookie3</span><br><span class="line">2015-04 2015-04-15      cookie2</span><br><span class="line">2015-04 2015-04-16      cookie1</span><br></pre></td></tr></table></figure><ul><li>2.GROUPING SETS:在一个GROUP BY查询中，根据不同的维度组合进行聚合，等价于将不同维度的GROUP BY结果集进行UNION ALL</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">month,</span><br><span class="line">day,</span><br><span class="line">COUNT(DISTINCT cookieid) AS uv,</span><br><span class="line">GROUPING__ID </span><br><span class="line">FROM lxw1234 </span><br><span class="line">GROUP BY month,day </span><br><span class="line">GROUPING SETS (month,day) </span><br><span class="line">ORDER BY GROUPING__ID;</span><br><span class="line"> </span><br><span class="line">month      day            uv      GROUPING__ID</span><br><span class="line">------------------------------------------------</span><br><span class="line">2015-03    NULL            5       1</span><br><span class="line">2015-04    NULL            6       1</span><br><span class="line">NULL       2015-03-10      4       2</span><br><span class="line">NULL       2015-03-12      1       2</span><br><span class="line">NULL       2015-04-12      2       2</span><br><span class="line">NULL       2015-04-13      3       2</span><br><span class="line">NULL       2015-04-15      2       2</span><br><span class="line">NULL       2015-04-16      2       2</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">等价于 </span><br><span class="line">SELECT month,NULL,COUNT(DISTINCT cookieid) AS uv,1 AS GROUPING__ID FROM lxw1234 GROUP BY month </span><br><span class="line">UNION ALL </span><br><span class="line">SELECT NULL,day,COUNT(DISTINCT cookieid) AS uv,2 AS GROUPING__ID FROM lxw1234 GROUP BY day</span><br></pre></td></tr></table></figure><p><strong>注：GROUPING__ID，表示结果属于哪一个分组集合。</strong></p><ul><li>3.CUBE:根据GROUP BY的维度的所有组合进行聚合</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">month,</span><br><span class="line">day,</span><br><span class="line">COUNT(DISTINCT cookieid) AS uv,</span><br><span class="line">GROUPING__ID </span><br><span class="line">FROM lxw1234 </span><br><span class="line">GROUP BY month,day </span><br><span class="line">WITH CUBE </span><br><span class="line">ORDER BY GROUPING__ID;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">month      day             uv     GROUPING__ID</span><br><span class="line">--------------------------------------------</span><br><span class="line">NULL            NULL            7       0</span><br><span class="line">2015-03         NULL            5       1</span><br><span class="line">2015-04         NULL            6       1</span><br><span class="line">NULL            2015-04-12      2       2</span><br><span class="line">NULL            2015-04-13      3       2</span><br><span class="line">NULL            2015-04-15      2       2</span><br><span class="line">NULL            2015-04-16      2       2</span><br><span class="line">NULL            2015-03-10      4       2</span><br><span class="line">NULL            2015-03-12      1       2</span><br><span class="line">2015-03         2015-03-10      4       3</span><br><span class="line">2015-03         2015-03-12      1       3</span><br><span class="line">2015-04         2015-04-16      2       3</span><br><span class="line">2015-04         2015-04-12      2       3</span><br><span class="line">2015-04         2015-04-13      3       3</span><br><span class="line">2015-04         2015-04-15      2       3</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">等价于</span><br><span class="line">SELECT NULL,NULL,COUNT(DISTINCT cookieid) AS uv,0 AS GROUPING__ID FROM lxw1234</span><br><span class="line">UNION ALL </span><br><span class="line">SELECT month,NULL,COUNT(DISTINCT cookieid) AS uv,1 AS GROUPING__ID FROM lxw1234 GROUP BY month </span><br><span class="line">UNION ALL </span><br><span class="line">SELECT NULL,day,COUNT(DISTINCT cookieid) AS uv,2 AS GROUPING__ID FROM lxw1234 GROUP BY day</span><br><span class="line">UNION ALL </span><br><span class="line">SELECT month,day,COUNT(DISTINCT cookieid) AS uv,3 AS GROUPING__ID FROM lxw1234 GROUP BY month,day</span><br></pre></td></tr></table></figure><ul><li>4.ROLLUP:是CUBE的子集，以最左侧的维度为主，从该维度进行层级聚合。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">-- 以month维度进行层级聚合：</span><br><span class="line">SELECT </span><br><span class="line">month,</span><br><span class="line">day,</span><br><span class="line">COUNT(DISTINCT cookieid) AS uv,</span><br><span class="line">GROUPING__ID  </span><br><span class="line">FROM lxw1234 </span><br><span class="line">GROUP BY month,day</span><br><span class="line">WITH ROLLUP </span><br><span class="line">ORDER BY GROUPING__ID;</span><br><span class="line"> </span><br><span class="line">month      day             uv     GROUPING__ID</span><br><span class="line">---------------------------------------------------</span><br><span class="line">NULL             NULL            7       0</span><br><span class="line">2015-03          NULL            5       1</span><br><span class="line">2015-04          NULL            6       1</span><br><span class="line">2015-03          2015-03-10      4       3</span><br><span class="line">2015-03          2015-03-12      1       3</span><br><span class="line">2015-04          2015-04-12      2       3</span><br><span class="line">2015-04          2015-04-13      3       3</span><br><span class="line">2015-04          2015-04-15      2       3</span><br><span class="line">2015-04          2015-04-16      2       3</span><br><span class="line"> </span><br><span class="line">可以实现这样的上钻过程：</span><br><span class="line">月天的UV-&gt;月的UV-&gt;总UV</span><br></pre></td></tr></table></figure><h3 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h3><ul><li>1.创建文件set_message.sql</li><li>2.在文件中定位存储过程</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 创建一个存储过程set_message，它接受一个STRING类型的IN参数，输出一个STRING类型的OUT参数。</span><br><span class="line">CREATE PROCEDURE set_message(IN name STRING, OUT result STRING)</span><br><span class="line">BEGIN</span><br><span class="line"> SET result = &apos;Hello, &apos; || name || &apos;!&apos;;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure><ul><li>3.自定义函数</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INCLUDE /home/hadoop/set_message.sql</span><br><span class="line">DECLARE str STRING;</span><br><span class="line">CALL set_message(&apos;hadoop&apos;, str);</span><br><span class="line">PRINT str;</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> hive </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（七）Hive的部署</title>
      <link href="/2019/10/15/%E5%A4%A7%E6%95%B0%E6%8D%AE07/"/>
      <url>/2019/10/15/%E5%A4%A7%E6%95%B0%E6%8D%AE07/</url>
      <content type="html"><![CDATA[<p>Hive是构建在Hadoop HDFS上的一个数据仓库，可以将结构化的数据文件映射为一张数据库表（Hive的表其实就是HDFS的目录/文件），并提供类SQL查询功能，其本质是将SQL转换为MapReduce程序。</p><p>本文章主要介绍在centos环境下如何安装Hive。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>Hive的底层运算是MapReduce计算框架，Hive只是将可读性强，容易编程的SQL语句通过Hive软件转换成MR程序在集群上执行。<br>hive可以看做mapreduce客户端，能用mapreduce程序完成的任务基本都可以对应的替换成hql（Hive SQL）编写的hive任务。<br><strong>Hive最大的限制特点就是不支持基于行记录的更新，删除，增加。但是用户可以通过查询生成新表，或者将查询结果导入文件中来“实现”hive基于行记录的操作。</strong></p><p><img src="/image/大数据07/大数据07_001.png" alt=""></p><h3 id="一-安装"><a href="#一-安装" class="headerlink" title="一.安装"></a>一.安装</h3><h4 id="1-安装前准备"><a href="#1-安装前准备" class="headerlink" title="1.安装前准备"></a>1.安装前准备</h4><ul><li>1.安装MySQL并创建hive数据库：数据库主要是存放hive的数据源路径和数据元信息，可以安装，也可以使用内置数据库 Derby。</li><li>2.安装JDK和Hadoop：详细安装见 大数据（六）</li></ul><h4 id="2-hive安装步骤"><a href="#2-hive安装步骤" class="headerlink" title="2.hive安装步骤"></a>2.hive安装步骤</h4><ul><li><p>1.下载hive版本包： 根据hadoop版本选择对应<a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/" target="_blank" rel="noopener">版本包</a>下载，如hive-2.x与hadoop-2.x匹配，hive-3.x与hadoop-3.x匹配</p></li><li><p>2.解压并配置Hive</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf apache-hive-3.1.2-bin.tar.gz -C /hadoop/install</span><br><span class="line">mv apache-hive-3.1.2-bin/ apache-hive-3.1.2/</span><br></pre></td></tr></table></figure><ul><li>3.修改配置文件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 复制一个"hive-default.xml.template",命名为hive-default.xml</span></span><br><span class="line"><span class="built_in">cd</span> /hadoop/install/apache-hive-3.1.2/conf/</span><br><span class="line">cp hive-log4j2.properties.template hive-log4j2.properties</span><br><span class="line"><span class="comment"># 创建hive-site.xml，并填入内容</span></span><br><span class="line">vi hive-site.xml</span><br></pre></td></tr></table></figure><p>hive-site.xml 的内容：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> standalone=<span class="string">"no"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="php"><span class="meta">&lt;?</span>xml-stylesheet type=<span class="string">"text/xsl"</span> href=<span class="string">"configuration.xsl"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ########################### hive的 JDBC连接 ############################ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mysql 连接用户名 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>UserName<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mysql 连接密码 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>Password!<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mysql 连接URL 如果hive和mysql在同一服务器上，使用localhost --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://localhost:3306/myhive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mysql 连接驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>4.添加驱动包<ul><li>1.下载<a href="https://mvnrepository.com/artifact/mysql/mysql-connector-java/5.1.6" target="_blank" rel="noopener">mysql驱动jar包</a></li><li>2.上传jar包到 hive的安装目录下 的lib目录</li></ul></li></ul><ul><li>5.初始化元数据库</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /hadoop/install/apache-hive-3.1.2/bin/</span><br><span class="line">schematool -dbType mysql -initSchema</span><br></pre></td></tr></table></figure><ul><li>6.配置hive环境变量</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开profile文件</span></span><br><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><p>末尾添加如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export HIVE_HOME=/hadoop/install/apache-hive-3.1.2</span><br><span class="line">export PATH=$PATH:$HIVE_HOME/bin</span><br></pre></td></tr></table></figure></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 环境变量生效</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure><ul><li>7.启动hive</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure><ul><li>8.测试</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; create database <span class="built_in">test</span>;        <span class="comment"># 创建test数据库</span></span><br><span class="line">OK</span><br><span class="line">Time taken: 0.069 seconds</span><br><span class="line">hive&gt; use <span class="built_in">test</span>;                    <span class="comment"># 进入test数据库</span></span><br><span class="line">OK</span><br><span class="line">Time taken: 0.068 seconds</span><br><span class="line">hive&gt; create table tbl_test(id int);    <span class="comment"># 创建表 tt</span></span><br><span class="line">OK</span><br><span class="line">Time taken: 1.886 seconds</span><br><span class="line">hive&gt; show tables;                <span class="comment"># 查看test库中所有的表</span></span><br><span class="line">OK</span><br><span class="line">tbl_test</span><br><span class="line">Time taken: 0.093 seconds, Fetched: 1 row(s)</span><br></pre></td></tr></table></figure><h3 id="二-常用命令"><a href="#二-常用命令" class="headerlink" title="二.常用命令"></a>二.常用命令</h3><p>hiveql的命令大部分跟SQL一样,下面列一下差异点：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 1 select distinct 后必须指定字段名</span><br><span class="line"># 2 join 条件仅支持等值关联且不支持or条件</span><br><span class="line"># 3 子查询不能在select中使用；</span><br><span class="line"># 4 HQL中没有UNION，可使用distinct+ union all 实现 UNION；</span><br><span class="line"># 5 HQL以分号分隔，必须在每个语句结尾写上分号；</span><br><span class="line"># 6 HQL中字符串的比较比较严格，区分大小写及空格，因此在比较时建议upper(trim(a))=upper(trim(b))</span><br><span class="line"># 7 日期判断，建议使用to_date(),如：to_date(orderdate)=‘2016-07-18’</span><br><span class="line"># 8 关键字必须在字段名上加``符号，如select `exchange` from xxdb.xxtb;</span><br><span class="line"># 9 数据库和表/视图之间仅有1个点，如xx_db.xx_tb;</span><br><span class="line"></span><br><span class="line"># HQL不支持update/delete</span><br><span class="line"># 实际采用union all + left join (is null)变相实现update</span><br><span class="line"># 思路：</span><br><span class="line"># 1 取出增量数据；</span><br><span class="line"># 2 使用昨日分区的全量数据通过主键左连接增量数据，并且只取增量表中主键为空的数据（即，取未发生变化的全量数据）；</span><br><span class="line"># 3 合并1、2的数据覆盖至最新的分区，即实现了update；</span><br><span class="line"></span><br><span class="line"># HQL delete实现</span><br><span class="line"># 采用not exists/left join(is null)的方法变相实现。</span><br><span class="line"># 1.取出已删除的主键数据（表B）；</span><br><span class="line"># 2.使用上一个分区的全量数据（表A）通过主键左连接A，并且只取A中主键为空的数据，然后直接insert overwrite至新的分区；</span><br></pre></td></tr></table></figure><h4 id="1-基础命令"><a href="#1-基础命令" class="headerlink" title="1.基础命令"></a>1.基础命令</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 查看某个数据库</span><br><span class="line">show databases; </span><br><span class="line">use 数据库;      # 进入某个数据库</span><br><span class="line">show tables;    # 展示所有表</span><br><span class="line">desc 表名;            # 显示表结构</span><br><span class="line">show partitions 表名; # 显示表名的分区</span><br><span class="line">show create table_name;   # 显示创建表的结构</span><br><span class="line"></span><br><span class="line"># 建表语句</span><br><span class="line"># 内部表</span><br><span class="line">use xxdb; create table xxx;</span><br><span class="line"># 创建一个表，结构与其他一样</span><br><span class="line">create table xxx like xxx;</span><br><span class="line"># 外部表</span><br><span class="line">use xxdb; create external table xxx;</span><br><span class="line"># 分区表</span><br><span class="line">use xxdb; create external table xxx (l int) partitoned by (d string)</span><br><span class="line"># 内外部表转化</span><br><span class="line">alter table table_name set TBLPROPROTIES (&apos;EXTERNAL&apos;=&apos;TRUE&apos;); # 内部表转外部表</span><br><span class="line">alter table table_name set TBLPROPROTIES (&apos;EXTERNAL&apos;=&apos;FALSE&apos;);# 外部表转内部表</span><br><span class="line"></span><br><span class="line"># 表结构修改</span><br><span class="line"># 重命名表</span><br><span class="line">use xxxdb; alter table table_name rename to new_table_name;</span><br><span class="line"># 增加字段</span><br><span class="line">alter table table_name add columns (newcol1 int comment ‘新增’)；</span><br><span class="line"># 修改字段</span><br><span class="line">alter table table_name change col_name new_col_name new_type；</span><br><span class="line"># 删除字段(COLUMNS中只放保留的字段)</span><br><span class="line">alter table table_name replace columns (col1 int,col2 string,col3 string)；</span><br><span class="line"># 删除表</span><br><span class="line">use xxxdb; drop table table_name;</span><br><span class="line"># 删除分区</span><br><span class="line"># 注意：若是外部表，则还需要删除文件(hadoop fs -rm -r -f  hdfspath)</span><br><span class="line">alter table table_name drop if exists partitions (d=‘2016-07-01&apos;);</span><br></pre></td></tr></table></figure><h4 id="2-常用函数"><a href="#2-常用函数" class="headerlink" title="2.常用函数"></a>2.常用函数</h4><h5 id="2-1-数学函数"><a href="#2-1-数学函数" class="headerlink" title="2.1 数学函数"></a>2.1 数学函数</h5><table><thead><tr><th>Name  (Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>round(DOUBLE a)</td><td>Returns the rounded BIGINT value of a.返回对a四舍五入的BIGINT值</td><td>DOUBLE</td></tr><tr><td>round(DOUBLE a, INT d)</td><td>Returns a  rounded to d decimal  places.返回DOUBLE型d的保留n位小数的DOUBLW型的近似值</td><td>DOUBLE</td></tr><tr><td>bround(DOUBLE a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-11103" target="_blank" rel="noopener">Returns the rounded BIGINT value of a using HALF_EVEN   rounding mode (as of Hive 1.3.0, 2.0.0). Also known as Gaussian rounding or   bankers’ rounding. Example: bround(2.5) = 2, bround(3.5) = 4.   银行家舍入法（1~4：舍，6~9：进，5-&gt;前位数是偶：舍，5-&gt;前位数是奇：进）</a></td><td>DOUBLE</td></tr><tr><td>bround(DOUBLE a, INT d)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-11103" target="_blank" rel="noopener">Returns a rounded to d decimal places using HALF_EVEN   rounding mode (as of Hive 1.3.0, 2.0.0). Example: bround(8.25, 1) = 8.2,   bround(8.35, 1) = 8.4. 银行家舍入法,保留d位小数</a></td><td>DOUBLE</td></tr><tr><td>floor(DOUBLE a)</td><td>Returns the maximum BIGINT value that is equal to or less than a向下取整，最数轴上最接近要求的值的左边的值 如：6.10-&gt;6 -3.4-&gt;-4</td><td>BIGINT</td></tr><tr><td>ceil(DOUBLE a), ceiling(DOUBLE a)</td><td>Returns the minimum BIGINT value that is equal to or greater  than a.求其不小于小给定实数的最小整数如：ceil(6) = ceil(6.1)= ceil(6.9) = 6</td><td>BIGINT</td></tr><tr><td>rand(), rand(INT seed)</td><td>Returns a random number (that changes from row to row) that  is distributed uniformly from 0 to 1. Specifying the seed will make sure the  generated random number sequence is deterministic.每行返回一个DOUBLE型随机数seed是随机因子</td><td>DOUBLE</td></tr><tr><td>exp(DOUBLE a), exp(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns ea where e is the base of the natural logarithm.   Decimal version added in Hive 0.13.0.返回e的a幂次方， a可为小数</a></td><td>DOUBLE</td></tr><tr><td>ln(DOUBLE a), ln(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the natural logarithm of the argument a. Decimal   version added in Hive 0.13.0.以自然数为底d的对数，a可为小数</a></td><td>DOUBLE</td></tr><tr><td>log10(DOUBLE a), log10(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the base-10 logarithm of the argument a. Decimal   version added in Hive 0.13.0.以10为底d的对数，a可为小数</a></td><td>DOUBLE</td></tr><tr><td>log2(DOUBLE a), log2(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the base-2 logarithm of the argument a. Decimal   version added in Hive 0.13.0.以2为底数d的对数，a可为小数</a></td><td>DOUBLE</td></tr><tr><td>log(DOUBLE base, DOUBLE a)log(DECIMAL base, DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the base-base logarithm of the argument a. Decimal   versions added in Hive 0.13.0.以base为底的对数，base 与 a都是DOUBLE类型</a></td><td>DOUBLE</td></tr><tr><td>pow(DOUBLE a, DOUBLE p), power(DOUBLE a, DOUBLE p)</td><td>Returns ap.计算a的p次幂</td><td>DOUBLE</td></tr><tr><td>sqrt(DOUBLE a), sqrt(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the square root of a. Decimal version added in Hive   0.13.0.计算a的平方根</a></td><td>DOUBLE</td></tr><tr><td>bin(BIGINT a)</td><td><a href="http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_bin" target="_blank" rel="noopener">Returns   the number in binary format (see   http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_bin).计算二进制a的STRING类型，a为BIGINT类型</a></td><td>STRING</td></tr><tr><td>hex(BIGINT a) hex(STRING a) hex(BINARY a)</td><td>If the argument is an INT or binary,  hex returns the number  as a STRING in  hexadecimal format. Otherwise if the number is a STRING, it converts each character into its hexadecimal  representation and returns the resulting STRING.  (See<a href="http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_hex" target="_blank" rel="noopener">http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_hex</a>,  BINARY version as of  Hive 0.12.0.)计算十六进制a的STRING类型，如果a为STRING类型就转换成字符相对应的十六进制</td><td>STRING</td></tr><tr><td>unhex(STRING a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2482" target="_blank" rel="noopener">Inverse of hex. Interprets each pair of characters as a   hexadecimal number and converts to the byte representation of the number.   (BINARY version as of Hive 0.12.0, used to return a string.)hex的逆方法</a></td><td>BINARY</td></tr><tr><td>conv(BIGINT num, INT from_base, INT to_base), conv(STRING  num, INT from_base, INT to_base)</td><td><a href="http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_conv" target="_blank" rel="noopener">Converts   a number from a given base to another (see   http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_conv).将GIGINT/STRING类型的num从from_base进制转换成to_base进制</a></td><td>STRING</td></tr><tr><td>abs(DOUBLE a)</td><td>Returns the absolute value.计算a的绝对值</td><td>DOUBLE</td></tr><tr><td>pmod(INT a, INT b), pmod(DOUBLE a, DOUBLE b)</td><td>Returns the positive value of a mod b.a对b取模</td><td>INT or DOUBLE</td></tr><tr><td>sin(DOUBLE a), sin(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the sine of a (a is in radians). Decimal version   added in Hive 0.13.0.求a的正弦值</a></td><td>DOUBLE</td></tr><tr><td>asin(DOUBLE a), asin(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the arc sin of a if -1&lt;=a&lt;=1 or NULL   otherwise. Decimal version added in Hive 0.13.0.求d的反正弦值</a></td><td>DOUBLE</td></tr><tr><td>cos(DOUBLE a), cos(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the cosine of a (a is in radians). Decimal version   added in Hive 0.13.0.求余弦值</a></td><td>DOUBLE</td></tr><tr><td>acos(DOUBLE a), acos(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the arccosine of a if -1&lt;=a&lt;=1 or NULL   otherwise. Decimal version added in Hive 0.13.0.求反余弦值</a></td><td>DOUBLE</td></tr><tr><td>tan(DOUBLE a), tan(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the tangent of a (a is in radians). Decimal version   added in Hive 0.13.0.求正切值</a></td><td>DOUBLE</td></tr><tr><td>atan(DOUBLE a), atan(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Returns the arctangent of a. Decimal version added in Hive   0.13.0.求反正切值</a></td><td>DOUBLE</td></tr><tr><td>degrees(DOUBLE a), degrees(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6385" target="_blank" rel="noopener">Converts value of a from radians to degrees. Decimal version   added in Hive 0.13.0.奖弧度值转换角度值</a></td><td>DOUBLE</td></tr><tr><td>radians(DOUBLE a), radians(DOUBLE a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6327" target="_blank" rel="noopener">Converts value of a from degrees to radians. Decimal version   added in Hive 0.13.0.将角度值转换成弧度值</a></td><td>DOUBLE</td></tr><tr><td>positive(INT a), positive(DOUBLE a)</td><td>Returns a.返回a</td><td>INT or DOUBLE</td></tr><tr><td>negative(INT a), negative(DOUBLE a)</td><td>Returns -a.返回a的相反数</td><td>INT or DOUBLE</td></tr><tr><td>sign(DOUBLE a), sign(DECIMAL a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-6246" target="_blank" rel="noopener">Returns the sign of a as ‘1.0’ (if a is positive) or ‘-1.0’   (if a is negative), ‘0.0’ otherwise. The decimal version returns INT instead   of DOUBLE. Decimal version added in Hive   0.13.0.如果a是正数则返回1.0，是负数则返回-1.0，否则返回0.0</a></td><td>DOUBLE or INT</td></tr><tr><td>e()</td><td>Returns the value of e.数学常数e</td><td>DOUBLE</td></tr><tr><td>pi()</td><td>Returns the value of pi.数学常数pi</td><td>DOUBLE</td></tr><tr><td>factorial(INT a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9857" target="_blank" rel="noopener">Returns the factorial of a (as of Hive 1.2.0). Valid a is   [0..20]. 求a的阶乘</a></td><td>BIGINT</td></tr><tr><td>cbrt(DOUBLE a)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9858" target="_blank" rel="noopener">Returns the cube root of a double value (as of Hive 1.2.0).   求a的立方根</a></td><td>DOUBLE</td></tr><tr><td>shiftleft(TINYINT\</td><td>SMALLINT\</td><td>INT a, INT b)shiftleft(BIGINT a,  INT b)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9859" target="_blank" rel="noopener">Bitwise left shift (as of Hive 1.2.0). Shifts a b positions   to the left.Returns int for tinyint, smallint and int a. Returns bigint for   bigint a.按位左移</a></td><td>INT BIGINT</td></tr><tr><td>shiftright(TINYINT\</td><td>SMALLINT\</td><td>INT a, INTb)shiftright(BIGINT a,  INT b)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9859" target="_blank" rel="noopener">Bitwise right shift (as of Hive 1.2.0). Shifts a b positions   to the right.Returns int for tinyint, smallint and int a. Returns bigint for   bigint a.按拉右移</a></td><td>INTBIGINT</td></tr><tr><td>shiftrightunsigned(TINYINT\</td><td>SMALLINT\</td><td>INTa, INT  b),shiftrightunsigned(BIGINT a, INT b)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9859" target="_blank" rel="noopener">Bitwise unsigned right shift (as of Hive 1.2.0). Shifts a b   positions to the right.Returns int for tinyint, smallint and int a. Returns   bigint for bigint a.无符号按位右移（&lt;&lt;&lt;）</a></td><td>INTBIGINT</td></tr><tr><td>greatest(T v1, T v2, …)</td><td>Returns the greatest value of the list of values (as of Hive 1.1.0). Fixed to return NULL when one or more arguments are  NULL, and strict type restriction relaxed, consistent with “&gt;”  operator (as of Hive 2.0.0). 求最大值</td><td>T</td></tr><tr><td>least(T v1, T v2, …)</td><td>Returns the least value of the list of values (as of Hive 1.1.0). Fixed to return NULL when one or more arguments are  NULL, and strict type restriction relaxed, consistent with “&lt;”  operator (as of Hive 2.0.0). 求最小值</td><td>T</td></tr></tbody></table><h5 id="2-2-集合函数"><a href="#2-2-集合函数" class="headerlink" title="2.2 集合函数"></a>2.2 集合函数</h5><table><thead><tr><th>Name(Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>size(Map&lt;K.V&gt;)</td><td>Returns the number of elements in the map type.求map的长度</td><td>int</td></tr><tr><td>size(Array<t>)</t></td><td>Returns the number of elements in the array type.求数组的长度</td><td>int</td></tr><tr><td>map_keys(Map&lt;K.V&gt;)</td><td>Returns an unordered array containing the keys of the input  map.返回map中的所有key</td><td>array<k></k></td></tr><tr><td>map_values(Map&lt;K.V&gt;)</td><td>Returns an unordered array containing the values of the input  map.返回map中的所有value</td><td>array<v></v></td></tr><tr><td>array_contains(Array<t>, value)</t></td><td>Returns TRUE if the array contains value.如该数组Array包含value返回true。，否则返回false</td><td>boolean</td></tr><tr><td>sort_array(Array<t>)</t></td><td><a href="https://issues.apache.org/jira/browse/HIVE-2279" target="_blank" rel="noopener">Sorts the input array in ascending order according to the   natural ordering of the array elements and returns it (as of version   0.9.0).按自然顺序对数组进行排序并返回</a></td><td>array</td></tr></tbody></table><h5 id="2-3-类型转换函数"><a href="#2-3-类型转换函数" class="headerlink" title="2.3 类型转换函数"></a>2.3 类型转换函数</h5><table><thead><tr><th><em>Name(Signature)</em></th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>binary(string\</td><td>binary)</td><td>Casts the parameter into a binary.将输入的值转换成二进制</td><td>binary</td></tr><tr><td>cast(expr as <type>)</type></td><td>Converts the results of the expression expr to <type>. For example, cast(‘1’ as BIGINT) will convert the  string ‘1’ to its integral representation. A null is returned if the  conversion does not succeed. If cast(expr as boolean) Hive returns true for a  non-empty string.将expr转换成type类型  如：cast(“1” as BIGINT) 将字符串1转换成了BIGINT类型，如果转换失败将返回NULL</type></td><td>Expected  “=” to follow “type”</td></tr></tbody></table><h5 id="2-4-日期函数"><a href="#2-4-日期函数" class="headerlink" title="2.4 日期函数"></a>2.4 日期函数</h5><table><thead><tr><th>Name(Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>from_unixtime(bigint unixtime[, string format])</td><td>Converts the number of seconds from unix epoch (1970-01-01  00:00:00 UTC) to a string representing the timestamp of that moment in the  current system time zone in the format of “1970-01-01 00:00:00”.将时间的秒值转换成format格式（format可为“yyyy-MM-dd hh:mm:ss”,“yyyy-MM-dd  hh”,“yyyy-MM-dd hh:mm”等等）如from_unixtime(1250111000,”yyyy-MM-dd”)  得到2009-03-12</td><td>string</td></tr><tr><td>unix_timestamp()</td><td>Gets current Unix timestamp in seconds.获取本地时区下的时间戳</td><td>bigint</td></tr><tr><td>unix_timestamp(string date)</td><td>Converts time string in format yyyy-MM-dd  HH:mm:ss to Unix timestamp (in seconds), using the  default timezone and the default locale, return 0 if fail:  unix_timestamp(‘2009-03-20 11:30:01’) = 1237573801将格式为yyyy-MM-dd  HH:mm:ss的时间字符串转换成时间戳 如unix_timestamp(‘2009-03-20 11:30:01’) = 1237573801</td><td>bigint</td></tr><tr><td>unix_timestamp(string date, string pattern)</td><td><a href="http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html" target="_blank" rel="noopener">Convert   time string with given pattern (see   [http://docs.oracle.com/javase/tutorial/i18n/format/simpleDateFormat.html])   to Unix time stamp (in seconds), return 0 if fail:   unix_timestamp(‘2009-03-20’, ‘yyyy-MM-dd’) =   1237532400.将指定时间字符串格式字符串转换成Unix时间戳，如果格式不对返回0 如：unix_timestamp(‘2009-03-20’,   ‘yyyy-MM-dd’) = 1237532400</a></td><td>bigint</td></tr><tr><td>to_date(string timestamp)</td><td>Returns the date part of a timestamp string:  to_date(“1970-01-01 00:00:00”) = “1970-01-01”.返回时间字符串的日期部分</td><td>string</td></tr><tr><td>year(string date)</td><td>Returns the year part of a date or a timestamp string:  year(“1970-01-01 00:00:00”) = 1970, year(“1970-01-01”) =  1970.返回时间字符串的年份部分</td><td>int</td></tr><tr><td>quarter(date/timestamp/string)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-3404" target="_blank" rel="noopener">Returns the quarter of the year for a date, timestamp, or   string in the range 1 to 4 (as of Hive 1.3.0). Example: quarter(‘2015-04-08’)   = 2.返回当前时间属性哪个季度 如quarter(‘2015-04-08’) = 2</a></td><td>int</td></tr><tr><td>month(string date)</td><td>Returns the month part of a date or a timestamp string:  month(“1970-11-01 00:00:00”) = 11, month(“1970-11-01”) =  11.返回时间字符串的月份部分</td><td>int</td></tr><tr><td>day(string date) dayofmonth(date)</td><td>Returns the day part of a date or a timestamp string:  day(“1970-11-01 00:00:00”) = 1, day(“1970-11-01”) = 1.返回时间字符串的天</td><td>int</td></tr><tr><td>hour(string date)</td><td>Returns the hour of the timestamp: hour(‘2009-07-30  12:58:59’) = 12, hour(‘12:58:59’) = 12.返回时间字符串的小时</td><td>int</td></tr><tr><td>minute(string date)</td><td>Returns the minute of the timestamp.返回时间字符串的分钟</td><td>int</td></tr><tr><td>second(string date)</td><td>Returns the second of the timestamp.返回时间字符串的秒</td><td>int</td></tr><tr><td>weekofyear(string date)</td><td>Returns the week number of a timestamp string:  weekofyear(“1970-11-01 00:00:00”) = 44,  weekofyear(“1970-11-01”) = 44.返回时间字符串位于一年中的第几个周内  如weekofyear(“1970-11-01 00:00:00”) = 44,  weekofyear(“1970-11-01”) = 44</td><td>int</td></tr><tr><td>datediff(string enddate, string startdate)</td><td>Returns the number of days from startdate to enddate:  datediff(‘2009-03-01’, ‘2009-02-27’) = 2.计算开始时间startdate到结束时间enddate相差的天数</td><td>int</td></tr><tr><td>date_add(string startdate, int days)</td><td>Adds a number of days to startdate: date_add(‘2008-12-31’, 1)  = ‘2009-01-01’.从开始时间startdate加上days</td><td>string</td></tr><tr><td>date_sub(string startdate, int days)</td><td>Subtracts a number of days to startdate:  date_sub(‘2008-12-31’, 1) = ‘2008-12-30’.从开始时间startdate减去days</td><td>string</td></tr><tr><td>from_utc_timestamp(timestamp, string timezone)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2272" target="_blank" rel="noopener">Assumes given timestamp is UTC and converts to given   timezone (as of Hive 0.8.0). For example, from_utc_timestamp(‘1970-01-01   08:00:00’,’PST’) returns 1970-01-01 00:00:00.如果给定的时间戳并非UTC，则将其转化成指定的时区下时间戳</a></td><td>timestamp</td></tr><tr><td>to_utc_timestamp(timestamp, string timezone)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2272" target="_blank" rel="noopener">Assumes given timestamp is in given timezone and converts to   UTC (as of Hive 0.8.0). For example, to_utc_timestamp(‘1970-01-01   00:00:00’,’PST’) returns 1970-01-01 08:00:00.如果给定的时间戳指定的时区下时间戳，则将其转化成UTC下的时间戳</a></td><td>timestamp</td></tr><tr><td>current_date</td><td><a href="https://issues.apache.org/jira/browse/HIVE-5472" target="_blank" rel="noopener">Returns the current date at the start of query evaluation   (as of Hive 1.2.0). All calls of current_date within the same query return   the same value.返回当前时间日期</a></td><td>date</td></tr><tr><td>current_timestamp</td><td><a href="https://issues.apache.org/jira/browse/HIVE-5472" target="_blank" rel="noopener">Returns the current timestamp at the start of query   evaluation (as of Hive 1.2.0). All calls of current_timestamp within the same   query return the same value.返回当前时间戳</a></td><td>timestamp</td></tr><tr><td>add_months(string start_date, int num_months)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9357" target="_blank" rel="noopener">Returns the date that is num_months after start_date (as of   Hive 1.1.0). start_date is a string, date or timestamp. num_months is an   integer. The time part of start_date is ignored. If start_date is the last   day of the month or if the resulting month has fewer days than the day   component of start_date, then the result is the last day of the resulting   month. Otherwise, the result has the same day component as   start_date.返回当前时间下再增加num_months个月的日期</a></td><td>string</td></tr><tr><td>last_day(string date)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9358" target="_blank" rel="noopener">Returns the last day of the month which the date belongs to   (as of Hive 1.1.0). date is a string in the format ‘yyyy-MM-dd HH:mm:ss’ or   ‘yyyy-MM-dd’. The time part of date is   ignored.返回这个月的最后一天的日期，忽略时分秒部分（HH:mm:ss）</a></td><td>string</td></tr><tr><td>next_day(string start_date, string day_of_week)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9520" target="_blank" rel="noopener">Returns the first date which is later than start_date and   named as day_of_week (as of Hive1.2.0). start_date is a   string/date/timestamp. day_of_week is 2 letters, 3 letters or full name of   the day of the week (e.g. Mo, tue, FRIDAY). The time part of start_date is   ignored. Example: next_day(‘2015-01-14’, ‘TU’) =   2015-01-20.返回当前时间的下一个星期X所对应的日期 如：next_day(‘2015-01-14’, ‘TU’) = 2015-01-20   以2015-01-14为开始时间，其下一个星期二所对应的日期为2015-01-20</a></td><td>string</td></tr><tr><td>trunc(string date, string format)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9480" target="_blank" rel="noopener">Returns date truncated to the unit specified by the format   (as of Hive 1.2.0). Supported formats: MONTH/MON/MM, YEAR/YYYY/YY. Example:   trunc(‘2015-03-17’, ‘MM’) = 2015-03-01.返回时间的最开始年份或月份   如trunc(“2016-06-26”,“MM”)=2016-06-01 trunc(“2016-06-26”,“YY”)=2016-01-01   注意所支持的格式为MONTH/MON/MM, YEAR/YYYY/YY</a></td><td>string</td></tr><tr><td>months_between(date1, date2)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9518" target="_blank" rel="noopener">Returns number of months between dates date1 and date2 (as   of Hive 1.2.0). If date1 is later than date2, then the result is positive. If   date1 is earlier than date2, then the result is negative. If date1 and date2   are either the same days of the month or both last days of months, then the   result is always an integer. Otherwise the UDF calculates the fractional   portion of the result based on a 31-day month and considers the difference in   time components date1 and date2. date1 and date2 type can be date, timestamp   or string in the format ‘yyyy-MM-dd’ or ‘yyyy-MM-dd HH:mm:ss’. The result is   rounded to 8 decimal places. Example: months_between(‘1997-02-28 10:30:00’,   ‘1996-10-30’) = 3.94959677**返回date1与date2之间相差的月份，如date1&gt;date2，则返回正，如果date1</a></td><td>double</td></tr><tr><td>date_format(date/timestamp/string ts, string fmt)</td><td>Converts a date/timestamp/string to a value of string in the  format specified by the date format fmt (as of Hive 1.2.0).  Supported formats are Java SimpleDateFormat formats  –<a href="https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html" target="_blank" rel="noopener">https://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a>.  The second argument fmt should be constant. Example:  date_format(‘2015-04-08’, ‘y’) = ‘2015’.date_format can be used to implement  other UDFs, e.g.:dayname(date) is date_format(date, ‘EEEE’)dayofyear(date) is  date_format(date, ‘D’)按指定格式返回时间date  如：date_format(“2016-06-22”,”MM-dd”)=06-22</td><td>string</td></tr></tbody></table><h5 id="2-5-条件函数"><a href="#2-5-条件函数" class="headerlink" title="2.5 条件函数"></a>2.5 条件函数</h5><table><thead><tr><th>Name(Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>if(boolean testCondition, T valueTrue, T valueFalseOrNull)</td><td>Returns valueTrue when testCondition is true, returns  valueFalseOrNull otherwise.如果testCondition  为true就返回valueTrue,否则返回valueFalseOrNull ，（valueTrue，valueFalseOrNull为泛型）</td><td>T</td></tr><tr><td>nvl(T value, T default_value)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2288" target="_blank" rel="noopener">Returns default value if value is null else returns value   (as of HIve 0.11).如果value值为NULL就返回default_value,否则返回value</a></td><td>T</td></tr><tr><td>COALESCE(T v1, T v2, …)</td><td>Returns the first v that is not NULL, or NULL if all v’s are  NULL.返回第一非null的值，如果全部都为NULL就返回NULL 如：COALESCE  (NULL,44,55)=44/strong&gt;</td><td>T</td></tr><tr><td>CASE a WHEN b THEN c [WHEN d THEN e]* [ELSE f] END</td><td>When a = b, returns c; when a = d, returns e; else returns f.如果a=b就返回c,a=d就返回e，否则返回f 如CASE 4 WHEN 5 THEN 5 WHEN 4 THEN 4  ELSE 3 END 将返回4</td><td>T</td></tr><tr><td>CASE WHEN a THEN b [WHEN c THEN d]* [ELSE e] END</td><td>When a = true, returns b; when c = true, returns d; else  returns e.如果a=ture就返回b,c= ture就返回d，否则返回e 如：CASE WHEN  5&gt;0 THEN 5 WHEN 4&gt;0 THEN 4 ELSE 0 END 将返回5；CASE WHEN 5&lt;0 THEN 5 WHEN  4&lt;0 THEN 4 ELSE 0 END 将返回0</td><td>T</td></tr><tr><td>isnull( a )</td><td>Returns true if a is NULL and false otherwise.如果a为null就返回true，否则返回false</td><td>boolean</td></tr><tr><td>isnotnull ( a )</td><td>Returns true if a is not NULL and false otherwise.如果a为非null就返回true，否则返回false</td><td>boolean</td></tr></tbody></table><h5 id="2-6-字符函数"><a href="#2-6-字符函数" class="headerlink" title="2.6 字符函数"></a>2.6 字符函数</h5><table><thead><tr><th>Name(Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>ascii(string str)</td><td>Returns the numeric value of the first character of str.返回str中首个ASCII字符串的整数值</td><td>int</td></tr><tr><td>base64(binary bin)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2482" target="_blank" rel="noopener">Converts the argument from binary to a base 64 string (as of   Hive 0.12.0)..将二进制bin转换成64位的字符串</a></td><td>string</td></tr><tr><td>concat(string\</td><td>binary A, string\</td><td>binary B…)</td><td>Returns the string or bytes resulting from concatenating the  strings or bytes passed in as parameters in order. For example, concat(‘foo’,  ‘bar’) results in ‘foobar’. Note that this function can take any number of  input strings..对二进制字节码或字符串按次序进行拼接</td><td>string</td></tr><tr><td>context_ngrams(array&lt;array<string>&gt;,  array<string>, int K, int pf)</string></string></td><td>Returns the top-k contextual N-grams from a set of tokenized  sentences, given a string of “context”. See StatisticsAndDataMining  for more information..与ngram类似，但context_ngram()允许你预算指定上下文(数组)来去查找子序列，具体看StatisticsAndDataMining(这里的解释更易懂)</td><td>array&lt;struct&lt;string,double&gt;&gt;</td></tr><tr><td>concat_ws(string SEP, string A, string B…)</td><td>Like concat() above, but with custom separator SEP..与concat()类似，但使用指定的分隔符喜进行分隔</td><td>string</td></tr><tr><td>concat_ws(string SEP, array<string>)</string></td><td><a href="https://issues.apache.org/jira/browse/HIVE-2203" target="_blank" rel="noopener">Like concat_ws() above, but taking an array of strings. (as   of Hive 0.9.0).拼接Array中的元素并用指定分隔符进行分隔</a></td><td>string</td></tr><tr><td>decode(binary bin, string charset)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2482" target="_blank" rel="noopener">Decodes the first argument into a String using the provided   character set (one of ‘US-ASCII’, ‘ISO-8859-1’, ‘UTF-8’, ‘UTF-16BE’,   ‘UTF-16LE’, ‘UTF-16’). If either argument is null, the result will also be   null. (As of Hive 0.12.0.).使用指定的字符集charset将二进制值bin解码成字符串，支持的字符集有：’US-ASCII’,   ‘ISO-8859-1’, ‘UTF-8’, ‘UTF-16BE’, ‘UTF-16LE’, ‘UTF-16’，如果任意输入参数为NULL都将返回NULL</a></td><td>string</td></tr><tr><td>encode(string src, string charset)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2482" target="_blank" rel="noopener">Encodes the first argument into a BINARY using the provided   character set (one of ‘US-ASCII’, ‘ISO-8859-1’, ‘UTF-8’, ‘UTF-16BE’,   ‘UTF-16LE’, ‘UTF-16’). If either argument is null, the result will also be   null. (As of Hive 0.12.0.).使用指定的字符集charset将字符串编码成二进制值，支持的字符集有：’US-ASCII’,   ‘ISO-8859-1’, ‘UTF-8’, ‘UTF-16BE’, ‘UTF-16LE’, ‘UTF-16’，如果任一输入参数为NULL都将返回NULL</a></td><td>binary</td></tr><tr><td>find_in_set(string str, string strList)</td><td>Returns the first occurance of str in strList where strList  is a comma-delimited string. Returns null if either argument is null. Returns  0 if the first argument contains any commas. For example, find_in_set(‘ab’,  ‘abc,b,ab,c,def’) returns 3..返回以逗号分隔的字符串中str出现的位置，如果参数str为逗号或查找失败将返回0，如果任一参数为NULL将返回NULL回</td><td>int</td></tr><tr><td>format_number(number x, int d)</td><td>Formats the number X to a format like ‘#,###,###.##’, rounded  to D decimal places, and returns the result as a string. If D is 0, the  result has no decimal point or fractional part. (As of Hive 0.10.0; bug with float types fixed in Hive 0.14.0, decimal type  support added in Hive 0.14.0).将数值X转换成”#,###,###.##”格式字符串，并保留d位小数，如果d为0，将进行四舍五入且不保留小数</td><td>string</td></tr><tr><td>get_json_object(string json_string, string path)</td><td>Extracts json object from a json string based on json path  specified, and returns json string of the extracted json object. It will  return null if the input json string is invalid. NOTE:  The json path can only have the characters [0-9a-z_], i.e., no upper-case or  special characters. Also, the keys <em>cannot start with numbers.</em> This is due to restrictions on Hive column names..从指定路径上的JSON字符串抽取出JSON对象，并返回这个对象的JSON格式，如果输入的JSON是非法的将返回NULL,注意此路径上JSON字符串只能由数字  字母 下划线组成且不能有大写字母和特殊字符，且key不能由数字开头，这是由于Hive对列名的限制</td><td>string</td></tr><tr><td>in_file(string str, string filename)</td><td>Returns true if the string str appears as an entire line in  filename..如果文件名为filename的文件中有一行数据与字符串str匹配成功就返回true</td><td>boolean</td></tr><tr><td>instr(string str, string substr)</td><td>Returns the position of the first occurrence of substr in str. Returns null if either of the arguments are null and returns 0 if substr  could not be found in str.  Be aware that this is not zero based. The first character in str has index 1..查找字符串str中子字符串substr出现的位置，如果查找失败将返回0，如果任一参数为Null将返回null，注意位置为从1开始的</td><td>int</td></tr><tr><td>length(string A)</td><td>Returns the length of the string..返回字符串的长度</td><td>int</td></tr><tr><td>locate(string substr, string str[, int pos])</td><td>Returns the position of the first occurrence of substr in str  after position pos..查找字符串str中的pos位置后字符串substr第一次出现的位置</td><td>int</td></tr><tr><td>lower(string A) lcase(string A)</td><td>Returns the string resulting from converting all characters  of B to lower case. For example, lower(‘fOoBaR’) results in ‘foobar’..将字符串A的所有字母转换成小写字母</td><td>string</td></tr><tr><td>lpad(string str, int len, string pad)</td><td>Returns str, left-padded with pad to a length of len..从左边开始对字符串str使用字符串pad填充，最终len长度为止，如果字符串str本身长度比len大的话，将去掉多余的部分</td><td>string</td></tr><tr><td>ltrim(string A)</td><td>Returns the string resulting from trimming spaces from the  beginning(left hand side) of A. For example, ltrim(‘ foobar ‘) results in  ‘foobar ‘..去掉字符串A前面的空格</td><td>string</td></tr><tr><td>ngrams(array&lt;array<string>&gt;,  int N, int K, int pf)</string></td><td>Returns the top-k N-grams from a set of tokenized sentences,  such as those returned by the sentences() UDAF. See StatisticsAndDataMining  for more information..返回出现次数TOP  K的的子序列,n表示子序列的长度，具体看StatisticsAndDataMining (这里的解释更易懂)</td><td>array&lt;struct&lt;string,double&gt;&gt;</td></tr><tr><td>parse_url(string urlString, string partToExtract [, string  keyToExtract])</td><td>Returns the specified part from the URL. Valid values for  partToExtract include HOST, PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, and  USERINFO. For example, parse_url(‘<a href="http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;" target="_blank" rel="noopener">http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;</a>,  ‘HOST’) returns ‘facebook.com’. Also a value of a particular key in QUERY can  be extracted by providing the key as the third argument, for example,  parse_url(‘<a href="http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;" target="_blank" rel="noopener">http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;</a>, ‘QUERY’,  ‘k1’) returns ‘v1’..返回从URL中抽取指定部分的内容，参数url是URL字符串，而参数partToExtract是要抽取的部分，这个参数包含(HOST,  PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, and  USERINFO,例如：parse_url(‘<a href="http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;" target="_blank" rel="noopener">http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;</a>,  ‘HOST’) =’facebook.com’，如果参数partToExtract值为QUERY则必须指定第三个参数key  如：parse_url(‘<a href="http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;" target="_blank" rel="noopener">http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1&#39;</a>, ‘QUERY’,  ‘k1’) =‘v1’</td><td>string</td></tr><tr><td>printf(String format, Obj… args)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2695" target="_blank" rel="noopener">Returns the input formatted according do printf-style format   strings (as of Hive0.9.0)..按照printf风格格式输出字符串</a></td><td>string</td></tr><tr><td>regexp_extract(string subject, string pattern, int index)</td><td>Returns the string extracted using the pattern. For example,  regexp_extract(‘foothebar’, ‘foo(.*?)(bar)’, 2) returns ‘bar.’ Note that some  care is necessary in using predefined character classes: using ‘\s’ as the  second argument will match the letter s; ‘\s’ is  necessary to match whitespace, etc. The ‘index’ parameter is the Java regex  Matcher group() method index. See docs/api/java/util/regex/Matcher.html for  more information on the ‘index’ or Java regex group() method..抽取字符串subject中符合正则表达式pattern的第index个部分的子字符串，注意些预定义字符的使用，如第二个参数如果使用’\s’将被匹配到s,’\s’才是匹配空格</td><td>string</td></tr><tr><td>regexp_replace(string INITIAL_STRING, string PATTERN, string  REPLACEMENT)</td><td>Returns the string resulting from replacing all substrings in  INITIAL_STRING that match the java regular expression syntax defined in  PATTERN with instances of REPLACEMENT. For example,  regexp_replace(“foobar”, “oo\</td><td>ar”, “”) returns  ‘fb.’ Note that some care is necessary in using predefined character classes:  using ‘\s’ as the second argument will match the letter s; ‘\s’ is necessary to match whitespace, etc..按照Java正则表达式PATTERN将字符串INTIAL_STRING中符合条件的部分成REPLACEMENT所指定的字符串，如里REPLACEMENT这空的话，抽符合正则的部分将被去掉  如：regexp_replace(“foobar”, “oo\</td><td>ar”, “”) = ‘fb.’  注意些预定义字符的使用，如第二个参数如果使用’\s’将被匹配到s,’\s’才是匹配空格</td><td>string</td></tr><tr><td>repeat(string str, int n)</td><td>Repeats str n times..重复输出n次字符串str</td><td>string</td></tr><tr><td>reverse(string A)</td><td>Returns the reversed string..反转字符串</td><td>string</td></tr><tr><td>rpad(string str, int len, string pad)</td><td>Returns str, right-padded with pad to a length of len..从右边开始对字符串str使用字符串pad填充，最终len长度为止，如果字符串str本身长度比len大的话，将去掉多余的部分</td><td>string</td></tr><tr><td>rtrim(string A)</td><td>Returns the string resulting from trimming spaces from the  end(right hand side) of A. For example, rtrim(‘ foobar ‘) results in ‘  foobar’..去掉字符串后面出现的空格</td><td>string</td></tr><tr><td>sentences(string str, string lang, string locale)</td><td>Tokenizes a string of natural language text into words and  sentences, where each sentence is broken at the appropriate sentence boundary  and returned as an array of words. The ‘lang’ and ‘locale’ are optional  arguments. For example, sentences(‘Hello there! How are you?’) returns (  (“Hello”, “there”), (“How”, “are”,  “you”) )..字符串str将被转换成单词数组，如：sentences(‘Hello  there! How are you?’) =( (“Hello”, “there”),  (“How”, “are”, “you”) )</td><td>array&lt;array<string>&gt;</string></td></tr><tr><td>space(int n)</td><td>Returns a string of n spaces..返回n个空格</td><td>string</td></tr><tr><td>split(string str, string pat)</td><td>Splits str around pat (pat is a regular expression)..按照正则表达式pat来分割字符串str,并将分割后的数组字符串的形式返回</td><td>array</td></tr><tr><td>str_to_map(text[, delimiter1, delimiter2])</td><td>Splits text into key-value pairs using two delimiters.  Delimiter1 separates text into K-V pairs, and Delimiter2 splits each K-V  pair. Default delimiters are ‘,’ for delimiter1 and ‘=’ for delimiter2..将字符串str按照指定分隔符转换成Map，第一个参数是需要转换字符串，第二个参数是键值对之间的分隔符，默认为逗号;第三个参数是键值之间的分隔符，默认为”=”</td><td>map&lt;string,string&gt;</td></tr><tr><td>substr(string\</td><td>binary A, int start) substring(string\</td><td>binary A,  int start)</td><td><a href="http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr" target="_blank" rel="noopener">Returns   the substring or slice of the byte array of A starting from start position   till the end of string A. For example, substr(‘foobar’, 4) results in ‘bar’   (see   [http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr])..对于字符串A,从start位置开始截取字符串并返回</a></td><td>string</td></tr><tr><td>substr(string\</td><td>binary A, int start, int len)  substring(string\</td><td>binary A, int start, int len)</td><td><a href="http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr" target="_blank" rel="noopener">Returns   the substring or slice of the byte array of A starting from start position   with length len. For example, substr(‘foobar’, 4, 1) results in ‘b’ (see   [http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_substr])..对于二进制/字符串A,从start位置开始截取长度为length的字符串并返回</a></td><td>string</td></tr><tr><td>substring_index(string A, string delim, int count)</td><td>Returns the substring from string A before count occurrences  of the delimiter delim (as of Hive 1.3.0). If count is  positive, everything to the left of the final delimiter (counting from the  left) is returned. If count is negative, everything to the right of the final  delimiter (counting from the right) is returned. Substring_index performs a  case-sensitive match when searching for delim. Example:  substring_index(‘<a href="http://www.apache.org&#39;" target="_blank" rel="noopener">www.apache.org&#39;</a>, ‘.’, 2) = ‘<a href="http://www.apache&#39;..截取第count分隔符之前的字符串，如count为正则从左边开始截取，如果为负则从右边开始截取" target="_blank" rel="noopener">www.apache&#39;..截取第count分隔符之前的字符串，如count为正则从左边开始截取，如果为负则从右边开始截取</a></td><td>string</td></tr><tr><td>translate(string\</td><td>char\</td><td>varchar input, string\</td><td>char\</td><td>varchar  from, string\</td><td>char\</td><td>varchar to)</td><td>Translates the input string by replacing the characters  present in the from string  with the corresponding characters in the to string. This is similar to the translatefunction in PostgreSQL. If any of the parameters to this UDF  are NULL, the result is NULL as well. (Available as of Hive 0.10.0, for  string types)Char/varchar support added as of Hive 0.14.0..将input出现在from中的字符串替换成to中的字符串  如：translate(“MOBIN”,”BIN”,”M”)=”MOM”</td><td>string</td></tr><tr><td>trim(string A)</td><td>Returns the string resulting from trimming spaces from both  ends of A. For example, trim(‘ foobar ‘) results in ‘foobar’.将字符串A前后出现的空格去掉</td><td>string</td></tr><tr><td>unbase64(string str)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-2482" target="_blank" rel="noopener">Converts the argument from a base 64 string to BINARY. (As   of Hive 0.12.0.).将64位的字符串转换二进制值</a></td><td>binary</td></tr><tr><td>upper(string A) ucase(string A)</td><td>Returns the string resulting from converting all characters  of A to upper case. For example, upper(‘fOoBaR’) results in ‘FOOBAR’..将字符串A中的字母转换成大写字母</td><td>string</td></tr><tr><td>initcap(string A)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-3405" target="_blank" rel="noopener">Returns string, with the first letter of each word in   uppercase, all other letters in lowercase. Words are delimited by whitespace.   (As of Hive 1.1.0.).将字符串A转换第一个字母大写其余字母的字符串</a></td><td>string</td></tr><tr><td>levenshtein(string A, string B)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9556" target="_blank" rel="noopener">Returns the Levenshtein distance between two strings (as of   Hive 1.2.0). For example, levenshtein(‘kitten’, ‘sitting’) results in   3..计算两个字符串之间的差异大小 如：levenshtein(‘kitten’, ‘sitting’) = 3</a></td><td>int</td></tr><tr><td>soundex(string A)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-9738" target="_blank" rel="noopener">Returns soundex code of the string (as of Hive 1.2.0). For   example, soundex(‘Miller’) results in M460..将普通字符串转换成soundex字符串</a></td><td>string</td></tr></tbody></table><h5 id="2-7-聚合函数"><a href="#2-7-聚合函数" class="headerlink" title="2.7 聚合函数"></a>2.7 聚合函数</h5><table><thead><tr><th>Name(Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>count(*), count(expr), count(DISTINCT expr[, expr…])</td><td><a href="https://cwiki.apache.org/confluence/display/Hive/Configuration+Properties#ConfigurationProperties-hive.optimize.distinct.rewrite" target="_blank" rel="noopener">count(*) - Returns the total number of retrieved rows,   including rows containing NULL values.统计总行数，包括含有NULL值的行count(expr) - Returns   the number of rows for which the supplied expression is   non-NULL.统计提供非NULL的expr表达式值的行数count(DISTINCT expr[, expr]) - Returns the   number of rows for which the supplied expression(s) are unique and non-NULL.   Execution of this can be optimized with   hive.optimize.distinct.rewrite.统计提供非NULL且去重后的expr表达式值的行数</a></td><td>BIGINT</td></tr><tr><td>sum(col), sum(DISTINCT col)</td><td>Returns the sum of the elements in the group or the sum of  the distinct values of the column in the group.sum(col),表示求指定列的和，sum(DISTINCT  col)表示求去重后的列的和</td><td>DOUBLE</td></tr><tr><td>avg(col), avg(DISTINCT col)</td><td>Returns the average of the elements in the group or the  average of the distinct values of the column in the group.avg(col),表示求指定列的平均值，avg(DISTINCT  col)表示求去重后的列的平均值</td><td>DOUBLE</td></tr><tr><td>min(col)</td><td>Returns the minimum of the column in the group.求指定列的最小值</td><td>DOUBLE</td></tr><tr><td>max(col)</td><td>Returns the maximum value of the column in the group.求指定列的最大值</td><td>DOUBLE</td></tr><tr><td>variance(col), var_pop(col)</td><td>Returns the variance of a numeric column in the group.求指定列数值的方差</td><td>DOUBLE</td></tr><tr><td>var_samp(col)</td><td>Returns the unbiased sample variance of a numeric column in  the group.求指定列数值的样本方差</td><td>DOUBLE</td></tr><tr><td>stddev_pop(col)</td><td>Returns the standard deviation of a numeric column in the  group.求指定列数值的标准偏差</td><td>DOUBLE</td></tr><tr><td>stddev_samp(col)</td><td>Returns the unbiased sample standard deviation of a numeric  column in the group.求指定列数值的样本标准偏差</td><td>DOUBLE</td></tr><tr><td>covar_pop(col1, col2)</td><td>Returns the population covariance of a pair of numeric  columns in the group.求指定列数值的协方差</td><td>DOUBLE</td></tr><tr><td>covar_samp(col1, col2)</td><td>Returns the sample covariance of a pair of a numeric columns  in the group.求指定列数值的样本协方差</td><td>DOUBLE</td></tr><tr><td>corr(col1, col2)</td><td>Returns the Pearson coefficient of correlation of a pair of a  numeric columns in the group.返回两列数值的相关系数</td><td>DOUBLE</td></tr><tr><td>percentile(BIGINT col, p)</td><td>Returns the exact pth percentile of a column in the group  (does not work with floating point types). p must be between 0 and 1. NOTE: A  true percentile can only be computed for integer values. Use  PERCENTILE_APPROX if your input is non-integral.返回col的p%分位数</td><td>DOUBLE</td></tr></tbody></table><h5 id="2-8-表生成函数"><a href="#2-8-表生成函数" class="headerlink" title="2.8 表生成函数"></a>2.8 表生成函数</h5><table><thead><tr><th>Name(Signature)</th><th>Description</th><th>Return  Type</th></tr></thead><tbody><tr><td>explode(array<type> a)</type></td><td>For each element in a, generates a row containing that  element.对于a中的每个元素，将生成一行且包含该元素</td><td>Array Type</td></tr><tr><td>explode(ARRAY)</td><td>Returns one row for each element from the array..每行对应数组中的一个元素</td><td>N rows</td></tr><tr><td>explode(MAP)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-1735" target="_blank" rel="noopener">Returns one row for each key-value pair from the input map   with two columns in each row: one for the key and another for the value. (As   of Hive 0.8.0.).每行对应每个map键-值，其中一个字段是map的键，另一个字段是map的值</a></td><td>N rows</td></tr><tr><td>posexplode(ARRAY)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-4943" target="_blank" rel="noopener">Behaves like explode for arrays, but includes the position   of items in the original array by returning a tuple of (pos, value). (As of   Hive 0.13.0.).与explode类似，不同的是还返回各元素在数组中的位置</a></td><td>N rows</td></tr><tr><td>stack(INT n, v_1, v_2, …, v_k)</td><td>Breaks up v_1, …, v_k into n rows. Each row will have k/n  columns. n must be constant..把M列转换成N行，每行有M/N个字段，其中n必须是个常数</td><td>N rows</td></tr><tr><td>json_tuple(jsonStr, k1, k2, …)</td><td>Takes a set of names (keys) and a JSON string, and returns a  tuple of values. This is a more efficient version of the get_json_object UDF because it can get multiple keys with just one call..从一个JSON字符串中获取多个键并作为一个元组返回，与get_json_object不同的是此函数能一次获取多个键值</td><td>tuple</td></tr><tr><td>parse_url_tuple(url, p1, p2, …)</td><td>This is similar to the parse_url() UDF but can extract multiple parts at once out of a URL. Valid  part names are: HOST, PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, USERINFO,  QUERY:<key>..返回从URL中抽取指定N部分的内容，参数url是URL字符串，而参数p1,p2,….是要抽取的部分，这个参数包含HOST,  PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, USERINFO, QUERY:</key></td><td>tuple</td></tr><tr><td>inline(ARRAY&lt;STRUCT[,STRUCT]&gt;)</td><td><a href="https://issues.apache.org/jira/browse/HIVE-3238" target="_blank" rel="noopener">Explodes an array of structs into a table. (As of Hive   0.10.).将结构体数组提取出来并插入到表中</a></td></tr></tbody></table><h4 id="3-加载数据"><a href="#3-加载数据" class="headerlink" title="3.加载数据"></a>3.加载数据</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># array</span><br><span class="line">create table person(name string,work_locations array&lt;string&gt;)</span><br><span class="line">ROW FORMAT DELIMITED</span><br><span class="line">FIELDS TERMINATED BY &apos;\t&apos;</span><br><span class="line">COLLECTION ITEMS TERMINATED BY &apos;,&apos;;</span><br><span class="line"># 数据</span><br><span class="line">biansutao beijing,shanghai,tianjin,hangzhou</span><br><span class="line">linan changchu,chengdu,wuhan</span><br><span class="line"># 入库数据</span><br><span class="line">LOAD DATA LOCAL INPATH &apos;/home/hadoop/person.txt&apos; OVERWRITE INTO TABLE person;</span><br><span class="line">select * from person;</span><br><span class="line"># biansutao       [&quot;beijing&quot;,&quot;shanghai&quot;,&quot;tianjin&quot;,&quot;hangzhou&quot;]</span><br><span class="line"># linan           [&quot;changchu&quot;,&quot;chengdu&quot;,&quot;wuhan&quot;]</span><br><span class="line"></span><br><span class="line"># map</span><br><span class="line">create table score(name string, score map&lt;string,int&gt;)</span><br><span class="line">ROW FORMAT DELIMITED</span><br><span class="line">FIELDS TERMINATED BY &apos;\t&apos;</span><br><span class="line">COLLECTION ITEMS TERMINATED BY &apos;,&apos;</span><br><span class="line">MAP KEYS TERMINATED BY &apos;:&apos;;</span><br><span class="line"># 数据</span><br><span class="line">biansutao &apos;数学&apos;:80,&apos;语文&apos;:89,&apos;英语&apos;:95</span><br><span class="line">jobs &apos;语文&apos;:60,&apos;数学&apos;:80,&apos;英语&apos;:99</span><br><span class="line"># 入库数据</span><br><span class="line">LOAD DATA LOCAL INPATH &apos;/home/hadoop/score.txt&apos; OVERWRITE INTO TABLE score;</span><br><span class="line">select * from score;</span><br><span class="line"># biansutao       &#123;&quot;数学&quot;:80,&quot;语文&quot;:89,&quot;英语&quot;:95&#125;</span><br><span class="line"># jobs            &#123;&quot;语文&quot;:60,&quot;数学&quot;:80,&quot;英语&quot;:99&#125;</span><br><span class="line"></span><br><span class="line"># struct</span><br><span class="line">CREATE TABLE test(id int,course struct&lt;course:string,score:int&gt;)</span><br><span class="line">ROW FORMAT DELIMITED</span><br><span class="line">FIELDS TERMINATED BY &apos;\t&apos;</span><br><span class="line">COLLECTION ITEMS TERMINATED BY &apos;,&apos;;</span><br><span class="line"># 数据</span><br><span class="line">1 english,80</span><br><span class="line">2 math,89</span><br><span class="line">3 chinese,95</span><br><span class="line"># 入库</span><br><span class="line">LOAD DATA LOCAL INPATH &apos;/home/hadoop/test.txt&apos; OVERWRITE INTO TABLE test;</span><br><span class="line"># 查询</span><br><span class="line">select * from test;</span><br><span class="line"># 1       &#123;&quot;course&quot;:&quot;english&quot;,&quot;score&quot;:80&#125;</span><br><span class="line"># 2       &#123;&quot;course&quot;:&quot;math&quot;,&quot;score&quot;:89&#125;</span><br><span class="line"># 3       &#123;&quot;course&quot;:&quot;chinese&quot;,&quot;score&quot;:95&#125;</span><br></pre></td></tr></table></figure><h4 id="4-配置优化"><a href="#4-配置优化" class="headerlink" title="4.配置优化"></a>4.配置优化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># 开启任务并行执行</span><br><span class="line">set hive.exec.parallel=true</span><br><span class="line"># 设置运行内存</span><br><span class="line">set mapreduce.map.memory.mb=1024;</span><br><span class="line">set mapreduce.reduce.memory.mb=1024;</span><br><span class="line"># 指定队列</span><br><span class="line">set mapreduce.job.queuename=jppkg_high;</span><br><span class="line"># 动态分区，为了防止一个reduce处理写入一个分区导致速度严重降低，下面需设置为false</span><br><span class="line"># 默认为true</span><br><span class="line">set hive.optimize.sort.dynamic.partition=false;</span><br><span class="line"># 设置变量</span><br><span class="line">set hivevar:factor_timedecay=-0.3;</span><br><span class="line">set hivevar:pre_month=$&#123;zdt.addDay(-30).format(&quot;yyyy-MM-dd&quot;)&#125;;</span><br><span class="line">set hivevar:pre_date=$&#123;zdt.addDay(-1).format(&quot;yyyy-MM-dd&quot;)&#125;;</span><br><span class="line">set hivevar:cur_date=$&#123;zdt.format(&quot;yyyy-MM-dd&quot;)&#125;;</span><br><span class="line"># 添加第三方jar包, 添加临时函数</span><br><span class="line">add jar ***.jar;</span><br><span class="line"># 压缩输出，ORC默认自带压缩，不需要额外指定,如果使用非ORCFile,则设置如下</span><br><span class="line">hive.exec.compress.output=true</span><br><span class="line"># 如果一个大文件可以拆分，为防止一个Map读取过大的数据，拖慢整体流程，需设置</span><br><span class="line">hive.hadoop.suports.splittable.combineinputformat</span><br><span class="line"># 避免因数据倾斜造成的计算效率，默认false</span><br><span class="line">hive.groupby.skewindata</span><br><span class="line"># 避免因join引起的数据倾斜</span><br><span class="line">hive.optimize.skewjoin</span><br><span class="line"># map中会做部分聚集操作，效率高，但需要更多内存</span><br><span class="line">hive.map.aggr   -- 默认打开</span><br><span class="line">hive.groupby.mapaggr.checkinterval  -- 在Map端进行聚合操作的条目数目</span><br><span class="line"># 当多个group by语句有相同的分组列，则会优化为一个MR任务。默认关闭。</span><br><span class="line">hive.multigroupby.singlemr</span><br><span class="line"># 自动使用索引，默认不开启，需配合row group index，可以提高计算速度</span><br><span class="line">hive.optimize.index.filter</span><br></pre></td></tr></table></figure><h4 id="5-常用技巧"><a href="#5-常用技巧" class="headerlink" title="5. 常用技巧"></a>5. 常用技巧</h4><ul><li>1.插入中文数据</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into temp.tbl_test  PARTITION(ymd=&apos;2019-06-19&apos;) select decode(binary(&apos;李白&apos;),&apos;utf-8&apos;);</span><br></pre></td></tr></table></figure><ul><li>2.更新数据</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert overwrite table temp.tbl_test  values (&apos;1&apos;,&apos;2&apos;,&apos;3&apos;);</span><br></pre></td></tr></table></figure><ul><li>3.按照分隔符拆分某个列返回多条 一条转多条</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select  new_column_name from tbl_test lateral view explode(split(column_list_name,&apos;拆分符号&apos;))  as new_column_name;</span><br></pre></td></tr></table></figure><ul><li>4.将分组中多条的某列的值转为一条的一个数组返回</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-- column_name字段不去重</span><br><span class="line">select username, collect_set(column_name) as new_column_list_name from tbl_test group by username;</span><br><span class="line">-- column_name字段去重</span><br><span class="line">select username, collect_list(column_name) as new_column_list_name from tbl_test group by username;</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> hive </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（六）Hadoop的部署</title>
      <link href="/2019/09/15/%E5%A4%A7%E6%95%B0%E6%8D%AE06/"/>
      <url>/2019/09/15/%E5%A4%A7%E6%95%B0%E6%8D%AE06/</url>
      <content type="html"><![CDATA[<p>本文章主要介绍在centos环境下如何安装Hadoop。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="下载并安装Hadoop"><a href="#下载并安装Hadoop" class="headerlink" title="下载并安装Hadoop"></a>下载并安装Hadoop</h3><ul><li>1.使用以下命令添加Hadoop系统用户<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo addgroup hadoop <span class="comment"># 新建用户组   </span></span><br><span class="line">sudo adduser --ingroup hadoop hadoop <span class="comment"># 新建用户</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>注意：</strong>出现这个报错”hadoop is not in the sudoers file. This incident will be reported.”,可以通过以root用户身份登录解决此错误</p><ul><li>2.配置SSH<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su - hadoop <span class="comment"># 切换用户</span></span><br><span class="line">ssh-keygen -t rsa -P <span class="string">""</span> <span class="comment"># 创建一个新密钥</span></span><br><span class="line">cat <span class="variable">$HOME</span>/.ssh/id_rsa.pub &gt;&gt; <span class="variable">$HOME</span>/.ssh/authorized_keys <span class="comment"># 启用密钥</span></span><br><span class="line">ssh localhost <span class="comment"># 测试是否可用</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>注意：</strong>出现 openssh-server没安装的错误，请使用下面命令安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum openssh-server</span><br></pre></td></tr></table></figure></p><ul><li><p>3.下载Hadoop</p><ul><li><p>3.1 点击<a href="http://apache.org/dyn/closer.cgi/hadoop/core" target="_blank" rel="noopener">Hadoop</a>链接,再点击镜像地址<br><img src="/image/大数据06/大数据06_001.png" alt=""></p></li><li><p>3.2 选择稳定版本<br><img src="/image/大数据06/大数据06_002.png" alt=""></p></li><li><p>3.3 选择tar.gz文件（文件名没有’src’）<br><img src="/image/大数据06/大数据06_003.png" alt=""></p></li></ul></li><li><p>4.放到服务器解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo tar xzf hadoop-3.2.1.tar.gz -C /hadoop/install <span class="comment"># 解压</span></span><br><span class="line"><span class="built_in">cd</span> /hadoop/install</span><br><span class="line">sudo mv hadoop-3.2.1 hadoop <span class="comment"># 修改文件名</span></span><br><span class="line">sudo chown -R hadoop:hadoop hadoop <span class="comment"># 目录增加用户权限</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="配置Hadoop"><a href="#配置Hadoop" class="headerlink" title="配置Hadoop"></a>配置Hadoop</h3><h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> HADOOP_HOME=&lt;Hadoop的安装路径&gt; <span class="comment"># 设置HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=&lt;Java的安装路径&gt; <span class="comment"># 设置JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin <span class="comment"># 将Hadoop的bin目录添加到PATH</span></span><br><span class="line">. ~/.bashrc <span class="comment"># 环境下应用该配置</span></span><br></pre></td></tr></table></figure><h4 id="配置-HDFS"><a href="#配置-HDFS" class="headerlink" title="配置 HDFS"></a>配置 <strong>HDFS</strong></h4><h5 id="配置环境变量-1"><a href="#配置环境变量-1" class="headerlink" title="配置环境变量"></a>配置环境变量</h5><p>在 <strong>$HADOOP_HOME/etc/hadoop/hadoop-env.sh</strong> 设置 <strong>JAVA_HOME</strong></p><p>配置前：<br><img src="/image/大数据06/大数据06_004.png" alt=""></p><p>配置后：<br><img src="/image/大数据06/大数据06_005.png" alt=""></p><h5 id="配置核心组件文件"><a href="#配置核心组件文件" class="headerlink" title="配置核心组件文件"></a>配置核心组件文件</h5><p><strong>$HADOOP_HOME/etc/hadoop/core-site.xml</strong> 中有两个参数</p><ul><li><strong>hadoop.tmp.dir -</strong>  用于Hadoop的存储数据文件的目录 </li><li><p><strong>fs.default.name -</strong> 指定默认的文件系统 </p></li><li><p>1.打开文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit <span class="variable">$HADOOP_HOME</span>/etc/hadoop/core-site.xml</span><br></pre></td></tr></table></figure></li><li><p>2.复制下面配置到 文件内容的 <code>&lt;configuration&gt;</code> 和 <code>&lt;/configuration&gt;</code> 之间</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/hadoop/install/hadoop/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>Parent directory for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS <span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:54310<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>The name of the default file system. <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/大数据06/大数据06_006.png" alt=""></p><ul><li>3.移动到目录 <strong>$HADOOP_HOME/etc/hadoop</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p &lt;以上设置中使用的目录路径&gt;</span><br></pre></td></tr></table></figure><ul><li>4.授权目录权限</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R hadoop:hadoop &lt;在上一步中创建的目录路径&gt;</span><br><span class="line">sudo chmod 750 &lt;在上一步中创建的目录路径&gt;</span><br></pre></td></tr></table></figure><h5 id="配置文件系统"><a href="#配置文件系统" class="headerlink" title="配置文件系统"></a>配置文件系统</h5><ul><li><p>1.打开文件 $HADOOP_HOME/etc/hadoop/hdfs-site.xml </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit <span class="variable">$HADOOP_HOME</span>/etc/hadoop/hdfs-site.xml</span><br></pre></td></tr></table></figure></li><li><p>2.复制下面配置到 文件内容的 <code>&lt;configuration&gt;</code> 和 <code>&lt;/configuration&gt;</code> 之间</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>Default block replication.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>/hadoop/install/hadoop/hdfs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/大数据06/大数据06_008.png" alt=""></p><ul><li>3.创建以上设置中指定的目录并授权<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir -p /hadoop/install/hadoop/hdfs</span><br><span class="line">sudo chown -R hadoop:hadoop /hadoop/install/hadoop/hdfs</span><br><span class="line">sudo chmod 750 /hadoop/install/hadoop/hdfs</span><br></pre></td></tr></table></figure></li></ul><h4 id="配置-Map-Reduce"><a href="#配置-Map-Reduce" class="headerlink" title="配置 Map Reduce"></a>配置 <strong>Map Reduce</strong></h4><h5 id="配置环境变量-2"><a href="#配置环境变量-2" class="headerlink" title="配置环境变量"></a>配置环境变量</h5><ul><li><p>1.设置HADOOP_HOME路径</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/profile.d/hadoop.sh <span class="comment"># 打开文件</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=&lt;Hadoop的安装路径&gt; <span class="comment"># 增加设置环境变量命令</span></span><br><span class="line">sudo chmod +x /etc/profile.d/hadoop.sh <span class="comment"># 脚本增加执行权限</span></span><br></pre></td></tr></table></figure></li><li><p>2.增加脚本权限，并退出终端界面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x /etc/profile.d/hadoop.sh <span class="comment"># 脚本增加执行权限</span></span><br><span class="line"><span class="comment"># 重新登陆使用命令验证变量设置是否生效</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$HADOOP_HOME</span></span><br></pre></td></tr></table></figure></li></ul><h5 id="配置MapReduce计算框架文件"><a href="#配置MapReduce计算框架文件" class="headerlink" title="配置MapReduce计算框架文件"></a>配置MapReduce计算框架文件</h5><ul><li><p>1.复制文件 <strong>mapred-site.xml</strong> 并打开</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp <span class="variable">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml.template <span class="variable">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml</span><br><span class="line">sudo gedit <span class="variable">$HADOOP_HOME</span>/etc/hadoop/mapred-site.xml</span><br></pre></td></tr></table></figure></li><li><p>2.复制下面配置到 文件内容的 <code>&lt;configuration&gt;</code> 和 <code>&lt;/configuration&gt;</code> 之间</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobtracker.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">value</span>&gt;</span>master:54311<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>MapReduce job tracker runs at this host and port.</span><br><span class="line"><span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/大数据06/大数据06_007.png" alt=""></p><h4 id="配置-yarn-site-xml-文件"><a href="#配置-yarn-site-xml-文件" class="headerlink" title="配置 yarn-site.xml 文件"></a>配置 yarn-site.xml 文件</h4><ul><li><p>1.打开文件 $HADOOP_HOME/etc/hadoop/yarn-site.xml</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit <span class="variable">$HADOOP_HOME</span>/etc/hadoop/yarn-site.xml</span><br></pre></td></tr></table></figure></li><li><p>2.复制下面配置到 文件内容的 <code>&lt;configuration&gt;</code> 和 <code>&lt;/configuration&gt;</code> 之间</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:18040<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:18030<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:18025<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:18141<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:18088<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="格式化HDFS"><a href="#格式化HDFS" class="headerlink" title="格式化HDFS"></a>格式化HDFS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$HADOOP_HOME</span>/bin/hdfs namenode -format</span><br></pre></td></tr></table></figure><h3 id="启动Hadoop"><a href="#启动Hadoop" class="headerlink" title="启动Hadoop"></a>启动Hadoop</h3><ul><li>1.使用以下命令启动hdfs<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$HADOOP_HOME</span>/sbin/start-dfs.sh</span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/大数据06/大数据06_009.png" alt=""></p><ul><li><p>2.使用以下命令启动yarn</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$HADOOP_HOME</span>/sbin/start-yarn.sh</span><br></pre></td></tr></table></figure></li><li><p>3.使用 <strong>jps</strong> 工具/命令，验证所有与Hadoop相关的进程是否正在运行。如果Hadoop已成功启动，则jps的输出应显示NameNode/NodeManager/ResourceManager/SecondaryNameNode/DataNode。<br>  <img src="/image/大数据06/大数据06_010.png" alt="">    </p></li></ul><h3 id="停止Hadoop"><a href="#停止Hadoop" class="headerlink" title="停止Hadoop"></a>停止Hadoop</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$HADOOP_HOME</span>/sbin/stop-dfs.sh</span><br><span class="line"><span class="variable">$HADOOP_HOME</span>/sbin/stop-yarn.sh</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（五）Hadoop的基础概念</title>
      <link href="/2019/08/15/%E5%A4%A7%E6%95%B0%E6%8D%AE05/"/>
      <url>/2019/08/15/%E5%A4%A7%E6%95%B0%E6%8D%AE05/</url>
      <content type="html"><![CDATA[<p>随着海量数据增加，需要大数据技术去存储和处理它。Hadoop是大数据技术的基础，对Hadoop基础知识的掌握的扎实程度，会决定在大数据技术道路上走多远。<br>本文章主要介绍Hadoop的基础知识。 </p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="起源"><a href="#起源" class="headerlink" title="起源"></a>起源</h3><p>Google 遇到两个问题 <strong>大量的网页日益增加怎么存储</strong> 和 <strong>搜索算法</strong>，提出了三大理论（<strong>GFS 文件存储</strong>、<strong>Map-Reduce 计算</strong>、<strong>BigTable</strong>）来解决这个问题，受到启发的Doug Cutting等人开始尝试实现MapReduce计算框架，并将它与NDFS（Nutch Distributed File System）结合，用以支持Nutch引擎的主要算法。<br>由于NDFS和MapReduce在Nutch引擎中有着良好的应用，所以它们于2006年2月被分离出来，成为一套完整而独立的软件，并被命名为Hadoop。</p><h3 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h3><p><strong>Apache Hadoop</strong> 是一个开源分布式计算软件框架，允许使用 <strong>简单的编程模型</strong> 在 <strong>跨计算机集群</strong> 的 <strong>分布式环境</strong> 中存储和处理大数据。</p><ul><li>数据分布在多台机器,单份数据复制到多个节点</li><li>尽量地将任务分配到离数据最近的机器上运行(网络IO速度 &lt;&lt; 本地磁盘IO速度)</li><li>使用串行IO取代随机IO,一般数据写入后不再修改(传输时间 &lt;&lt; 寻道时间)</li></ul><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ol><li><strong>高可靠性</strong>：冗余副本策略、机架感知策略、心跳机制、安全模式、校验和、回收站、元数据保护和快照机制等设计保证可靠性。例如冗余副本策略，自动保存数据的多个副本，并且能够自动将失败的任务重新分配。</li><li><strong>高扩展性：</strong>Hadoop是在可用的计算机集簇间分配数据并完成计算任务的，这些集簇可以方便地扩展到数以千计的节点中。</li><li><strong>高效性</strong>：Hadoop能够在节点之间动态地移动数据，并保证各个节点的动态平衡，因此处理速度非常快  。</li><li><strong>低成本：</strong>开源的，只需要一般的商用硬件。</li></ol><h3 id="生态系统和组件"><a href="#生态系统和组件" class="headerlink" title="生态系统和组件"></a>生态系统和组件</h3><p><img src="/image/大数据05/大数据05_001.png" alt=""></p><h3 id="Hadoop架构"><a href="#Hadoop架构" class="headerlink" title="Hadoop架构"></a>Hadoop架构</h3><p><img src="/image/大数据05/大数据05_002.png" alt=""></p><ul><li>主节点：主节点允许您使用Hadoop MapReduce进行数据并行处理。</li><li>从节点：从节点是Hadoop集群中的其他计算机，可让您存储数据以进行复杂的计算。此外，所有从属节点都随附有Task Tracker和一个DataNode。这使您可以分别与NameNode和Job Tracker同步进程。</li><li>NameNode：NameNode表示名称空间中使用的每个文件和目录</li><li>数据节点：DataNode可帮助您管理HDFS节点的状态，并允许您与块进行交互</li></ul><h3 id="Hadoop组成"><a href="#Hadoop组成" class="headerlink" title="Hadoop组成"></a>Hadoop组成</h3><p><img src="/image/大数据05/大数据05_003.png" alt=""></p><ul><li><p><strong>MapReduce:</strong> 分布式计算</p></li><li><p><strong>HDFS:</strong> 分布式文件存储</p></li><li><p><strong>YARN:</strong> 分布式资源管理</p></li><li><p><strong>Others:</strong> 利用YARN的资源管理功能实现其他的数据处理方式</p></li></ul><h4 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a>HDFS</h4><p><img src="/image/大数据05/大数据05_004.png" alt=""></p><ul><li><strong>Block数据块</strong><ol><li>基本存储单位，一般大小为64M(注:配置大的块 )<ol><li>减少搜寻时间，一般硬盘传输速率比寻道时间要快，大的块可以减少寻道时间；</li><li>减少管理块的数据开销，每个块都需要在NameNode上有对应的记录；</li><li>对数据块进行读写，减少建立网络的连接成本;</li></ol></li><li>一个大文件会被拆分成一个个的块，然后存储于不同的机器。如果一个文件少于Block大小，那么实际占用的空间为其文件的大小</li><li>基本的读写单位，类似于磁盘的页，每次都是读写一个块</li><li>每个块都会被复制到多台机器，默认复制3份</li></ol></li><li><strong>NameNode</strong><ol><li>存储文件的metadata，运行时所有数据都保存到内存，整个HDFS可存储的文件数受限于NameNode的内存大小</li><li>一个Block在NameNode中对应一条记录（一般一个block占用150字节），如果是大量的小文件，会消耗大量内存。同时map task的数量是由splits来决定的，所以用MapReduce处理大量的小文件时，就会产生过多的map task，线程管理开销将会增加作业时间。处理大量小文件的速度远远小于处理同等大小的大文件的速度。因此Hadoop建议存储大文件</li><li>数据会定时保存到本地磁盘，但不保存block的位置信息，而是由DataNode注册时上报和运行时维护（NameNode中与DataNode相关的信息并不保存到NameNode的文件系统中，而是NameNode每次重启后，动态重建）</li><li>NameNode失效则整个HDFS都失效了，所以要保证NameNode的可用性</li></ol></li><li><strong>Secondary NameNode</strong><ol><li>定时与NameNode进行同步（定期合并文件系统镜像和编辑日志，然后把合并后的传给NameNode，替换其镜像，并清空编辑日志，类似于CheckPoint机制），但NameNode失效后仍需要手工将其设置成主机</li></ol></li><li><strong>DataNode</strong><ol><li>保存具体的block数据</li><li>负责数据的读写操作和复制操作</li><li>DataNode启动时会向NameNode报告当前存储的数据块信息，后续也会定时报告修改信息</li><li>DataNode之间会进行通信，复制数据块，保证数据的冗余性</li></ol></li></ul><h4 id="YARN"><a href="#YARN" class="headerlink" title="YARN"></a>YARN</h4><p><img src="/image/大数据05/大数据05_005.jpg" alt=""></p><p>旧的MapReduce架构：存在<strong>单点</strong>和<strong>资源利用率</strong>问题</p><ul><li><strong>JobTracker:</strong> 负责资源管理，跟踪资源消耗和可用性，作业生命周期管理（调度作业任务，跟踪进度，为任务提供容错）</li><li><strong>TaskTracker:</strong> 加载或关闭任务，定时报告任务状态</li></ul><p>YARN就是将JobTracker的职责进行拆分，将资源管理和任务调度监控拆分成独立的进程：</p><ul><li>ResourceManager: 全局资源管理和任务调度</li><li>NodeManager: 单个节点的资源管理和监控</li><li>ApplicationMaster: 单个作业的资源管理和任务监控</li><li>Container: 资源申请的单位和任务运行的容器</li></ul><p><img src="/image/大数据05/大数据05_006.jpg" alt=""><br><img src="/image/大数据05/大数据05_007.jpg" alt=""></p><h4 id="MapReduce"><a href="#MapReduce" class="headerlink" title="MapReduce"></a>MapReduce</h4><p>MapReduce主要是先读取文件数据，然后进行Map处理，接着Reduce处理，最后把处理结果写到文件中<br><img src="/image/大数据05/大数据05_008.png" alt=""><br><img src="/image/大数据05/大数据05_009.png" alt=""><br><img src="/image/大数据05/大数据05_010.png" alt=""></p><p>More info: <a href="https://pennywong.gitbooks.io/hadoop-notebook/content/index.html" target="_blank" rel="noopener">Hadoop</a></p>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
            <tag> hadoop </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（四）大数据生态</title>
      <link href="/2019/07/15/%E5%A4%A7%E6%95%B0%E6%8D%AE04/"/>
      <url>/2019/07/15/%E5%A4%A7%E6%95%B0%E6%8D%AE04/</url>
      <content type="html"><![CDATA[<p>海量数据就需要对应大数据技术去存储和处理它。</p><p>本文章主要介绍如何搭建大数据生态环境。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>现在搭建大数据环境有三种方式：</p><ul><li><p>1.docker方式: 利用docker-compose一键编排部署</p><ul><li>优点：一键部署，快捷方便</li><li>缺点：性能不高只适合测试环境或者学习</li></ul></li><li><p>2.使用成熟的发行版本去部署：例如 CM(Cloudera Manager)+CDH（Cloudera’s Distribution Including Apache Hadoop）或者Ambari+HDP(Hortonworks Data Platform)</p><ul><li>优点：集群安装部署和运维方便</li><li>缺点：屏蔽太多细节，妨碍对组件理解</li></ul></li><li><p>3.使用开源版本：</p><ul><li>优点：  完全开源免费，社区活跃， 文档、资料详实 ，</li><li>缺点： 集群安装部署复杂，需要编写大量配置文件，需要考虑组件之间的兼容性问题、版本匹配问题、冲突问题、编译问题等；  集群运维复杂，需要安装第三方软件辅助。  </li></ul></li></ul><h3 id="机器准备"><a href="#机器准备" class="headerlink" title="机器准备"></a>机器准备</h3><ul><li>1.准备多台物理机或者使用VM安装多台虚机</li><li>2.从官网下载centos系统包并安装</li></ul><h3 id="机器配置"><a href="#机器配置" class="headerlink" title="机器配置"></a>机器配置</h3><p>如果是docker方式部署，就不需要经历这个步骤</p><ul><li>0.修改服务器的ip地址</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/sysconfig/network-scripts/ifcfg-eth0</span><br><span class="line">BOOTPROTO=<span class="string">"static"</span></span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=192.168.52.100</span><br><span class="line">NETMASK=255.255.255.0</span><br><span class="line">GATEWAY=192.168.52.1</span><br><span class="line">DNS1=8.8.8.8</span><br></pre></td></tr></table></figure><p>例如：将准备好的三台服务器的IP地址分别设置成为如下：</p><ul><li>第一台机器IP地址：192.168.52.100</li><li>第二台机器IP地址：192.168.52.110</li><li>第三台机器IP地址：192.168.52.120</li><li><p>第四台机器IP地址：192.168.52.130</p></li><li><p>1.关闭防火墙</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># centos 7 默认使用的是firewall，也可以使用iptables配置规则</span></span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl mask firewalld.service</span><br><span class="line"></span><br><span class="line">service iptables status <span class="comment"># 查看状态</span></span><br><span class="line">service iptables stop <span class="comment"># 临时关闭</span></span><br><span class="line">chkconfig iptables --list <span class="comment"># 查看防火墙启动级别</span></span><br><span class="line">chkconfig iptables off <span class="comment"># 永久关闭</span></span><br></pre></td></tr></table></figure><ul><li>2.关闭SELinux（所有节点）</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用root用户登录四台服务器，执行以下命令关闭selinux</span></span><br><span class="line">vim /etc/selinux/config</span><br><span class="line">SELINUX=enforcing <span class="comment"># 注释掉</span></span><br><span class="line">SELINUX=disabled <span class="comment"># 添加</span></span><br><span class="line">/usr/sbin/sestatus -v <span class="comment"># 查看状态</span></span><br></pre></td></tr></table></figure><ul><li>3.修改主机名</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在不同机器上执行</span></span><br><span class="line">hostnamectl <span class="built_in">set</span>-hostname master</span><br><span class="line">hostnamectl <span class="built_in">set</span>-hostname node01</span><br><span class="line">hostnamectl <span class="built_in">set</span>-hostname node02</span><br><span class="line">hostnamectl <span class="built_in">set</span>-hostname node03</span><br></pre></td></tr></table></figure><ul><li>4.更改主机名与IP地址映射</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/hosts</span><br><span class="line">192.168.52.100 master.kaikeba.com master</span><br><span class="line">192.168.52.110 node01.kaikeba.com node01</span><br><span class="line">192.168.52.120 node02.kaikeba.com node02</span><br><span class="line">192.168.52.130 node03.kaikeba.com node03</span><br></pre></td></tr></table></figure><ul><li>5.主机间ntp同步时间</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum -y install ntpdate</span><br><span class="line">crontab -e</span><br><span class="line">*/1 * * * * /usr/sbin/ntpdate time1.aliyun.com <span class="comment"># 这边使用的阿里云的ntp服务器，如果不能访问外网，就应该配置内网的ntp服务器</span></span><br></pre></td></tr></table></figure><ul><li>6.添加普通用户</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建hadoop，并设置密码为 hadoop </span></span><br><span class="line">sudo addgroup hadoop <span class="comment"># 新建用户组   </span></span><br><span class="line">sudo adduser --ingroup hadoop hadoop <span class="comment"># 新建用户</span></span><br><span class="line">passwd hadoop</span><br><span class="line"><span class="comment"># 给用户增加roo权限：在（root ALL=(ALL)ALL）在下面添加一行</span></span><br><span class="line">sudo vim /etc/sudoers</span><br><span class="line">hadoop ALL=(ALL) ALL</span><br></pre></td></tr></table></figure><ul><li>7.配置免密登录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成私钥和公钥,在/home/当前用户/.ssh目录下找到id_rsa(私钥)和id_rsa.pub(公钥)</span></span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line"> </span><br><span class="line"><span class="comment">#三台机器在hadoop用户下，执行以下命令将公钥拷贝到master服务器上面去</span></span><br><span class="line">ssh-copy-id master</span><br><span class="line"> </span><br><span class="line"><span class="comment"># master在hadoop用户下，执行以下命令，将authorized_keys拷贝到 node01、node02与node03服务器</span></span><br><span class="line"><span class="built_in">cd</span> /home/hadoop/.ssh/</span><br><span class="line">scp authorized_keys node01:<span class="variable">$PWD</span></span><br><span class="line">scp authorized_keys node02:<span class="variable">$PWD</span></span><br><span class="line">scp authorized_keys node03:<span class="variable">$PWD</span></span><br></pre></td></tr></table></figure><ul><li>8.定义统一目录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /hadoop/soft <span class="comment"># 软件压缩包存放目录</span></span><br><span class="line">mkdir -p /hadoop/install <span class="comment"># 软件解压后存放目录</span></span><br><span class="line">chown -R hadoop:hadoop /hadoop <span class="comment"># 将文件夹权限更改为hadoop用户</span></span><br></pre></td></tr></table></figure><ul><li>9.安装java</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从官网下载jdk包，解压到目录</span></span><br><span class="line">tar -zxf jdk-8u141-linux-x64.tar.gz -C /hadoop/install</span><br><span class="line"> </span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加以下配置内容，配置jdk环境变量</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/hadoop/install/jdk1.8.0_141</span><br><span class="line"><span class="built_in">export</span> PATH=:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><ul><li>10.在root用户下重启</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reoot -h now</span><br></pre></td></tr></table></figure><h3 id="Docker-部署"><a href="#Docker-部署" class="headerlink" title="Docker 部署"></a>Docker 部署</h3><p>不少公司把所有的 大数据组件都做成了 docker image ，可以直接通过 docker-compose 一键按照，具体看一下参考下面的教程：</p><ul><li><a href="https://clubhouse.io/developer-how-to/how-to-set-up-a-hadoop-cluster-in-docker/" target="_blank" rel="noopener">安装教程1</a></li><li><a href="https://hub.docker.com/r/bde2020/hadoop-namenode" target="_blank" rel="noopener">安装教程2</a></li></ul><h3 id="CM-CDH-部署"><a href="#CM-CDH-部署" class="headerlink" title="CM + CDH 部署"></a>CM + CDH 部署</h3><ul><li>CM：Cloudera Manager，Cloudera公司编写的一个CDH的管理后台，类似各CMS的管理后台。</li><li><p>CDH：Cloudera’s distribution,including Apache Hadoop，Cloudera公司制作的一个Hadoop发行版，集成了Hadoop及Hive等与Hadoop关系紧密的工具。</p></li><li><p>1.下载</p><ul><li>根据操作系统从<a href="http://archive.cloudera.com/cm5/redhat/6/x86_64/cm/" target="_blank" rel="noopener">CM bin文件</a>下载对应版本</li><li>根据操作系统从[CM rpm包]<a href="http://archive.cloudera.com/cm5/redhat/6/x86_64/cm/)下载对应版本" target="_blank" rel="noopener">http://archive.cloudera.com/cm5/redhat/6/x86_64/cm/)下载对应版本</a></li><li>根据操作系统从<a href="http://archive.cloudera.com/cdh5/parcels/" target="_blank" rel="noopener">CDH</a>下载对应版本的manifest.json、.parcel和.sha1文件</li></ul></li><li><p>2.上传介质到master，上传目录为/hadoop/soft，并解压</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf cm5.5.1.tar.gz </span><br><span class="line">tar -zxvf cdh5.5.1.tar.gz</span><br></pre></td></tr></table></figure><ul><li>3.各个节点配置本地yum源（master）</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d</span><br><span class="line">vi cloudera-manager.repo</span><br></pre></td></tr></table></figure><p>添加下面内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[cloudera-manager]</span><br><span class="line">name=Cloudera Manager, Version 5.5.1</span><br><span class="line">baseurl=http://192.168.52.100/cm5.5.1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><ul><li>4.启动http服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service httpd status <span class="comment"># 查看服务状态</span></span><br><span class="line">service httpd start <span class="comment"># 打开服务</span></span><br></pre></td></tr></table></figure><ul><li><p>5.验证本地yum源</p><ul><li>将上一步baseurl地址粘贴到浏览器</li><li>确认是否能正常访问到已经上传安装文件的机器的安装文件目录。</li></ul></li><li><p>6.运行CM安装</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 赋予bin文件执行权限</span></span><br><span class="line">chmod u+x cloudera-manager-installer5.5.1.bin</span><br><span class="line"><span class="built_in">cd</span> /hadoop/soft</span><br><span class="line"><span class="comment"># 运行bin文件</span></span><br><span class="line">./cloudera-manager-installer5.5.1.bin</span><br></pre></td></tr></table></figure><ul><li><p>7.验证CM安装是否完成</p><ul><li>使用命令查看服务状态：service cloudera-scm-server status</li><li>点击 管理界面(<a href="http://192.168.52.100:7180/cmf" target="_blank" rel="noopener">http://192.168.52.100:7180/cmf</a>) 登陆，用户名和密码都为admin</li></ul></li><li><p>8.修正参数</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 0 &gt; /proc/sys/vm/swappiness</span><br><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/defrag</span><br><span class="line"><span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br></pre></td></tr></table></figure><ul><li><p>9.开始安装</p><ul><li>1.接受许可</li><li>2.选择相应的版本</li><li>3.选择主机：搜索主机，也可以自己输ip</li><li>4.选择存储库：使用Parcel，远程Parcel 存储库URL指定安装源(本地源)</li><li>5.勾选JDK</li><li>6.填写用户（hadoop）密码</li><li>7.开始安装</li><li>8.自定义添加服务</li><li>9.安装角色</li><li>10.数据库选择：建议使用默认数据库。以后可以进行修改。</li><li>11.指定数据目录</li></ul></li><li><p>10.排错</p><ul><li>1.完成以上，说明集群已经安装成功，其他问题需要在后续过程调试。页面显示红色不等于服务没有安装成功，验证参数没有满足默认而已。</li><li>2.关闭时钟同步</li><li>3.验证安装：例如 到安装HDFS角色的服务器上任意目录执行如下命令（hadoop fs -ls /），能正常执行即代表功能可用</li></ul></li></ul><h3 id="开源版本部署"><a href="#开源版本部署" class="headerlink" title="开源版本部署"></a>开源版本部署</h3><p>从下图可以知道，使用开源版本部署比较麻烦，组件比较多，后面就一章一章慢慢说。</p><p><img src="/image/大数据04/大数据04_001.jpg" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（三）大数据测试</title>
      <link href="/2019/06/15/%E5%A4%A7%E6%95%B0%E6%8D%AE03/"/>
      <url>/2019/06/15/%E5%A4%A7%E6%95%B0%E6%8D%AE03/</url>
      <content type="html"><![CDATA[<p>大数据是无法使用传统计算技术处理的大型数据集的集合，所以这些数据集的测试涉及各种要处理的工具，技术和框架，需要去了解和掌握。</p><p>大数据测试是大数据应用程序的测试，不是测试软件产品的各个功能，而是测试大数据应用程序对其数据处理的验证，<strong>数据处理功能和性能测试</strong>是关键。 </p><p>本文章主要介绍大数据测试的基本知识。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="大数据测试类型"><a href="#大数据测试类型" class="headerlink" title="大数据测试类型"></a>大数据测试类型</h3><ul><li>数据处理<ul><li>批量</li><li>实时</li><li>交互 </li></ul></li><li>数据质量<ul><li>一致性</li><li>准确性</li><li>有效性</li><li>完整性 </li></ul></li></ul><h3 id="大数据测试步骤"><a href="#大数据测试步骤" class="headerlink" title="大数据测试步骤"></a>大数据测试步骤</h3><p><img src="/image/大数据03/大数据03_001.png" alt=""></p><h4 id="数据阶段验证"><a href="#数据阶段验证" class="headerlink" title="数据阶段验证"></a>数据阶段验证</h4><p>大数据测试的第一步，也称作pre-hadoop阶段该过程包括如下验证：</p><ol><li>来自各方面的数据资源应该被验证，来确保正确的数据被加载进系统</li><li>将源数据与推送到Hadoop系统中的数据进行比较，以确保它们匹配</li><li>验证正确的数据被提取并被加载到HDFS正确的位置</li></ol><p>该阶段可以使用工具 <a href="https://www.talend.com/" target="_blank" rel="noopener">Talend</a> 或 <a href="http://www.datameer.com/" target="_blank" rel="noopener">Datameer</a>，进行数据阶段验证。</p><h4 id="MapReduce-验证"><a href="#MapReduce-验证" class="headerlink" title="MapReduce 验证"></a>MapReduce 验证</h4><p>大数据测试的第二步是MapReduce的验证。在这个阶段，测试者在每个节点上进行业务逻辑验证，然后在运行多个节点后验证它们，确保如下操作的正确性：</p><ol><li>Map与Reduce进程正常工作</li><li>在数据上实施数据聚合或隔离规则</li><li>生成键值对</li><li>在执行Map和Reduce进程后验证数据</li></ol><h4 id="输出阶段验证"><a href="#输出阶段验证" class="headerlink" title="输出阶段验证"></a>输出阶段验证</h4><p>大数据测试的最后或第三阶段是输出验证过程。生成输出数据文件，同时把文件移到一个EDW(Enterprise Data Warehouse:企业数据仓库)中或着把文件移动到任何其他基于需求的系统中。在第三阶段的活动包括：</p><ol><li>检查转换(Transformation)规则被正确应用</li><li>检查数据完整性和成功的数据加载到目标系统中</li><li>通过将目标数据与HDFS文件系统数据进行比较来检查没有数据损坏</li></ol><h3 id="架构测试"><a href="#架构测试" class="headerlink" title="架构测试"></a>架构测试</h3><p>Hadoop处理大量数据，并且资源非常密集。因此，架构测试对于确保大数据项目的成功至关重要。设计不良或不正确的系统可能会导致性能下降，并且系统可能无法满足要求。至少应在Hadoop环境中完成 <strong>性能</strong> 和 <strong>故障转移</strong> 测试服务。</p><ul><li><strong>性能测试</strong> 包括测试作业完成时间，内存利用率，数据吞吐量和类似的系统指标。</li><li><strong>故障转移</strong> 测试服务的目的是验证数据节点发生故障时无缝地进行数据处理</li></ul><h4 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h4><p>大数据性能测试包括两个主要措施</p><ul><li><strong>数据提取和遍历</strong>：在此阶段，测试人员将验证快速系统如何使用各种数据源中的数据。测试涉及识别队列可以在给定时间范围内处理的其他消息。它还包括可以将数据插入基础数据存储库的速度，例如向Mongo和Cassandra数据库的插入率。</li><li><strong>数据处理</strong>：它涉及验证查询或映射归约作业的执行速度。它还包括当基础数据存储区填充在数据集中时，单独测试数据处理。例如，在基础HDFS上运行Map Reduce作业。</li></ul><p><strong>注：由于系统由多个组件组成，并且必须单独测试每个组件。例如，对消息进行索引和使用的速度、MapReduce作业、查询性能和搜索等。</strong> </p><h5 id="性能测试方法"><a href="#性能测试方法" class="headerlink" title="性能测试方法"></a>性能测试方法</h5><p>大数据应用性能测试涉及大量结构化和非结构化数据的测试，并且需要特定的测试方法来测试这些海量数据。</p><p><img src="/image/大数据03/大数据03_002.png" alt=""></p><h5 id="测试步骤"><a href="#测试步骤" class="headerlink" title="测试步骤"></a>测试步骤</h5><ol><li>过程从设置要测试性能的大数据群集开始</li><li>确定和设计相应的工作量</li><li>准备个人客户(自定义脚本创建)</li><li>执行测试并分析结果(如果不满足目标，则调整组件并重新执行)</li><li>最佳配置</li></ol><h5 id="性能测试的参数"><a href="#性能测试的参数" class="headerlink" title="性能测试的参数"></a>性能测试的参数</h5><p>需要进行性能测试验证的各种参数是：</p><ol><li>数据存储：数据如何存储在不同的节点中</li><li>提交日志：允许增长的提交日志有多大</li><li>并发性：有多少个线程可以执行写入和读取操作</li><li>缓存：调整缓存设置“行缓存”和“键缓存”。</li><li>超时：连接超时值，查询超时值等</li><li>JVM参数：堆大小，GC收集算法等</li><li>地图降低性能：排序，合并等</li><li>消息队列：消息速率，大小等</li></ol><h3 id="测试环境需求"><a href="#测试环境需求" class="headerlink" title="测试环境需求"></a>测试环境需求</h3><p>测试环境需要取决于您正在测试的应用程序的类型。对于大数据测试，测试环境应包含</p><ul><li>它应该有足够的空间用于存储和处理大量数据</li><li>它应该具有包含分布式节点和数据的集群</li><li>它应具有最低的CPU和内存利用率以保持高性能</li></ul><h3 id="大数据测试-与-传统数据库测试-对比"><a href="#大数据测试-与-传统数据库测试-对比" class="headerlink" title="大数据测试 与 传统数据库测试 对比"></a>大数据测试 与 传统数据库测试 对比</h3><table><thead><tr><th style="text-align:center">类型</th><th style="text-align:center">传统数据库测试</th><th style="text-align:center">大数据测试</th></tr></thead><tbody><tr><td style="text-align:center">数据</td><td style="text-align:center">使用结构化数据;<br>测试方法定义明确且经过时间检验;<br>测试人员可以选择手动执行采样策略或通过自动化工具选择”详尽验证”策略</td><td style="text-align:center">使用结构化和非结构化数据;<br>测试方法类似开发工作;<br>大数据中的采样策略是一个挑战</td></tr><tr><td style="text-align:center">环境</td><td style="text-align:center">由于文件大小有限，因此不需要特殊的测试环境</td><td style="text-align:center">由于数据量大和文件大（HDFS），因此需要特殊的测试环境</td></tr><tr><td style="text-align:center">验证工具</td><td style="text-align:center">使用基于Excel的宏或基于UI的自动化工具</td><td style="text-align:center">没有定义的工具，范围从MapReduce到HiveQL等编程工具</td></tr></tbody></table><h3 id="大数据场景中使用的工具"><a href="#大数据场景中使用的工具" class="headerlink" title="大数据场景中使用的工具"></a>大数据场景中使用的工具</h3><table><thead><tr><th style="text-align:center">类型</th><th style="text-align:center">组件</th></tr></thead><tbody><tr><td style="text-align:center">数据处理</td><td style="text-align:center"><a href="https://flink.apache.org/" target="_blank" rel="noopener">Apache Flink</a> <a href="https://spark.apache.org/" target="_blank" rel="noopener">Apache Spark</a></td></tr><tr><td style="text-align:center">消息系统</td><td style="text-align:center"><a href="https://kafka.apache.org/" target="_blank" rel="noopener">Apache Kafka</a> <strong><a href="https://pulsar.apache.org/" target="_blank" rel="noopener">Apache Pulsar</a></strong></td></tr><tr><td style="text-align:center">数据查询引擎</td><td style="text-align:center"><a href="https://hive.apache.org/" target="_blank" rel="noopener">Apache Hive</a> <a href="https://spark.apache.org/sql/" target="_blank" rel="noopener">Apache SparkSQL</a> <a href="https://impala.apache.org/" target="_blank" rel="noopener">Apache Impala</a> <a href="https://www.elastic.co/cn/" target="_blank" rel="noopener">Elasticsearch</a></td></tr><tr><td style="text-align:center">数据采集</td><td style="text-align:center"><a href="https://flume.apache.org/" target="_blank" rel="noopener">Apache Flume</a> <a href="https://www.elastic.co/cn/products/logstash" target="_blank" rel="noopener">Logstash</a></td></tr><tr><td style="text-align:center">数据存储</td><td style="text-align:center"><a href="https://hbase.apache.org/" target="_blank" rel="noopener">Apache HBase</a> <a href="http://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/HdfsUserGuide.html" target="_blank" rel="noopener">HDFS</a></td></tr><tr><td style="text-align:center">数据转换、同步</td><td style="text-align:center"><a href="https://sqoop.apache.org/" target="_blank" rel="noopener">Apache Sqoop</a></td></tr><tr><td style="text-align:center">资源管理</td><td style="text-align:center"><a href="https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html" target="_blank" rel="noopener">Apache Hadoop YARN</a></td></tr><tr><td style="text-align:center">应用协调</td><td style="text-align:center"><a href="https://zookeeper.apache.org/" target="_blank" rel="noopener">Apache Zookeeper</a></td></tr><tr><td style="text-align:center">数据分析和报告工具</td><td style="text-align:center"><strong><a href="https://zeppelin.apache.org/" target="_blank" rel="noopener">Apache Zeppelin</a> <a href="http://gethue.com/" target="_blank" rel="noopener">Cloudera Hue</a></strong></td></tr></tbody></table><h3 id="大数据测试中的挑战"><a href="#大数据测试中的挑战" class="headerlink" title="大数据测试中的挑战"></a>大数据测试中的挑战</h3><ul><li>自动化:大数据的自动化测试需要具有专业技术知识的人员。自动化工具不具备处理测试期间出现的意外问题的能力</li><li>虚拟化:这是测试不可或缺的阶段之一。虚拟机延迟会在实时大数据测试中造成时序问题。在大数据中管理图像也很麻烦。</li><li>大数据集<ul><li>需要验证更多数据，并且需要更快地进行处理</li><li>需要自动化测试工作</li><li>需要能够在不同平台上进行测试</li></ul></li><li>性能测试挑战<ul><li>多种技术：每个子组件都属于不同的技术，并且需要单独进行测试</li><li>特定工具不可用：没有单个工具可以执行端到端测试。例如，NoSQL可能不适用于消息队列</li><li>测试脚本：设计测试方案和测试用例需要高度的脚本编写</li><li>测试环境：由于数据量大，需要特殊的测试环境</li><li>监视解决方案：存在可以监视整个环境的有限解决方案</li><li>诊断解决方案：需要开发自定义解决方案来挖掘性能瓶颈区域</li></ul></li></ul><p>More info: <a href="https://www.guru99.com/big-data-testing-functional-performance.html#1" target="_blank" rel="noopener">大数据测试</a></p>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（二）大数据的流程和应用</title>
      <link href="/2019/05/15/%E5%A4%A7%E6%95%B0%E6%8D%AE02/"/>
      <url>/2019/05/15/%E5%A4%A7%E6%95%B0%E6%8D%AE02/</url>
      <content type="html"><![CDATA[<p>本文章主要介绍大数据业务流程以及应用。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/大数据02/大数据02_001.png" alt=""></p><h3 id="大数据业务流程"><a href="#大数据业务流程" class="headerlink" title="大数据业务流程"></a>大数据业务流程</h3><ul><li><a href="#数据采集">数据采集</a></li><li><a href="#数据提取">数据提取</a></li><li><a href="#数据应用">数据应用</a></li></ul><h4 id="数据采集"><a href="#数据采集" class="headerlink" title="数据采集"></a>数据采集</h4><p>数据采集就是使用不同的方式去各种数据源采集数据</p><table><thead><tr><th style="text-align:center">数据来源</th><th style="text-align:center">外部</th><th style="text-align:center">内部</th><th style="text-align:center">内部</th></tr></thead><tbody><tr><td style="text-align:center">数据类型</td><td style="text-align:center">公开的信息</td><td style="text-align:center">用户的行为信息</td><td style="text-align:center">用户信息</td></tr><tr><td style="text-align:center">获取方式</td><td style="text-align:center">爬虫</td><td style="text-align:center">埋点</td><td style="text-align:center">业务数据库</td></tr></tbody></table><h4 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h4><ul><li><p>数据清洗：数据由于来自各个源，为了使用方便和隐私考虑，需要清洗</p><ul><li>判断是否加密信息<ul><li>加密信息解密，获取明文数据</li><li>脱敏数据，跳过清洗</li></ul></li><li>数据规则：例如去掉空格和一些特殊字符，让数据变得有效和统一规范</li><li>数据统一加密，生成衍生加密表</li></ul></li><li><p>企业数仓：清洗的数据最后统一存储到企业数仓,在企业数仓通过数据整理分类和分析,提取有效的应用信息</p><ul><li>数据分类,形成基础信息表</li><li>通过基础信息表,形成综合信息表(宽表 维度表)</li><li>通过业务综合表进行一定数据计算形成应用标签存储<strong>数据集市</strong></li></ul></li></ul><h4 id="数据应用"><a href="#数据应用" class="headerlink" title="数据应用"></a>数据应用</h4><ul><li>通过业务综合表进行一定数据计算（算法模型/决策）形成应用标签存储<strong>数据集市</strong></li><li>通过接口查询或者报表展示</li></ul><h3 id="大数据数据流"><a href="#大数据数据流" class="headerlink" title="大数据数据流"></a>大数据数据流</h3><p><img src="/image/大数据02/大数据02_002.png" alt=""></p><h3 id="大数据应用"><a href="#大数据应用" class="headerlink" title="大数据应用"></a>大数据应用</h3><ul><li>精准营销:<ul><li>从数据集市获取用户特征(行为/角色标签) </li><li>组合不同的特征形成不一样受众群体</li><li>针对不同的受众群体制定不同的策略去营销:,通过不同方式(短信/邮件/软件的消息和广告位)去推荐商品</li></ul></li><li>风险控制<ul><li>从数据获取用户的风险信息</li><li>通过风控策略（决策引擎）把用户划分成不同风险级别，采取不同风险控制</li></ul></li><li>数据报表<ul><li>从数据集市获取产品和公司的运行信息</li><li>通过不同图表去展示，反应产品和公司的状况</li></ul></li></ul>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>大数据（一）大数据的基本概念</title>
      <link href="/2019/04/15/%E5%A4%A7%E6%95%B0%E6%8D%AE01/"/>
      <url>/2019/04/15/%E5%A4%A7%E6%95%B0%E6%8D%AE01/</url>
      <content type="html"><![CDATA[<p>本文章主要介绍大数据的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="什么是数据"><a href="#什么是数据" class="headerlink" title="什么是数据"></a>什么是数据</h3><p>计算机执行中操作的字符或符号，可以以电信号的形式存储和传输，并记录在磁、光或机械记录介质上。</p><h3 id="什么是大数据"><a href="#什么是大数据" class="headerlink" title="什么是大数据"></a>什么是大数据</h3><p>大数据是数量巨大且随时间呈指数增长的数据集合。此类数据是如此庞大和复杂，以至于传统的数据管理工具都无法对其进行存储或有效处理。</p><p><img src="/image/大数据01/大数据01_001.jpg" alt=""></p><h3 id="大数据示例"><a href="#大数据示例" class="headerlink" title="大数据示例"></a>大数据示例</h3><ol><li>在  <strong>纽约股票交易所</strong>  产生约  <strong>一兆兆字节</strong>  每天新的贸易数据。<br><img src="/image/大数据01/大数据01_002.jpg" alt=""></li><li>统计数据显示，每天有  <strong>500 TB</strong>  以上的新数据被摄入社交媒体网站 <strong>Facebook</strong> 的数据库中  。这些数据主要通过照片和视频上传，消息交换，发表评论等方式生成。<br><img src="/image/大数据01/大数据01_003.jpg" alt=""></li><li>单个  <strong>Jet 引擎</strong>  可以在 <strong>30分钟</strong>  的飞行时间内生成  <strong>10 TB</strong> 以上的数据  。每天有成千上万的航班，因此数据生成量可达  PB级。<br><img src="/image/大数据01/大数据01_004.jpg" alt=""></li></ol><h3 id="大数据类型"><a href="#大数据类型" class="headerlink" title="大数据类型"></a>大数据类型</h3><h4 id="结构化的"><a href="#结构化的" class="headerlink" title="结构化的"></a>结构化的</h4><p>可以以<strong>固定格式存储，访问和处理</strong>的任何数据称为<strong>结构化</strong>数据。<strong>关系数据库</strong>管理系统中存储的 数据是 “结构化”数据的一个示例 。</p><p>数据库中的“雇员”表是结构化数据的示例</p><table><thead><tr><th style="text-align:center">员工ID</th><th style="text-align:center">员工姓名</th><th style="text-align:center">性别</th><th style="text-align:center">部门</th><th style="text-align:center">Salary_In_lacs</th></tr></thead><tbody><tr><td style="text-align:center">2365</td><td style="text-align:center">拉杰什·库尔卡尼（Rajesh Kulkarni）</td><td style="text-align:center">男</td><td style="text-align:center">金融</td><td style="text-align:center">650000</td></tr><tr><td style="text-align:center">3398</td><td style="text-align:center">Pratibha Joshi</td><td style="text-align:center">女</td><td style="text-align:center">管理员</td><td style="text-align:center">650000</td></tr><tr><td style="text-align:center">7465</td><td style="text-align:center">舒希尔·罗伊</td><td style="text-align:center">男</td><td style="text-align:center">管理员</td><td style="text-align:center">500000</td></tr><tr><td style="text-align:center">7500</td><td style="text-align:center">Shubhojit Das</td><td style="text-align:center">男</td><td style="text-align:center">金融</td><td style="text-align:center">500000</td></tr><tr><td style="text-align:center">7699</td><td style="text-align:center">普里亚·桑（Priya Sane）</td><td style="text-align:center">女</td><td style="text-align:center">金融</td><td style="text-align:center">550000</td></tr></tbody></table><h4 id="非结构化"><a href="#非结构化" class="headerlink" title="非结构化"></a>非结构化</h4><p>任何形式或结构<strong>未知</strong>的数据都归为<strong>非结构化</strong>数据。非结构化数据的典型示例是包含简单文本文件，图像，视频等的组合的异构数据源。 <strong>非结构化数据的示例</strong>如下图：<br><img src="/image/大数据01/大数据01_005.png" alt=""></p><h4 id="半结构化"><a href="#半结构化" class="headerlink" title="半结构化"></a>半结构化</h4><p><strong>半结构化</strong>数据可以<strong>包含两种形式</strong>的数据。我们可以将半结构化数据看作是结构化的形式，但实际上它不是通过例如关系型数据库中的表来定义的。半结构化数据的示例如下图：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">rec</span>&gt;</span> <span class="tag">&lt;<span class="name">name</span>&gt;</span>闷闷不乐<span class="tag">&lt;/ <span class="attr">name</span>&gt;</span> <span class="tag">&lt;<span class="name">sex</span>&gt;</span>男<span class="tag">&lt;/ <span class="attr">sex</span>&gt;</span> <span class="tag">&lt;<span class="name">age</span>&gt;</span> 35 <span class="tag">&lt;/ <span class="attr">age</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">rec</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rec</span>&gt;</span> <span class="tag">&lt;<span class="name">name</span>&gt;</span> Seema R <span class="tag">&lt;/ <span class="attr">name</span>&gt;</span> <span class="tag">&lt;<span class="name">sex</span>&gt;</span>女<span class="tag">&lt;/ <span class="attr">sex</span>&gt;</span> <span class="tag">&lt;<span class="name">age</span>&gt;</span> 41 <span class="tag">&lt;/ <span class="attr">age</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">rec</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rec</span>&gt;</span> <span class="tag">&lt;<span class="name">name</span>&gt;</span> Satish Mane <span class="tag">&lt;/ <span class="attr">name</span>&gt;</span> <span class="tag">&lt;<span class="name">sex</span>&gt;</span> Male <span class="tag">&lt;/ <span class="attr">sex</span>&gt;</span> <span class="tag">&lt;<span class="name">age</span>&gt;</span> 29 <span class="tag">&lt;/ <span class="attr">age</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">rec</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rec</span>&gt;</span> <span class="tag">&lt;<span class="name">name</span>&gt;</span> Subrato Roy <span class="tag">&lt;/ <span class="attr">name</span>&gt;</span> <span class="tag">&lt;<span class="name">sex</span>&gt;</span> Male <span class="tag">&lt;/ <span class="attr">sex</span>&gt;</span> <span class="tag">&lt;<span class="name">age</span>&gt;</span> 26 <span class="tag">&lt;/ <span class="attr">age</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">rec</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rec</span>&gt;</span> <span class="tag">&lt;<span class="name">name</span>&gt;</span> Jeremiah J <span class="tag">&lt;/ <span class="attr">name</span>&gt;</span> <span class="tag">&lt;<span class="name">sex</span>&gt;</span> Male <span class="tag">&lt;/ <span class="attr">sex</span>&gt;</span> <span class="tag">&lt;<span class="name">age</span>&gt;</span> 35 <span class="tag">&lt;/ <span class="attr">age</span>&gt;</span> <span class="tag">&lt;/ <span class="attr">rec</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="大数据的特征"><a href="#大数据的特征" class="headerlink" title="大数据的特征"></a>大数据的特征</h3><ol><li><strong>大量</strong>: 随着信息技术的高速发展，数据开始爆发性增长，存储单位从早期的KB和MB,到后面的GB到TB，乃至现在的PB、EB级别。<br><img src="/image/大数据01/大数据01_006.jpg" alt=""></li><li><strong>多样性</strong> : 广泛的数据来源决定了大数据形式的多样性。在早期，电子表格和数据库是大多数应用程序考虑的唯一数据源。如今，分析应用程序中还考虑了电子邮件、照片、视频、监视设备、PDF和音频等形式的数据。各种各样的非结构化数据给存储，挖掘和分析数据带来了某些问题。</li><li><strong>高速</strong>: 大数据的产生非常迅速，主要通过互联网传输，需要数据的生成和处理速度可以满足需求。生活中每个人都离不开互联网，也就是说每天每个人都在向大数据提供大量的资料。并且这些数据是需要及时处理的，因为花费大量资本去存储作用较小的历史数据是非常不划算的，对于一个平台而言，也许保存的数据只有过去几天或者一个月之内，再远的数据就要及时清理，不然代价太大。基于这种情况，大数据对处理速度有非常严格的要求，服务器中大量的资源都用于处理和计算数据，很多平台都需要做到实时分析。数据无时无刻不在产生，谁的速度更快，谁就有优势。</li><li><strong>价值</strong>: 现实世界所产生的数据中，有价值的数据所占比例很小。相比于传统的小数据，大数据最大的价值在于通过从大量不相关的各种类型的数据中，挖掘出对未来趋势与模式预测分析有价值的数据，并通过机器学习方法、人工智能方法或数据挖掘方法深度分析，发现新规律和新知识，并运用于农业、金融、医疗等各个领域，从而最终达到改善社会治理、提高生产效率、推进科学研究的效果。</li></ol><h3 id="大数据处理的优势"><a href="#大数据处理的优势" class="headerlink" title="大数据处理的优势"></a>大数据处理的优势</h3><ul><li>企业可以在决策时利用外部情报</li><li>改善客户服务</li><li>及早发现产品和服务的风险</li><li>更高的运营效率</li></ul>]]></content>
      
      
        <tags>
            
            <tag> 大数据 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（十）Kubernetes</title>
      <link href="/2019/03/11/Docker10/"/>
      <url>/2019/03/11/Docker10/</url>
      <content type="html"><![CDATA[<p>Kubernetes（k8s）是Google(基于borg)开源的容器集群管理系统，使用Docker对应用程序包装、实例化、运行，能方便地管理跨机器运行容器化的应用，自我修复机制使得容器集群总是运行在用户期望的状态。本文章介绍 Kubernetes 。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>Kubernetes的名字来自希腊语，意思是“舵手” 或 “领航员”。K8s是将8个字母“ubernete”替换为“8”的缩写。</p><ul><li><strong>可移植</strong>: 支持公有云，私有云，混合云，多重云（multi-cloud）</li><li><strong>可扩展</strong>: 模块化, 插件化, 可挂载, 可组合</li><li><strong>自动化</strong>: 自动部署，自动重启，自动复制，自动伸缩/扩展</li></ul><h3 id="集群架构"><a href="#集群架构" class="headerlink" title="集群架构"></a>集群架构</h3><p><img src="/image/Docker10/Docker10_001.png" alt=""></p><h4 id="Master"><a href="#Master" class="headerlink" title="Master"></a>Master</h4><p>集群控制节点，master节点上运行着一组关键的进程</p><ul><li>Kubernetes API Server(kube-apiserver):集群控制的入口进程,提供 HTTP Rest 接口的关键服务程序(所有资源增、删、改、查等操作的唯一入口)</li><li>Kubernetes Controller Manager(kube-controller-manager):所有资源对象的自动化控制中心</li><li>Kubernetes Scheduler(kube-scheduler):资源调度(pod)的进程</li><li>Etcd Server:Kubernetes 里所有资源对象的数据全部是保持在etcd中</li></ul><p><img src="/image/Docker10/Docker10_002.png" alt=""></p><h4 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h4><p>Node是Master管理的工作主机，可以是物理主机、VM等，运行Kubelet、kube-proxy和docker Engine</p><ul><li>kubelet: pod对应容器的创建、暂停等任务</li><li>kube-proxy: k8s service 的通信与负载均衡机制的重要组件</li><li>Docker Engine:dokcer 引擎，负责本机容器的创建与管理</li></ul><p><img src="/image/Docker10/Docker10_003.png" alt=""></p><h4 id="其他概念"><a href="#其他概念" class="headerlink" title="其他概念"></a>其他概念</h4><ul><li><p>Pods：最小部署单元，可包含多个容器，是连接在一起的容器组合并共享文件卷。一个Pod中的多个容器应用通常是紧密耦合的，Pod在Node上被创建、启动或者销毁。</p></li><li><p>Services：抽象服务出口。可以看作一组提供相同服务的Pod的对外访问接口，就像一个基础版本的负载均衡器,Service作用于哪些Pod是通过Label Selector来定义的</p><ul><li>拥有一个指定的名字（比如my-mysql-server）</li><li>拥有一个虚拟IP（Cluster IP、Service IP或VIP）和端口号，销毁之前不会改变，只能内网访问</li><li>NodePort:每个Node的真实端口，能够访问Node的客户端就能通过这个端口访问到内部的Service了</li></ul></li><li><p>Namespace:命名空间将对象逻辑上分配到不同Namespace，可以是不同的项目、用户等区分管理，并设定控制策略，从而实现多租户。</p></li><li><p>Volume ：Pod中能够被多个容器访问的共享目录，其生命周期与Pod相同跟容器无关。</p><ul><li>EmptyDir，Pod分配到Node时创建的，初始内容为空，Pod从Node中移除时EmptyDir数久删    - 除。主要用于临时空间、CheckPoint临时保存目录等</li><li>hostPath，在Pod上挂载宿主机上的文件或目录，主要用于需要永久保存的</li><li>gcePersistentDisk,使用谷歌计算引擎上永久磁盘上的文件，写入数据永久保存。</li><li>awsElasticBlockStore，使用Amazon提供的EBS Volume</li><li>nfs，使用NFS(网络文件系统)提供的共享目录</li><li>iscsi，使用iSCSI设备</li><li>glusterfs，使用开源GlusterFS网络文件系统</li><li>rbd，使用Linux块设备共享存储</li><li>gitRepo，通过挂载一个空目录，从Git库clone一个&gt; - git repository给Pod使用</li><li>secret，一个secret volume用于为Pod提供加密的信息</li><li>persistent Volume, “网络存储”，独立于“计算资源”而存在的实体资源，可以看做一个与Kubernetes无关的网盘</li></ul></li><li><p>Labels： Label以key/value形式附加到Pos、Service、RC、Node等上面，每个对象可以定义多个label，以提供Label Selector来选择对象， Label Selector有两种形式：</p><ul><li>基于等式，name=redis-slave选择k/v都相等的，env!=production选择k=env但是v!=production的</li><li>基于集合，name [not] in (redis-master,redis-slave)，类似于SQL中in</li></ul></li><li><p>Replication controllers： 管理 Pods 的生命周期。它们确保指定数量的 Pods 会一直运行，还有实现资源伸缩。</p><ul><li>定义RC实现Pod的创建与副本数量的自动控制</li><li>RC 通过Lable Selector机制实现对副本的自动控制</li><li>通过改变RC的Pod副本数量，实现Pod的扩容或缩容</li><li>通过改变RC里Pod模板中的镜像版本，实现Pod的滚动更新</li></ul></li><li><p>Deployment: 1.2引入，为了更好地解决pod的编排问题，内部使用了Replica Set 实现；它相对于RC的最大的升级是可以随时知道当前Pod部署的进度</p></li><li><p>Horizontal Pod Autocaler(HPA): Pod横向自动扩容，通过追踪分析RC控制的所有目标Pod的负载变化情况，确定是否需要针对性地调整目标Pod的副本数</p></li><li><p>Annotation：与Lable类似，也使用key/value 键值对的形式定义，不同于Lable定义Kubernetes的元数据，它是用户任意定义的附加信息，以便于外部工具进行查找</p></li></ul><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p><img src="/image/Docker10/Docker10_004.png" alt=""></p><p>Kubernetes主要由以下几个核心组件组成：</p><ul><li>etcd:保存了整个集群的状态；</li><li>apiserver:提供了资源操作的唯一入口，并提供认证、授权、访问控制、API注册和发现等机制；</li><li>controller manager:负责维护集群的状态，比如故障检测、自动扩展、滚动更新等；</li><li>scheduler:负责资源的调度，按照预定的调度策略将Pod调度到相应的机器上；</li><li>kubelet:负责维护容器的生命周期，同时也负责Volume（CVI）和网络（CNI）的管理；</li><li>Container runtime:负责镜像管理以及Pod和容器的真正运行（CRI）；</li><li>kube-proxy:负责为Service提供cluster内部的服务发现和负载均衡；</li></ul><p>除了核心组件，还有一些推荐的Add-ons：</p><ul><li>kube-dns:负责为整个集群提供DNS服务</li><li>Ingress Controller:为服务提供外网入口</li><li>Heapster:提供资源监控</li><li>Dashboard:提供GUI</li><li>Federation:提供跨可用区的集群</li><li><h3 id="分层架构"><a href="#分层架构" class="headerlink" title="分层架构"></a>分层架构</h3></li></ul><p><img src="/image/Docker10/Docker10_005.png" alt=""></p><ul><li>核心层：Kubernetes最核心的功能，对外提供API构建高层的应用，对内提供插件式应用执行环境</li><li>应用层：部署（无状态应用、有状态应用、批处理任务、集群应用等）和路由（服务发现、DNS解析等）</li><li>管理层：系统度量（如基础设施、容器和网络的度量），自动化（如自动扩展、动态Provision等）以及策略管理（RBAC、Quota、PSP、NetworkPolicy等）</li><li>接口层：kubectl命令行工具)、客户端SDK以及集群联邦</li><li>生态系统：在接口层之上的庞大容器集群管理调度的生态系统，可以划分为两个范畴<ul><li>Kubernetes外部：日志、监控、配置管理、CI、CD、Workflow、FaaS、OTS应用、ChatOps等</li><li>Kubernetes内部：CRI、CNI、CVI、镜像仓库、Cloud Provider、集群自身的配置和管理等</li></ul></li></ul><h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建集群</span></span><br><span class="line">kubeadm init --apiserver-advertise-address=&lt;master_ip&gt; --kubernetes-version=&lt;kube_version&gt; --pod-network-cidr=&lt;ip/netmasks&gt;  <span class="comment"># 初始化</span></span><br><span class="line">kubeadm reset <span class="comment"># 还原kubeadm init或join操作</span></span><br><span class="line">kubectl join --token &lt;node&gt; &lt;master_ip:master_port&gt; <span class="comment"># 在子节点执行,加入这个集群</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署应用</span></span><br><span class="line">kubectl run &lt;apply_name&gt; \</span><br><span class="line">      --image=&lt;image&gt; \</span><br><span class="line">      --port=&lt;nodeport&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发布应用</span></span><br><span class="line">kubectl expose delpoyment &lt;apply_name&gt; --<span class="built_in">type</span>=<span class="string">"NodePort"</span> --port &lt;nodeport&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 扩展应用</span></span><br><span class="line">kubectl scale delpoyment/&lt;apply_name&gt; --replicas=2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新应用</span></span><br><span class="line">kubectl <span class="built_in">set</span> image delpoyment/&lt;apply_name&gt; &lt;apply_name&gt;=&lt;image&gt;</span><br></pre></td></tr></table></figure><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><ul><li><p>1.help：获取命令的相关帮助信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl &lt;<span class="built_in">command</span>&gt; --<span class="built_in">help</span></span><br></pre></td></tr></table></figure></li><li><p>2.get：用于获取集群的一个或一些resource信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl get [(-o|--output=)json|yaml|wide|custom-columns=...|custom-columns-file=...|go-template=...|go-template-file=...|jsonpath=...|jsonpath-file=...] (TYPE [NAME | -l label] | TYPE/NAME ...) [flags]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取pod信息</span></span><br><span class="line">kubectl get pod -o wide</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取namespace信息</span></span><br><span class="line">kubectl get namespace</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看rc和service列表</span></span><br><span class="line">kubectl get rc,service</span><br></pre></td></tr></table></figure></li><li><p>3.describe：类似于get，get获得的是resource状态信息，describe获得的是resource集群相关的信息。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取pod信息</span></span><br><span class="line">kubectl describe pod</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取namespace信息</span></span><br><span class="line">kubectl describe namespace</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示Node的详细信息</span></span><br><span class="line">kubectl describe nodes &lt;node-name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示Pod的详细信息</span></span><br><span class="line">kubectl describe pods/&lt;pod-name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示由RC管理的Pod的信息</span></span><br><span class="line">kubectl describe pods &lt;rc-name&gt;</span><br></pre></td></tr></table></figure></li><li><p>4.create：通过配置文件名或stdin创建集群resource</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl create -f &lt;file_name&gt;</span><br><span class="line">kubectl create clusterrole NAME --verb=verb --resource=resource.group [--resource-name=resourcename] [--dry-run] <span class="comment"># 创建一个ClusterRole</span></span><br><span class="line">kubectl create clusterrolebinding NAME --clusterrole=NAME [--user=username] [--group=groupname] [--serviceaccount=namespace:serviceaccountname] [--dry-run] <span class="comment"># 为特定的ClusterRole创建ClusterRoleBinding</span></span><br><span class="line">kubectl create configmap NAME [--from-file=[key=]<span class="built_in">source</span>] [--from-literal=key1=value1] [--dry-run] <span class="comment"># 根据配置文件、目录或指定的literal-value创建configmap </span></span><br><span class="line">kubectl create deployment NAME --image=image [--dry-run] <span class="comment"># 创建具有指定名称的deployment </span></span><br><span class="line">kubectl create namespace NAME [--dry-run] <span class="comment"># 创建一个具有指定名称的namespace</span></span><br><span class="line">kubectl create poddisruptionbudget NAME --selector=SELECTOR --min-available=N [--dry-run] <span class="comment"># 使用指定的name、selector和所需的最小pod数量，创建一个pod disruption budget</span></span><br><span class="line">kubectl create quota NAME [--hard=key1=value1,key2=value2] [--scopes=Scope1,Scope2] [--dry-run=bool] <span class="comment"># 创建具有指定名称、hard限制和可选scopes的resourcequota</span></span><br><span class="line">kubectl create role NAME --verb=verb --resource=resource.group/subresource [--resource-name=resourcename] [--dry-run] <span class="comment"># 使用单一规则创建Role</span></span><br><span class="line">kubectl create rolebinding NAME --clusterrole=NAME|--role=NAME [--user=username] [--group=groupname] [--serviceaccount=namespace:serviceaccountname] [--dry-run] <span class="comment"># 为特定Role或ClusterRole创建RoleBinding</span></span><br><span class="line">kubectl create service &lt;clusterip|externalname|loadbalancer|nodeport|account&gt; <span class="comment"># 使用指定的子命令创建 Service服务</span></span><br><span class="line">kubectl create secret &lt;docker-registry|generic|tls&gt; <span class="comment"># 使用指定的子命令创建 secret</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据yaml配置文件一次性创建service和rc</span></span><br><span class="line">kubectl create -f my-service.yaml -f my-rc.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据&lt;directory&gt;目录下所有.yaml、.yml、.json文件的定义进行创建操作</span></span><br><span class="line">kubectl create -f &lt;directory&gt;</span><br></pre></td></tr></table></figure></li><li><p>5.replace：对已有资源进行更新、替换</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl replace -f &lt;file_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据yaml配置文件更新nignx</span></span><br><span class="line">kubectl replace -f rc-nginx.yaml</span><br></pre></td></tr></table></figure></li><li><p>6.patch：在容器运行时，直接对容器进行修改属性</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl patch (-f FILENAME | TYPE NAME) -p PATCH</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改label为nginx-3</span></span><br><span class="line">kubectl patch pod rc-nginx-2-kpiqt -p <span class="string">'&#123;"metadata":&#123;"labels":&#123;"app":"nginx-3"&#125;&#125;&#125;'</span></span><br></pre></td></tr></table></figure></li><li><p>7.edit：在线编辑resource源的操作</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl edit (RESOURCE/NAME | -f FILENAME)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取pod信息</span></span><br><span class="line">kubectl edit po rc-nginx-btv4j</span><br></pre></td></tr></table></figure></li><li><p>8.delete：删除资源对象</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl delete ([-f FILENAME] | TYPE [(NAME | -l label | --all)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基于Pod.yaml定义的名称删除Pod</span></span><br><span class="line">kubectl delete -f pod.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有包含某个label的Pod和service</span></span><br><span class="line">kubectl delete pods,services -l name=&lt;label-name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除所有Pod</span></span><br><span class="line">kubectl delete pods --all</span><br></pre></td></tr></table></figure></li><li><p>9.apply：在原有resource的基础上进行更新，还会resource中添加一条注释，标记当前的apply</p></li><li><p>10.logs：用于显示pod运行中，容器内程序输出到标准输出的内容</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取pod的日志</span></span><br><span class="line">kubectl logs &lt;pod_name&gt;</span><br></pre></td></tr></table></figure></li><li><p>11.rolling-update:创建了一个新的RC， 然后一次更新一个pod方式逐步使用新的PodTemplate，最终实现Pod滚动更新，new-controller.json需要与之前RC在相同的namespace下</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl rolling-update OLD_CONTROLLER_NAME ([NEW_CONTROLLER_NAME] --image=NEW_CONTAINER_IMAGE | -f NEW_CONTROLLER_SPEC)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据yaml模板更新rc-nginx-2</span></span><br><span class="line">kubectl rolling-update rc-nginx-2 -f rc-nginx.yaml</span><br></pre></td></tr></table></figure></li><li><p>12.scale:扩容或缩容 Deployment、ReplicaSet、Replication Controller或 Job 中Pod数量</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl scale [--resource-version=version] [--current-replicas=count] --replicas=COUNT (-f FILENAME | TYPE NAME)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置pod的数量为4(原本数量小于4为扩容,大于为缩容)</span></span><br><span class="line">kubectl scale rc rc-nginx-3 —replicas=4</span><br></pre></td></tr></table></figure></li><li><p>13.exec：执行容器的命令</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 执行Pod的data命令，默认是用Pod中的第一个容器执行</span></span><br><span class="line">kubectl <span class="built_in">exec</span> &lt;pod-name&gt; data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定Pod中某个容器执行data命令</span></span><br><span class="line">kubectl <span class="built_in">exec</span> &lt;pod-name&gt; -c &lt;container-name&gt; data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过bash获得Pod中某个容器的TTY，相当于登录容器</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it &lt;pod-name&gt; -c &lt;container-name&gt; bash</span><br></pre></td></tr></table></figure></li><li><p>14.attach:查看容器中以daemon形式运行的进程的输出</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取pod的容器输出吸血流</span></span><br><span class="line">kubectl attach &lt;pod-name&gt; -c &lt;containers_name&gt;</span><br></pre></td></tr></table></figure></li><li><p>15.run：创建并运行容器镜像、deployment 和job</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl run NAME --image=image [--env=<span class="string">"key=value"</span>] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [--<span class="built_in">command</span>] -- [COMMAND] [args...]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动nginx实例</span></span><br><span class="line">kubectl run nginx --image=nginx</span><br></pre></td></tr></table></figure></li><li><p>16.expose：指定deployment、service、replica set、replication controller或pod ，并使用该资源的选择器作为指定端口上新服务的选择器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl expose (-f FILENAME | TYPE NAME) [--port=port] [--protocol=TCP|UDP] [--target-port=number-or-name] [--name=name] [--external-ip=external-ip-of-service] [--<span class="built_in">type</span>=<span class="built_in">type</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为RC的nginx创建service，并通过Service的80端口转发至容器的8000端口上</span></span><br><span class="line">kubectl expose rc nginx --port=80 --target-port=8000</span><br></pre></td></tr></table></figure></li><li><p>17.annotate：更新一个或多个资源的Annotations信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl annotate [--overwrite] (-f FILENAME | TYPE NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--resource-version=version]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据“pod.json”中的type和name更新pod的annotation</span></span><br><span class="line">kubectl annotate -f pod.json description=<span class="string">'my frontend'</span></span><br></pre></td></tr></table></figure></li><li><p>18.autoscale：使用 autoscaler 自动设置在kubernetes集群中运行的pod数量</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl autoscale (-f FILENAME | TYPE NAME | TYPE/NAME) [--min=MINPODS] --max=MAXPODS [--cpu-percent=CPU] [flags]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用RC“foo”设定，使其Pod的数量介于1和5之间，CPU使用率维持在80％</span></span><br><span class="line">kubectl autoscale rc foo --max=5 --cpu-percent=80</span><br></pre></td></tr></table></figure></li><li><p>19.convert：转换配置文件为不同的API版本，支持YAML和JSON格式</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl convert -f &lt;file_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将“pod.yaml”转换为最新版本并打印到stdout</span></span><br><span class="line">kubectl convert -f pod.yaml</span><br></pre></td></tr></table></figure></li><li><p>20.label：更新资源上的 label</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl label [--overwrite] (-f FILENAME | TYPE NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--resource-version=version]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给名为foo的Pod添加label unhealthy=true。</span></span><br><span class="line">kubectl label pods foo unhealthy=<span class="literal">true</span></span><br></pre></td></tr></table></figure></li><li><p>21.rollout：对资源进行管理</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl rollout &lt;<span class="built_in">history</span>|pause|resume|status|undo&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回滚到之前的deployment</span></span><br><span class="line">kubectl rollout undo deployment/abc</span><br></pre></td></tr></table></figure></li><li><p>22.set：配置应用资源</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">kubectl <span class="built_in">set</span> &lt;image|resources|selector|subject&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将deployment的nginx容器cpu限制为“200m”，将内存设置为“512Mi”</span></span><br><span class="line">kubectl <span class="built_in">set</span> resources deployment nginx -c=nginx --limits=cpu=200m,memory=5</span><br></pre></td></tr></table></figure></li></ul><p>More info: <a href="https://kubernetes.io/docs/tutorials/kubernetes-basics/" target="_blank" rel="noopener">交互教程</a>  <a href="http://docs.kubernetes.org.cn/227.htm" target="_blank" rel="noopener">kubernetes</a></p>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（九）Docker 命令</title>
      <link href="/2019/02/16/Docker09/"/>
      <url>/2019/02/16/Docker09/</url>
      <content type="html"><![CDATA[<p>在本章介绍 Docker 命令。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="容器生命周期管理"><a href="#容器生命周期管理" class="headerlink" title="容器生命周期管理"></a>容器生命周期管理</h3><h4 id="run"><a href="#run" class="headerlink" title="run"></a>run</h4><p>docker run ：创建一个新的容器并运行一个命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-a stdin:</strong> 指定标准输入输出内容类型，可选 STDIN/STDOUT/STDERR 三项；</li><li><strong>-d:</strong> 后台运行容器，并返回容器ID；</li><li><strong>-i:</strong> 以交互模式运行容器，通常与 -t 同时使用；</li><li><strong>-P:</strong> 随机端口映射，容器内部端口<strong>随机</strong>映射到主机的端口</li><li><strong>-p:</strong> 指定端口映射，格式为：<strong>主机(宿主)端口:容器端口</strong></li><li><strong>-t:</strong> 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</li><li><strong>–name=”nginx-lb”:</strong> 为容器指定一个名称；</li><li><strong>–dns 8.8.8.8:</strong> 指定容器使用的DNS服务器，默认和宿主一致；</li><li><strong>–dns-search example.com:</strong> 指定容器DNS搜索域名，默认和宿主一致；</li><li><strong>-h “mars”:</strong> 指定容器的hostname；</li><li><strong>-e username=”ritchie”:</strong> 设置环境变量；</li><li><strong>–env-file=[]:</strong> 从指定文件读入环境变量；</li><li><strong>–cpuset=”0-2” or –cpuset=”0,1,2”:</strong> 绑定容器到指定CPU运行；</li><li><strong>-m :</strong> 设置容器使用内存最大值；</li><li><strong>–net=”bridge”:</strong> 指定容器的网络连接类型，支持 bridge/host/none/container: 四种类型；</li><li><strong>–link=[]:</strong> 添加链接到另一个容器；</li><li><strong>–expose=[]:</strong> 开放一个端口或一组端口；</li><li><strong>–volume , -v:</strong> 绑定一个卷</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用docker镜像nginx:latest以后台模式启动一个容器,并将容器命名为mynginx。</span></span><br><span class="line">docker run --name mynginx -d nginx:latest</span><br></pre></td></tr></table></figure><h4 id="start-stop-restart"><a href="#start-stop-restart" class="headerlink" title="start/stop/restart"></a>start/stop/restart</h4><p><strong>docker start</strong> :启动一个或多个已经被停止的容器</p><p><strong>docker stop</strong> :停止一个运行中的容器</p><p><strong>docker restart</strong> :重启容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker start [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">docker stop [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">docker restart [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动已被停止的容器myrunoob</span></span><br><span class="line">docker start myrunoob</span><br><span class="line"><span class="comment"># 停止运行中的容器myrunoob</span></span><br><span class="line">docker stop myrunoob</span><br><span class="line"><span class="comment"># 重启容器myrunoob</span></span><br><span class="line">docker restart myrunoob</span><br></pre></td></tr></table></figure><h4 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h4><p><strong>docker kill</strong> :杀掉一个运行中的容器。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">kill</span> [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-s :</strong> 向容器发送一个信号</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 杀掉运行中的容器mynginx</span></span><br><span class="line">runoob@runoob:~$ docker <span class="built_in">kill</span> -s KILL mynginx</span><br></pre></td></tr></table></figure><h4 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h4><p><strong>docker rm ：</strong> 删除一个或多个容器。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-f :</strong> 通过 SIGKILL 信号强制删除一个运行中的容器。</li><li><strong>-l :</strong> 移除容器间的网络连接，而非容器本身。</li><li><strong>-v :</strong> 删除与容器关联的卷。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 强制删除容器 db01、db02</span></span><br><span class="line">docker rm -f db01 db02</span><br></pre></td></tr></table></figure><h4 id="pause-unpause"><a href="#pause-unpause" class="headerlink" title="pause/unpause"></a>pause/unpause</h4><p><strong>docker pause</strong> :暂停容器中所有的进程。</p><p><strong>docker unpause</strong> :恢复容器中所有的进程。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pause [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">docker unpause [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 暂停数据库容器db01提供服务。</span></span><br><span class="line">docker pause db01</span><br><span class="line"><span class="comment"># 恢复数据库容器db01提供服务。</span></span><br><span class="line">docker unpause db01</span><br></pre></td></tr></table></figure><h4 id="create"><a href="#create" class="headerlink" title="create"></a>create</h4><p><strong>docker create ：</strong> 创建一个新的容器但不启动它</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker create [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用docker镜像nginx:latest创建一个容器,并将容器命名为myrunoob</span></span><br><span class="line">runoob@runoob:~$ docker create  --name myrunoob  nginx:latest</span><br></pre></td></tr></table></figure><h4 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h4><p><strong>docker exec ：</strong> 在运行的容器中执行命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> [OPTIONS] CONTAINER COMMAND [ARG...]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-d :</strong> 分离模式: 在后台运行</li><li><strong>-i :</strong> 即使没有附加也保持STDIN 打开</li><li><strong>-t :</strong> 分配一个伪终端</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在容器 mynginx 中以交互模式执行容器内 /root/runoob.sh 脚本:</span></span><br><span class="line">runoob@runoob:~$ docker <span class="built_in">exec</span> -it mynginx /bin/sh /root/runoob.sh</span><br><span class="line"><span class="comment"># 在容器 mynginx 中开启一个交互模式的终端:</span></span><br><span class="line">runoob@runoob:~$ docker <span class="built_in">exec</span> -i -t  mynginx /bin/bash</span><br></pre></td></tr></table></figure><hr><h3 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h3><h4 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h4><p><strong>docker ps :</strong> 列出容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps [OPTIONS]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-a :</strong>显示所有的容器，包括未运行的。</li><li><strong>-f :</strong>根据条件过滤显示的内容。</li><li><strong>–format :</strong>指定返回值的模板文件。</li><li><strong>-l :</strong>显示最近创建的容器。</li><li><strong>-n :</strong>列出最近创建的n个容器。</li><li><strong>–no-trunc :</strong>不截断输出。</li><li><strong>-q :</strong>静默模式，只显示容器编号。</li><li><strong>-s :</strong>显示总的文件大小。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出所有在运行的容器信息</span></span><br><span class="line">runoob@runoob:~$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND                ...  PORTS                    NAMES</span><br><span class="line">09b93464c2f7   nginx:latest   <span class="string">"nginx -g 'daemon off"</span> ...  80/tcp, 443/tcp          myrunoob</span><br><span class="line">96f7f14e99ab   mysql:5.6      <span class="string">"docker-entrypoint.sh"</span> ...  0.0.0.0:3306-&gt;3306/tcp   mymysql</span><br></pre></td></tr></table></figure><p>输出详情介绍：</p><ul><li><strong>CONTAINER ID:</strong> 容器 ID。</li><li><strong>IMAGE:</strong> 使用的镜像。</li><li><strong>COMMAND:</strong> 启动容器时运行的命令。</li><li><strong>CREATED:</strong> 容器的创建时间。</li><li><strong>STATUS:</strong> 容器状态。</li><li><strong>PORTS:</strong> 容器的端口信息和使用的连接类型（tcp\udp）。</li><li><strong>NAMES:</strong> 自动分配的容器名称。</li></ul><p>状态有7种：</p><ul><li>created（已创建）</li><li>restarting（重启中）</li><li>running（运行中）</li><li>removing（迁移中）</li><li>paused（暂停）</li><li>exited（停止）</li><li>dead（死亡）</li></ul><h4 id="inspect"><a href="#inspect" class="headerlink" title="inspect"></a>inspect</h4><p><strong>docker inspect :</strong> 获取容器/镜像的元数据。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect [OPTIONS] NAME|ID [NAME|ID...]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-f :</strong>指定返回值的模板文件。</li><li><strong>-s :</strong>显示总的文件大小。</li><li><strong>–type :</strong>为指定类型返回JSON。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取镜像mysql:5.6的元信息。</span></span><br><span class="line"></span><br><span class="line">runoob@runoob:~$ docker inspect mysql:5.6</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"Id"</span>: <span class="string">"sha256:2c0964ec182ae9a045f866bbc2553087f6e42bfc16074a74fb820af235f070ec"</span>,</span><br><span class="line">        <span class="string">"RepoTags"</span>: [</span><br><span class="line">            <span class="string">"mysql:5.6"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"RepoDigests"</span>: [],</span><br><span class="line">        <span class="string">"Parent"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Comment"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Created"</span>: <span class="string">"2016-05-24T04:01:41.168371815Z"</span>,</span><br><span class="line">        <span class="string">"Container"</span>: <span class="string">"e0924bc460ff97787f34610115e9363e6363b30b8efa406e28eb495ab199ca54"</span>,</span><br><span class="line">        <span class="string">"ContainerConfig"</span>: &#123;</span><br><span class="line">            <span class="string">"Hostname"</span>: <span class="string">"b0cf605c7757"</span>,</span><br><span class="line">            <span class="string">"Domainname"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"User"</span>: <span class="string">""</span>,</span><br><span class="line">            <span class="string">"AttachStdin"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"AttachStdout"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"AttachStderr"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="string">"ExposedPorts"</span>: &#123;</span><br><span class="line">                <span class="string">"3306/tcp"</span>: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取正在运行的容器mymysql的 IP。</span></span><br><span class="line">runoob@runoob:~$ docker inspect --format=<span class="string">'&#123;&#123;range .NetworkSettings.Networks&#125;&#125;&#123;&#123;.IPAddress&#125;&#125;&#123;&#123;end&#125;&#125;'</span> mymysql</span><br><span class="line">172.17.0.3</span><br></pre></td></tr></table></figure><h4 id="top"><a href="#top" class="headerlink" title="top"></a>top</h4><p><strong>docker top :</strong>查看容器中运行的进程信息，支持 ps 命令参数。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top [OPTIONS] CONTAINER [ps OPTIONS]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看容器mymysql的进程信息。</span></span><br><span class="line">runoob@runoob:~/mysql$ docker top mymysql</span><br><span class="line">UID    PID    PPID    C      STIME   TTY  TIME       CMD</span><br><span class="line">999    40347  40331   18     00:58   ?    00:00:02   mysqld</span><br></pre></td></tr></table></figure><h4 id="attach"><a href="#attach" class="headerlink" title="attach"></a>attach</h4><p><strong>docker attach :</strong>连接到正在运行中的容器。</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach [OPTIONS] CONTAINER</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 容器mynginx将访问日志指到标准输出，连接到容器查看访问信息。</span></span><br><span class="line">runoob@runoob:~$ docker attach --sig-proxy=<span class="literal">false</span> mynginx</span><br><span class="line">192.168.239.1 - - [10/Jul/2016:16:54:26 +0000] <span class="string">"GET / HTTP/1.1"</span> 304 0 <span class="string">"-"</span> <span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36"</span> <span class="string">"-"</span></span><br></pre></td></tr></table></figure><h4 id="events"><a href="#events" class="headerlink" title="events"></a>events</h4><p><strong>docker events :</strong> 从服务器获取实时事件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker events [OPTIONS]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-f ：</strong>根据条件过滤事件；</li><li><strong>–since ：</strong>从指定的时间戳后显示所有事件;</li><li><strong>–until ：</strong>流水时间显示到指定的时间为止；</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 显示docker 2016年7月1日后的所有事件。</span></span><br><span class="line">runoob@runoob:~/mysql$ docker events  --since=<span class="string">"1467302400"</span></span><br><span class="line">2016-07-08T19:44:54.501277677+08:00 network connect 66f958fd13dc4314ad20034e576d5c5eba72e0849dcc38ad9e8436314a4149d4 (container=b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64, name=bridge, <span class="built_in">type</span>=bridge)</span><br><span class="line">2016-07-08T19:44:54.723876221+08:00 container start b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64 (image=nginx:latest, name=elegant_albattani)</span><br><span class="line">2016-07-08T19:44:54.726110498+08:00 container resize b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64 (height=39, image=nginx:latest, name=elegant_albattani, width=167)</span><br><span class="line">2016-07-08T19:46:22.137250899+08:00 container die b8573233d675705df8c89796a2c2687cd8e36e03646457a15fb51022db440e64 (exitCode=0, image=nginx:latest, name=elegant_albattani)</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="logs"><a href="#logs" class="headerlink" title="logs"></a>logs</h4><p><strong>docker logs :</strong> 获取容器的日志</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs [OPTIONS] CONTAINER</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-f :</strong> 跟踪日志输出</li><li><strong>–since :</strong>显示某个开始时间的所有日志</li><li><strong>-t :</strong> 显示时间戳</li><li><strong>–tail :</strong>仅列出最新N条容器日志</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 跟踪查看容器mynginx的日志输出。</span></span><br><span class="line">runoob@runoob:~$ docker logs -f mynginx</span><br><span class="line">192.168.239.1 - - [10/Jul/2016:16:53:33 +0000] <span class="string">"GET / HTTP/1.1"</span> 200 612 <span class="string">"-"</span> <span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36"</span> <span class="string">"-"</span></span><br><span class="line">2016/07/10 16:53:33 [error] 5<span class="comment">#5: *1 open() "/usr/share/nginx/html/favicon.ico" failed (2: No such file or directory), client: 192.168.239.1, server: localhost, request: "GET /favicon.ico HTTP/1.1", host: "192.168.239.130", referrer: "http://192.168.239.130/"</span></span><br><span class="line">192.168.239.1 - - [10/Jul/2016:16:53:33 +0000] <span class="string">"GET /favicon.ico HTTP/1.1"</span> 404 571 <span class="string">"http://192.168.239.130/"</span> <span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36"</span> <span class="string">"-"</span></span><br><span class="line">192.168.239.1 - - [10/Jul/2016:16:53:59 +0000] <span class="string">"GET / HTTP/1.1"</span> 304 0 <span class="string">"-"</span> <span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.93 Safari/537.36"</span> <span class="string">"-"</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="wait"><a href="#wait" class="headerlink" title="wait"></a>wait</h4><p><strong>docker wait :</strong> 阻塞运行直到容器停止，然后打印出它的退出代码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">wait</span> [OPTIONS] CONTAINER [CONTAINER...]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">wait</span> CONTAINER</span><br></pre></td></tr></table></figure><h4 id="export"><a href="#export" class="headerlink" title="export"></a>export</h4><p><strong>docker export :</strong>将文件系统作为一个tar归档文件导出到STDOUT。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">export</span> [OPTIONS] CONTAINER</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-o :</strong>将输入内容写到文件。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将id为a404c6c174a2的容器按日期保存为tar文件。</span></span><br><span class="line">runoob@runoob:~$ docker <span class="built_in">export</span> -o mysql-`date +%Y%m%d`.tar a404c6c174a2</span><br><span class="line">runoob@runoob:~$ ls mysql-`date +%Y%m%d`.tar</span><br><span class="line">mysql-20160711.tar</span><br></pre></td></tr></table></figure><h4 id="port"><a href="#port" class="headerlink" title="port"></a>port</h4><p><strong>docker port :</strong>列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker port [OPTIONS] CONTAINER [PRIVATE_PORT[/PROTO]]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看容器mynginx的端口映射情况。</span></span><br><span class="line">runoob@runoob:~$ docker port mymysql</span><br><span class="line">3306/tcp -&gt; 0.0.0.0:3306</span><br></pre></td></tr></table></figure><hr><h3 id="容器rootfs命令"><a href="#容器rootfs命令" class="headerlink" title="容器rootfs命令"></a>容器rootfs命令</h3><h4 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h4><p><strong>docker commit :</strong>从容器创建一个新的镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-a :</strong>提交的镜像作者；</li><li><strong>-c :</strong>使用Dockerfile指令来创建镜像；</li><li><strong>-m :</strong>提交时的说明文字；</li><li><strong>-p :</strong>在commit时，将容器暂停。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将容器a404c6c174a2 保存为新的镜像,并添加提交人信息和说明信息。</span></span><br><span class="line">runoob@runoob:~$ docker commit -a <span class="string">"runoob.com"</span> -m <span class="string">"my apache"</span> a404c6c174a2  mymysql:v1 </span><br><span class="line">sha256:37af1236adef1544e8886be23010b66577647a40bc02c0885a6600b33ee28057</span><br></pre></td></tr></table></figure><h4 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h4><p><strong>docker cp :</strong>用于容器与主机之间的数据拷贝。</p><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-</span><br><span class="line">docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-L :</strong>保持源目标中的链接</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将主机/www/runoob目录拷贝到容器96f7f14e99ab的/www目录下。</span></span><br><span class="line">docker cp /www/runoob 96f7f14e99ab:/www/</span><br></pre></td></tr></table></figure><h4 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h4><p><strong>docker diff :</strong> 检查容器里文件结构的更改。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker diff [OPTIONS] CONTAINER</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看容器mymysql的文件结构更改。</span></span><br><span class="line">runoob@runoob:~$ docker diff mymysql</span><br><span class="line">A /logs</span><br></pre></td></tr></table></figure><h3 id="镜像仓库"><a href="#镜像仓库" class="headerlink" title="镜像仓库"></a>镜像仓库</h3><h4 id="login"><a href="#login" class="headerlink" title="login"></a>login</h4><p><strong>docker login :</strong> 登陆到一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub</p><p><strong>docker logout :</strong> 登出一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker login [OPTIONS] [SERVER]</span><br><span class="line">docker <span class="built_in">logout</span> [OPTIONS] [SERVER]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-u :</strong>登陆的用户名</li><li><strong>-p :</strong>登陆的密码</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 登陆到Docker Hub</span></span><br><span class="line">docker login -u 用户名 -p 密码</span><br><span class="line"><span class="comment"># 登出Docker Hub</span></span><br><span class="line">docker <span class="built_in">logout</span></span><br></pre></td></tr></table></figure><h4 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h4><p><strong>docker pull :</strong> 从镜像仓库中拉取或者更新指定镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull [OPTIONS] NAME[:TAG|@DIGEST]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-a :</strong>拉取所有 tagged 镜像  </li><li><strong>–disable-content-trust :</strong>忽略镜像的校验,默认开启</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从Docker Hub下载java最新版镜像。</span></span><br><span class="line">docker pull java</span><br></pre></td></tr></table></figure><h4 id="push"><a href="#push" class="headerlink" title="push"></a>push</h4><p><strong>docker push :</strong> 将本地的镜像上传到镜像仓库,要先登陆到镜像仓库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push [OPTIONS] NAME[:TAG]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>–disable-content-trust :</strong>忽略镜像的校验,默认开启</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上传本地镜像myapache:v1到镜像仓库中。</span></span><br><span class="line">docker push myapache:v1</span><br></pre></td></tr></table></figure><h4 id="search"><a href="#search" class="headerlink" title="search"></a>search</h4><p><strong>docker search :</strong> 从Docker Hub查找镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search [OPTIONS] TERM</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>–automated :</strong>只列出 automated build类型的镜像；</li><li><strong>–no-trunc :</strong>显示完整的镜像描述；</li><li><strong>-s :</strong>列出收藏数不小于指定值的镜像。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从Docker Hub查找所有镜像名包含java，并且收藏数大于10的镜像</span></span><br><span class="line">runoob@runoob:~$ docker search -s 10 java</span><br><span class="line">NAME                  DESCRIPTION                           STARS   OFFICIAL   AUTOMATED</span><br><span class="line">java                  Java is a concurrent, class-based...   1037    [OK]       </span><br><span class="line">anapsix/alpine-java   Oracle Java 8 (and 7) with GLIBC ...   115                [OK]</span><br><span class="line">develar/java                                                 46                 [OK]</span><br><span class="line">isuper/java-oracle    This repository contains all java...   38                 [OK]</span><br><span class="line">lwieske/java-8        Oracle Java 8 Container - Full + ...   27                 [OK]</span><br><span class="line">nimmis/java-centos    This is docker images of CentOS 7...   13                 [OK]</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li><strong>NAME:</strong> 镜像仓库源的名称</li><li><strong>DESCRIPTION:</strong> 镜像的描述</li><li><strong>OFFICIAL:</strong> 是否 docker 官方发布</li><li><strong>stars:</strong> 类似 Github 里面的 star，表示点赞、喜欢的意思。</li><li><strong>AUTOMATED:</strong> 自动构建。</li></ul><hr><h3 id="本地镜像管理"><a href="#本地镜像管理" class="headerlink" title="本地镜像管理"></a>本地镜像管理</h3><h4 id="images"><a href="#images" class="headerlink" title="images"></a>images</h4><p><strong>docker images :</strong> 列出本地镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images [OPTIONS] [REPOSITORY[:TAG]]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-a :</strong>列出本地所有的镜像（含中间映像层，默认情况下，过滤掉中间映像层）；</li><li><strong>–digests :</strong>显示镜像的摘要信息；</li><li><strong>-f :</strong>显示满足条件的镜像；</li><li><strong>–format :</strong>指定返回值的模板文件；</li><li><strong>–no-trunc :</strong>显示完整的镜像信息；  </li><li><strong>-q :</strong>只显示镜像ID。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看本地镜像列表</span></span><br><span class="line">runoob@runoob:~$ docker images</span><br></pre></td></tr></table></figure><h4 id="rmi"><a href="#rmi" class="headerlink" title="rmi"></a>rmi</h4><p><strong>docker rmi :</strong> 删除本地一个或多少镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi [OPTIONS] IMAGE [IMAGE...]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-f :</strong>强制删除；</li><li><strong>–no-prune :</strong>不移除该镜像的过程镜像，默认移除；</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 强制删除本地镜像 runoob/ubuntu:v4</span></span><br><span class="line">root@runoob:~<span class="comment"># docker rmi -f runoob/ubuntu:v4</span></span><br></pre></td></tr></table></figure><h4 id="tag"><a href="#tag" class="headerlink" title="tag"></a>tag</h4><p><strong>docker tag :</strong> 标记本地镜像，将其归入某一仓库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将镜像ubuntu:15.10标记为 runoob/ubuntu:v3 镜像</span></span><br><span class="line">root@runoob:~<span class="comment"># docker tag ubuntu:15.10 runoob/ubuntu:v3</span></span><br></pre></td></tr></table></figure><h4 id="build"><a href="#build" class="headerlink" title="build"></a>build</h4><p><strong>docker build</strong> 命令用于使用 Dockerfile 创建镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build [OPTIONS] PATH | URL | -</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>–build-arg=[] :</strong>设置镜像创建时的变量；</li><li><strong>–cpu-shares :</strong>设置 cpu 使用权重；</li><li><strong>–cpu-period :</strong>限制 CPU CFS周期；</li><li><strong>–cpu-quota :</strong>限制 CPU CFS配额；</li><li><strong>–cpuset-cpus :</strong>指定使用的CPU id；</li><li><strong>–cpuset-mems :</strong>指定使用的内存 id；</li><li><strong>–disable-content-trust :</strong>忽略校验，默认开启；</li><li><strong>-f :</strong>指定要使用的Dockerfile路径；</li><li><strong>–force-rm :</strong>设置镜像过程中删除中间容器；</li><li><strong>–isolation :</strong>使用容器隔离技术；</li><li><strong>–label=[] :</strong>设置镜像使用的元数据；</li><li><strong>-m :</strong>设置内存最大值；</li><li><strong>–memory-swap :</strong>设置Swap的最大值为内存+swap，”-1”表示不限swap；</li><li><strong>–no-cache :</strong>创建镜像的过程不使用缓存；</li><li><strong>–pull :</strong>尝试去更新镜像的新版本；</li><li><strong>–quiet, -q :</strong>安静模式，成功后只输出镜像 ID；</li><li><strong>–rm :</strong>设置镜像成功后删除中间容器；</li><li><strong>–shm-size :</strong>设置/dev/shm的大小，默认值是64M；</li><li><strong>–ulimit :</strong>Ulimit配置。</li><li><strong>–tag, -t:</strong> 镜像的名字及标签，通常 name:tag 或者 name 格式；可以在一次构建中为一个镜像设置多个标签。</li><li><strong>–network:</strong> 默认 default。在构建期间设置RUN指令的网络模式</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用当前目录的 Dockerfile 创建镜像，标签为 runoob/ubuntu:v1</span></span><br><span class="line">docker build -t runoob/ubuntu:v1 .</span><br></pre></td></tr></table></figure><h4 id="history"><a href="#history" class="headerlink" title="history"></a>history</h4><p><strong>docker history :</strong> 查看指定镜像的创建历史。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">history</span> [OPTIONS] IMAGE</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-H :</strong>以可读的格式打印镜像大小和日期，默认为true；</li><li><strong>–no-trunc :</strong>显示完整的提交记录； </li><li><strong>-q :</strong>仅列出提交记录ID。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看本地镜像runoob/ubuntu:v3的创建历史</span></span><br><span class="line">root@runoob:~<span class="comment"># docker history runoob/ubuntu:v3</span></span><br></pre></td></tr></table></figure><h4 id="save"><a href="#save" class="headerlink" title="save"></a>save</h4><p><strong>docker save :</strong> 将指定镜像保存成 tar 归档文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save [OPTIONS] IMAGE [IMAGE...]</span><br></pre></td></tr></table></figure><p>OPTIONS 说明：</p><ul><li><strong>-o :</strong>输出到的文件。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将镜像 runoob/ubuntu:v3 生成 my_ubuntu_v3.tar 文档</span></span><br><span class="line">runoob@runoob:~$ docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3</span><br></pre></td></tr></table></figure><h4 id="load"><a href="#load" class="headerlink" title="load"></a>load</h4><p><strong>docker load :</strong> 导入使用 <a href="#save">docker save</a> 命令导出的镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker load [OPTIONS]</span><br></pre></td></tr></table></figure><p>OPTIONS 说明：</p><ul><li><strong>–input , -i :</strong> 指定导入的文件，代替 STDIN。</li><li><strong>–quiet , -q :</strong> 精简输出信息。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入镜像</span></span><br><span class="line">$ docker load &lt; busybox.tar.gz</span><br></pre></td></tr></table></figure><h4 id="import"><a href="#import" class="headerlink" title="import"></a>import</h4><p><strong>docker import :</strong> 从归档文件中创建镜像。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-c :</strong>应用docker 指令创建镜像； </li><li><strong>-m :</strong>提交时的说明文字；</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从镜像归档文件my_ubuntu_v3.tar创建镜像，命名为runoob/ubuntu:v4</span></span><br><span class="line">runoob@runoob:~$ docker import  my_ubuntu_v3.tar runoob/ubuntu:v4</span><br></pre></td></tr></table></figure><hr><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="info"><a href="#info" class="headerlink" title="info"></a>info</h4><p>docker info : 显示 Docker 系统信息，包括镜像和容器数。。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info [OPTIONS]</span><br></pre></td></tr></table></figure><h4 id="version"><a href="#version" class="headerlink" title="version"></a>version</h4><p>docker version :显示 Docker 版本信息。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker version [OPTIONS]</span><br></pre></td></tr></table></figure><p>OPTIONS说明：</p><ul><li><strong>-f :</strong>指定返回值的模板文件。</li></ul>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（八）Docker API</title>
      <link href="/2019/01/16/Docker08/"/>
      <url>/2019/01/16/Docker08/</url>
      <content type="html"><![CDATA[<p>Docker 本身提供了强大的API功能，我们可以通过访问Docker API来对Docker服务进行管理。<br>在本章介绍如何使用Docker API。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Docker-API"><a href="#Docker-API" class="headerlink" title="Docker API"></a>Docker API</h3><p>Docker提供了很多的API以便用户使用。这些API包含四个方面：</p><ul><li>Docker Registry API：提供了与存储Docker镜像的Docker Registry集成的功能。</li><li>Docker Hub API：：提供了与Docker HUB集成的功能</li><li>Docker OAuth API: 提供了与OAuth的认证授权的功能</li><li>Docker Remote API：：提供与Docker守护进程进行集成的功能</li></ul><h4 id="Docker-Registry-API"><a href="#Docker-Registry-API" class="headerlink" title="Docker Registry API"></a>Docker Registry API</h4><table><thead><tr><th>用途</th><th>方法</th><th>url</th><th>样例</th></tr></thead><tbody><tr><td>取出镜像层</td><td>GET</td><td>/v1/images/(image_id)/layer</td><td><img src="/image/Docker08/Docker08_001.jpg" alt=""></td></tr><tr><td>插入镜像层</td><td>PUT</td><td>/v1/images/(image_id)/layer</td><td><img src="/image/Docker08/Docker08_002.jpg" alt=""></td></tr><tr><td>检索镜像</td><td>GET</td><td>/v1/images/(image_id)/json</td><td></td></tr><tr><td>检索根镜像</td><td>GET</td><td>/v1/images/(image_id)/ancestry</td><td></td></tr><tr><td>获取库里所有的标签或者指定标签</td><td>GET</td><td>/v1/repositories/(namespace)/(repository)/tags</td><td><img src="/image/Docker08/Docker08_003.jpg" alt=""></td></tr><tr><td>获取库里所有的标签或者指定标签</td><td>GET</td><td>/v1/repositories/(namespace)/(repository)/tags/(tag*)</td><td><img src="/image/Docker08/Docker08_004.jpg" alt=""></td></tr><tr><td>删除标签</td><td>DELETE</td><td>/v1/repositories/(namespace)/(repository)/tags/(tag*)</td><td><img src="/image/Docker08/Docker08_005.jpg" alt=""></td></tr><tr><td>registry状态检查</td><td>GET</td><td>/v1/_ping</td><td><img src="/image/Docker08/Docker08_006.jpg" alt=""></td></tr><tr><td>创建镜像</td><td>POST</td><td>/images/create</td><td><img src="/image/Docker08/Docker08_007.jpg" alt=""></td></tr><tr><td>利用容器创建镜像</td><td>POST</td><td>/commit</td><td><img src="/image/Docker08/Docker08_008.jpg" alt=""></td></tr><tr><td>获取镜像清单</td><td>GET</td><td>/images/json</td><td><img src="/image/Docker08/Docker08_009.jpg" alt=""></td></tr><tr><td>导入指定的路径文件</td><td>POST</td><td>/images/(name)/insert</td><td><img src="/image/Docker08/Docker08_010.jpg" alt=""></td></tr><tr><td>删除镜像</td><td>DELETE</td><td>/images/(name)</td><td><img src="/image/Docker08/Docker08_011.jpg" alt=""></td></tr><tr><td>推送镜像到Registry</td><td>POST</td><td>/images/(name)/push</td><td><img src="/image/Docker08/Docker08_012.jpg" alt=""></td></tr><tr><td>Tag镜像</td><td>POST</td><td>/images/(name)/tag</td><td><img src="/image/Docker08/Docker08_013.jpg" alt=""></td></tr><tr><td>搜索镜像</td><td>GET</td><td>/images/search</td><td><img src="/image/Docker08/Docker08_014.jpg" alt=""></td></tr><tr><td>查看镜像历史</td><td>GET</td><td>/images/(name)/history</td><td><img src="/image/Docker08/Docker08_015.jpg" alt=""></td></tr><tr><td>构建镜像</td><td>POST</td><td>/build</td><td><img src="/image/Docker08/Docker08_016.jpg" alt=""></td></tr></tbody></table><h4 id="Docker-Hub-API"><a href="#Docker-Hub-API" class="headerlink" title="Docker Hub API"></a>Docker Hub API</h4><table><thead><tr><th>用途</th><th>方法</th><th>url</th><th>样例</th></tr></thead><tbody><tr><td><strong>创建一个新的仓库</strong></td><td>PUT</td><td>/v1/repositories/(repo_name)/</td><td></td></tr><tr><td><strong>删除已经存在的仓库</strong></td><td>DELETE</td><td>/v1/repositories/(repo_name)/</td><td></td></tr><tr><td><strong>更新仓库镜像</strong></td><td>PUT</td><td>/v1/repositories/(repo_name)/images</td><td></td></tr><tr><td><strong>从仓库中获取镜像</strong></td><td>GET</td><td>/v1/repositories/(repo_name)/images</td><td></td></tr><tr><td><strong>授权</strong></td><td>PUT</td><td>/v1/repositories/(repo_name)/auth</td><td></td></tr><tr><td><strong>创建用户仓库</strong></td><td>PUT</td><td>/v1/repositories/(namespace)/(repo_name)/</td><td><img src="/image/Docker08/Docker08_017.jpg" alt=""></td></tr><tr><td><strong>删除用户仓库</strong></td><td>DELETE</td><td>/v1/repositories/(namespace)/(repo_name)/</td><td><img src="/image/Docker08/Docker08_018.jpg" alt=""></td></tr><tr><td><strong>更新用户仓库镜像</strong></td><td>PUT</td><td>/v1/repositories/(namespace)/(repo_name)/images</td><td><img src="/image/Docker08/Docker08_019.jpg" alt=""></td></tr><tr><td><strong>从仓库中下载镜像</strong></td><td>GET</td><td>/v1/repositories/(namespace)/(repo_name)/images</td><td><img src="/image/Docker08/Docker08_020.jpg" alt=""></td></tr><tr><td><strong>验证用户登录</strong></td><td>GET</td><td>/v1/users</td><td><img src="/image/Docker08/Docker08_021.jpg" alt=""></td></tr><tr><td><strong>添加新用户</strong></td><td>POST</td><td>/v1/users</td><td></td></tr><tr><td><strong>更新用户信息</strong></td><td>PUT</td><td>/v1/users/(username)/</td></tr></tbody></table><h4 id="Docker-Remote-API"><a href="#Docker-Remote-API" class="headerlink" title="Docker Remote API"></a>Docker Remote API</h4><table><thead><tr><th>用途</th><th>方法</th><th>url</th><th>样例</th></tr></thead><tbody><tr><td><strong>容器列表</strong></td><td>GET</td><td>/containers/json</td><td><img src="/image/Docker08/Docker08_022.jpg" alt=""></td></tr><tr><td><strong>创建新容器</strong></td><td>POST</td><td>/containers/create</td><td><img src="/image/Docker08/Docker08_023.jpg" alt=""></td></tr><tr><td><strong>监控容器</strong></td><td>GET</td><td>/containers/(id)/json</td><td><img src="/image/Docker08/Docker08_024.jpg" alt=""></td></tr><tr><td><strong>进程列表</strong></td><td>GET</td><td>/containers/(id)/top</td><td><img src="/image/Docker08/Docker08_025.jpg" alt=""></td></tr><tr><td><strong>容器日志</strong></td><td>GET</td><td>/containers/(id)/logs</td><td><img src="/image/Docker08/Docker08_026.jpg" alt=""></td></tr><tr><td><strong>导出容器</strong></td><td>GET</td><td>/containers/(id)/export</td><td><img src="/image/Docker08/Docker08_027.jpg" alt=""></td></tr><tr><td><strong>启动容器</strong></td><td>POST</td><td>/containers/(id)/start</td><td><img src="/image/Docker08/Docker08_028.jpg" alt=""></td></tr><tr><td><strong>停止容器</strong></td><td>POST</td><td>/containers/(id)/stop</td><td><img src="/image/Docker08/Docker08_029.jpg" alt=""></td></tr><tr><td><strong>重启容器</strong></td><td>POST</td><td>/containers/(id)/restart</td><td><img src="/image/Docker08/Docker08_030.jpg" alt=""></td></tr><tr><td><strong>终止容器</strong></td><td>POST</td><td>/containers/(id)/kill</td><td><img src="/image/Docker08/Docker08_031.jpg" alt=""></td></tr></tbody></table><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>当Docker允许与访客容器目录共享而不限制其访问权限时，Docker Daemon的控制权应该只给授权用户。</li><li>REST API支持Unix sockets，从而防止了cross-site-scripting攻击。</li><li>REST API的HTTP接口应该在可信网络或者VPN下使用。</li><li>在服务器上单独运行Docker时，需要与其它服务隔离。</li><li>容器以非特权用户运行。</li><li>Apparmor、SELinux、GRSEC解决方案，可用于额外的安全层。</li><li>可以使用其它容器系统的安全功能。</li></ul><p>More info:<a href="https://docs.docker.com/engine/api/v1.37/#" target="_blank" rel="noopener">Docker API</a></p>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（七）Docker Registry</title>
      <link href="/2018/12/16/Docker07/"/>
      <url>/2018/12/16/Docker07/</url>
      <content type="html"><![CDATA[<p>Docker Registry 是所有仓库（包括共有和私有）以及工作流的中央Registry。本章介绍Docker Registry的工作角色。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Docker-Registry"><a href="#Docker-Registry" class="headerlink" title="Docker Registry"></a>Docker Registry</h3><p>Docker Registry有三个角色，分别是index、registry和registry client。</p><ul><li>1.Index:负责并维护有关用户帐户、镜像的校验以及公共命名空间的信息。它使用以下组件维护这些信息：<ul><li>Web UI</li><li>元数据存储</li><li>认证服务</li><li>符号化</li></ul></li></ul><ul><li><p>2.Registry:是镜像和图表的仓库。然而，它没有一个本地数据库，也不提供用户的身份认证，由S3、云文件和本地文件系统提供数据库支持。此外，通过Index Auth service的Token方式进行身份认证。</p><ul><li>Sponsor Registry：第三方的registry，供客户和Docker社区使用。</li><li>Mirror Registry：第三方的registry，只让客户使用。</li><li>Vendor Registry：由发布Docker镜像的供应商提供的registry。</li><li>Private Registry：通过设有防火墙和额外的安全层的私有实体提供的registry。</li></ul></li><li><p>3.Registry Client:Docker充当registry客户端来负责维护推送和拉取的任务，以及客户端的授权。</p></li></ul><h3 id="工作流程详解"><a href="#工作流程详解" class="headerlink" title="工作流程详解"></a>工作流程详解</h3><ul><li>1:用户要获取并下载镜像。所涉及的步骤如下：<ul><li>1.用户发送请求到index来下载镜像。</li><li>2.index 发出响应，返回三个相关部分信息：<ul><li>该镜像所处的registry</li><li>该镜像包括所有层的校验</li><li>以授权为目的的Token &gt; 注意：当请求header里有X-Docker-Token时才会返回Token。而私人仓库需要基本的身份验证，对于公有仓库这一点不是强制性的。</li></ul></li><li>3.用户通过响应后返回的Token和registry沟通，registry全权负责镜像，它用来存储基本的镜像和继承的层。</li><li>4.registry现在要与index证实该token是被授权的。</li><li>5.index会发送“true” 或者 “false”给registry，由此判定是否允许用户下载所需要的镜像。</li></ul></li></ul><p><img src="/image/Docker07/Docker07_001.png" alt=""></p><ul><li>2:用户想要将镜像推送到registry中。其中涉及的步骤如下：<ul><li>1.用户发送附带证书的请求到index要求分配库名。</li><li>2.在认证成功，命名空间可用之后，库名也被分配。index发出响应返回临时的token。</li><li>3.镜像连带token，一起被推送到registry中。</li><li>4.registry与index证实token被授权，然后在index验证之后开始读取推送流。</li><li>5.该index由Docker校验的镜像更新。</li></ul></li></ul><p><img src="/image/Docker07/Docker07_002.png" alt=""></p><ul><li>3.用户想要从index或registry中删除镜像：<ul><li>1.index接收来自Docker一个删除库的信号。</li><li>2.如果index对库验证成功，它将删除该库，并返回一个临时的token。</li><li>3.registry现在接收到带有该token的删除信号。</li><li>4.registry与index核实该token，然后删除库以及所有与其相关的信息。</li><li>5.Docker现在通知有关删除的index，然后index移除库的所有记录。</li></ul></li></ul><p><img src="/image/Docker07/Docker07_003.png" alt=""></p><ul><li><p>4：用户希望在没有index的独立模式中使用registry。<br>  使用没有index的registry，这完全由Docker控制，它最适合于在私有网络中存储镜像。registry运行在一个特殊的模式里，此模式限制了registry与Docker index的通信。所有有关安全性和身份验证的信息需要用户自己注意。</p></li><li><p>5：用户想要在有index的独立模式中使用registry。<br>  在这种情况下，一个自定义的index会被创建在私有网络里来存储和访问镜像的问题。然而，通知Docker有关定制的index是耗时的。 Docker提供一个有趣的概念chaining registries，从而，实现负载均衡和为具体请求而指定的registry分配。在接下来的Docker教程系列中，我们将讨论如何在上述每个情景中使用Docker Registry API ，以及深入了解Docker Security。</p></li></ul>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（六）Docker Swarm</title>
      <link href="/2018/11/16/Docker06/"/>
      <url>/2018/11/16/Docker06/</url>
      <content type="html"><![CDATA[<p><a href="https://github.com/docker/classicswarm" target="_blank" rel="noopener">Docker Swarm</a> 和 Docker Compose 一样，都是 Docker 官方容器编排项目，但不同的是，Docker Compose 是一个在单个服务器或主机上创建多个容器的工具，而 Docker Swarm 则可以在多个服务器或主机上创建容器集群服务，对于微服务的部署，显然 Docker Swarm 会更加适合。  本文章介绍如何使用 Docker  Swarm 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/Docker06/Docker06_001.png" alt=""></p><p>从 Docker 1.12.0 版本开始，Docker Swarm 已经包含在 Docker 引擎中（docker swarm），并且已经内置了服务发现工具，我们就不需要像之前一样，再配置 Etcd 或者 Consul 来进行服务发现配置了。</p><p>Swarm Deamon 只是一个调度器(Scheduler)和路由器(router),自身不运行容器，只接受Docker客户端发来的请求，调度适合的节点来运行容器。意味着即使Swarm由于某些原因挂掉了，集群中的节点也会照常运行，当Swarm重新恢复运行之后，他会收集重建集群信息。</p><h3 id="运行机制"><a href="#运行机制" class="headerlink" title="运行机制"></a>运行机制</h3><p> Swarm是典型的master-slave结构，通过发现服务来选举manager。manager是中心管理节点，各个node上运行agent接受manager的统一管理，集群会自动通过Raft协议分布式选举出manager节点，无需额外的发现服务支持，避免了单点的瓶颈问题，同时也内置了DNS的负载均衡和对外部负载均衡机制的集成支持。 下图是Docker Client使用Swarm对 集群(Cluster)进行调度使用。 </p><p><img src="/image/Docker06/Docker06_002.png" alt=""></p><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><ul><li><p>1.Swarm<br>集群的管理和编排是使用嵌入docker引擎的SwarmKit，可以在docker初始化时启动swarm模式或者加入已存在的swarm。子命令有init, join, leave, update。（docker swarm –help查看帮助）</p></li><li><p>2.Node：node是加入到swarm集群中的一个docker引擎实体，可以在一台物理机上运行多个node。子命令有accept, promote, demote, inspect, update, tasks, ls, rm。（docker node –help查看帮助）</p><ul><li>manager node管理节点：执行集群的管理功能，维护集群的状态，选举一个leader节点去执行调度任务。</li><li>worker node工作节点：接收和执行任务。参与容器集群负载调度，仅用于承载task。</li></ul></li><li><p>3.Service服务：一个服务是工作节点上执行任务的定义。创建一个服务，指定了容器所使用的镜像和容器运行的命令。子命令有create, inspect, update, remove, tasks。（docker service–help查看帮助）</p></li><li><p>4.Task任务：一个任务包含了一个容器及其运行的命令。task是service的执行实体，task启动docker容器并在容器中执行任务。</p></li></ul><h3 id="工作模式"><a href="#工作模式" class="headerlink" title="工作模式"></a>工作模式</h3><ol><li>Node</li></ol><p><img src="/image/Docker06/Docker06_003.png" alt=""></p><ol start="2"><li>Service</li></ol><p><img src="/image/Docker06/Docker06_004.png" alt=""></p><ol start="3"><li>任务与调度</li></ol><p><img src="/image/Docker06/Docker06_005.png" alt=""></p><ol start="4"><li>服务副本与全局服务</li></ol><p><img src="/image/Docker06/Docker06_006.png" alt=""></p><h3 id="Swarm的调度策略"><a href="#Swarm的调度策略" class="headerlink" title="Swarm的调度策略"></a>Swarm的调度策略</h3><p>Swarm在调度(scheduler)节点（leader节点）运行容器的时候，会根据指定的策略来计算最适合运行容器的节点，目前支持的策略有：spread, binpack, random.</p><ul><li><p>1.Random<br>顾名思义，就是随机选择一个Node来运行容器，一般用作调试用，spread和binpack策略会根据各个节点的可用的CPU, RAM以及正在运<br>行的容器的数量来计算应该运行容器的节点。</p></li><li><p>2.Spread<br>在同等条件下，Spread策略会选择运行容器最少的那台节点来运行新的容器，binpack策略会选择运行容器最集中的那台机器来运行新的节点。<br>使用Spread策略会使得容器会均衡的分布在集群中的各个节点上运行，一旦一个节点挂掉了只会损失少部分的容器。</p></li><li><p>3.Binpack<br>Binpack策略最大化的避免容器碎片化，就是说binpack策略尽可能的把还未使用的节点留给需要更大空间的容器运行，尽可能的把容器运行在<br>一个节点上面。</p></li></ul><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>以下示例，均以 Docker Machine 和 virtualbox 进行介绍，确保你的主机已安装 virtualbox。</p><ul><li>1.创建 swarm 集群管理节点（manager）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 docker 机器</span></span><br><span class="line">$ docker-machine create -d virtualbox swarm-manager</span><br></pre></td></tr></table></figure></li></ul><p><img src="/image/Docker06/Docker06_007.png" alt=""></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始化 swarm 集群，进行初始化的这台机器，就是集群的管理节点。</span></span><br><span class="line"><span class="variable">$docker</span>-machine ssh swarm-manager</span><br><span class="line">$ docker swarm init --advertise-addr 192.168.99.107 <span class="comment">#这里的 IP 为创建机器时分配的 ip。</span></span><br></pre></td></tr></table></figure><p><img src="/image/Docker06/Docker06_008.png" alt=""></p><p>以上输出，证明已经初始化成功。需要把以下这行复制出来，在增加工作节点时会用到：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker swarm join --token SWMTKN-1-4oogo9qziq768dma0uh3j0z0m5twlm10iynvz7ixza96k6jh9p-ajkb6w7qd06y1e33yrgko64sk 192.168.99.107:2377</span><br></pre></td></tr></table></figure><ul><li><p>2.创建 swarm 集群工作节点（worker）</p><p>  这里直接创建好俩台机器，swarm-worker1 和 swarm-worker2 。<br>  <img src="/image/Docker06/Docker06_009.png" alt=""></p><p>  分别进入两个机器里，用到上一步复制的内容,添加至上一步中创建的集群.</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker swarm join --token SWMTKN-1-4oogo9qziq768dma0uh3j0z0m5twlm10iynvz7ixza96k6jh9p-ajkb6w7qd06y1e33yrgko64sk 192.168.99.107:2377</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_010.png" alt=""><br>  以上数据输出说明已经添加成功。</p></li></ul><ul><li><p>3.查看集群信息</p><p>  进入管理节点，执行：docker info 可以查看当前集群的信息。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker info</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_011.png" alt=""></p><p>  通过画红圈的地方，可以知道当前运行的集群中，有三个节点，其中有一个是管理节点。</p></li><li><p>4.部署服务到集群中</p><p>  <strong>注意</strong>：跟集群管理有关的任何操作，都是在管理节点上操作的。</p><p>  以下例子，在一个工作节点上创建一个名为 helloworld 的服务，这里是随机指派给一个工作节点：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service create --replicas 1 --name helloworld alpine ping docker.com</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_012.png" alt=""></p></li><li><p>5.查看服务部署情况</p><p>  查看 helloworld 服务运行在哪个节点上，可以看到目前是在 swarm-worker1 节点：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service ps helloworld</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_013.png" alt=""></p><p>  查看 helloworld 部署的具体信息：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service inspect --pretty helloworld</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_014.png" alt=""></p></li><li><p>6.扩展集群服务</p><p>  我们将上述的 helloworld 服务扩展到俩个节点。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service scale helloworld=2</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_015.png" alt=""></p><p>  可以看到已经从一个节点，扩展到两个节点。</p><p>  <img src="/image/Docker06/Docker06_016.png" alt=""></p></li><li><p>7.删除服务</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service rm helloworld</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_017.png" alt=""></p><p>  查看是否已删除：</p><p>  <img src="/image/Docker06/Docker06_018.png" alt=""></p></li><li><p>8.滚动升级服务</p><p>  以下实例，我们将介绍 redis 版本如何滚动升级至更高版本。<br>  创建一个 3.0.6 版本的 redis。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service create --replicas 1 --name redis --update-delay 10s redis:3.0.6</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_019.png" alt=""></p><p>  滚动升级 redis</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker service update --image redis:3.0.7 redis</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_020.png" alt=""></p><p>  看图可以知道 redis 的版本已经从 3.0.6 升级到了 3.0.7，说明服务已经升级成功。</p></li><li><p>9.停止某个节点接收新的任务</p><p>  查看所有的节点：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$ docker node ls</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_021.png" alt=""></p><p>  可以看到目前所有的节点都是 Active, 可以接收新的任务分配。</p><p>  停止节点 swarm-worker1：</p><p>  <img src="/image/Docker06/Docker06_022.png" alt=""><br>  <strong>注意</strong>：swarm-worker1 状态变为 Drain。不会影响到集群的服务，只是 swarm-worker1 节点不再接收新的任务，集群的负载能力有所下降。</p><p>  可以通过以下命令重新激活节点：</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker@swarm-manager:~$  docker node update --availability active swarm-worker1</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker06/Docker06_023.png" alt=""></p></li></ul><p>More info: <a href="https://www.cnblogs.com/zhujingzhi/p/9792432.html" target="_blank" rel="noopener">Docker Swarm</a></p>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（五）Docker Machine</title>
      <link href="/2018/10/16/Docker05/"/>
      <url>/2018/10/16/Docker05/</url>
      <content type="html"><![CDATA[<p> <a href="https://docs.docker.com/machine/overview/" target="_blank" rel="noopener">Docker Machine</a> 是 Docker 官方提供的一个工具，它可以帮助我们在远程的机器上安装 Docker，或者在虚拟机 host 上直接安装虚拟机并在虚拟机中安装 Docker。 本文章介绍如何使用 Docker  Machine 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Docker-Machine"><a href="#Docker-Machine" class="headerlink" title="Docker Machine"></a>Docker Machine</h3><p>Docker Machine是一个工具，可让您在虚拟主机上安装Docker Engine，并使用docker-machine命令管理主机。</p><ul><li><p>Docker Engine：人们说的“Docker”通常指的是Docker Engine，由Docker守护程序组成的客户端 - 服务器应用程序，指定用于与守护进程交互的接口的REST API，以及与守护进程通信的命令行界面（CLI）客户端（通过REST API包装器）。</p><p>  <img src="/image/Docker05/Docker05_001.png" alt=""></p><p>  <img src="/image/Docker05/Docker05_002.png" alt=""></p></li><li><p>Docker Machine是一个用于配置和管理Dockerized主机（带有Docker Engine的主机）的工具。<br>  Docker Machine有自己的命令行客户端 docker-machine和Docker Engine客户端。<br>  使用Machine在一个或多个虚拟系统上安装Docker Engine，这些虚拟系统可以是本地的（使用Machine在Mac或Windows上的VirtualBox中安装和运行Docker Engine）或远程（使用Machine在云提供商上配置Dockerized主机）。<br>  这些Dockerized机器就是托管在 Docker Machine上的机器。</p><p>  <img src="/image/Docker05/Docker05_003.png" alt=""></p></li></ul><h3 id="安装-Docker-Machine"><a href="#安装-Docker-Machine" class="headerlink" title="安装 Docker Machine"></a>安装 Docker Machine</h3><p>安装 Docker Machine 之前你需要先安装 Docker。</p><p>Docker Mechine 可以在多种平台上安装使用，包括 Linux 、MacOS 以及 windows。</p><h4 id="Linux-安装命令"><a href="#Linux-安装命令" class="headerlink" title="Linux 安装命令"></a>Linux 安装命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ base=https://github.com/docker/machine/releases/download/v0.16.0 &amp;&amp;</span><br><span class="line">  curl -L <span class="variable">$base</span>/docker-machine-$(uname -s)-$(uname -m) &gt;/tmp/docker-machine &amp;&amp;</span><br><span class="line">  sudo mv /tmp/docker-machine /usr/<span class="built_in">local</span>/bin/docker-machine &amp;&amp;</span><br><span class="line">  chmod +x /usr/<span class="built_in">local</span>/bin/docker-machine</span><br></pre></td></tr></table></figure><h4 id="macOS-安装命令"><a href="#macOS-安装命令" class="headerlink" title="macOS 安装命令"></a>macOS 安装命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ base=https://github.com/docker/machine/releases/download/v0.16.0 &amp;&amp;</span><br><span class="line">  curl -L <span class="variable">$base</span>/docker-machine-$(uname -s)-$(uname -m) &gt;/usr/<span class="built_in">local</span>/bin/docker-machine &amp;&amp;</span><br><span class="line">  chmod +x /usr/<span class="built_in">local</span>/bin/docker-machine</span><br></pre></td></tr></table></figure><h4 id="Windows-安装命令"><a href="#Windows-安装命令" class="headerlink" title="Windows 安装命令"></a>Windows 安装命令</h4><p>如果你是 Windows 平台，可以使用 <a href="https://git-for-windows.github.io/" target="_blank" rel="noopener">Git BASH</a>，并输入以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ base=https://github.com/docker/machine/releases/download/v0.16.0 &amp;&amp;</span><br><span class="line">  mkdir -p <span class="string">"<span class="variable">$HOME</span>/bin"</span> &amp;&amp;</span><br><span class="line">  curl -L <span class="variable">$base</span>/docker-machine-Windows-x86_64.exe &gt; <span class="string">"<span class="variable">$HOME</span>/bin/docker-machine.exe"</span> &amp;&amp;</span><br><span class="line">  chmod +x <span class="string">"<span class="variable">$HOME</span>/bin/docker-machine.exe"</span></span><br></pre></td></tr></table></figure><p>查看是否安装成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine version</span><br><span class="line">docker-machine version 0.16.0, build 9371605</span><br></pre></td></tr></table></figure><hr><h3 id="在远程主机上安装-Docker"><a href="#在远程主机上安装-Docker" class="headerlink" title="在远程主机上安装 Docker"></a>在远程主机上安装 Docker</h3><p>如果我们有多台 Ubuntu 主机都需要安装 Docker，不需要一个个登录安装，通过 docker-machine 命令我们可以轻松的在远程主机上安装 Docker。</p><h4 id="1-前提条件"><a href="#1-前提条件" class="headerlink" title="1.前提条件"></a>1.前提条件</h4><p>在使用 docker-machine 进行远程安装前我们需要做一些准备工作：</p><ul><li><p>1.在目标主机上创建一个用户并加入sudo 组</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 比如我们要在远程主机上添加一个名为 nick 的用户并加入 sudo 组</span></span><br><span class="line">$ sudo adduser nick</span><br><span class="line">$ sudo usermod -a -G sudo nick</span><br></pre></td></tr></table></figure></li><li><p>2.为该用户设置 sudo 操作不需要输入密码</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开/etc/sudoers</span></span><br><span class="line">sudo visudo</span><br><span class="line"><span class="comment"># 把下面一行内容添加到文档的最后并保存文件</span></span><br><span class="line">nick   ALL=(ALL:ALL) NOPASSWD: ALL</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>3.把本地用户的 ssh public key 添加到目标主机上</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-copy-id -i ~/.ssh/id_rsa.pub nick@xxx.xxx.xxx.xxx</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h4><p>在本地运行下面的命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># generic驱动</span></span><br><span class="line">$ docker-machine create -d generic \</span><br><span class="line">    --generic-ip-address=xxx.xxx.xxx.xxx \</span><br><span class="line">    --generic-ssh-user=nick \</span><br><span class="line">    --generic-ssh-key ~/.ssh/id_rsa \</span><br><span class="line">    krdevdb</span><br></pre></td></tr></table></figure></p><ul><li>create 命令本是要创建虚拟主机并安装 Docker，因为本例中的目标主机已经存在，所以仅安装 Docker。</li><li>-d 是 –driver 的简写形式，主要用来指定使用什么驱动程序来创建目标主机。</li><li>–generic 开头的三个参数主要是指定操作的目标主机和使用的账户。</li><li>krdevdb 是虚拟机的名称，Docker Machine 会用它来设置目标主机的名称。</li></ul><p><img src="/image/Docker05/Docker05_004.png" alt=""></p><h4 id="3-检查安装结果"><a href="#3-检查安装结果" class="headerlink" title="3.检查安装结果"></a>3.检查安装结果</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine ls</span><br></pre></td></tr></table></figure><p><img src="/image/Docker05/Docker05_005.png" alt=""></p><h4 id="4-管理远程的-Docker"><a href="#4-管理远程的-Docker" class="headerlink" title="4.管理远程的 Docker"></a>4.管理远程的 Docker</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 远程到主机krdevdb</span></span><br><span class="line"><span class="built_in">eval</span> $(docker-machine env krdevdb) </span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line">docker version</span><br></pre></td></tr></table></figure><p><img src="/image/Docker05/Docker05_006.png" alt=""></p><h4 id="5-在本地主机上安装带有-Docker-的虚机"><a href="#5-在本地主机上安装带有-Docker-的虚机" class="headerlink" title="5.在本地主机上安装带有 Docker 的虚机"></a>5.在本地主机上安装带有 Docker 的虚机</h4><p>在本地的一台安装了 vSphere 的虚拟机 host 上安装带有 Docker 的虚拟机。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine create \</span><br><span class="line">    --driver vmwarevsphere \</span><br><span class="line">    --vmwarevsphere-vcenter=xxx.xxx.xxx.xxx \</span><br><span class="line">    --vmwarevsphere-username=root \</span><br><span class="line">    --vmwarevsphere-password=12345678 \</span><br><span class="line">    --vmwarevsphere-cpu-count=1 \</span><br><span class="line">    --vmwarevsphere-memory-size=512 \</span><br><span class="line">    --vmwarevsphere-disk-size=10240 \</span><br><span class="line">    testvm</span><br></pre></td></tr></table></figure><p>解释一下比较重要的参数：</p><ul><li>–driver vmwarevsphere ：我们的虚拟机 host 上安装的是 vmware 的产品 vSphere，因此需要给 Docker Machine 提供对应的驱动，这样才能够在上面安装新的虚拟机。</li><li>–vmwarevsphere-vcenter=xxx.xxx.xxx.xxx ：虚拟机 host 的 IP 地址</li><li>–vmwarevsphere-username=root ：虚拟机 host 的 用户名</li><li>–vmwarevsphere-password=12345678 ：虚拟机 host 的 密码</li><li>–vmwarevsphere-cpu-count=1 ：虚拟机 host 的 cpu</li><li>–vmwarevsphere-memory-size=512 ：虚拟机 host 的 内存</li><li>–vmwarevsphere-disk-size=10240 ：虚拟机 host 的 磁盘资源</li><li>testvm：新建虚拟机的名称。</li></ul><hr><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><ul><li><p>1.列出可用的机器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine ls</span><br></pre></td></tr></table></figure></li><li><p>2.创建机器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine create --driver virtualbox <span class="built_in">test</span></span><br></pre></td></tr></table></figure><ul><li><strong>–driver</strong>：指定用来创建机器的驱动类型，这里是 virtualbox。</li></ul></li></ul><ul><li><p>3.查看机器的 ip</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine ip <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li><li><p>4.停止机器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine stop <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li><li><p>5.启动机器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine start <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li><li><p>6.进入机器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine ssh <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li></ul><hr><h3 id="命令参数说明"><a href="#命令参数说明" class="headerlink" title="命令参数说明"></a>命令参数说明</h3><ul><li><p><strong>docker-machine active</strong>：查看当前激活状态的 Docker 主机。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine ls</span><br><span class="line"></span><br><span class="line">NAME      ACTIVE   DRIVER         STATE     URL</span><br><span class="line">dev       -        virtualbox     Running   tcp://192.168.99.103:2376</span><br><span class="line">staging   *        digitalocean   Running   tcp://203.0.113.81:2376</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$DOCKER_HOST</span></span><br><span class="line">tcp://203.0.113.81:2376</span><br><span class="line"></span><br><span class="line">$ docker-machine active</span><br><span class="line">staging</span><br></pre></td></tr></table></figure></li><li><p><strong>config</strong>：查看当前激活状态 Docker 主机的连接信息。</p></li><li><p><strong>creat</strong>：创建 Docker 主机</p></li><li><p><strong>env</strong>：显示连接到某个主机需要的环境变量</p></li><li><p><strong>inspect</strong>： 以 json 格式输出指定Docker的详细信息</p></li><li><p><strong>ip</strong>： 获取指定 Docker 主机的地址</p></li><li><p><strong>kill</strong>： 直接杀死指定的 Docker 主机</p></li><li><p><strong>ls</strong>： 列出所有的管理主机</p></li><li><p><strong>provision</strong>： 重新配置指定主机</p></li><li><p><strong>regenerate-certs</strong>： 为某个主机重新生成 TLS 信息</p></li><li><p><strong>restart</strong>： 重启指定的主机</p></li><li><p><strong>rm</strong>： 删除某台 Docker 主机，对应的虚拟机也会被删除</p></li><li><p><strong>ssh</strong>： 通过 SSH 连接到主机上，执行命令</p></li><li><p><strong>scp</strong>： 在 Docker 主机之间以及 Docker 主机和本地主机之间通过 scp 远程复制数据</p></li><li><p><strong>mount</strong>： 使用 SSHFS 从计算机装载或卸载目录</p></li><li><p><strong>start</strong>： 启动一个指定的 Docker 主机，如果对象是个虚拟机，该虚拟机将被启动</p></li><li><p><strong>status</strong>： 获取指定 Docker 主机的状态(包括：Running、Paused、Saved、Stopped、Stopping、Starting、Error)等</p></li><li><p><strong>stop</strong>： 停止一个指定的 Docker 主机</p></li><li><p><strong>upgrade</strong>： 将一个指定主机的 Docker 版本更新为最新</p></li><li><p><strong>url</strong>： 获取指定 Docker 主机的监听 URL</p></li><li><p><strong>version</strong>： 显示 Docker Machine 的版本或者主机 Docker 版本</p></li><li><p><strong>help</strong>： 显示帮助信息</p></li></ul>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（四）Docker Compose</title>
      <link href="/2018/09/16/Docker04/"/>
      <url>/2018/09/16/Docker04/</url>
      <content type="html"><![CDATA[<p>Docker Compose是 Docker 提供的一个命令行工具，<strong>使用 Docker Compose 可以轻松、高效的管理容器，它是一个用于定义和运行多容器 Docker 的应用程序工具</strong> 。通过 Compose，您可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。</p><p>本文章介绍如何使用 Docker  Compose 。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>macOS和windows PC 桌面版的Docker自带，不需要安装。下面介绍Linux的安装</p><p>Linux 上我们可以从 <a href="https://github.com/docker/compose/releases" target="_blank" rel="noopener">Github</a> 上下载最新发行的版本包来使用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载 1.24.1 版本包</span></span><br><span class="line">sudo curl -L <span class="string">"https://github.com/docker/compose/releases/download/1.24.1/docker-compose-<span class="variable">$(uname -s)</span>-<span class="variable">$(uname -m)</span>"</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"><span class="comment"># 授权可执行权限</span></span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建软链</span></span><br><span class="line">sudo ln -s /usr/<span class="built_in">local</span>/bin/docker-compose /usr/bin/docker-compose</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试是否安装成功</span></span><br><span class="line">docker-compose --version</span><br></pre></td></tr></table></figure><h3 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h3><p>工程、服务、容器<br>Docker Compose 将所管理的容器分为三层，分别是工程（project）、服务（service）、容器（container）<br>Docker Compose 运行目录下的所有文件（docker-compose.yml）组成一个工程,一个工程包含多个服务，每个服务中定义了容器运行的镜像、参数、依赖，一个服务可包括多个容器实例.</p><p>使用 docker-compose 构建一个在docker中运行的基于python flask框架的web应用。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 预计最终目录结构</span><br><span class="line">└── compose_project</span><br><span class="line">    ├── docker</span><br><span class="line">    │   └── docker-compose.yml</span><br><span class="line">    ├── Dockerfile</span><br><span class="line">    └── src</span><br><span class="line">        ├── app.py</span><br><span class="line">        └── requirements.txt</span><br></pre></td></tr></table></figure><h4 id="1-准备"><a href="#1-准备" class="headerlink" title="1.准备"></a>1.准备</h4><ul><li><p>1.1.创建工程目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir compose_project</span><br><span class="line"><span class="built_in">cd</span> compose_project</span><br><span class="line">mkdir src <span class="comment"># 源码文件夹</span></span><br><span class="line">mkdir docker <span class="comment"># docker配置文件夹</span></span><br></pre></td></tr></table></figure></li><li><p>1.2.在compose_project/src/目录下创建python flask应用 compose_project/src/app.py文件</p></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rom flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> redis <span class="keyword">import</span> Redis</span><br><span class="line"> </span><br><span class="line">app = Flask(__name__)</span><br><span class="line">redis = Redis(host=<span class="string">'redis_ip'</span>, port=<span class="number">6666</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_num</span><span class="params">()</span>:</span></span><br><span class="line">    count = redis.incr(<span class="string">'hits'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f'<span class="subst">&#123;count&#125;</span> times.\n'</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    app.run(host=<span class="string">"0.0.0.0"</span>, debug=<span class="keyword">True</span>)</span><br></pre></td></tr></table></figure><ul><li>1.3.创建python 需求文件 compose_project/src/requirements.txt<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flask</span><br><span class="line">redis</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-定义创建容器的Dockerfile文件"><a href="#2-定义创建容器的Dockerfile文件" class="headerlink" title="2. 定义创建容器的Dockerfile文件"></a>2. 定义创建容器的Dockerfile文件</h4><p> compose_project/目录下创建Dockerfile文件： </p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.7</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> src/ /opt/src</span></span><br><span class="line"><span class="bash">WORKDIR /opt/src</span></span><br><span class="line"><span class="bash"> </span></span><br><span class="line"><span class="bash">RUN pip install -r requirements.txt</span></span><br><span class="line"><span class="bash">CMD [<span class="string">"python"</span>, <span class="string">"app.py"</span>]</span></span><br></pre></td></tr></table></figure><h4 id="3-定义docker-compose脚本"><a href="#3-定义docker-compose脚本" class="headerlink" title="3. 定义docker-compose脚本"></a>3. 定义docker-compose脚本</h4><p>在compose_project/docker/目录下创建docker-compose.yml文件，并在里面定义服务 。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'3'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">../../../../../09.cahe/Desktop</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="bullet">     -</span> <span class="string">"5000:5000"</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">"redis:3.0.7"</span></span><br></pre></td></tr></table></figure><ul><li>web容器： <ul><li>使用当前docker-compose.yml文件所在目录的上级目录（compose_project/Dockerfile）中的Dockerfile构建映像。 </li><li>Flask Web服务器的默认端口5000,将容器上的暴露端口5000映射到主机上的端口5000。</li></ul></li><li>redis容器:  redis 服务使用从Docker Hub提取的官方redis镜像3.0.7版本     </li></ul><h4 id="4-使用Compose构建并运行您的应用程序"><a href="#4-使用Compose构建并运行您的应用程序" class="headerlink" title="4.  使用Compose构建并运行您的应用程序"></a>4.  使用Compose构建并运行您的应用程序</h4><p> 在compose_project/docker/目录下执行docker-compose.yml文件： </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br><span class="line"><span class="comment"># 若是要后台运行，命令需要-d：</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"><span class="comment"># 若不使用默认的docker-compose.yml 文件名：</span></span><br><span class="line">docker-compose -f server.yml up -d</span><br></pre></td></tr></table></figure><h3 id="Docker-Compose-常用命令"><a href="#Docker-Compose-常用命令" class="headerlink" title="Docker Compose 常用命令"></a>Docker Compose 常用命令</h3><ul><li><p>ps：列出所有运行容器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure></li><li><p>logs：查看服务日志输出</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose logs</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>port：打印绑定的公共端口，下面命令可以输出 flask 服务 8761 端口所绑定的公共端口</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose port flask 8761</span><br></pre></td></tr></table></figure></li><li><p>build：构建或者重新构建服务</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose build</span><br></pre></td></tr></table></figure></li><li><p>start：启动指定服务已存在的容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose start flask</span><br></pre></td></tr></table></figure></li><li><p>stop：停止已运行的服务的容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose stop flask</span><br></pre></td></tr></table></figure></li><li><p>rm：删除指定服务的容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose rm flask</span><br></pre></td></tr></table></figure></li><li><p>up：构建、启动容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up</span><br></pre></td></tr></table></figure></li><li><p>kill：通过发送 SIGKILL 信号来停止指定服务的容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose <span class="built_in">kill</span> flask</span><br></pre></td></tr></table></figure></li><li><p>pull：下载服务镜像</p></li><li><p>scale：设置指定服务运气容器的个数，以 service=num 形式指定</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose scale user=3 movie=3</span><br></pre></td></tr></table></figure></li><li><p>run：在一个服务上执行一个命令</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose run web bash</span><br></pre></td></tr></table></figure></li></ul><h3 id="yml-配置指令参考"><a href="#yml-配置指令参考" class="headerlink" title="yml 配置指令参考"></a>yml 配置指令参考</h3><ul><li><p>version：指指定本 yml 依从的 compose 哪个版本制定的</p><hr></li></ul><ul><li><p>services：多个容器集合</p><hr></li></ul><ul><li><p>build：指定为构建镜像上下文路径，该值可以是一个路径，也可以是一个对象，用于指定 Dockerfile 参数,例如</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3.7"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  webapp:</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">./dir</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3.7"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  webapp:</span></span><br><span class="line"><span class="attr">    build:</span></span><br><span class="line"><span class="attr">      context:</span> <span class="string">./dir</span></span><br><span class="line"><span class="attr">      dockerfile:</span> <span class="string">Dockerfile-alternate</span></span><br><span class="line"><span class="attr">      args:</span></span><br><span class="line"><span class="attr">        buildno:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">"com.example.description=Accounting webapp"</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">"com.example.department=Finance"</span></span><br><span class="line"><span class="bullet">        -</span> <span class="string">"com.example.label-with-empty-value"</span></span><br><span class="line"><span class="attr">      target:</span> <span class="string">prod</span></span><br></pre></td></tr></table></figure><ul><li><p>context：上下文路径。</p></li><li><p>dockerfile：指定构建镜像的 Dockerfile 文件名。</p></li><li><p>args：添加构建参数，这是只能在构建过程中访问的环境变量。</p></li><li><p>labels：设置构建镜像的标签。</p></li><li><p>target：多层构建，可以指定构建哪一层。</p><hr></li></ul></li></ul><ul><li><p>cap_add cap_drop:添加或删除容器拥有的宿主机的内核功能。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cap_add:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">ALL</span> <span class="comment"># 开启全部权限</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cap_drop:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">SYS_PTRACE</span> <span class="comment"># 关闭 ptrace权限</span></span><br></pre></td></tr></table></figure><hr></li></ul><ul><li><p>cgroup_parent:为容器指定父 cgroup 组，意味着将继承该组的资源限制。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cgroup_parent:</span> <span class="string">m-executor-abcd</span></span><br></pre></td></tr></table></figure><hr></li><li><p>container_name:指定自定义容器名称，而不是生成的默认名称。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">container_name:</span> <span class="string">my-web-container</span></span><br></pre></td></tr></table></figure><hr></li><li><p>depends_on:设置依赖关系</p><ul><li>docker-compose up ：以依赖性顺序启动服务。在以下示例中，先启动 db 和 redis ，才会启动 web。</li><li>docker-compose up SERVICE ：自动包含 SERVICE 的依赖项。在以下示例中，docker-compose up web 还将创建并启动 db 和 redis。</li><li><p>docker-compose stop ：按依赖关系顺序停止服务。在以下示例中，web 在 db 和 redis 之前停止。 </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3.7"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  web:</span></span><br><span class="line"><span class="attr">    build:</span> <span class="string">.</span></span><br><span class="line"><span class="attr">    depends_on:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">db</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">  db:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="string">postgres</span></span><br></pre></td></tr></table></figure><p><strong>注意：web 服务不会等待 redis db 完全启动 之后才启动。</strong></p></li></ul><hr></li><li><p>deploy:指定与服务的部署和运行有关的配置,只在 swarm 模式下才会有用。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3.7"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  redis:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="attr">redis:alpine</span></span><br><span class="line"><span class="attr">    deploy:</span></span><br><span class="line">      <span class="string">mode：replicated</span></span><br><span class="line"><span class="attr">      replicas:</span> <span class="number">6</span></span><br><span class="line"><span class="attr">      endpoint_mode:</span> <span class="string">dnsrr</span></span><br><span class="line"><span class="attr">      labels:</span> </span><br><span class="line"><span class="attr">        description:</span> <span class="string">"This redis service label"</span></span><br><span class="line"><span class="attr">      resources:</span></span><br><span class="line"><span class="attr">        limits:</span></span><br><span class="line"><span class="attr">          cpus:</span> <span class="string">'0.50'</span></span><br><span class="line"><span class="attr">          memory:</span> <span class="number">50</span><span class="string">M</span></span><br><span class="line"><span class="attr">        reservations:</span></span><br><span class="line"><span class="attr">          cpus:</span> <span class="string">'0.25'</span></span><br><span class="line"><span class="attr">          memory:</span> <span class="number">20</span><span class="string">M</span></span><br><span class="line"><span class="attr">      restart_policy:</span></span><br><span class="line"><span class="attr">        condition:</span> <span class="string">on-failure</span></span><br><span class="line"><span class="attr">        delay:</span> <span class="number">5</span><span class="string">s</span></span><br><span class="line"><span class="attr">        max_attempts:</span> <span class="number">3</span></span><br><span class="line"><span class="attr">        window:</span> <span class="number">120</span><span class="string">s</span></span><br></pre></td></tr></table></figure></li></ul><p>  可以选参数：</p><p>  <strong>endpoint_mode</strong>：访问集群服务的方式。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">endpoint_mode:</span> <span class="string">vip</span> </span><br><span class="line"><span class="comment"># Docker 集群服务一个对外的虚拟 ip。所有的请求都会通过这个虚拟 ip 到达集群服务内部的机器。</span></span><br><span class="line"><span class="attr">endpoint_mode:</span> <span class="string">dnsrr</span></span><br><span class="line"><span class="comment"># DNS 轮询（DNSRR）。所有的请求会自动轮询获取到集群 ip 列表中的一个 ip 地址。</span></span><br></pre></td></tr></table></figure><p>  <strong>labels</strong>：在服务上设置标签。可以用容器上的 labels（跟 deploy 同级的配置） 覆盖 deploy 下的 labels。</p><p>  <strong>mode</strong>：指定服务提供的模式。</p><ul><li><p><strong>replicated</strong>：复制服务，复制指定服务到集群的机器上。</p></li><li><p><strong>global</strong>：全局服务，服务将部署至集群的每个节点。</p></li><li><p>图解：下图中黄色的方块是 replicated 模式的运行情况，灰色方块是 global 模式的运行情况。</p><p>  <img src="/image/Docker04/Docker04_001.png" alt=""></p><p><strong>replicas：mode</strong> 为 replicated 时，需要使用此参数配置具体运行的节点数量。</p><p><strong>resources</strong>：配置服务器资源使用的限制，例如上例子，配置 redis 集群运行需要的 cpu 的百分比 和 内存的占用。避免占用资源过高出现异常。</p><p><strong>restart_policy</strong>：配置如何在退出容器时重新启动容器。</p></li><li><p>condition：可选 none，on-failure 或者 any（默认值：any）。</p></li><li>delay：设置多久之后重启（默认值：0）。</li><li>max_attempts：尝试重新启动容器的次数，超出次数，则不再尝试（默认值：一直重试）。</li><li><p>window：设置容器重启超时时间（默认值：0）。</p><p><strong>rollback_config</strong>：配置在更新失败的情况下应如何回滚服务。</p></li><li><p>parallelism：一次要回滚的容器数。如果设置为0，则所有容器将同时回滚。</p></li><li>delay：每个容器组回滚之间等待的时间（默认为0s）。</li><li>failure_action：如果回滚失败，该怎么办。其中一个 continue 或者 pause（默认pause）。</li><li>monitor：每个容器更新后，持续观察是否失败了的时间 (ns|us|ms|s|m|h)（默认为0s）。</li><li>max_failure_ratio：在回滚期间可以容忍的故障率（默认为0）。</li><li><p>order：回滚期间的操作顺序。其中一个 stop-first（串行回滚），或者 start-first（并行回滚）（默认 stop-first ）。</p><p><strong>update_config</strong>：配置应如何更新服务，对于配置滚动更新很有用。</p></li><li><p>parallelism：一次更新的容器数。</p></li><li>delay：在更新一组容器之间等待的时间。</li><li>failure_action：如果更新失败，该怎么办。其中一个 continue，rollback 或者pause （默认：pause）。</li><li>monitor：每个容器更新后，持续观察是否失败了的时间 (ns|us|ms|s|m|h)（默认为0s）。</li><li>max_failure_ratio：在更新过程中可以容忍的故障率。</li><li><p>order：回滚期间的操作顺序。其中一个 stop-first（串行回滚），或者 start-first（并行回滚）（默认stop-first）。</p><p><strong>注</strong>：仅支持 V3.4 及更高版本。</p><hr></li></ul><ul><li><p>devices：指定设备映射列表</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devices:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"/dev/ttyUSB0:/dev/ttyUSB0"</span></span><br></pre></td></tr></table></figure><hr></li><li><p>dns：自定义 DNS 服务器，可以是单个值或列表的多个值。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dns:</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dns:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line"><span class="bullet">  -</span> <span class="number">9.9</span><span class="number">.9</span><span class="number">.9</span></span><br></pre></td></tr></table></figure><hr></li><li><p>dns_search：自定义 DNS 搜索域，可以是单个值或列表。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dns_search:</span> <span class="string">example.com</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dns_search:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">dc1.example.com</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">dc2.example.com</span></span><br></pre></td></tr></table></figure><hr></li><li><p>entrypoint：覆盖容器默认的 entrypoint。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">entrypoint:</span> <span class="string">/code/entrypoint.sh</span></span><br></pre></td></tr></table></figure></li></ul><pre><code>也可以是以下格式：<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">entrypoint:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">php</span></span><br><span class="line"><span class="bullet">    -</span> <span class="bullet">-d</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20100525/xdebug.so</span></span><br><span class="line"><span class="bullet">    -</span> <span class="bullet">-d</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">memory_limit=-1</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">vendor/bin/phpunit</span></span><br></pre></td></tr></table></figure>------</code></pre><ul><li><p>env_file：从文件添加环境变量。可以是单个值或列表的多个值。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">env_file:</span> <span class="string">.env</span></span><br></pre></td></tr></table></figure></li></ul><pre><code><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">env_file:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">./common.env</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">./apps/web.env</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">/opt/secrets.env</span></span><br></pre></td></tr></table></figure>------</code></pre><ul><li><p>environment：添加环境变量。您可以使用数组或字典、任何布尔值，布尔值需要用引号引起来，以确保 YML 解析器不会将其转换为 True 或 False。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">environment:</span></span><br><span class="line"><span class="attr">  RACK_ENV:</span> <span class="string">development</span></span><br><span class="line"><span class="attr">  SHOW:</span> <span class="string">'true'</span></span><br></pre></td></tr></table></figure><hr><ul><li><p>expose：暴露端口，但不映射到宿主机，只被连接的服务访问。仅可以指定内部端口为参数。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">expose:</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">"3000"</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">"8000"</span></span><br></pre></td></tr></table></figure><hr></li></ul></li><li><p>extra_hosts：添加主机名映射。类似 docker client –add-host。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extra_hosts:</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">"somehost:162.242.195.82"</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">"otherhost:50.31.209.229"</span></span><br></pre></td></tr></table></figure></li></ul><pre><code>以上会在此服务的内部容器中 /etc/hosts 创建一个具有 ip 地址和主机名的映射关系：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">162.242.195.82  somehost</span><br><span class="line">50.31.209.229   otherhost</span><br></pre></td></tr></table></figure>------</code></pre><ul><li><p>healthcheck：用于检测 docker 服务是否健康运行。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">healthcheck:</span></span><br><span class="line"><span class="attr">  test:</span> <span class="string">["CMD",</span> <span class="string">"curl"</span><span class="string">,</span> <span class="string">"-f"</span><span class="string">,</span> <span class="string">"http://localhost"</span><span class="string">]</span> <span class="comment"># 设置检测程序</span></span><br><span class="line"><span class="attr">  interval:</span> <span class="number">1</span><span class="string">m30s</span> <span class="comment"># 设置检测间隔</span></span><br><span class="line"><span class="attr">  timeout:</span> <span class="number">10</span><span class="string">s</span> <span class="comment"># 设置检测超时时间</span></span><br><span class="line"><span class="attr">  retries:</span> <span class="number">3</span> <span class="comment"># 设置重试次数</span></span><br><span class="line"><span class="attr">  start_period:</span> <span class="number">40</span><span class="string">s</span> <span class="comment"># 启动后，多少秒开始启动检测程序</span></span><br></pre></td></tr></table></figure><hr><ul><li><p>image：指定容器运行的镜像。以下格式都可以：    </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">image:</span> <span class="attr">ubuntu:14.04</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">tutum/influxdb</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">example-registry.com:4000/postgresql</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">a4bc65fd</span> <span class="comment"># 镜像id</span></span><br></pre></td></tr></table></figure><hr></li></ul></li><li><p>logging：服务的日志记录配置。</p><p>  driver：指定服务容器的日志记录驱动程序，默认值为json-file。有以下三个选项</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver:</span> <span class="string">"json-file"</span></span><br><span class="line"><span class="attr">driver:</span> <span class="string">"syslog"</span></span><br><span class="line"><span class="attr">driver:</span> <span class="string">"none"</span></span><br></pre></td></tr></table></figure></li></ul><pre><code>仅在 json-file 驱动程序下，可以使用以下参数，限制日志得数量和大小。<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  driver:</span> <span class="string">json-file</span></span><br><span class="line"><span class="attr">  options:</span></span><br><span class="line"><span class="attr">    max-size:</span> <span class="string">"200k"</span> <span class="comment"># 单个文件大小为200k</span></span><br><span class="line"><span class="attr">    max-file:</span> <span class="string">"10"</span> <span class="comment"># 最多10个文件</span></span><br></pre></td></tr></table></figure>当达到文件限制上限，会自动删除旧得文件。syslog 驱动程序下，可以使用 syslog-address 指定日志接收地址。<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line"><span class="attr">  driver:</span> <span class="string">syslog</span></span><br><span class="line"><span class="attr">  options:</span></span><br><span class="line"><span class="attr">    syslog-address:</span> <span class="string">"tcp://192.168.0.42:123"</span></span><br></pre></td></tr></table></figure>------</code></pre><ul><li><p>network_mode：设置网络模式</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network_mode:</span> <span class="string">"bridge"</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">"host"</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">"none"</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">"service:[service name]"</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">"container:[container name/id]"</span></span><br></pre></td></tr></table></figure></li></ul><pre><code>networks配置容器连接的网络，引用顶级 networks 下的条目 。<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  some-service:</span></span><br><span class="line"><span class="attr">    networks:</span></span><br><span class="line"><span class="attr">      some-network:</span></span><br><span class="line"><span class="attr">        aliases:</span></span><br><span class="line"><span class="bullet">         -</span> <span class="string">alias1</span></span><br><span class="line"><span class="attr">      other-network:</span></span><br><span class="line"><span class="attr">        aliases:</span></span><br><span class="line"><span class="bullet">         -</span> <span class="string">alias2</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line"><span class="attr">  some-network:</span></span><br><span class="line">    <span class="comment"># Use a custom driver</span></span><br><span class="line"><span class="attr">    driver:</span> <span class="string">custom-driver-1</span></span><br><span class="line"><span class="attr">  other-network:</span></span><br><span class="line">    <span class="comment"># Use a custom driver which takes special options</span></span><br><span class="line"><span class="attr">    driver:</span> <span class="string">custom-driver-2</span></span><br></pre></td></tr></table></figure>**aliases** ：同一网络上的其他容器可以使用服务名称或此别名来连接到对应容器的服务。------        </code></pre><ul><li><p>restart</p><ul><li>no：是默认的重启策略，在任何情况下都不会重启容器。</li><li>always：容器总是重新启动。</li><li>on-failure：在容器非正常退出时（退出状态非0），才会重启容器。</li><li><p>unless-stopped：在容器退出时总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容器</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">restart:</span> <span class="string">"no"</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">on-failure</span></span><br><span class="line"><span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><pre><code>注：swarm 集群模式，请改用 restart_policy。------        </code></pre><ul><li><p>secrets：存储敏感数据，例如密码</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3.1"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mysql:</span></span><br><span class="line"><span class="attr">  image:</span> <span class="string">mysql</span></span><br><span class="line"><span class="attr">  environment:</span></span><br><span class="line"><span class="attr">    MYSQL_ROOT_PASSWORD_FILE:</span> <span class="string">/run/secrets/my_secret</span></span><br><span class="line"><span class="attr">  secrets:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">my_secret</span></span><br><span class="line"></span><br><span class="line"><span class="attr">secrets:</span></span><br><span class="line"><span class="attr">  my_secret:</span></span><br><span class="line"><span class="attr">    file:</span> <span class="string">./my_secret.txt</span></span><br></pre></td></tr></table></figure><hr></li><li><p>security_opt：修改容器默认的 schema 标签。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">security-opt：</span></span><br><span class="line"><span class="attr">  - label:</span><span class="attr">user:USER</span>   <span class="comment"># 设置容器的用户标签</span></span><br><span class="line"><span class="attr">  - label:</span><span class="attr">role:ROLE</span>   <span class="comment"># 设置容器的角色标签</span></span><br><span class="line"><span class="attr">  - label:</span><span class="attr">type:TYPE</span>   <span class="comment"># 设置容器的安全策略标签</span></span><br><span class="line"><span class="attr">  - label:</span><span class="attr">level:LEVEL</span>  <span class="comment"># 设置容器的安全等级标签</span></span><br></pre></td></tr></table></figure><hr></li><li><p>stop_grace_period：指定在容器无法处理 SIGTERM (或者任何 stop_signal 的信号)，等待多久后发送 SIGKILL 信号关闭容器。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stop_grace_period:</span> <span class="number">1</span><span class="string">s</span> <span class="comment"># 等待 1 秒</span></span><br><span class="line"><span class="attr">stop_grace_period:</span> <span class="number">1</span><span class="string">m30s</span> <span class="comment"># 等待 1 分 30 秒</span></span><br></pre></td></tr></table></figure></li></ul><pre><code>默认的等待时间是 10 秒。------    </code></pre><ul><li><p>stop_signal：设置停止容器的替代信号。默认情况下使用 SIGTERM 。以下示例，使用 SIGUSR1 替代信号 SIGTERM 来停止容器。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stop_signal:</span> <span class="string">SIGUSR1</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>sysctls：设置容器中的内核参数，可以使用数组或字典格式。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sysctls:</span></span><br><span class="line">  <span class="string">net.core.somaxconn:</span> <span class="number">1024</span></span><br><span class="line">  <span class="string">net.ipv4.tcp_syncookies:</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sysctls:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">net.core.somaxconn=1024</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">net.ipv4.tcp_syncookies=0</span></span><br></pre></td></tr></table></figure><hr></li><li><p>tmpfs：在容器内安装一个临时文件系统。可以是单个值或列表的多个值。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tmpfs:</span> <span class="string">/run</span></span><br><span class="line"></span><br><span class="line"><span class="attr">tmpfs:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">/run</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">/tmp</span></span><br></pre></td></tr></table></figure><hr></li><li><p>ulimits：覆盖容器默认的 ulimit。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ulimits:</span></span><br><span class="line"><span class="attr">  nproc:</span> <span class="number">65535</span></span><br><span class="line"><span class="attr">  nofile:</span></span><br><span class="line"><span class="attr">    soft:</span> <span class="number">20000</span></span><br><span class="line"><span class="attr">    hard:</span> <span class="number">40000</span></span><br></pre></td></tr></table></figure><hr></li><li><p>volumes：将主机的数据卷或着文件挂载到容器里。</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"3.7"</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr">  db:</span></span><br><span class="line"><span class="attr">    image:</span> <span class="attr">postgres:latest</span></span><br><span class="line"><span class="attr">    volumes:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"/localhost/postgres.sock:/var/run/postgres/postgres.sock"</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">"/localhost/data:/var/lib/postgresql/data"</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（三）Dockerfile</title>
      <link href="/2018/08/16/Docker03/"/>
      <url>/2018/08/16/Docker03/</url>
      <content type="html"><![CDATA[<p>Dockerfile 是记录了镜像是如何被构建出来的配置文件, 可以被 docker 直接执行以创建一个镜像。文章介绍如何编写Dockerfile。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/Docker03/Docker03_001.png" alt=""></p><h3 id="编写Dockerfile-构建镜像"><a href="#编写Dockerfile-构建镜像" class="headerlink" title="编写Dockerfile 构建镜像"></a>编写Dockerfile 构建镜像</h3><ul><li>1.创建文件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir Dockerfile</span><br><span class="line"><span class="built_in">cd</span> Dockerfile</span><br><span class="line">vi Dockerfile</span><br></pre></td></tr></table></figure><ul><li><p>2.编写镜像信息</p><p>  分为四部分：</p><ul><li>基础镜像信息</li><li>维护者信息</li><li>镜像操作指令</li><li>容器启动时执行指令。</li></ul></li></ul><p>Dockerfile中每一个指令都会建立一层，<strong> 最多127层镜像</strong>， 可以用&amp;&amp;将各个所需命令串联起来简化为了1层。 ‘#’ 为 Dockerfile 中的注释。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This my first nginx Dockerfile</span></span><br><span class="line"><span class="comment"># Version 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Base images 基于基础镜像上构建</span></span><br><span class="line">FROM centos</span><br><span class="line"></span><br><span class="line"><span class="comment">#MAINTAINER 维护者信息</span></span><br><span class="line">MAINTAINER xiaoming </span><br><span class="line"></span><br><span class="line"><span class="comment">#ENV 设置环境变量</span></span><br><span class="line">ENV PATH /usr/<span class="built_in">local</span>/nginx/sbin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ADD  文件放在当前目录下，拷过去会自动解压</span></span><br><span class="line">ADD nginx-1.8.0.tar.gz /usr/<span class="built_in">local</span>/  </span><br><span class="line">ADD epel-release-latest-7.noarch.rpm /usr/<span class="built_in">local</span>/  </span><br><span class="line"></span><br><span class="line"><span class="comment">#RUN 执行以下命令 </span></span><br><span class="line">RUN rpm -ivh /usr/<span class="built_in">local</span>/epel-release-latest-7.noarch.rpm</span><br><span class="line">RUN yum install -y wget lftp gcc gcc-c++ make openssl-devel pcre-devel pcre &amp;&amp; yum clean all</span><br><span class="line">RUN useradd -s /sbin/nologin -M www</span><br><span class="line"></span><br><span class="line"><span class="comment">#WORKDIR 相当于cd</span></span><br><span class="line">WORKDIR /usr/<span class="built_in">local</span>/nginx-1.8.0 </span><br><span class="line"></span><br><span class="line">RUN ./configure --prefix=/usr/<span class="built_in">local</span>/nginx --user=www --group=www --with-http_ssl_module --with-pcre &amp;&amp; make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">RUN <span class="built_in">echo</span> <span class="string">"daemon off;"</span> &gt;&gt; /etc/nginx.conf</span><br><span class="line"></span><br><span class="line"><span class="comment">#EXPOSE 映射端口</span></span><br><span class="line">EXPOSE 80</span><br><span class="line"></span><br><span class="line"><span class="comment">#CMD 运行以下命令</span></span><br><span class="line">CMD [<span class="string">"nginx"</span>]</span><br></pre></td></tr></table></figure><ul><li>3.构建镜像</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker build [options] PATH | URL</span><br><span class="line"></span><br><span class="line"># [OPTIONS]</span><br><span class="line">-t &lt;指定镜像的名字&gt;</span><br><span class="line">-f &lt;指定构建镜像的 Dockerfile 文件（Dockerfile 可不在当前路径下）&gt;</span><br><span class="line">PATH|URL # 指定构建镜像的上下文的路径，构建镜像的过程中，可以且只可以引用上下文中的任何文件</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t nginx:<span class="built_in">test</span> .</span><br></pre></td></tr></table></figure><h3 id="Dockerfile-常用命令"><a href="#Dockerfile-常用命令" class="headerlink" title="Dockerfile 常用命令"></a>Dockerfile 常用命令</h3><p><img src="/image/Docker03/Docker03_002.png" alt=""></p><table><thead><tr><th style="text-align:center">指令</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">FROM</td><td style="text-align:center">指定所创建镜像的基础镜像</td></tr><tr><td style="text-align:center">MAINTAINER</td><td style="text-align:center">指定维护者信息</td></tr><tr><td style="text-align:center">RUN</td><td style="text-align:center">运行命令</td></tr><tr><td style="text-align:center">CMD</td><td style="text-align:center">指定启动容器时默认执行的命令</td></tr><tr><td style="text-align:center">LABEL</td><td style="text-align:center">指定生成镜像的元数据标签信息</td></tr><tr><td style="text-align:center">EXPOSE</td><td style="text-align:center">声明镜像内服务所监听的端口</td></tr><tr><td style="text-align:center">ENV</td><td style="text-align:center">指定环境变量</td></tr><tr><td style="text-align:center">ADD</td><td style="text-align:center">赋值指定的路径下的内容到容器中的路径下，可以为URL；如果为tar文件，会自动解压到路径下</td></tr><tr><td style="text-align:center">COPY</td><td style="text-align:center">赋值本地主机的路径下的内容到容器中的路径下；一般情况下推荐使用COPY而不是ADD</td></tr><tr><td style="text-align:center">ENTRYPOINT</td><td style="text-align:center">指定镜像的默认入口</td></tr><tr><td style="text-align:center">VOLUME</td><td style="text-align:center">创建数据挂载点</td></tr><tr><td style="text-align:center">USER</td><td style="text-align:center">指定运行容器时的用户名或UID</td></tr><tr><td style="text-align:center">WORKDIR</td><td style="text-align:center">配置工作目录</td></tr><tr><td style="text-align:center">ARG</td><td style="text-align:center">指定镜像内使用的参数(例如版本号信息等)</td></tr><tr><td style="text-align:center">ONBUILD</td><td style="text-align:center">配置当前所创建的镜像作为其他镜像的基础镜像时，所执行的创建操作的命令</td></tr><tr><td style="text-align:center">STOPSIGNAL</td><td style="text-align:center">容器退出的信号</td></tr><tr><td style="text-align:center">HEALTHCHECK</td><td style="text-align:center">如何进行健康检查</td></tr><tr><td style="text-align:center">SHELL</td><td style="text-align:center">指定使用SHELL时的默认SHELL类型</td></tr></tbody></table><ul><li><p>1.FROM:指定基础镜像，要在哪个镜像建立</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">FROM &lt;image&gt; </span><br><span class="line">FROM &lt;image&gt;:&lt;tag&gt;</span><br></pre></td></tr></table></figure><p>  第一条指令必须为 FROM 指令。FROM命令会指定镜像基于哪个基础镜像创建，接下来的命令也会基于这个基础镜像（CentOS和Ubuntu有些命令可是不一样的）。FROM命令可以多次使用，表示会创建多个镜像。</p></li><li><p>2.MAINTAINER：指定维护者信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">MAINTAINER &lt;name&gt;</span><br></pre></td></tr></table></figure></li><li><p>3.ARG:指定一些镜像内使用的参数(例如版本号信息等)，这些参数在执行docker build命令时才以–build-arg<varname>=<value>格式传入。</value></varname></p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">ARG&lt;name&gt;[=&lt;default value&gt;]</span><br></pre></td></tr></table></figure></li><li><p>4.RUN：在镜像中要执行的命令</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">RUN &lt;<span class="built_in">command</span>&gt;</span><br><span class="line">RUN [<span class="string">"executable"</span>, <span class="string">"param1"</span>, <span class="string">"param2"</span>]</span><br></pre></td></tr></table></figure><p>  前者默认将在 shell 终端中运行命令，即 /bin/bash -c ；后者则使用 exec 执行。指定使用其它终端可以通过第二种方式实现，例如 RUN [“/bin/bash”, “-c”,”echo hello”] 。<br>  每条RUN指令将在当前镜像的基础上执行指定命令，并提交为新的镜像。当命令较长时可以使用\换行。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RUN apt-get update \</span><br><span class="line">    &amp;&amp; apt-get install -y libsnappy-dev zliblg-dev libbz2-dev \</span><br><span class="line">    &amp;&amp; rm -rf /var/cache/apt</span><br></pre></td></tr></table></figure></li><li><p>5.WORKDIR：指定当前工作目录，相当于 cd</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">WORKDIR /path/to/workdir</span><br></pre></td></tr></table></figure><p>  为后续的 RUN 、 CMD 、 ENTRYPOINT 指令配置工作目录。<br>  可以使用多个 WORKDIR 指令，后续命令如果参数是相对路径，则会基于之前命令指定的路径。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如</span></span><br><span class="line">WORKDIR /a</span><br><span class="line">WORKDIR b</span><br><span class="line">WORKDIR c</span><br><span class="line">RUN <span class="built_in">pwd</span></span><br></pre></td></tr></table></figure></li><li><p>6.EXPOSE：指定容器要打开的端口</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">EXPOSE &lt;port&gt; [&lt;port&gt;...]</span><br></pre></td></tr></table></figure><p>  告诉 Docker 服务端容器暴露的端口号，供互联系统使用。在启动容器时需要通过 -P，Docker 主机会自动分配一个端口转发到指定的端口。<br>  注意：<br>  该命令只是起到声明租用，并不会自动完成端口映射。<br>  在容器启动时需要使用-P(大写P)，Docker主机会自动分配一个宿主机未被使用的临时端口转发到指定的端口；使用-p(小写p)，则可以具体指定哪个宿主机的本地端口映射过来。</p></li></ul><ul><li><p>7.ENV：定义环境变量</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">ENV &lt;key&gt; &lt;value&gt; <span class="comment"># 指定一个环境变量，会被后续 RUN 指令使用，并在容器运行时保持。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 例如</span></span><br><span class="line">ENV PATH /usr/<span class="built_in">local</span>/nginx/sbin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p>  指令指定的环境变量在运行时可以被覆盖掉，如docker run –env <key>=<value> built_image。</value></key></p></li><li><p>8.COPY ：复制本地主机的 （为 Dockerfile 所在目录的相对路径）到容器中的</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">COPY</span><br></pre></td></tr></table></figure></li><li><p>9.ADD：相当于 COPY，但是比 COPY 功能更强大</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">ADD &lt;src&gt; &lt;dest&gt;</span><br></pre></td></tr></table></figure><p>  该命令将复制指定的 到容器中的 。 其中<src> 可以是Dockerfile所在目录的一个相对路径；也可以是一个 URL；还可以是一个 tar 文件，复制进容器会自动解压。<br>  <dest>可以使镜像内的绝对路径，或者相当于工作目录(WORKDIR)的相对路径，支持正则表达式。</dest></src></p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如</span></span><br><span class="line">ADD *.c /code/</span><br></pre></td></tr></table></figure></li><li><p>10.VOLUME：挂载目录</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">USER daemon</span><br></pre></td></tr></table></figure><p>  指定运行容器时的用户名或 UID，后续的 RUN 也会使用指定用户。当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户，例如： RUN useradd -s /sbin/nologin -M www。</p></li><li><p>11.LABEL:用来生成用于生成镜像的元数据的标签信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 例如</span></span><br><span class="line">LABEL version=<span class="string">"1.0"</span></span><br><span class="line">LABEL description=<span class="string">"This text illustrates \ that label-values can span multiple lines."</span></span><br></pre></td></tr></table></figure></li><li><p>12.ENTRYPOINT:指定镜像的默认入口命令，该入口命令会在启动容器时作为根命令执行，所有传入值作为该命令的参数</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">ENTRYPOINT [<span class="string">"executable"</span>, <span class="string">"param1"</span>, <span class="string">"param2"</span>]</span><br><span class="line">ENTRYPOINT <span class="built_in">command</span> param1 param2 <span class="comment">#（shell中执行）</span></span><br></pre></td></tr></table></figure><p>  此时，CMD指令指定值将作为根命令的参数。<br>  每个Dockerfile中只能有一个ENTRYPOINT，当指定多个时，只有最后一个有效。<br>  在运行时可以被–entrypoint参数覆盖掉，如docker run –entrypoint。</p></li><li><p>13.CMD:指定启动容器时执行的命令</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">CMD [<span class="string">"executable"</span>,<span class="string">"param1"</span>,<span class="string">"param2"</span>] 使用 <span class="built_in">exec</span> 执行，推荐方式；</span><br><span class="line">CMD <span class="built_in">command</span> param1 param2 在 /bin/bash 中执行，提供给需要交互的应用；</span><br><span class="line">CMD [<span class="string">"param1"</span>,<span class="string">"param2"</span>] 提供给 ENTRYPOINT 的默认参数；</span><br></pre></td></tr></table></figure><p>  每个 Dockerfile 只能有一条 CMD 命令。如果指定了多条命令，只有最后一条会被执行。如果用户启动容器时候指定了运行的命令，则会覆盖掉 CMD 指定的命令。</p></li><li><p>14.ONBUILD：在构建本镜像时不生效，在基于此镜像构建镜像时生效</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">ONBUILD [INSTRUCTION]</span><br></pre></td></tr></table></figure><p>  配置当所创建的镜像作为其它新创建镜像的基础镜像时，所执行的操作指令。</p></li><li><p>15.STOPSIGNAL:指定所创建镜像启动的容器接收退出的信号值</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例如</span></span><br><span class="line">STOPSIGNAL singnal</span><br></pre></td></tr></table></figure></li><li><p>16.HEALTHCHECK：配置所启动容器如何进行健康检查(如何判断是否健康)，自Docker 1.12开始支持</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">HEALTHCHECK [OPTIONS] CMD <span class="built_in">command</span> <span class="comment"># 根据所执行命令返回值是否为0判断；</span></span><br><span class="line">HEALTHCHECK NONE <span class="comment"># 禁止基础镜像中的健康检查。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [OPTION]参数</span></span><br><span class="line">--inerval=DURATION  <span class="comment"># (默认为：30s)：多久检查一次；</span></span><br><span class="line">--timeout=DURATION  <span class="comment"># (默认为：30s)：每次检查等待结果的超时时间；</span></span><br><span class="line">--retries=N 　　     <span class="comment"># (默认为：3)：如果失败了，重试几次才最终确定失败。</span></span><br></pre></td></tr></table></figure></li><li><p>17.SHELL：指定其他命令使用shell时的默认shell类型（默认值为 [“bin/sh”,”-c”]）</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">SHELL [<span class="string">"executable"</span>,<span class="string">"parameters"</span>]</span><br></pre></td></tr></table></figure><p>  默认值为 [“bin/sh”,”-c”]</p></li></ul><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul><li>对于Windows系统，建议在Dockerfile开头添加# escape=`来指定转移信息</li><li>ENTRYPOINT 和 CMD 的区别：ENTRYPOINT 不能被执行时的参数覆盖掉，CMD 可以被覆盖掉默认的参数。ENTRYPOINT 指定了该镜像启动时的入口默认参数，CMD 则指定了容器启动时的命令。</li><li>调试dockerfile，使用dockerfile需要好久的时间，建议进入容器手动先执行dockerfile命令实践。</li><li>编写.dockerignore文件(过滤Dockerfile所在目录中的其他文件)</li><li>容器只运行单个应用</li><li>将多个RUN指令合并为一个</li><li>基础镜像的标签不要用latest</li><li>每个RUN指令后删除多余文件</li><li>选择合适的基础镜像(alpine版本最好)</li><li>设置WORKDIR和CMD</li><li>使用ENTRYPOINT (可选)</li><li>在entrypoint脚本中使用exec</li><li>COPY与ADD优先使用前者</li><li>合理调整COPY与RUN的顺序</li><li>设置默认的环境变量，映射端口和数据卷</li><li>使用LABEL设置镜像元数据</li><li>添加HEALTHCHECK</li><li>最小化镜像的层数。</li><li>多行参数时应该分类，在每个换行符\前都增加一个空格。</li><li>对构建缓存要有清楚的认识</li></ul><p>More info: <a href="https://docs.docker.com/engine/reference/builder/#shell" target="_blank" rel="noopener">官方文档</a></p>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（二）Docker的运行</title>
      <link href="/2018/07/16/Docker02/"/>
      <url>/2018/07/16/Docker02/</url>
      <content type="html"><![CDATA[<p>文章介绍Docker的如何运行和基本命令。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Docker的构成"><a href="#Docker的构成" class="headerlink" title="Docker的构成"></a>Docker的构成</h3><p>Docker有三个组件和三个基本元素:</p><p>三个组件分别是：</p><ul><li><strong>Docker Client</strong> ：是用户界面，它支持用户与 <strong>Docker Daemon</strong> 之间通信。 </li><li><strong>Docker Daemon</strong>： 运行于主机上，处理服务请求。 </li><li><strong>Docker Registry</strong>：是中央registry，拥有Docker容器镜像备份的公有和私有访问权限。</li></ul><p> 三个基本要素分别是： </p><ul><li><strong>Docker Containers</strong>： 负责应用程序的运行，包括操作系统、用户添加的文件以及元数据。 镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</li><li><strong>Docker Images</strong>： 是一个只读模板，用来运行Docker容器。 就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。</li><li><strong>DockerFile</strong> ：是文件指令集，用来说明如何自动创建Docker镜像。 </li></ul><p><img src="/image/Docker02/Docker02_001.png" alt=""></p><h3 id="Docker的技术支柱"><a href="#Docker的技术支柱" class="headerlink" title="Docker的技术支柱"></a>Docker的技术支柱</h3><p>Docker使用以下操作系统的功能来提高容器技术效率：</p><ul><li><strong>Namespaces</strong> 充当隔离的第一级。确保一个容器中运行一个进程而且不能看到或影响容器外的其它进程。 </li><li><strong>Control Groups</strong>是LXC的重要组成部分，具有资源核算与限制的关键功能。 </li><li><strong>UnionFS</strong>（文件系统）作为容器的构建块。为了支持Docker的轻量级以及速度快的特性，它创建了用户层。 </li></ul><h3 id="使用Docker-运行程序"><a href="#使用Docker-运行程序" class="headerlink" title="使用Docker 运行程序"></a>使用Docker 运行程序</h3><h4 id="1-创建镜像"><a href="#1-创建镜像" class="headerlink" title="1.创建镜像"></a>1.创建镜像</h4><ul><li><p>1.1.Docker Client 发送给Docker Daemon命令:需要创建的镜像以及需要在容器内运行的命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t ubuntu:15.10 .</span><br></pre></td></tr></table></figure><p>各个参数解析：</p><ul><li><strong>docker:</strong> Docker 的二进制执行文件。</li><li><strong>run:</strong> 与前面的 docker 组合来创建镜像 。</li><li><strong>ubuntu:15.10</strong> 指定要创建的镜像名称:镜像标签 </li><li><strong>.</strong>  指定镜像构建过程中的上下文环境的目录 </li></ul></li></ul><ul><li><p>1.2.镜像创建完成，就可以将它们推送到中央Registry：Docker Registry，以供他人使用。Docker Index为镜像提供了两个级别的访问权限：公有访问和私有访问。公有仓库是可搜索和可重复使用的，而私有仓库只能给那些拥有访问权限的成员使用.你可以将镜像存储在私有仓库，Docker官网有私有仓库的套餐可以供你选择。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 仓库地址在 /etc/docker 下的daemon.json文件下可以找到</span></span><br><span class="line">docker login # 登陆仓库</span><br><span class="line">docker tag ubuntu:15.10 &lt;仓库地址&gt;/ubuntu:15.10 # 修改镜像标签</span><br><span class="line">docker push &lt;仓库地址&gt;/ubuntu:15.10 # 镜像推送</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-运行容器"><a href="#2-运行容器" class="headerlink" title="2.运行容器"></a>2.运行容器</h4><p>运行容器源于我们在第一步中创建的镜像。当容器被启动后，一个读写层会被添加到镜像的顶层。当分配到合适的网络和IP地址后，需要的应用程序就可以在容器中运行了。 </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run ubuntu:15.10 /bin/echo "Hello world"</span><br></pre></td></tr></table></figure><p>各个参数解析：</p><ul><li><strong>docker:</strong> Docker 的二进制执行文件。</li><li><strong>run:</strong> 与前面的 docker 组合来运行一个容器。</li><li><strong>ubuntu:15.10</strong> 指定要运行的镜像，Docker 首先从本地主机上查找镜像是否存在，如果不存在，Docker 就会从镜像仓库 <strong>Docker Hub</strong> 下载公共镜像。</li><li><strong>/bin/echo “Hello world”:</strong> 在启动的容器里执行的命令</li></ul><h3 id="关于镜像、容器、仓库的基本命令"><a href="#关于镜像、容器、仓库的基本命令" class="headerlink" title="关于镜像、容器、仓库的基本命令"></a>关于镜像、容器、仓库的基本命令</h3><p><img src="/image/Docker02/Docker02_002.png" alt=""></p><h4 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h4><ul><li><p>1.获取镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search &lt;image&gt; <span class="comment"># 在docker index中搜索image</span></span><br></pre></td></tr></table></figure></li><li><p>2.获取镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull &lt;image&gt;  <span class="comment"># 从docker registry server 中下拉image</span></span><br><span class="line">docker pull &lt;server:port/image:tag&gt; <span class="comment"># 获取image</span></span><br></pre></td></tr></table></figure></li><li><p>3.查看镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker images： <span class="comment"># 列出images</span></span><br><span class="line">docker images -a <span class="comment"># 列出所有的images（包含历史）</span></span><br></pre></td></tr></table></figure></li><li><p>4.删除镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi  &lt;image ID&gt; <span class="comment"># 删除一个或多个image</span></span><br></pre></td></tr></table></figure></li><li><p>5.创建镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker commit -m <span class="string">"add new image"</span> -a &lt;container_id&gt; &lt;new_image_name&gt; <span class="comment"># 基于已有镜像的容器创建</span></span><br><span class="line">cat &lt;本地模板&gt; | Docker import - image:tag <span class="comment"># 基于本地模板导入</span></span><br><span class="line">docker build -t &lt;image:tag&gt; &lt;docker_file_dir. <span class="comment"># 基于dockerfile创建</span></span><br></pre></td></tr></table></figure></li><li><p>6.存出镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save -o &lt;image_file&gt; &lt;image:tag&gt;</span><br></pre></td></tr></table></figure></li><li><p>7.载入镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker save -o &lt;image_file&gt; &lt;image:tag&gt;</span><br></pre></td></tr></table></figure></li><li><p>8.上传镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push &lt;user/image:tag&gt;</span><br></pre></td></tr></table></figure></li></ul><h4 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h4><ul><li><p>1.创建容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker create -it &lt;image:tag&gt;</span><br></pre></td></tr></table></figure></li><li><p>2.创建并启动容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it &lt;image:tag&gt; /bin/bash</span><br></pre></td></tr></table></figure></li><li><p>3.守护态运行</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ddocker run -d &lt;image:tag&gt;</span><br></pre></td></tr></table></figure></li><li><p>4.查看容器信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker ps <span class="comment"># 列出当前所有正在运行的container</span></span><br><span class="line">docker ps -l <span class="comment"># 列出最近一次启动的container</span></span><br><span class="line">docker ps -a <span class="comment"># 列出所有的container（包含历史，即运行过的container）</span></span><br><span class="line">docker ps -q <span class="comment"># 列出最近一次运行的container ID</span></span><br></pre></td></tr></table></figure></li><li><p>5.获取容器的输出信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f &lt;image:tag&gt;或&lt;container_id&gt;</span><br></pre></td></tr></table></figure></li><li><p>6.终止容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop &lt;image:tag&gt;或&lt;container_id&gt;</span><br></pre></td></tr></table></figure></li><li><p>7.启动容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start &lt;image:tag&gt;或&lt;container_id&gt;</span><br></pre></td></tr></table></figure></li><li><p>8.重启容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart &lt;image:tag&gt;或&lt;container_id&gt;</span><br></pre></td></tr></table></figure></li><li><p>9.进入容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker attach &lt;image:tag&gt;或&lt;container_id&gt;</span><br><span class="line">docker <span class="built_in">exec</span> -it &lt;image:tag&gt;或&lt;container_id&gt; /bin/bash </span><br><span class="line">nsenter --target &lt;docker_pid&gt; --mount --uts --ipc --net --pid</span><br></pre></td></tr></table></figure></li><li><p>10.删除容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm &lt;container_id&gt; <span class="comment">#：删除一个或多个container</span></span><br><span class="line">docker rm `docker ps -a -q` <span class="comment">#：删除所有的container</span></span><br><span class="line">docker ps -a -q | xargs docker rm <span class="comment"># 同上, 删除所有的container</span></span><br></pre></td></tr></table></figure></li><li><p>11.导出容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">export</span> &lt;container_id&gt; &gt;test.tar</span><br></pre></td></tr></table></figure></li><li><p>12.容器快照导入到本地镜像库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;container_snapshot&gt; | docker import - &lt;user/image:tag&gt;</span><br></pre></td></tr></table></figure></li></ul><h4 id="仓库"><a href="#仓库" class="headerlink" title="仓库"></a>仓库</h4><ul><li><p>1.登录</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login</span><br></pre></td></tr></table></figure></li><li><p>2.更新镜像标签</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag &lt;server:port/image:tag&gt; &lt;image:tag&gt;</span><br></pre></td></tr></table></figure></li><li><p>3.创建私有仓库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 5000:5000 registry:&lt;registry_version&gt;</span><br></pre></td></tr></table></figure></li><li><p>4.管理私有仓库镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker tag &lt;image:tag&gt; &lt;私有仓库IP:端口/new_tag&gt; <span class="comment"># 重新标记一个本地镜像为私有仓库的版本</span></span><br><span class="line">docker push &lt;私有仓库IP:端口/image:new_tag&gt;</span><br><span class="line">curl http://&lt;私有仓库IP:端口&gt;/v2/&lt;image&gt;/tags/list <span class="comment"># 查看私有仓库中的镜像列表</span></span><br><span class="line">docker pull &lt;私有仓库IP:端口/image:new_tag&gt; <span class="comment"># 拉取本地仓库中的镜像</span></span><br></pre></td></tr></table></figure></li></ul><p>More info: <a href="https://www.flux7.com/tutorial/docker-tutorial-series-part-1-an-introduction-docker-components/" target="_blank" rel="noopener">Docker教程</a></p>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Docker（一）Docker的基本概念</title>
      <link href="/2018/06/16/Docker01/"/>
      <url>/2018/06/16/Docker01/</url>
      <content type="html"><![CDATA[<p>Docker 可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。文章介绍 Docker 的基本概念和部署安装。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="Linux-容器"><a href="#Linux-容器" class="headerlink" title="Linux 容器"></a>Linux 容器</h3><p>资源利用率和环境部署的问题，早期使用虚拟机解决。但是虚拟机存在问题（资源占用多、冗余步骤多、启动慢），由于虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：<strong>Linux 容器（Linux Containers，缩写为 LXC）</strong>。</p><p><strong>Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离</strong>。或者说，在正常进程的外面套了一个保护层。对于容器里面的进程来说，它接触到的各种资源都是虚拟的，从而实现与底层系统的隔离。</p><h3 id="容器优势"><a href="#容器优势" class="headerlink" title="容器优势"></a>容器优势</h3><p><img src="/image/Docker01/Docker01_001.png" alt=""></p><ul><li>启动快</li></ul><p>容器里面的应用，直接就是底层系统的一个进程，而不是虚拟机内部的进程。所以，启动容器相当于启动本机的一个进程，而不是启动一个操作系统，速度就快很多。</p><ul><li>资源占用少</li></ul><p>容器只占用需要的资源，不占用那些没有用到的资源；虚拟机由于是完整的操作系统，不可避免要占用所有资源。另外，多个容器可以共享资源，虚拟机都是独享资源。</p><ul><li>体积小</li></ul><p>容器只要包含用到的组件即可，而虚拟机是整个操作系统的打包，所以容器文件比虚拟机文件要小很多。</p><p><img src="/image/Docker01/Docker01_002.png" alt=""></p><h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><p>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案。</p><p>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样。</p><h3 id="Docker-的用途"><a href="#Docker-的用途" class="headerlink" title="Docker 的用途"></a>Docker 的用途</h3><p>Docker 的主要用途，目前有三大类。</p><ul><li>提供一次性的环境。比如本地测试他人的软件、持续集成的时候提供单元测试和构建的环境。</li><li>提供弹性的云服务。因为 Docker 容器可以随开随关，很适合动态扩容和缩容。</li><li>组建微服务架构。通过多个容器，一台机器可以跑多个服务，因此在本机就可以模拟出微服务架构。</li></ul><p><img src="/image/Docker01/Docker01_003.png" alt=""></p><h3 id="Docker-框架"><a href="#Docker-框架" class="headerlink" title="Docker 框架"></a>Docker 框架</h3><p>Docker 包括三个基本概念:</p><ul><li>镜像（Image）：Docker 镜像（Image），就相当于是一个 root 文件系统。比如官方镜像 ubuntu:16.04 就包含了完整的一套 Ubuntu16.04 最小系统的 root 文件系统。</li><li>容器（Container）：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和实例一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</li><li>仓库（Repository）：仓库可看成一个代码控制中心，用来保存镜像。</li><li>Docker 使用客户端-服务器 (C/S) 架构模式，使用远程API来管理和创建Docker容器。Docker 容器通过 Docker 镜像来创建。</li></ul><p><img src="/image/Docker01/Docker01_004.png" alt=""></p><table><thead><tr><th style="text-align:center">概念</th><th style="text-align:left">说明</th></tr></thead><tbody><tr><td style="text-align:center">Docker 镜像(Images)</td><td style="text-align:left">Docker 镜像是用于创建 Docker 容器的模板，比如 Ubuntu 系统。</td></tr><tr><td style="text-align:center">Docker 容器(Container)</td><td style="text-align:left">容器是独立运行的一个或一组应用，是镜像运行时的实体。</td></tr><tr><td style="text-align:center">Docker 客户端(Client)</td><td style="text-align:left">Docker 客户端通过命令行或者其他工具使用 Docker SDK (<a href="https://docs.docker.com/develop/sdk/" target="_blank" rel="noopener">https://docs.docker.com/develop/sdk/</a>) 与 Docker 的守护进程通信。</td></tr><tr><td style="text-align:center">Docker 主机(Host)</td><td style="text-align:left">一个物理或者虚拟的机器用于执行 Docker 守护进程和容器。</td></tr><tr><td style="text-align:center">Docker Registry</td><td style="text-align:left">Docker 仓库用来保存镜像，可以理解为代码控制中的代码仓库。一个 Docker Registry 中可以包含多个仓库（Repository）；每个仓库可以包含多个标签（Tag）；每个标签对应一个镜像。通常，一个仓库会包含同一个软件不同版本的镜像，而标签就常用于对应该软件的各个版本。我们可以通过 <strong>&lt;仓库名&gt;:&lt;标签&gt;</strong> 的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以 <strong>latest</strong> 作为默认标签。<strong>Docker Hub</strong>(<a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com</a>) 官方维护一个公共仓库，提供了庞大的镜像集合，使用需要先注册一下。</td></tr><tr><td style="text-align:center">Docker Machine</td><td style="text-align:left">Docker Machine是一个简化Docker安装的命令行工具，通过一个简单的命令行即可在相应的平台上安装Docker，比如VirtualBox、 Digital Ocean、Microsoft Azure。</td></tr></tbody></table><h3 id="Docker-部署安装"><a href="#Docker-部署安装" class="headerlink" title="Docker 部署安装"></a>Docker 部署安装</h3><p>Docker 是一个开源的商业产品，有两个版本：社区版（Community Edition，缩写为 CE）和企业版（Enterprise Edition，缩写为 EE）。企业版包含了一些收费服务，个人开发者一般用不到。<br>Docker CE 的安装请参考官方文档。</p><blockquote><ul><li><a href="https://docs.docker.com/docker-for-mac/install/" target="_blank" rel="noopener">Mac</a></li><li><a href="https://docs.docker.com/docker-for-windows/install/" target="_blank" rel="noopener">Windows</a></li><li><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">Ubuntu</a></li><li><a href="https://docs.docker.com/install/linux/docker-ce/debian/" target="_blank" rel="noopener">Debian</a></li><li><a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener">CentOS</a></li><li><a href="https://docs.docker.com/install/linux/docker-ce/fedora/" target="_blank" rel="noopener">Fedora</a></li><li><a href="https://docs.docker.com/install/linux/docker-ce/binaries/" target="_blank" rel="noopener">其他 Linux 发行版</a></li></ul></blockquote><h4 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h4><ul><li><p>1.前提条件:Docker 运行在 CentOS 7 上，要求系统为64位且系统内核版本为 3.10 以上。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker01/Docker01_005.png" alt=""></p></li><li><p>2.移除旧的版本</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">              docker-client \</span><br><span class="line">              docker-client-latest \</span><br><span class="line">              docker-common \</span><br><span class="line">              docker-latest \</span><br><span class="line">              docker-latest-logrotate \</span><br><span class="line">              docker-logrotate \</span><br><span class="line">              docker-selinux \</span><br><span class="line">              docker-engine-selinux \</span><br><span class="line">              docker-engine</span><br></pre></td></tr></table></figure></li><li><p>3.安装必要的系统工具</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure></li><li><p>4.添加软件源信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></li><li><p>5.更新 yum 缓存</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum makecache fast</span><br></pre></td></tr></table></figure></li><li><p>6.安装</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum -y install docker-ce</span><br></pre></td></tr></table></figure></li><li><p>7.启动 Docker 后台服务</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure></li><li><p>8.测试运行 hello-world</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p>  <img src="/image/Docker01/Docker01_006.png" alt=""></p></li><li><p>9.查看docker信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker version <span class="comment"># 查看docker的版本号，包括客户端、服务端、依赖的Go等</span></span><br><span class="line">docker info <span class="comment"># 查看系统(docker)层面信息，包括管理的images, containers数等</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="Docker-资源汇总"><a href="#Docker-资源汇总" class="headerlink" title="Docker 资源汇总"></a>Docker 资源汇总</h3><h4 id="Docker-资源"><a href="#Docker-资源" class="headerlink" title="Docker 资源"></a>Docker 资源</h4><ul><li>Docker 官方主页: <a href="https://www.docker.com/" target="_blank" rel="noopener">https://www.docker.com</a></li><li>Docker 官方博客: <a href="https://blog.docker.com/" target="_blank" rel="noopener">https://blog.docker.com/</a></li><li>Docker 官方文档: <a href="https://docs.docker.com/" target="_blank" rel="noopener">https://docs.docker.com/</a></li><li>Docker Store: <a href="https://store.docker.com/" target="_blank" rel="noopener">https://store.docker.com</a></li><li>Docker Cloud: <a href="https://cloud.docker.com/" target="_blank" rel="noopener">https://cloud.docker.com</a></li><li>Docker Hub: <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com</a></li><li>Docker 的源代码仓库: <a href="https://github.com/moby/moby" target="_blank" rel="noopener">https://github.com/moby/moby</a></li><li>Docker 发布版本历史: <a href="https://docs.docker.com/release-notes/" target="_blank" rel="noopener">https://docs.docker.com/release-notes/</a></li><li>Docker 常见问题: <a href="https://docs.docker.com/engine/faq/" target="_blank" rel="noopener">https://docs.docker.com/engine/faq/</a></li><li>Docker 远端应用 API: <a href="https://docs.docker.com/develop/sdk/" target="_blank" rel="noopener">https://docs.docker.com/develop/sdk/</a></li></ul><h4 id="Docker-国内镜像"><a href="#Docker-国内镜像" class="headerlink" title="Docker 国内镜像"></a>Docker 国内镜像</h4><ul><li>阿里云的加速器：<a href="https://help.aliyun.com/document_detail/60750.html" target="_blank" rel="noopener">https://help.aliyun.com/document_detail/60750.html</a></li><li>网易加速器：<a href="http://hub-mirror.c.163.com" target="_blank" rel="noopener">http://hub-mirror.c.163.com</a></li><li>官方中国加速器：<a href="https://registry.docker-cn.com" target="_blank" rel="noopener">https://registry.docker-cn.com</a></li><li>ustc 的镜像：<a href="https://docker.mirrors.ustc.edu.cn" target="_blank" rel="noopener">https://docker.mirrors.ustc.edu.cn</a></li><li>daocloud：<a href="https://www.daocloud.io/mirror#accelerator-doc（注册后使用）" target="_blank" rel="noopener">https://www.daocloud.io/mirror#accelerator-doc（注册后使用）</a></li></ul><p>More info: <a href="https://www.runoob.com/docker/docker-architecture.html" target="_blank" rel="noopener">Docker教程</a></p>]]></content>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>云计算（四）OpenStack</title>
      <link href="/2018/05/16/%E4%BA%91%E8%AE%A1%E7%AE%9704/"/>
      <url>/2018/05/16/%E4%BA%91%E8%AE%A1%E7%AE%9704/</url>
      <content type="html"><![CDATA[<p>OpenStack 是当今最具影响力的云计算管理工具——通过命令或者基于 Web 的可视化控制面板来管理 IaaS 云端的资源池（服务器、存储和网络）。它最先由美国国家航空航天局（NASA）和 Rackspace 在 2010 年合作研发，现在参与的人员和组织汇集了来自 100 多个国家的超过 9500 名的个人和 850 多个世界上赫赫有名的企业，如 NASA、谷歌、惠普、Intel、IBM、微软等。<br>本文章主要介绍OpenStack的基本知识。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>OpenStack 采用 Python 语言开发，遵循 Apache 开源协议，因此相比 CloudStack 来说，更轻量化，效率更高。</p><ul><li><a href="https://www.openstack.org/user-stories" target="_blank" rel="noopener">OpenStack目前被广泛应用在各行各业</a></li><li><a href="https://docs.openstack.org/nova/latest/user/support-matrix.html" target="_blank" rel="noopener">OpenStack 支持 KVM、Xen、Lvc、Docker 等虚拟机软件或容器，默认为 KVM</a></li><li><a href="https://releases.openstack.org/" target="_blank" rel="noopener">各个版本的发行时间表参考网</a></li></ul><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p>OpenStack 组件的主要作用是充当“中间人”，它不履行具体的实际任务，而由各种第三方软件来完成，比如虚拟机软件由 KVM 承担，网站任务由 Apache 承担，虚拟网络任务由 iptables、DNSmasq、Linux vSwitch、Linux 网桥承担或者统一由 OpenContrail 承担，结构化数据存储任务由 MySQL 或者 PostgreSQL 承担，中央存储任务由 Ceph 承担（也可采用其他产品）。当然，OpenStack 中也有实现具体功能的组件，比如 Swift 做中央存储，我们也可以选择相对发展多年并且被大量使用的第三方产品，如 Ceph。</p><p><img src="/image/云计算04/云计算04_001.jpg" alt=""></p><table><thead><tr><th>分类</th><th>组件名称</th><th>功能</th></tr></thead><tbody><tr><td>核心组件</td><td>Nova</td><td>管理虚拟机的整个生命周期:创建、运行、挂起、调度、关闭、销毁等。这是真正的执行部件。接受 DashBoard 发來的命令并完成具体的动作。但是 Nova 不是虛拟机软件，所以还需要虚拟机软件（如 KVM、Xen、Hyper-v 等）配合</td></tr><tr><td>核心组件</td><td>Neutron</td><td>管理网络资源，提供/一组应用编程接口(API)，用户可以调用它们来定义网络(如 VLAN )，并把定义好的网络附加给租户。Networking 是一个插件式结构，支持当前主流的网络设备和最新网铬技术</td></tr><tr><td>核心组件</td><td>Swift</td><td>是 <a href="http://c.biancheng.net/nosql/" target="_blank" rel="noopener">NoSQL</a> 数据库，类似 <a href="http://c.biancheng.net/hbase/" target="_blank" rel="noopener">HBase</a>，为虚拟机提供非结构化数据存储，它把相同的数据存储在多台计箅机上，以确保数据不会丢失。用户可通过 RESTful 和 HTTP 类型的 API 来和它通信。这是实际的存储项目，类似 Ceph，不过在 OpcnStack 具体实施时，人们更愿意采用 Ceph。</td></tr><tr><td>核心组件</td><td>Cinder</td><td>管理块设备，为虚拟机管理 SAN 设备源。但是它本身不是块设备源， 需要一个存储后端来提供实际的块设备源（如 iSCSI、FC等）。Cinder 相当于一个管家，当虚拟机需要块设备时，询问管家去哪里获取具体的块设备。它也是插件式的，安装在具体的 SAN 设备里。Cinder 支持的存储后端品牌参见 <a href="https://wiki.openstack.org/wiki/CinderSupportMatrix，驱动参见" target="_blank" rel="noopener">https://wiki.openstack.org/wiki/CinderSupportMatrix，驱动参见</a> <a href="https://github.com/openstack/cinder/tree/master/cinder/volume/drivers。" target="_blank" rel="noopener">https://github.com/openstack/cinder/tree/master/cinder/volume/drivers。</a></td></tr><tr><td>核心组件</td><td>Keystone</td><td>为其他服务提供身份验证、权限管理、令牌管理及服务名册管理。要使用云计算的所有用户事先需要在 Keystone 中建立账号和密码，并定义权限（注意:这里的“用户”不是指虚拟机里的系统账户，如 Windows 7 中的 Administrator )。另外，OpenStack 服务（如 Nova、Neutron、Swift、Cinder 等）也要在里面注册，并且登记具体的 API，Keystone 本身也要注册和登记 API</td></tr><tr><td>核心组件</td><td>Glance</td><td>存取虚拟机磁盘镜像文件，Compute 服务在启动虚拟机时需要从这里获取镜像文件。这个组件不同于上面的 Swift 和 Cinder，这两者提供的 存储是在虚拟机里使用的</td></tr><tr><td>可选组件</td><td>Horizon</td><td>提供了一个网页界面，用户登录后可以做这些操作：管理虚拟机、配置权限、分配 IP 地址、创建租户和用户等。本质上就是通过图形化的 操作界面控制其他服务（如 Compute、Networking 等)。当然，如果你熟悉命令，也可以直接采用命令来完成相应的任务</td></tr><tr><td>可选组件</td><td>Heat</td><td>如果要在成千上万个虚拟机里安装和配置同一个软件，该怎么办？采用 Orchestrates 是一个不错的主意，它向每个虚拟机里注人一个名叫 heat-cfntools 的客户端工具，然后就能同时操作很多虚拟机</td></tr><tr><td>可选组件</td><td>Sahana</td><td>使用户能够在 OpenStack 平台上（利用虚拟机）一键式创建和管理 Hadoop 集群，实现类似 AWS 的 EMR（Amazon Elastic MapReduce Service）功能。用户只需要提供简单的配置参数和模板，如版本信息（CDH 版本）、集群拓扑（几个 Slave、几个 Datanode）、节点配置信息（CPU、内存）等，Sahara 服务就能够在几分钟内根据提供的模板快速 部署 Hadoop、Spark 及 Storm 集群。Sahana 是一个<a href="http://c.biancheng.net/big_data/" target="_blank" rel="noopener">大数据</a>分析项目</td></tr><tr><td>可选组件</td><td>Ironic</td><td>把裸金属机器（与虚拟机相对）加人到资源池中</td></tr><tr><td>可选组件</td><td>Zaqar</td><td>Zaqar 为 Web 和移动开发者提供多租户云消息和通知服务，开发人员可以通过 REST API 在其云应用的不同组件中通过不同的通信模式（如 生产者/消费者或发布者/订阅者）来传递消息</td></tr><tr><td>可选组件</td><td>Ceilometer</td><td>结合 Aodh、CloudKitty 两个组件，完成计费任务，如结算、消耗的 资源统计、性能监控等。OpenStack 之所以能管理公共云，一是因为 Ceilometer 的存在，二是因为引人了租户的概念</td></tr><tr><td>可选组件</td><td>Barbican</td><td>是 OpenStack 的密钥管理组件，其他组件可以调用 Barbican 对外暴露的 REST API 来存储和访问密钥</td></tr><tr><td>可选组件</td><td>Manila</td><td>为虚拟机提供文件共享服务，不过需要存储后端的配合</td></tr><tr><td>可选组件</td><td>其他组件：Congress（策略服务）、Designate（DNS 服务）、Freezer（备份及还原服务）、Magnum（容器支持）、Mistral（工作流服务）、Monasca（监控服务）、Searchlight（索引和搜索）、Senlin（集群服务）、Solum（APP集成开发平台）、Tacker（网络功能 虚拟化）、Trove（数据库服务）</td><td><br></td></tr></tbody></table><p><img src="/image/云计算04/云计算04_002.jpg" alt=""></p><h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><p>部署 OpenStack 时应该遵循“逐步扩展部署法”:</p><ol><li>最小系统具备基本的 IaaS 功能，能通过命令来进行管理，这一步只需安装 OpenStack 的 Keystone、Neutron、Nova 和 Glance 四个组件；</li><li>安装 Horizon 就成了小系统，这时可通过 Web 图形化界面来执行管理；</li><li>安装 Swift 和 Cinder 就成了准系统</li><li>给虚拟机附加磁盘块设备，并能满足大规模的存储需求；再加上计费组件 Ceilometer，就上升为一般系统，一般系统具备公有 IaaS 的功能。</li><li>一般系统跨到生产系统，需要完成的工作就特别多，其中性能和安全是两个不得不面对的棘手问题。 Iptables（设立门卫）、Selinux 或 Apparmor（加固系统）和 Snort（巡逻）都是为了强化安全,Keepalive监听服务器状态.</li></ol><p><img src="/image/云计算04/云计算04_003.jpg" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 云计算 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>云计算（三）搭建云计算环境</title>
      <link href="/2018/04/15/%E4%BA%91%E8%AE%A1%E7%AE%9703/"/>
      <url>/2018/04/15/%E4%BA%91%E8%AE%A1%E7%AE%9703/</url>
      <content type="html"><![CDATA[<p>本文章主要介绍搭建云计算需要解决的问题。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/云计算03/云计算03_001.jpg" alt=""></p><h3 id="硬件资源"><a href="#硬件资源" class="headerlink" title="硬件资源"></a>硬件资源</h3><ul><li><p>存储</p><p>采用SSD或者采用SATA+SSD的混合方式节约资源和降低成本。提供VM虚拟机运行环境的block device（块存储），以及提供KV方式的对象访问存储。</p></li><li><p>网络</p><p>  对于公有云以及私有云的一些应用场景，需要能够提供网络的逻辑隔离（SDN）或物理隔离，以及对网络的访问灵活问题。需要构建虚拟化网络，对物理网络资源进行抽象并池化，以便于分割或合并资源来满足共享的目的。常用的方式是：bridge、vlan、gre、sdn（openflow、opendaylight）等等。</p><ul><li>网络虚拟化发展<br><img src="/image/云计算03/云计算03_002.jpg" alt=""></li><li>单个物理机的网络<br><img src="/image/云计算03/云计算03_003.jpg" alt=""></li><li>多个物理机的网络<br><img src="/image/云计算03/云计算03_004.jpg" alt=""></li></ul></li></ul><h3 id="虚拟化"><a href="#虚拟化" class="headerlink" title="虚拟化"></a>虚拟化</h3><p><img src="/image/云计算03/云计算03_005.jpg" alt=""></p><ul><li><p>VM</p><p>  使用Xen（<a href="https://xenserver.org/" target="_blank" rel="noopener">XenServer</a>、<a href="https://docs.oracle.com/cd/E50699_01/html/E50085/gkers.html" target="_blank" rel="noopener">Oracle VM Server</a>）、<a href="https://openvz.org/" target="_blank" rel="noopener">OpenVZ</a> 、KVM(<a href="https://access.redhat.com/documentation/en-us/" target="_blank" rel="noopener">RHV</a>)、Vmware、VirtualBox等虚拟技术进行虚拟化，虚拟化后可以安装开源操作系统（<a href="https://distrowatch.com/" target="_blank" rel="noopener">Linux 内核</a>、<a href="https://www.freebsd.org/zh_CN/where.html" target="_blank" rel="noopener">FreeBSD</a>、<a href="https://illumos.org/" target="_blank" rel="noopener">Illumos 内核</a> )，通过  <strong><a href="https://docs.openstack.org/ussuri/" target="_blank" rel="noopener">OpenStack</a></strong>、<a href="http://cloudstack.apache.org/" target="_blank" rel="noopener">CloudStack</a> 、<a href="https://github.com/eucalyptus/eucalyptus" target="_blank" rel="noopener">Eucalyptus</a>和<a href="https://www.oracle.com/technetwork/cn/server-storage/vm/overview/ovm-211034-zhs.html" target="_blank" rel="noopener">Oracle VM Manager</a> 等等去管理分配资源</p></li></ul><p><img src="/image/云计算03/云计算03_006.jpg" alt=""></p><ul><li><p>容器化：可以使应用服务化</p><p>  对于各个应用场景来说，VM本身的启动需要占用大量的内存、cpu和存储资源，导致系统内存和cpu使用有一定的浪费，容器化是一种轻量级的实现，能够在资源初始化，资源利用率方面能够最大化。例如Linux-VServer、LXC、FreeBSD jail、Solaris Containers、<br><strong><a href="https://www.docker.com/" target="_blank" rel="noopener">Docker</a></strong>、Rocket/rkt 和openVZ/Odin等容器技术，Dokcer是通过<a href="https://kubernetes.io/" target="_blank" rel="noopener">Kubernetes</a>管理。</p></li></ul><p><img src="/image/云计算03/云计算03_007.jpg" alt=""></p><h3 id="管理和使用"><a href="#管理和使用" class="headerlink" title="管理和使用"></a>管理和使用</h3><ul><li><p>远程桌面：VDI可以远程登陆虚拟主机</p></li><li><p>高可用：集群负载均衡和容灾</p><p>  高可用问题是在分布式系统中必须要处理的问题，需要保证云管理系统的高可用性，存储介质的高可用性，网络的高可用性，虚拟机高可用问题等等。</p><ul><li>集群<ul><li>任务的拆分:尽量降低子任务之间的关联性，从而提高处理任务的并行度。</li><li>任务的调度:把拆分出来的子任务合理地调度给云端服务器并让它们协同完成,最能满足租户要求的调度方法就是合理的</li></ul></li><li>负载均衡:多租户请求合理分配（<a href="http://www.linuxvirtualserver.org/" target="_blank" rel="noopener">LVS</a> <a href="http://nginx.org/en/download.html" target="_blank" rel="noopener">nignx</a>）</li><li>容灾：<ul><li>检测服务器的状态：<a href="https://www.keepalived.org/" target="_blank" rel="noopener">Keepalived</a> </li><li>主从热备</li></ul></li></ul></li><li><p>租户隔离</p><ul><li>租户行为隔离</li><li>资源隔离</li><li>租户数据隔离，数据隔离比行为隔离更重要。<ul><li>分离数据库</li><li>共享数据库但分离 Schema</li><li>共享数据库和 Schema</li></ul></li></ul></li></ul><ul><li>安全问题<ul><li>防火墙：使用外网防火墙</li><li>网络隔离：网络进行多层划分，控制每层的入口</li><li>流量统一管理：API网关作为统一出入口</li><li>统一身份认证：<ul><li>统一用户管理（Identification） ：租户的账号、密码等信息集中存储，统一管理    </li><li>身份鉴别（Authentication）：当租户企图登录某个应用系统时，验证他的票据或者身份是否合法。</li><li>权限控制（Authorization）：规定允许登录系统的租户具备哪些操作权限。</li><li>操作日志登记（Accountability）：记录租户的操作行为，以便事后责任追溯。</li></ul></li></ul></li></ul><h3 id="具体实践"><a href="#具体实践" class="headerlink" title="具体实践"></a>具体实践</h3><p><img src="/image/云计算03/云计算03_008.jpg" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 云计算 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>云计算（二）云计算的角色</title>
      <link href="/2018/03/15/%E4%BA%91%E8%AE%A1%E7%AE%9702/"/>
      <url>/2018/03/15/%E4%BA%91%E8%AE%A1%E7%AE%9702/</url>
      <content type="html"><![CDATA[<p>本文章主要介绍什么是云计算的角色。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p><img src="/image/云计算02/云计算02_001.jpg" alt=""></p><table><thead><tr><th style="text-align:center">角色</th><th style="text-align:center">定义</th></tr></thead><tbody><tr><td style="text-align:center">云服务消费者</td><td style="text-align:center">租赁云服务产品的个人或单位组织</td></tr><tr><td style="text-align:center">云服务提供商</td><td style="text-align:center">提供云服务产品的个人或单位组织，如中国电信天翼云、阿里云、腾讯云等</td></tr><tr><td style="text-align:center">云服务代理商</td><td style="text-align:center">代理云服务提供商向消费者销售云计算服务并获取一定佣金的个人或者单位组织</td></tr><tr><td style="text-align:center">云计算审计员</td><td style="text-align:center">能对云计算安全性、云计算性能、云服务及信息系统的操作开展独立评估的第三方个人或者单位组织</td></tr><tr><td style="text-align:center">云服务承运商</td><td style="text-align:center">在云服务提供商和云服务消费者之间提供连接媒介，以便把云计算服务产品从云服务提供商那里转移到云服务消费者手中，如中国电信。但是广域网商和因特网商不属于云服务承运商</td></tr></tbody></table><p>不同角色的交互关系：</p><p><img src="/image/云计算02/云计算02_002.jpg" alt=""></p><h3 id="云服务消费者"><a href="#云服务消费者" class="headerlink" title="云服务消费者"></a>云服务消费者</h3><p>从云服务提供商或者云服务代理商那里租赁云服务产品，在合同期内和云服务提供商保持一种供/需业务关系。</p><p>不同云服务类型的消费者使用云服务产品和流程也不同：</p><p><img src="/image/云计算02/云计算02_003.jpg" alt=""></p><h3 id="云服务提供商"><a href="#云服务提供商" class="headerlink" title="云服务提供商"></a>云服务提供商</h3><p>个人或者单位组织，他们负责搭建云端并对外提供云服务产品。支撑云服务的 IT 层可以由云服务提供商自己组建，也可以租赁其他人的云服务。</p><p>云服务提供商的五大任务包括服务部署、服务编排、云服务管理、安全保障和隐私保护</p><ul><li><p>服务部署：参考上一章 云计算的形式</p></li><li><p>服务编排：指把各种系统组件合理地整合在一起，以便向云服务消费者提供云服务产品。分为三层，上层依赖直接下层。资源抽象与控制层利用下层的物理资源，向上层暴露资源池，而顶部的服务层利用下层的资源池向云服务消费者暴露服务接口，而云服务消费者不能直接操纵底层的物理资源。<br><img src="/image/云计算02/云计算02_004.jpg" alt=""></p><ul><li>顶部的服务层定义了云服务消费者访问计算资源的接口（简称访问接口）——IaaS、PaaS 和 SaaS。</li><li><p>中间层是资源抽象与控制层，包括两类系统组件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1）抽象组件</span><br><span class="line">主要用于对物理计算资源进行虚拟化，虚拟化之后的资源就可以放入资源池中，以便将来供云服务消费者弹性租赁。抽象组件包括虚拟机管理平台（Hypervisor）、虚拟机软件（VM）、软件定义存储（SDS）、软件定义网络（SDN）等，其中虚拟机技术是最常见的资源抽象组件。无论如何，抽象组件必须能确保高效、安全和可靠地运用底层的物理资源。</span><br><span class="line">2）控制组件:</span><br><span class="line">主要负责资源分配、访问控制和监控资源使用等。总之，本层的主要功能是把物理资源池化并有效管理被池化后的资源。</span><br></pre></td></tr></table></figure></li><li><p>底层是物理资源层，包含所有的物理计算资源——物理服务器（主要包含 CPU、内存计算资源）、网络设备（路由器、防火墙、交换机、网卡等）、存储设备（如硬盘、存储阵列），以及其他物理的计算设施；也包含基础设施资源，如加热器、空调、通风设备、供电设备等。</p></li></ul></li><li><p>云服务管理:云服务管理是指云服务提供商必须履行的一套流程和任务，以便圆满地把云服务交付给消费者。</p><ul><li>业务支持这是与客户有关的活动和服务，具体包括如下表所示。</li></ul></li></ul><table><thead><tr><th style="text-align:center">名称</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:center">租户管理</td><td>管理租户账号、激活/禁用/终止账号、管理用户资料、解决租户提出的问题、处理投诉等。</td></tr><tr><td style="text-align:center">合同管理</td><td>管理服务合同、洽谈/签订/关闭/终止合同等。</td></tr><tr><td style="text-align:center">云服务产品管理</td><td>建立和管理云服务产品目录，以便用户浏览和选择等。</td></tr><tr><td style="text-align:center">费用结算</td><td>生成发票并送交客户，回收款项，尽量做到现收现付。</td></tr><tr><td style="text-align:center">报表与审计</td><td>监视用户消耗资源状况，产生有关报表，履行事后监督和审计。</td></tr><tr><td style="text-align:center">价格管理</td><td>给云服务产品建立价格点和价格分层，监视竞争对手的报价并及时调整产品价格以确保竞争力。云服务提供商通常会给大客户提供价格折扣或者信用消费（先消费后付款）。</td></tr></tbody></table><pre><code>* 交付与配置 </code></pre><table><thead><tr><th style="text-align:center">名称</th><th>说明</th></tr></thead><tbody><tr><td style="text-align:center">快速交付</td><td>能快速响应用户的弹性需求，最好是自动化响应。</td></tr><tr><td style="text-align:center">资源变更</td><td>包括替换故障设备、升级设备、添加新设备，从而扩充资源容量，以及重新配置现有的设备。</td></tr><tr><td style="text-align:center">资源监控</td><td>发现和监视虚拟资源，监视云端操作和事件，并且产生性能报表。</td></tr><tr><td style="text-align:center">计量</td><td>定义付费的计量方法，比如根据某类资源（如存储、CPU、内存、网络带宽等）的使用量和时间长短计费，也有按照每使用一次计费的，还有的是较复杂的公式。</td></tr><tr><td style="text-align:center">服务水平协议（SLA）管理</td><td>具体涵盖 SLA 定义、SLA 实施监督和 SLA 执行评价，目的是保证服务质量。</td></tr></tbody></table><pre><code>* 可移植性与互操作性</code></pre><ul><li><p>安全保障</p><ul><li>3 种云服务模式蕴含的安全问题</li><li>4 种部署模型蕴含的安全问题</li><li>安全职责共担</li></ul></li><li><p>隐私保护</p></li></ul><h3 id="云服务审计员"><a href="#云服务审计员" class="headerlink" title="云服务审计员"></a>云服务审计员</h3><p>云计算审计员能对云计算利益相关者开展独立检查并发布评估结果，审计的核心任务就是通过对客观证据的审查来评估是否符合预设的标准。针对云服务提供商的审计主要包括安全审计、隐私保护审计和性能审计等。</p><ul><li>安全审计<br>云计算审计员评估云服务提供商是否具备足够的且准备妥当的安全控制措施以及是否严格遵守切实可行的安全流程。例如，云计算审计员审查云服务提供商是否遵守了 ISO 27001 安全标准。</li><li>隐私保护审计<br>隐私保护审计主要检查云服务提供商是否保护了个人信息（PI）和个人身份信息（PII）。</li><li>性能审计<br>云服务提供商必须满足在服务水平协议（SLA）中列举的服务质量（QoS）的要求，但是云服务消费者往往抱怨其利益受到损害，而云服务提供商也常常表示无辜，只有通过第三方独立开展性能审计才能消除供/需双方的分歧。</li></ul><h3 id="云服务代理商"><a href="#云服务代理商" class="headerlink" title="云服务代理商"></a>云服务代理商</h3><p>1）服务中介<br>云服务代理商处于云服务提供商和云服务消费者之间，他是云服务提供商的客户，又充当云服务消费者的云服务提供商。云服务代理商尽可能地改善一些云服务产品并给消费者提供增值服务，这些改善措施包括但不限于强化安全、完善性能报告、优化身份管理、做好本地化（语言、本地人的习惯、本地法律法规等）以及增强用户的交互体验等。<br><img src="/image/云计算02/云计算02_005.jpg" alt=""><br>2）服务聚合<br>云服务代理商把多个服务整合成一个或几个新的服务，以满足用户复杂的需求，同时提供数据集成，使得云服务消费者和多个云服务提供商之间的数据移动是安全的。示意图如图 2 所示。<br>3）服务套利<br>“套利”意为快速买卖以赚取差价。这里的服务套利类似于服务聚合，但是被聚合的服务是不固定的，云服务代理商可随时在多个云服务提供商的产品中筛选最好的服务。比如，云服务代理商可以使用信用评分措施来衡量和挑选分数最高的云服务提供商。<br>服务聚合<br><img src="/image/云计算02/云计算02_006.jpg" alt=""></p><h3 id="云服务承运商"><a href="#云服务承运商" class="headerlink" title="云服务承运商"></a>云服务承运商</h3><p>云服务承运商负责在云服务提供商和云服务消费者之间建立连接媒介，以便把云计算服务产品从云服务提供商那里转移到云服务消费者手中。</p><p>云服务的分发工作通常由网络和电信运营商或者专门的传输代理机构完成。传输代理机构是指提供诸如大容量磁盘这种物理的传输存储媒介的业务机构。为了保证服务质量，云服务提供商会和云服务承运商签订服务水平协议（SLA），还可能要求云服务承运商提供专线，以保证云服务供需双方的连接安全。</p>]]></content>
      
      
        <tags>
            
            <tag> 云计算 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>云计算（一）云计算的基本概念</title>
      <link href="/2018/02/15/%E4%BA%91%E8%AE%A1%E7%AE%9701/"/>
      <url>/2018/02/15/%E4%BA%91%E8%AE%A1%E7%AE%9701/</url>
      <content type="html"><![CDATA[<p>本文章主要介绍什么是云计算。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="传统it架构"><a href="#传统it架构" class="headerlink" title="传统it架构"></a>传统it架构</h3><p>典型的 IT 系统如下图所示</p><p><img src="/image/云计算01/云计算01_001.jpg" alt=""></p><p><strong>注：IT 就是信息（Information）与技术（Technology），其中 I 是目的，T 是手段，T 是用来加工处理 I 的。</strong></p><p>随着应用复杂的复杂化（不断增长的需求需要支持更多的用户、更强的计算能力和更加稳定安全等）：</p><ul><li>硬件成本增加</li><li>软件成本增加</li><li>人力成本增加</li></ul><p>所以企业就需要承担不断增大的成本。</p><h3 id="云计算"><a href="#云计算" class="headerlink" title="云计算"></a>云计算</h3><p>早期概念，云计算（cloud computing）是分布式计算的一种，指的是通过网络“云”将巨大的数据计算处理程序分解成无数个小程序，然后通过多部服务器组成的系统进行处理和分析这些小程序得到结果并返回给用户。</p><p>现阶段所说的已经不单单是一种分布式计算，而是通过<strong>虚拟化</strong>把硬件资源变成一个大虚拟资源池，再<strong>按需分配</strong>成各个小资源池，把软件部署到小资源池上，形成<strong>服务化</strong>，这样软硬件资源都都可以共享和重复利用。一定程度上优化了物理资源，用户不再需要昂贵、存储空间大的主机，可以选择<strong>相对廉价</strong>的PC组成云，一方面减少费用，另一方面计算性能不逊于大型主机。也可以节约人力成本。</p><h3 id="云计算的优缺点"><a href="#云计算的优缺点" class="headerlink" title="云计算的优缺点"></a>云计算的优缺点</h3><ul><li>优点:<ul><li>提高IT设备使用率，并降低设备量，利于企业之间或者个人之间共享信息，打破信息孤岛。</li><li>降低了消费者信息技术成本：前期投入和日常使用成本得到大幅度降低，同时也降低了因各种IT事故导致的损失。</li><li>提高了数据的安全性</li><li>提高了应用系统的可靠性</li><li>提高了用户体验：当今网络无处不在，云计算消费者可以随时随地采用任何云终端接入云端并使用云中的计算资源，真正实现移动办公。</li><li>降低软件使用门槛，可以让个人和中小企业使用大型昂贵软件，高性能计算机</li><li>从复杂的 IT 技术泥潭中摆脱出来，专注于自己的核心业务和市场。</li><li>能快速响应消费者对计算资源的弹性需求，从而能及时满足企业的业务变化。在传统 IT 系统下，一项新业务对 IT 资源的扩容要求，往往在数月或者一年后才能得到满足，这使得市场人员和管理层往往难以接受，因为市场是瞬息万变的。</li></ul></li></ul><ul><li><p>缺点:</p><ul><li><p>严重依赖网络。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">没有网络的地方，或者网络不稳定的地方，消费者可能根本无法使用云服务或用户体验很差。但这并不是云计算固有的缺陷，随着网络普及越来越广、网速越来越快，甚至是城市无线 Wi-Fi 全覆盖、国家无线 Wi-Fi 全覆盖的到来，将使网络不再是问题。   </span><br><span class="line">针对这个问题，现在有一些胖云终端产品，它会把一些常见的应用程序驻留在本地，同时缓存数据，当网络良好时，数据自动与云端同步。</span><br></pre></td></tr></table></figure></li><li><p>数据可能泄密的环节增多。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">云端、灾备中心、离线备份介质、网络、云终端、账号和密码，这些都有可能成为信息的泄密点。但是云计算使得数据信息遭到非人为因素破坏的概率大大降低了，比如在传统IT系统中，存储设备损坏、机房火灾、地震、雷劈、洪水等都会破坏数据，而在云计算环境则没有这些隐患。总之，云计算消除了一些数据泄密和破坏点，但是又带来了一些新的不安全因素。</span><br></pre></td></tr></table></figure></li><li><p>相对于传统的分散计算，云计算把计算资源集中在一起，因而风险也被集中在一起。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">云端成了单点故障，如果云端发生事故，则影响面将非常巨大。目前常见的应对措施是数据冗余存储、建立灾备中心、建立双活数据中心等。</span><br></pre></td></tr></table></figure></li><li><p>用户对数据和技术的掌控灵活度下降。</p></li></ul></li></ul><h3 id="云计算的形式"><a href="#云计算的形式" class="headerlink" title="云计算的形式"></a>云计算的形式</h3><p>根据面对的使用的人群、使用的方式和部署形式，分为四种。</p><h4 id="公有云"><a href="#公有云" class="headerlink" title="公有云"></a>公有云</h4><p>公有云就是 第三方的公有云供应商 为用户（个人或企业）提供可通过互联网访问的虚拟环境中的服务器空间。然后用户可以通过购买云服务器、数据存储和其他与云相关的服务等公有云服务来访问这些服务器。</p><ul><li>优点:<ul><li>成本更低 — 无需购买硬件或软件，仅对使用的服务按量付费。</li><li>无需维护 — 维护由服务提供商提供。</li><li>近乎无限制的缩放性 — 提供按需资源，可满足业务需求。</li><li>高可靠性 — 具备众多服务器，确保免受故障影响。</li></ul></li></ul><ul><li><p>缺点:</p><ul><li>安全性差</li><li>数据私密性差</li></ul></li><li><p>使用场景:<br>公有云部署通常用于提供基于 Web 的电子邮件、网上办公应用、存储以及测试和开发环境。</p></li></ul><h4 id="私有云"><a href="#私有云" class="headerlink" title="私有云"></a>私有云</h4><p>私有云是为一个企业或组织提供专用的云环境。<br>私有云可以由企业或组织内部的IT团队在该组织的防火墙后面进行内部操作，因此组织可以更好地控制其计算资源。<br>私有云主要由企业使用，因此它也被视为一种企业云。<br>私有云可在物理上位于组织的现场数据中心，也可由第三方服务提供商托管。</p><p>本地私有云<br><img src="/image/云计算01/云计算01_002.jpg" alt=""></p><p>托管私有云<br><img src="/image/云计算01/云计算01_003.jpg" alt=""></p><ul><li><p>优点:</p><ul><li>灵活性更高 — 组织可自定义云环境以满足特定业务需求。</li><li>安全性更高 — 资源不与其他组织共享，从而可实现更高控制性和安全性级别。</li><li>缩放性更高 — 私有云仍然具有公有云的缩放性和效率。</li><li>完全支持自定义</li></ul></li><li><p>缺点:</p><ul><li>成本高 </li><li>需要自己维护</li></ul></li><li><p>使用场景:<br>私有云的使用对象通常为政府机构、金融机构以及其他具备业务关键性运营且希望对环境拥有更大控制权的中型到大型组织。</p></li></ul><h4 id="混合云"><a href="#混合云" class="headerlink" title="混合云"></a>混合云</h4><p>混合云通过安全连接（如VPN连接或租用线路）组合一个或多个公有云和私有云环境，从而允许在不同云环境之间共享数据和应用程序。<br>当在私有云上运行的应用程序遇到使用高峰时，它们可以自动“突发”到公有云环境以获得额外的按需容量。由于额外的需求将在公有云上，因此无需担心提前配置硬件以满足高峰需求。<br>连接公有云和私有云有两种方法：VPN和点对点专用连接。</p><p><img src="/image/云计算01/云计算01_004.jpg" alt=""></p><ul><li><p>优势</p><ul><li>控制和安全性 — 组织可针对敏感资产维持私有基础结构。</li><li>灵活性 — 需要时可利用公有云中的其他资源。</li><li>成本效益低 — 具备扩展至公有云的能力，因此可仅在需要时支付额外的计算能力。</li><li>弹性伸缩 — 无需费时费力即可转换至云，因为可根据时间按工作负荷逐步迁移。</li><li>近乎无限制的缩放性 — 提供按需资源，可满足业务需求。</li></ul></li><li><p>使用场景:<br>混合云的使用对象通常由大流量的互联网业务，同时部分业务有合规需求或者需要充分利用现有IT资产的企业或组织。</p></li></ul><h4 id="社群云"><a href="#社群云" class="headerlink" title="社群云"></a>社群云</h4><p>社群云，也称社区云，是由几个组织共享的云端基础设施，它们支持特定的社群，有共同的关切事项，例如使命任务、安全需求、策略与法规遵循考量等。管理者可能是组织本身，也能是第三方；管理位置可能在组织内部，也可能在组织外部。</p><p>本地社区云<br><img src="/image/云计算01/云计算01_005.jpg" alt=""></p><p>托管社区云<br><img src="/image/云计算01/云计算01_006.jpg" alt=""></p><ul><li>使用场景:<br>社群云的使用对象通常是多个有密切关系的组织一起联合使用。</li></ul><h3 id="云计算的服务"><a href="#云计算的服务" class="headerlink" title="云计算的服务"></a>云计算的服务</h3><p>根据使用对象所需要的服务类型不一样，可以划分成三种，如下图所示：</p><p><img src="/image/云计算01/云计算01_007.jpg" alt=""></p><h4 id="IaaS"><a href="#IaaS" class="headerlink" title="IaaS"></a>IaaS</h4><p>基础设施即服务（Infrastructure as a Service，IaaS）</p><p>云服务提供商把 IT 系统的基础设施层作为服务出租出去，由消费者自己安装操作系统、中间件、数据库和应用程序</p><p><img src="/image/云计算01/云计算01_008.jpg" alt=""></p><p>IaaS 云端的基本架构模型逻辑上分为三层：</p><ul><li><p>第一层（云管理器）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">云管理器是云端对外的总入口，在这里验证用户身份，管理用户权限，向合法用户发放票据（然后用户持此票据使用计算资源）、分配资源并管理用户租赁的资源。</span><br></pre></td></tr></table></figure></li><li><p>第二层（集群管理器）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">每一个集群负责管理本集群内部的高速互联在一起的计算机，一个集群内的计算机可能有成百上千台。</span><br><span class="line">集群管理器接受上层的资源查询请求，然后向下层的计算机管理器发送查询请求，最后汇总并判断是部分满足还是全部满足上层请求的资源，再反馈给上层。如果接下来收到上层分配资源的命令，那么集群管理器指导下层的计算机管理器进行资源分配并配置虚拟网络，以便能让用户后续访问。</span><br><span class="line">另外，本层 PLS 中存储了本集群内的全部虚拟机镜像文件，这样一台虚拟机就能在集群内任意一台计算机上运行，并轻松实现虚拟机热迁移。</span><br></pre></td></tr></table></figure></li><li><p>第三层（计算机管理器）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">每台计算机上都有一个计算机管理器，它一方面与上层的集群管理器打交道，另一方面与本机上的虚拟机软件打交道。它把本机的状态（如正在运行的虚拟机数、可用的资源数等）反馈给上层，当收到上层的命令时，计算机管理器就指导本机的虚拟机软件执行相应命令。这些命令包括启动、关闭、重启、挂起、迁移和重配置虚拟机，以及设置虚拟网络等。</span><br></pre></td></tr></table></figure></li></ul><p>基本架构模型如下图所示：</p><p><img src="/image/云计算01/云计算01_009.jpg" alt=""></p><h4 id="PaaS"><a href="#PaaS" class="headerlink" title="PaaS"></a>PaaS</h4><p>平台即服务（Platform as a Service，PaaS）</p><p>云服务提供商把 IT 系统中的平台软件层作为服务出租出去，消费者自己开发或者安装程序，并运行程序。</p><p><img src="/image/云计算01/云计算01_010.jpg" alt=""></p><p>PaaS 云服务的消费者主要包括以下人员：</p><ul><li>程序开发人员：写代码、编译、调试、运行、部署、代码版本控制等，一揽子解决。</li><li>软件部署人员：把软件部署到 PaaS 云端，便于管理不同版本之间的冲突。</li><li>应用软件管理员：便于配置、调优和监视程序运行性能。</li><li>应用程序最终用户/程序测试人员：这时 PaaS 云服务相当于 SaaS 云服务。</li></ul><p><img src="/image/云计算01/云计算01_011.jpg" alt=""></p><h4 id="SaaS"><a href="#SaaS" class="headerlink" title="SaaS"></a>SaaS</h4><p>软件即服务（Software as a Service，SaaS）</p><p>云服务提供商把 IT 系统中的应用软件层作为服务出租出去，消费者不用自己安装应用软件，直接使用即可，这进一步降低了云服务消费者的技术门槛。</p><p><img src="/image/云计算01/云计算01_012.jpg" alt=""></p><p><img src="/image/云计算01/云计算01_013.jpg" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 云计算 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>自动化测试（四）自动化测试方案的扩展和展望</title>
      <link href="/2018/01/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9504/"/>
      <url>/2018/01/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9504/</url>
      <content type="html"><![CDATA[<p>本文章介绍自动化测试方案的扩展和展望。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><ul><li>需求管理<ul><li>创建和跟踪需求</li></ul></li><li>文档管理<ul><li>用例文档管理</li><li>业务文档</li><li>公共资料</li></ul></li><li>问题单管理</li><li>自动化管理和运行<ul><li>创建用例<ul><li>支持多种来源导入用例模板，然后根据用例版面自动填充用例</li><li>复制已有用例进行修改</li><li>可以复用已有用例</li></ul></li><li>运行用例<ul><li>支持主流框架运行</li><li>支持页面发起测试并展示结果，支持用例调试与问题定位</li><li>支持任务包含用例集合，通过任务定时调度，生成报告发送责任人</li><li>用例支持环境变量切换运行不同环境 </li><li>执行结果入库，进行同接口纵向对比统计和分析</li></ul></li></ul></li><li>自定义API<ul><li>业务API支持在线调用</li><li>常用工具计算API  </li></ul></li><li>数据统计<ul><li>需求量和消耗时间</li><li>问题数和线上问题</li></ul></li></ul><h3 id="功能模块的关联关系"><a href="#功能模块的关联关系" class="headerlink" title="功能模块的关联关系"></a>功能模块的关联关系</h3><ul><li>项目<ul><li>功能特性<ul><li>需求<ul><li>关联问题单</li><li>用例文档</li><li>自动化用例</li></ul></li></ul></li><li>业务文档</li></ul></li><li>公共文档<ul><li>环境信息</li><li>常用工具和流程 </li></ul></li></ul><h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p><img src="/image/自动化测试04_001.png" alt=""></p><h3 id="发展趋势"><a href="#发展趋势" class="headerlink" title="发展趋势"></a>发展趋势</h3><ul><li>通过接口或者业务定义自动生成用例</li><li>支持专项测试</li><li>通过项目的数据分析,判断项目风险程度</li></ul>]]></content>
      
      
        <tags>
            
            <tag> 自动化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>自动化测试（三）自动化测试方案的优化</title>
      <link href="/2017/12/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9503/"/>
      <url>/2017/12/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9503/</url>
      <content type="html"><![CDATA[<p>本文章介绍自动化测试方案的优化。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="用例选择的优化"><a href="#用例选择的优化" class="headerlink" title="用例选择的优化"></a>用例选择的优化</h3><ul><li>用例级别划分：p0+p1:p2:p3 数量比例 = 2:7:1<ul><li>p0: 冒烟用例 保证流程基本走通</li><li>p1: 基本功能测试 </li><li>p2: 复杂功能测试 </li><li>p3: 异常场景 </li></ul></li><li>优先覆盖p0和p1</li><li>用例层级<ul><li>单元测试:场景覆盖百分百</li><li>API:正常调用和健壮性场景覆盖</li><li>WEB:所有页面和用户常见操作</li></ul></li><li>用例优化：20%用例覆盖80%场景</li></ul><h3 id="用例执行的优化"><a href="#用例执行的优化" class="headerlink" title="用例执行的优化"></a>用例执行的优化</h3><h4 id="快"><a href="#快" class="headerlink" title="快"></a>快</h4><h5 id="构建快-执行快"><a href="#构建快-执行快" class="headerlink" title="构建快 执行快"></a>构建快 执行快</h5><ul><li>自动化任务划分<ul><li>根据执行时间拆分:执行时间 1min内 1~5min 超过5min</li><li>根据用例级别拆分:冒烟测试和全量测试</li></ul></li><li>并发和分布执行</li></ul><h5 id="定位快"><a href="#定位快" class="headerlink" title="定位快"></a>定位快</h5><ol><li>日志要包含关键信息:<ol><li>函数执行前后要有开始和完成日志</li><li>数值计算要有结果日志</li></ol></li><li>日志类别划分: <ol><li>debug:详情运行日志</li><li>info :重要运行日志</li><li>warn:警告信息</li><li>error:错误信息</li></ol></li></ol><h4 id="多"><a href="#多" class="headerlink" title="多"></a>多</h4><ul><li>多套环境:环境变量参数化,让用例可以在多套环境分别执行<ul><li>开发环境</li><li>测试环境</li><li>类生产环境 </li></ul></li><li>提高用例的自动化率<ul><li>减少用例:区分用例难度,实现对应策略解决 <ul><li>没有时间实现</li><li>实现难度大</li><li>暂时无法实现</li></ul></li><li>防止自动化用例堆积<ul><li>完成功能测试,需要完成p0和p1用例</li><li>划分责任人去实现</li></ul></li></ul></li></ul><h4 id="稳-用例稳定性"><a href="#稳-用例稳定性" class="headerlink" title="稳:用例稳定性"></a>稳:用例稳定性</h4><ul><li>增加重试机制</li><li>增加等待机制灵活和准确</li><li>提高校验的容错性</li><li>提高用例方案的稳定性<ul><li>ui用例:可以要求开发固定页面元素id,减少元素定位不稳定 </li></ul></li></ul><h3 id="与项目开发结合"><a href="#与项目开发结合" class="headerlink" title="与项目开发结合"></a>与项目开发结合</h3><p>持续集成<br><img src="/image/自动化测试03_001.png" alt="持续集成"></p><p>持续交付<br><img src="/image/自动化测试03_002.png" alt="持续交付"></p><p>持续部署<br><img src="/image/自动化测试03_003.png" alt="持续部署"></p><p>持续集成—&gt;持续交付—&gt;持续部署:</p><ul><li>提交代码 —-&gt; 代码静态检查—-&gt; 代码规范审核—-&gt; 单元测试—-&gt; 构建版本包 (完成持续集成)<ul><li>失败 —-&gt; 回滚代码 —-&gt; 发邮件给提交代码人员 </li></ul></li><li>版本包部署开发环境 —-&gt; 进行冒烟测试—-&gt; 进行全量测试</li><li>版本包部署测试环境 —-&gt; 进行冒烟测试—-&gt; 进行全量测试</li><li>版本包部署uat环境 —-&gt; 进行冒烟测试—-&gt; 进行全量测试<ul><li>失败 —-&gt; 发邮件给提交开发和测试人员</li></ul></li><li>版本包部署线上(完成持续交付)—-&gt; 进行冒烟测试—-&gt; 进行全量测试(完成持续部署)</li></ul>]]></content>
      
      
        <tags>
            
            <tag> 自动化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>自动化测试（二）自动化测试方案设计</title>
      <link href="/2017/11/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9502/"/>
      <url>/2017/11/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9502/</url>
      <content type="html"><![CDATA[<p>本文章介绍自动化测试方案设计。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="方案选择"><a href="#方案选择" class="headerlink" title="方案选择"></a>方案选择</h3><h4 id="自动化测试框架的类型"><a href="#自动化测试框架的类型" class="headerlink" title="自动化测试框架的类型"></a>自动化测试框架的类型</h4><ol><li>单的录制／回放：由工具录制并记录操作的过程和数据形成脚本，通过回放来重复人工操作的过程。在这种模式下数据和脚本混在一起，几乎一个测试用例对应一个脚本，维护成本很高。而且即使界面的简单变化也需要重新录制，脚本 可重复使用的效率低。</li><li>数据驱动 （data driven） 的自动化测试：从数据文件读取输入数据，通过变量的参数化，将测试数据传入测试脚本，不同的数据文件对应不同的测试用例。在这种模式下数据和脚本分离，脚本的利用率、可维护性大大提高，但受界面变化的影响仍然很大。</li><li>关键字驱动（keyword driven） 的自动化测试：关键字驱动测试是数据驱动测试的一种改进类型，它将测试逻辑按照关键字进行分解，形成数据文件，关键字对应封装的业务逻辑。主要关键字包括三类：被操作对象（Item）、操作（Operation）和值（value）， 用面向对象形式可将其表现为Item.Operation（Value）。 关键字驱动的主要思想是：脚本与数据分离、界面元素名与测试内部对象名分离、测试描述与具体实现细节分离。</li><li>行为驱动测试框架：支持自然语言作为测试用例描述的自动化测试框架。</li></ol><h4 id="考虑的因素"><a href="#考虑的因素" class="headerlink" title="考虑的因素"></a>考虑的因素</h4><ul><li>根据团队技术基础<ul><li>如果团队有编码基础，选择跟开发技术栈一致</li><li>没有，选择简单易学工具或者编程语言（python/js）</li></ul></li><li>业务的场景应用<ul><li>如果偏向后端测试且业务简单，都是接口，可以考虑直接用接口工具（jmeter/postman）实现</li><li>如果web或者移动端，就需要测试框架能支持selenium/appium</li><li>如果业务复杂，尽量使用能编码的框架 </li></ul></li><li>业务的生命周期</li></ul><h3 id="方案设计"><a href="#方案设计" class="headerlink" title="方案设计"></a>方案设计</h3><h4 id="分层设计：-高内聚低耦合"><a href="#分层设计：-高内聚低耦合" class="headerlink" title="分层设计： 高内聚低耦合"></a>分层设计： 高内聚低耦合</h4><ul><li>高内聚：就是每个模块尽可能独立完成自己的功能，不依赖于模块外部的代码；</li><li>低耦合：就是模块与模块之间接口的复杂程度，比如在类内部尽可能减少方法之间的调用，否则一个方法的变动会影响调用它的另一个方法。</li></ul><p>操作组件 —&gt;功能点—–&gt;业务流程：</p><ol><li>封装各个模块的底层API,构建上下游mock和fake, 通过调用单一个模块进行 功能点的验证</li><li>通过模块组合实现对业务流程的验证。</li></ol><p>页面PO设计</p><ol><li>以每个页面为单独一个类,页面中的控件为属性，控件的操作作为方法</li><li>组合不同方法去完成用户操作</li></ol><h4 id="脚本分离设计"><a href="#脚本分离设计" class="headerlink" title="脚本分离设计"></a>脚本分离设计</h4><ul><li>封装基础函数、基本的业务逻辑、验证点</li><li>对象、操作、测试数据、业务逻辑相互剥离、灵活调用</li></ul><h4 id="结构化管理"><a href="#结构化管理" class="headerlink" title="结构化管理"></a>结构化管理</h4><ol><li>用例目录结构化和命名规范<ol><li>Project/Resource/Method/Request命名。</li><li>TestSuit/TestCase/TestStep命名，呈现特性树，方便通过每个特性的用例数和功能点</li></ol></li><li>信息一体化：基本信息的编写（比如用例场景、用例维护人员、自动化用例）和项目文档（业务API、需求需求文档、环境信息和常用命令）能在一个地方统一跳转过去</li><li>对象、操作组件、基础函数、测试数据 结构化</li><li>参数化<ol><li>环境参数化</li><li>脚本参数化</li></ol></li></ol><ul><li>用例<ul><li>功能特性1<ul><li>测试数据<ul><li>输入数据</li><li>验证结果</li></ul></li><li>测试脚本</li><li>相关资料文档 </li></ul></li><li>功能特性2</li></ul></li><li>公共库<ul><li>业务逻辑</li><li>第三方库</li><li>自定义库</li></ul></li><li>公共文档</li><li>环境变量</li></ul><h3 id="方案执行"><a href="#方案执行" class="headerlink" title="方案执行"></a>方案执行</h3><h4 id="有效的执行体系"><a href="#有效的执行体系" class="headerlink" title="有效的执行体系"></a>有效的执行体系</h4><ol><li>批量、定制执行、自动运行</li><li>异常处理机制（重试或者跳过）</li><li>业务数据还原初始状态</li><li>版本管理</li></ol><h4 id="结果体系"><a href="#结果体系" class="headerlink" title="结果体系"></a>结果体系</h4><ol><li>针以每条用例，输出用例执行结果</li><li>针对每个检查点，输出详细的检查点执行结果</li><li>输出执行日志</li></ol>]]></content>
      
      
        <tags>
            
            <tag> 自动化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>自动化测试（一）自动化测试的基本概念</title>
      <link href="/2017/10/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9501/"/>
      <url>/2017/10/15/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%9501/</url>
      <content type="html"><![CDATA[<p><strong>自动化测试</strong>：指通过<strong>自动化测试工具</strong>或者轮子模拟手工测试并验证其结果完成整个测试过程。本文章介绍自动化测试的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="为什么要进行自动化测试"><a href="#为什么要进行自动化测试" class="headerlink" title="为什么要进行自动化测试"></a>为什么要进行自动化测试</h3><ul><li>自动化测试节约人力和时间成本：版本迭代的回归测试</li><li>有些测试项目手工很难实现：例如性能测试</li><li>项目质量流程和持续集成的需要</li></ul><p><img src="/image/自动化测试01_001.png" alt=""></p><h3 id="自动化测试的优缺点"><a href="#自动化测试的优缺点" class="headerlink" title="自动化测试的优缺点"></a>自动化测试的优缺点</h3><ul><li>优点<ul><li>避免测试人员因重复劳动产生厌倦</li><li>提高测试效率</li><li>保证每次测试地一致性和可重复性</li><li>更好的利用无人值守时间</li><li>进行一些手工无法进行的测试</li></ul></li><li>缺点<ul><li>维护成本相对比较高</li><li>测试时间不一定能缩短</li><li>没有手工测试发现缺陷多</li><li>UI 层面显示问题不容易发现</li></ul></li></ul><h3 id="什么样的项目适合做自动化测试"><a href="#什么样的项目适合做自动化测试" class="headerlink" title="什么样的项目适合做自动化测试"></a>什么样的项目适合做自动化测试</h3><ol><li>功能变动少</li><li>周期长</li><li>项目测试资源足够</li></ol><h3 id="自动化测试"><a href="#自动化测试" class="headerlink" title="自动化测试"></a>自动化测试</h3><ul><li>掌握一门开发语言:<ul><li>与开发技术栈一致</li><li>推荐：java/python/go</li></ul></li><li>熟悉被测系统<ul><li>web测试 ：js+css+html</li><li>移动端测试：Android 和iOS开发基础</li><li>C/S测试：TCP、IP协议</li></ul></li><li>掌握一套自动化测试框架<ul><li>python<ul><li><strong>Robot Framework</strong>：关键字驱动测试（高级封装 类配置化）<ul><li>优点<ul><li>需要的基础低，易学易写</li><li>支持多重封装，可以使用python封装方法</li><li>拥有庞大的生态系统，丰富的第三方扩展库</li></ul></li><li>缺点<ul><li>用例庞大，用例管理加载时间很久</li><li>业务逻辑比较复杂和特殊，封装成本较大</li><li>控制语句只有if/for，不支持多层嵌套</li></ul></li><li>应用<ul><li>接口：HTTP library (livetest)、HTTP library (Requests)等。</li><li>web： SeleniumLibrary，Selenium2Library，Selenium2Library for Java、watir-robot 等。</li><li>Windows GUI：AutoItLibrary</li><li>移动端：Android library、iOS library、AppiumLibrary 等。</li><li>数据库测试：Database Library (Java)、Database Library (Python)、MongoDB library 等。</li><li>文件对比测试：Diff Library。</li><li>用例管理：wxPython、 RIDE</li><li>并发测试：pabot</li><li>分布式测试：selenium grid</li></ul></li></ul></li><li><strong>UnitTest</strong>：Python自带的一个单元测试框架<ul><li>优点<ul><li>开发人员不需要安装任何其他模块。</li><li>Unittest是xUnit的衍生产品，其工作原理与其他xUnit框架类似。 没有强大 Python背景的人也容易使用。<ul><li>您可以以更简单的方式运行单个测试用例。 您需要做的就是在终端上指定名称。 输出也很简洁，使得框架在执行测试用例时更加灵活。</li></ul></li><li>测试报告在几毫秒内生成。</li></ul></li><li>缺点<ul><li>通常，snake_case用于命名python代码。 但是由于这个框架受到Junit的启发，传统的camelCase命名方法仍然存在。 这可能很混乱。</li><li>要求一定的python基础  </li><li>需要较多的代码</li></ul></li><li>应用<ul><li>接口：requests</li><li>web：selenium</li><li>window GUI：pywinauto </li><li>window进程：win32api</li><li>移动端 GUI：appium</li><li>数据库:hbase（thrift hbase-thrift）、mysql（pymysql）、redis 、hive（sasl thrift  thrift-sasl pyhive）、implala</li></ul></li></ul></li><li><strong>Pytest</strong>：基于unittest的扩展框架，比unittest更简洁高效<ul><li>优点<ul><li>pytest可以直接运行unittest模式的测试用例 </li><li>能够支持简单的单元测试和复杂的功能测试，支持xfail</li><li>pytest具有很多第三方插件，并且可以自定义扩展</li></ul></li><li>缺点<ul><li>要求一定的python基础</li></ul></li><li>应用<ul><li>测试报告： pytest-html</li><li>web：pytest-selenium</li><li>失败用例重试： pytest-rerunfailures</li><li>多CPU分发：pytest-xdist</li></ul></li></ul></li><li><strong>Behave</strong>：与SpecFlow和Cucumber非常相似，常被用于执行自动化测试。<ul><li>优点<ul><li>系统行为由半正式语言和域词汇表表达，以保持组织中的行为一致。</li><li>正在协调处理具有类似功能的不同模块的开发团队。</li><li>构建块总是可以执行各种测试用例。</li><li>细节中有推理和思考，从而产生更好的产品规格。</li><li>由于规范的格式相似，利益相关者或管理者对QAs和Devs的输出有更好的清晰度。</li></ul></li><li>缺点<ul><li>只适用于黑盒测试。</li></ul></li></ul></li><li><strong>Lettuce</strong>：基于Cucumber和Python的行为驱动类自动化工具<ul><li>优点<ul><li>好吧，就像任何其他BDD测试框架一样，Lettuce使开发人员能够创建多个场景并用简单的自然语言描述这些功能。</li><li>Dev和QA团队得到了适当的协调，因为规格格式相似。</li><li>对于黑盒测试，Lettuce对于运行行为驱动的测试用例非常有用。</li></ul></li><li>缺点<ul><li>只适用于黑盒测试。</li></ul></li></ul></li></ul></li><li>java<ul><li>JUnit <ul><li>优点<ul><li>庞大的社区</li></ul></li><li>缺点<ul><li>无法执行依赖性测试</li></ul></li></ul></li><li>TestNG<ul><li>优点<ul><li>JUnit升级版</li></ul></li><li>缺点<ul><li>用户需要一些时间来设置TestNG</li></ul></li></ul></li><li>JBehave：一种通过Selenium WebDriver来针对BDD开展Java测试的框架。</li><li>Serenity：种能被用于行为驱动测试的开源库。该框架可帮助您编写出各种结构良好、且易于维护的验收标准。它在一定程度上扩展了JUnit和WebDriver的功能。</li><li>Selenide：由Selenium提供的Selenide，可用作为Java应用程序编写稳定、精确且具有友好UI的测试用例。</li></ul></li><li>go<ul><li><a href="http://goconvey.co/" target="_blank" rel="noopener">GoConvey</a></li><li><a href="http://labix.org/gocheck" target="_blank" rel="noopener">GoCheck</a></li><li><a href="https://github.com/golang/mock/" target="_blank" rel="noopener">GoMock</a></li><li><a href="https://github.com/agiledragon/gomonkey" target="_blank" rel="noopener">GoMonkey</a></li><li><a href="https://github.com/Selvatico/go-mocket" target="_blank" rel="noopener">GoMocket</a></li></ul></li></ul></li></ul>]]></content>
      
      
        <tags>
            
            <tag> 自动化 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署Prometheus</title>
      <link href="/2017/10/15/%E9%83%A8%E7%BD%B2Prometheus/"/>
      <url>/2017/10/15/%E9%83%A8%E7%BD%B2Prometheus/</url>
      <content type="html"><![CDATA[<p>Prometheus是一个开源的服务监控系统，它通过HTTP协议从远程的机器收集数据并存储在本地的时序数据库上。本文章介绍如何在Centos7.5下面部署一套监控系统（Prometheus+Node_Exporter+Grafana）。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="安装Prometheus"><a href="#安装Prometheus" class="headerlink" title="安装Prometheus"></a>安装Prometheus</h3><p><img src="/image/部署Prometheus_001.png" alt=""></p><ul><li><p>1.下载安装</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/prometheus/prometheus/releases/download/v2.7.1/prometheus-2.7.1.linux-amd64.tar.gz</span><br><span class="line">tar -C /usr/<span class="built_in">local</span>/ -zxvf prometheus-2.7.1.linux-amd64.tar.gz</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/prometheus-2.7.1.linux-amd64/</span><br></pre></td></tr></table></figure></li><li><p>2.设置用户</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加用户</span></span><br><span class="line">groupadd prometheus</span><br><span class="line">useradd -g prometheus -s /sbin/nologin prometheus</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋权限</span></span><br><span class="line">chown -R prometheus:prometheus /usr/<span class="built_in">local</span>/prometheus-2.7.1.linux-amd64/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建prometheus运行数据目录</span></span><br><span class="line">mkdir -p /var/lib/prometheus</span><br><span class="line">chown -R prometheus:prometheus /var/lib/prometheus/</span><br></pre></td></tr></table></figure></li><li><p>3.配置systemd成服务，用 systemd 来开机启动</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建配置文件</span></span><br><span class="line">touch /usr/lib/systemd/system/prometheus.service</span><br><span class="line">chown prometheus:prometheus /usr/lib/systemd/system/prometheus.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制下面内容到配置文件</span></span><br><span class="line">vim /usr/lib/systemd/system/prometheus.service</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Prometheus</span><br><span class="line">Documentation=https://prometheus.io/</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line"><span class="comment"># Type设置为notify时，服务会不断重启</span></span><br><span class="line">Type=simple</span><br><span class="line">User=prometheus</span><br><span class="line"><span class="comment"># --storage.tsdb.path是可选项，默认数据目录在运行目录的./dada目录中</span></span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/prometheus-2.7.1.linux-amd64/prometheus --config.file=/usr/<span class="built_in">local</span>/prometheus-2.7.1.linux-amd64/prometheus.yml --storage.tsdb.path=/var/lib/prometheus</span><br><span class="line">Restart=on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> prometheus</span><br><span class="line">systemctl start prometheus</span><br></pre></td></tr></table></figure></li><li><p>4.设置iptables</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增下面规则</span></span><br><span class="line">vim /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 规则</span></span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9090 -j ACCEPT</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启 iptables</span></span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></li><li><p>5.查看服务状态</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line">./prometheus --version</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看状态</span></span><br><span class="line">systemctl status prometheus</span><br></pre></td></tr></table></figure></li><li><p>6.使用浏览器访问http://&lt;service_ip:9090&gt;</p></li></ul><p><img src="/image/部署Prometheus_002.png" alt=""></p><h3 id="安装Node-Exporter"><a href="#安装Node-Exporter" class="headerlink" title="安装Node_Exporter"></a>安装Node_Exporter</h3><p>Prometheus Server并不直接服务监控特定的目标，其主要任务负责数据的收集，存储并且对外提供数据查询支持。因此需要在被监控主机上安装Exporter,Prometheus周期性的从Exporter暴露的HTTP服务地址（通常存放采样数据的地址是/metrics)）拉取监控样本数据。</p><ul><li><p>1.部署</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载</span></span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src/</span><br><span class="line">wget https://github.com/prometheus/node_exporter/releases/download/v0.17.0/node_exporter-0.17.0.linux-amd64.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 部署</span></span><br><span class="line">tar -zxvf node_exporter-0.17.0.linux-amd64.tar.gz -C /usr/<span class="built_in">local</span>/</span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/</span><br><span class="line">mv node_exporter-0.17.0.linux-amd64/ node_exporter/</span><br></pre></td></tr></table></figure></li><li><p>2.新增用户</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">groupadd prometheus</span><br><span class="line">useradd -g prometheus -s /sbin/nologin prometheus</span><br><span class="line">chown -R prometheus:prometheus /usr/<span class="built_in">local</span>/node_exporter/</span><br></pre></td></tr></table></figure></li><li><p>3.设置开机启动</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建配置文件，把下面配置复制进去</span></span><br><span class="line">vim /usr/lib/systemd/system/node_exporter.service</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=node_exporter</span><br><span class="line">Documentation=https://prometheus.io/</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">User=prometheus</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/node_exporter/node_exporter</span><br><span class="line">Restart=on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置开机启动</span></span><br><span class="line">systemctl <span class="built_in">enable</span> node_exporter</span><br><span class="line">systemctl start node_exporter</span><br></pre></td></tr></table></figure></li><li><p>4.设置iptables</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增下面规则</span></span><br><span class="line">vim /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 规则</span></span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 9100 -j ACCEPT</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启 iptables</span></span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></li><li><p>5.使用浏览器访问http://&lt;monitor_ip:9100&gt;</p></li></ul><p><img src="/image/部署Prometheus_003.png" alt=""></p><h3 id="配置Prometheus"><a href="#配置Prometheus" class="headerlink" title="配置Prometheus"></a>配置Prometheus</h3><ul><li><ol><li><p>修改配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增配置到配置文件</span></span><br><span class="line">vim /usr/<span class="built_in">local</span>/prometheus-2.7.1.linux-amd64/prometheus.yml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局配置</span></span><br><span class="line"><span class="attr">global:</span></span><br><span class="line"><span class="attr">  scrape_interval:</span>     <span class="number">15</span><span class="string">s</span> <span class="comment"># 设置抓取时间间隔为15s，默认是1m</span></span><br><span class="line"><span class="attr">  evaluation_interval:</span> <span class="number">15</span><span class="string">s</span> <span class="comment"># 设置rules评估时间间隔为15s，默认是1m</span></span><br><span class="line">  <span class="comment"># scrape_timeout is set to the global default (10s).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 告警管理配置</span></span><br><span class="line"><span class="attr">alerting:</span></span><br><span class="line"><span class="attr">  alertmanagers:</span></span><br><span class="line">  <span class="string">+</span> <span class="attr">static_configs:</span></span><br><span class="line">    <span class="string">+</span> <span class="attr">targets:</span></span><br><span class="line">      <span class="comment"># - alertmanager:9093</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载rules，并根据设置的时间间隔定期评估，暂未使用，默认配置</span></span><br><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="comment"># - "first_rules.yml"</span></span><br><span class="line">  <span class="comment"># - "second_rules.yml"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 抓取(pull)，即监控目标配置</span></span><br><span class="line"><span class="comment"># 默认只有主机本身的监控配置</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># 监控目标的label（这里的监控目标只是一个metric，而不是指某特定主机，可以在特定主机取多个监控目标），在抓取的每条时间序列表中都会添加此label</span></span><br><span class="line"><span class="attr">  - job_name:</span> <span class="string">'prometheus'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># metrics_path defaults to '/metrics'</span></span><br><span class="line">    <span class="comment"># scheme defaults to 'http'.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 新增：可覆盖全局配置设置的抓取间隔，由15秒重写成5秒。</span></span><br><span class="line"><span class="attr">    scrape_interval:</span> <span class="number">5</span><span class="string">s</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 静态指定监控目标，暂不涉及使用一些服务发现机制发现目标</span></span><br><span class="line"><span class="attr">    static_configs:</span></span><br><span class="line"><span class="attr">    - targets:</span> <span class="string">['localhost:9090']</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 以下都为新增：(opentional)再添加一个label，标识了监控目标的主机</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">              instance:</span> <span class="string">prometheus</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">  - job_name:</span> <span class="string">'linux'</span></span><br><span class="line"><span class="attr">    scrape_interval:</span> <span class="number">10</span><span class="string">s</span></span><br><span class="line"></span><br><span class="line"><span class="attr">    static_configs:</span></span><br><span class="line">    <span class="comment"># 采用node_exporter默认开放的端口</span></span><br><span class="line"><span class="attr">    - targets:</span> <span class="string">['10.1.2.3:9100']</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">              instance:</span> <span class="string">node1</span></span><br></pre></td></tr></table></figure></li></ol></li><li><p>2.重启服务</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl  start prometheus</span><br></pre></td></tr></table></figure></li><li><p>3.使用浏览器访问http://&lt;monitor_ip:9100&gt;,点击status的targets</p><p>  <img src="/image/部署Prometheus_004.png" alt=""><br>  <img src="/image/部署Prometheus_005.png" alt=""></p></li></ul><h3 id="部署Grafana"><a href="#部署Grafana" class="headerlink" title="部署Grafana"></a>部署Grafana</h3><p>为了监控数据展示更好看,我们安装Grafana.它是用于可视化大型测量数据的开源程序，能Dashboard中显示了你不同metric数据源中的数据。</p><ul><li><p>1.部署</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src/</span><br><span class="line">wget https://dl.grafana.com/oss/release/grafana-6.0.0-1.x86_64.rpm </span><br><span class="line">sudo yum localinstall grafana-6.0.0-1.x86_64.rpm</span><br></pre></td></tr></table></figure></li><li><p>2.配置文件<br>  配置文件位于/etc/grafana/grafana.ini，这里暂时保持默认配置即可。</p></li><li><p>3.设置开机启动</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> grafana-server</span><br><span class="line">systemctl start grafana-server</span><br></pre></td></tr></table></figure></li><li><p>4.设置iptables</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增下面规则</span></span><br><span class="line">vim /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 规则</span></span><br><span class="line">-A INPUT -p tcp -m state --state NEW -m tcp --dport 3000 -j ACCEPT</span><br></pre></td></tr></table></figure>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重启 iptables</span></span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></li><li><p>5.添加数据源</p><ul><li><p>使用浏览器访问http://&lt;server_ip&gt;:3000，默认账号/密码：admin/admin</p><p>  <img src="/image/部署Prometheus_006.png" alt=""></p></li><li><p>在登陆首页，点击”Add data source”按钮，选择Prometheus,</p><p>  <img src="/image/部署Prometheus_007.png" alt=""><br>  <img src="/image/部署Prometheus_008.png" alt=""></p></li><li><p>取消Default的勾选,URL选择一下默认配置,其他不变,然后点击Save&amp;Test</p><p>  <img src="/image/部署Prometheus_009.png" alt=""><br>  <img src="/image/部署Prometheus_010.png" alt=""></p></li><li><p>在”Dashboards”页签下”import”自带的模版</p><p>  <img src="/image/部署Prometheus_011.png" alt=""></p></li></ul></li><li><p>6.下载模板导入dashboard(可选)</p><ul><li><p>选择左上角图标+–&gt;import</p><p>  <img src="/image/部署Prometheus_012.png" alt=""></p></li><li><p>填写url或者id,例如<a href="https://grafana.com/dashboards/405,点击Upload会自动下载模板" target="_blank" rel="noopener">https://grafana.com/dashboards/405,点击Upload会自动下载模板</a></p><p>  <img src="/image/部署Prometheus_013.png" alt=""></p></li><li><p>数据源选择”prometheus”，即添加的数据源name，点击”Import”按钮</p><p>  <img src="/image/部署Prometheus_014.png" alt=""></p></li></ul></li><li><p>7.查看dashboard</p><ul><li><p>选择Dashboard–&gt;Home</p><p>  <img src="/image/部署Prometheus_015.png" alt=""></p></li><li><p>列表中可见有已添加的两个dashboard，选择1个即可，如下：</p><p>  <img src="/image/部署Prometheus_016.png" alt=""><br>  <img src="/image/部署Prometheus_017.png" alt=""></p></li></ul></li></ul><p>More info: <a href="https://github.com/grafana/grafana" target="_blank" rel="noopener">Grafana Github</a>  <a href="https://github.com/prometheus" target="_blank" rel="noopener">Prometheus Github</a></p>]]></content>
      
      
        <tags>
            
            <tag> 监控 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux系统监控工具</title>
      <link href="/2017/09/15/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/"/>
      <url>/2017/09/15/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<p>多数 Linux 发行版都附带了监控工具。这些工具提供了获取系统活动的相关指标,可以用来查找问题的可能原因。文章介绍使用监控工具的基本命令。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h3><h4 id="Top-–-进程活动监控命令"><a href="#Top-–-进程活动监控命令" class="headerlink" title="Top – 进程活动监控命令"></a>Top – 进程活动监控命令</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top [参数]</span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>显示当前系统正在执行的进程的相关信息，包括进程ID、内存占用率、CPU占用率等</p></li><li><p>3.命令参数：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-b 批处理</span><br><span class="line">-c 显示完整的治命令</span><br><span class="line">-I 忽略失效过程</span><br><span class="line">-s 保密模式</span><br><span class="line">-S 累积模式</span><br><span class="line">-i&lt;时间&gt; 设置间隔时间</span><br><span class="line">-u&lt;用户名&gt; 指定用户名</span><br><span class="line">-p&lt;进程号&gt; 指定进程</span><br><span class="line">-n&lt;次数&gt; 循环显示的次数</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li><p>显示进程信息:top</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">top - 10:47:44 up 91 days, 20:45,  1 user,  load average: 0.08, 0.04, 0.05</span><br><span class="line">Tasks:  85 total,   1 running,  84 sleeping,   0 stopped,   0 zombie</span><br><span class="line">%Cpu(s):  1.3 us,  2.0 sy,  0.0 ni, 62.0 id, 34.7 wa,  0.0 hi,  0.0 si,  0.0 st</span><br><span class="line">KiB Mem :  1882892 total,    70220 free,   228056 used,  1584616 buff/cache</span><br><span class="line">KiB Swap:  1049596 total,   908028 free,   141568 used.  1419140 avail Mem </span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S %MEM     TIME+ COMMAND                                                                                            </span><br><span class="line">   27 root      20   0       0      0      0 S  0.0   3:12.62 kswapd0                                                                                            </span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计信息区:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一行:任务队列信息</span></span><br><span class="line"><span class="comment"># 10:47:44 — 当前系统时间</span></span><br><span class="line"><span class="comment"># up 91 days, 20:45 — 系统持续运行多久</span></span><br><span class="line"><span class="comment"># 1 user — 当前有2个用户登录系统</span></span><br><span class="line"><span class="comment"># load average: 0.08, 0.04, 0.05 — 每隔5秒钟检查一次活跃的进程数,后面的三个数分别是1分钟、5分钟、15分钟的负载情况。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二行:Tasks — 任务（进程）</span></span><br><span class="line"><span class="comment"># 85 total - 系统现有进程</span></span><br><span class="line"><span class="comment"># 1 running - 处于运行中的进程数</span></span><br><span class="line"><span class="comment"># 84 sleeping - 处于休眠的进程数</span></span><br><span class="line"><span class="comment"># 0 stopped - 处于停止的进程数</span></span><br><span class="line"><span class="comment"># 0 zombie - 处于僵尸的进程数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三行:cpu状态信息</span></span><br><span class="line"><span class="comment"># 1.3 us — 用户空间占用CPU的百分比</span></span><br><span class="line"><span class="comment"># 2.0 sy — 内核空间占用CPU的百分比</span></span><br><span class="line"><span class="comment"># 0.0 ni — 改变过优先级的进程占用CPU的百分比</span></span><br><span class="line"><span class="comment"># 62.0 id — 空闲CPU百分比</span></span><br><span class="line"><span class="comment"># 34.7 wa — IO等待占用CPU的百分比</span></span><br><span class="line"><span class="comment"># 0.0 hi — 硬中断（Hardware IRQ）占用CPU的百分比</span></span><br><span class="line"><span class="comment"># 0.0 si — 软中断（Software Interrupts）占用CPU的百分比</span></span><br><span class="line"><span class="comment"># 0.0 st — 虚拟机占用百分比</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第四行:内存状态</span></span><br><span class="line"><span class="comment"># 1882892 total — 物理内存总量</span></span><br><span class="line"><span class="comment"># 70220 free — 使用中的内存总量</span></span><br><span class="line"><span class="comment"># 228056 used — 空闲内存总量</span></span><br><span class="line"><span class="comment"># 1584616 buff/cache — 缓存的内存量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第五行:swap交换分区信息</span></span><br><span class="line"><span class="comment"># 1049596 total — 交换区总量</span></span><br><span class="line"><span class="comment"># 908028 free — 空闲交换区总量</span></span><br><span class="line"><span class="comment"># 141568 used — 使用的交换区总量</span></span><br><span class="line"><span class="comment"># 1419140 avail Mem — 可用于进程下一次分配的物理内存数量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第六行:空行</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第七行以下:各进程（任务）的状态监控</span></span><br><span class="line"><span class="comment"># PID — 进程id</span></span><br><span class="line"><span class="comment"># USER — 进程所有者</span></span><br><span class="line"><span class="comment"># PR — 进程优先级</span></span><br><span class="line"><span class="comment"># NI — nice值。负值表示高优先级，正值表示低优先级</span></span><br><span class="line"><span class="comment"># VIRT — 进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES</span></span><br><span class="line"><span class="comment"># RES — 进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA</span></span><br><span class="line"><span class="comment"># SHR — 共享内存大小，单位kb</span></span><br><span class="line"><span class="comment"># S — 进程状态。D=不可中断的睡眠状态 R=运行 S=睡眠 T=跟踪/停止 Z=僵尸进程</span></span><br><span class="line"><span class="comment"># %CPU — 上次更新到现在的CPU时间占用百分比</span></span><br><span class="line"><span class="comment"># %MEM — 进程使用的物理内存百分比</span></span><br><span class="line"><span class="comment"># TIME+ — 进程使用的CPU时间总计，单位1/100秒</span></span><br><span class="line"><span class="comment"># COMMAND — 进程名称（命令名/命令行）</span></span><br></pre></td></tr></table></figure></li><li><p>显示完整命令:top -c</p></li><li>以批处理模式显示程序信息:top -b</li><li>以累积模式显示程序信息:top -S</li><li>设置信息更新次数:top -n &lt;更新次数&gt;</li><li>设置信息更新时间:top -d &lt;间隔时间s&gt;</li><li>显示指定的进程信息:top -p <pid></pid></li><li>显示指定的进程信息:top -p <pid></pid></li><li>显示指定的进程信息:top -p <pid></pid></li></ul></li><li><p>5.使用技巧</p><ul><li>多U多核CPU监控：在top基本视图中，按键盘数字“1”，可监控每个逻辑CPU的状况</li><li>高亮显示当前运行进程：敲击键盘“b”（打开/关闭加亮效果）</li><li>进程字段排序： 敲击键盘“x”（打开/关闭排序列的加亮效果）</li><li>通过”shift + &gt;”或”shift + &lt;”可以向右或左改变排序列</li></ul></li><li><p>6.交互命令<br>在top 命令执行过程中可以使用的一些交互命令。这些命令都是单字母的，如果在命令行中使用了s 选项，其中一些命令可能会被屏蔽。</p></li></ul><table><thead><tr><th>交互命令</th><th>用法</th></tr></thead><tbody><tr><td>m</td><td>是否显示内存信息</td></tr><tr><td>A</td><td>根据各种系统资源的利用率对进程进行排序，有助于快速识别系统中性能不佳的任务。</td></tr><tr><td>f或者F</td><td>进入 top 的交互式配置屏幕，用于根据特定的需求而设置 top 的显示。</td></tr><tr><td>o或者O</td><td>交互式地调整 top 每一列的顺序。</td></tr><tr><td>z</td><td>切换彩色或黑白模式</td></tr><tr><td>h</td><td>显示帮助画面，给出一些简短的命令总结说明</td></tr><tr><td>k</td><td>终止一个进程。</td></tr><tr><td>i</td><td>忽略闲置和僵死进程。这是一个开关式命令。</td></tr><tr><td>q</td><td>退出程序</td></tr><tr><td>r</td><td>重新安排一个进程的优先级别</td></tr><tr><td>S</td><td>切换到累计模式</td></tr><tr><td>s</td><td>改变两次刷新之间的延迟时间（单位为s），如果有小数，就换算成m s。输入0值则系统将不断刷新，默认值是5 s</td></tr><tr><td>l</td><td>切换显示平均负载和启动时间信息</td></tr><tr><td>t</td><td>切换显示进程和CPU状态信息</td></tr><tr><td>c</td><td>切换显示命令名称和完整命令行</td></tr><tr><td>M</td><td>根据驻留内存大小进行排序</td></tr><tr><td>P</td><td>根据CPU使用百分比大小进行排序</td></tr><tr><td>T</td><td>根据时间/累计时间进行排序</td></tr><tr><td>W</td><td>将当前设置写入~/.toprc文件中</td></tr></tbody></table><h4 id="VmStat-虚拟内存统计"><a href="#VmStat-虚拟内存统计" class="headerlink" title="VmStat - 虚拟内存统计"></a>VmStat - 虚拟内存统计</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vmstat [-a] [-n] [-t] [-S unit] [delay [ count]]</span><br><span class="line">vmstat [-s] [-n] [-S unit]</span><br><span class="line">vmstat [-m] [-n] [delay [ count]]</span><br><span class="line">vmstat [-d] [-n] [delay [ count]]</span><br><span class="line">vmstat [-p disk partition] [-n] [delay [ count]]</span><br><span class="line">vmstat [-f]</span><br><span class="line">vmstat [-V]</span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>用来获得有关进程、虚存、页面交换空间及 CPU活动的信息。</p></li><li><p>3.命令参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-a：显示活跃和非活跃内存</span><br><span class="line">-f：显示从系统启动至今的fork数量 。</span><br><span class="line">-m：显示slabinfo</span><br><span class="line">-n：只在开始时显示一次各字段名称。</span><br><span class="line">-s：显示内存相关统计信息及多种系统活动数量。</span><br><span class="line">delay：刷新时间间隔。如果不指定，只显示一条结果。</span><br><span class="line">count：刷新次数。如果不指定刷新次数，但指定了刷新时间间隔，这时刷新次数为无穷。</span><br><span class="line">-d：显示磁盘相关统计信息。</span><br><span class="line">-p：显示指定磁盘分区统计信息</span><br><span class="line">-S：使用指定单位显示。参数有 k 、K 、m 、M ，分别代表1000、1024、1000000、1048576字节（byte）。默认单位为K（1024 bytes）</span><br><span class="line">-V：显示vmstat版本信息。</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li>参数说明：vmstat  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line">r  b   swpd   free   buff  cache   si   so    bi    bo   <span class="keyword">in</span>   cs us sy id wa st</span><br><span class="line">2  0 141824  75964 112312 1470536    0    0    62    22    3    2  0  0 99  0  0</span><br></pre></td></tr></table></figure></li></ul></li></ul><table><thead><tr><th>Procs（进程）参数</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>r</td><td>等待执行的任务数</td><td>展示了正在执行和等待cpu资源的任务个数。当这个值超过了cpu个数，就会出现cpu瓶颈。</td></tr><tr><td>b</td><td>等待IO的进程数量</td></tr></tbody></table><table><thead><tr><th>Memory(内存)参数</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>swpd</td><td>正在使用虚拟的内存大小，单位k</td><td></td></tr><tr><td>free</td><td>空闲内存大小</td></tr><tr><td>buff</td><td>已用的buff大小，对块设备的读写进行缓冲</td></tr><tr><td>cache</td><td>已用的cache大小，文件系统的cache</td></tr><tr><td>inact</td><td>非活跃内存大小，即被标明可回收的内存，区别于free和active</td></tr><tr><td>active</td><td>活跃的内存大小</td></tr></tbody></table><table><thead><tr><th>Swap参数</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>si</td><td>每秒从交换区写入内存的大小（单位：kb/s）</td></tr><tr><td>so</td><td>每秒从内存写到交换区的大小</td></tr></tbody></table><table><thead><tr><th>IO参数</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>bi</td><td>每秒读取的块数（读磁盘）</td></tr><tr><td>bo</td><td>每秒写入的块数（写磁盘）</td></tr></tbody></table><table><thead><tr><th>system参数</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>in</td><td>每秒中断数，包括时钟中断</td><td>值越大，会看到由内核消耗的cpu时间会越多</td></tr><tr><td>cs</td><td>每秒上下文切换数</td><td>这两个值越大，会看到由内核消耗的cpu时间会越多</td></tr></tbody></table><table><thead><tr><th>CPU（以百分比表示）参数</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>Us</td><td>用户进程执行消耗cpu时间(user time)</td><td>us的值比较高时，说明用户进程消耗的cpu时间多，但是如果长期超过50%的使用，那么我们就该考虑优化程序算法或其他措施了</td></tr><tr><td>Sy</td><td>系统进程消耗cpu时间(system time)</td><td>sys的值过高时，说明系统内核消耗的cpu资源多，这个不是良性的表现，我们应该检查原因。</td></tr><tr><td>Id</td><td>空闲时间(包括IO等待时间)</td></tr><tr><td>wa</td><td>等待IO时间</td><td>Wa过高时，说明io等待比较严重，这可能是由于磁盘大量随机访问造成的，也有可能是磁盘的带宽出现瓶颈。</td></tr></tbody></table><ul><li>显示活跃和非活跃内存：vmstat –a</li><li>查看内存使用的详细信息：vmstat -s</li><li>查看磁盘的读/写：vmstat -d</li></ul><h4 id="Lsof-列出打开的文件"><a href="#Lsof-列出打开的文件" class="headerlink" title="Lsof - 列出打开的文件"></a>Lsof - 列出打开的文件</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof [选项] [绝对路径的文件名]</span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>用于以列表的形式显示所有打开的文件和进程。打开的文件包括磁盘文件、网络套接字、管道、设备和进程</p></li><li><p>3.命令参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-a  将结果进行“与”运算（而不是“或”运算）</span><br><span class="line">-l  在输出显示用户 id 而不是用户名</span><br><span class="line">-t  仅获取进程ID</span><br><span class="line">-i  显示所有连接 </span><br><span class="line">-h  获取lsof使用帮助</span><br><span class="line">-u  显示指定用户打开了什么 </span><br><span class="line">-U  获取 UNIX 套接口地址</span><br><span class="line">-p  查看指定进程ID已打开的内容</span><br><span class="line">-F  格式化输出结果，用于其他命令。可以通过多种方式格式化，如-F pcfn（用户进程ID、命令名、文件描述符、文件名，并以空终止）</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li><p>列出活跃进程的所有打开文件:lsof</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">COMMAND  PID   USER  FD   TYPE DEVICE SIZE/OFF   NODE NAME</span><br><span class="line">httpd   6279   root txt    REG    8,2   344112 415135 /usr/sbin/httpd</span><br><span class="line"></span><br><span class="line"><span class="comment"># COMMAND - 进程名称</span></span><br><span class="line"><span class="comment"># PID - 进程标识符</span></span><br><span class="line"><span class="comment"># USER: - 进程所有者</span></span><br><span class="line"><span class="comment"># FD - 文件描述符，应用程序通过文件描述符识别到该文件。如cwd、txt等</span></span><br><span class="line"><span class="comment"># TYPE - 文件类型，REG、DIR、CHR、BLK、UNIX、FIFO、IPV4</span></span><br><span class="line"><span class="comment"># DEVICE: - 指定磁盘名称</span></span><br><span class="line"><span class="comment"># SIZE - 文件大小</span></span><br><span class="line"><span class="comment"># NODE - 索引节点（文件在磁盘上的标识）</span></span><br><span class="line"><span class="comment"># NAME - 打开文件的确切名称</span></span><br></pre></td></tr></table></figure></li><li><p>获取网络信息:</p><ul><li>显示所有连接:lsof -i</li><li>仅获取 IPv6 流量:lsof -i 6</li><li>仅显示TCP连接:lsof -iTCP</li><li>显示指定到指定主机的连接:lsof -i@&lt;host_ip&gt;</li><li>显示基于主机与端口的连接:lsof -i@&lt;host_ip:port&gt;</li><li>找出监听端口:lsof -i -sTCP:LISTEN</li><li>找出已建立的连接:lsof -i -sTCP:ESTABLISHED</li><li>显示某个端口范围的打开的连接:lsof -i@<host>:<port1>=<port2></port2></port1></host></li></ul></li><li><p>获取用户信息</p><ul><li>显示指定用户打开了什么：lsof -u <username></username></li><li>显示除指定用户以外的其他所有用户所做的事情:lsof -u ^<username></username></li><li>杀死指定用户所做的一切事情:kill -9 ‘lsof -t -u <username>‘</username></li><li>查看指定的命令正在使用的文件和网络连接:lsof -c <yourcommand></yourcommand></li><li>查看指定进程ID已打开的内容:lsof -p <pid></pid></li></ul></li></ul></li></ul><h4 id="Tcpdump-网络分组分析器"><a href="#Tcpdump-网络分组分析器" class="headerlink" title="Tcpdump - 网络分组分析器"></a>Tcpdump - 网络分组分析器</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">　　tcpdump [ -adeflnNOpqStvx ] [ -c 数量 ] [ -F 文件名 ]</span><br><span class="line">　　　　　　　　[ -i 网络接口 ] [ -r 文件名] [ -s snaplen ]　　</span><br><span class="line">　　　　　　　　[ -T 类型 ] [ -w 文件名 ] [表达式 ]</span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>最广泛使用的网络包分析器或者包监控程序之一，它用于捕捉或者过滤网络上指定接口上接收或者传输的TCP/IP包。它还有一个选项用于把捕捉到的包保存到文件里，以便以后进行分析。</p></li><li><p>3.命令参数：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">-A 以ASCII格式打印出所有分组，并将链路层的头最小化。 </span><br><span class="line">-c 在收到指定的数量的分组后，tcpdump就会停止。 </span><br><span class="line">-C 在将一个原始分组写入文件之前，检查文件当前的大小是否超过了参数file_size 中指定的大小。如果超过了指定大小，则关闭当前文件，然后在打开一个新的文件。参数 file_size 的单位是兆字节（是1,000,000字节，而不是1,048,576字节）。 </span><br><span class="line">-d 将匹配信息包的代码以人们能够理解的汇编格式给出。 </span><br><span class="line">-dd 将匹配信息包的代码以C语言程序段的格式给出。 </span><br><span class="line">-ddd 将匹配信息包的代码以十进制的形式给出。 </span><br><span class="line">-D 打印出系统中所有可以用tcpdump截包的网络接口。 </span><br><span class="line">-e 在输出行打印出数据链路层的头部信息。 </span><br><span class="line">-E 用spi@ipaddr algo:secret解密那些以addr作为地址，并且包含了安全参数索引值spi的IPsec ESP分组。 </span><br><span class="line">-f 将外部的Internet地址以数字的形式打印出来。 </span><br><span class="line">-F 从指定的文件中读取表达式，忽略命令行中给出的表达式。 </span><br><span class="line">-i 指定监听的网络接口。 </span><br><span class="line">-l 使标准输出变为缓冲行形式，可以把数据导出到文件。 </span><br><span class="line">-L 列出网络接口的已知数据链路。 </span><br><span class="line">-m 从文件module中导入SMI MIB模块定义。该参数可以被使用多次，以导入多个MIB模块。 </span><br><span class="line">-M 如果tcp报文中存在TCP-MD5选项，则需要用secret作为共享的验证码用于验证TCP-MD5选选项摘要（详情可参考RFC 2385）。 </span><br><span class="line">-b 在数据-链路层上选择协议，包括ip、arp、rarp、ipx都是这一层的。 </span><br><span class="line">-n 不把网络地址转换成名字。 </span><br><span class="line">-nn 不进行端口名称的转换。 </span><br><span class="line">-N 不输出主机名中的域名部分。例如，‘nic.ddn.mil‘只输出’nic‘。 </span><br><span class="line">-t 在输出的每一行不打印时间戳。 </span><br><span class="line">-O 不运行分组分组匹配（packet-matching）代码优化程序。 </span><br><span class="line">-P 不将网络接口设置成混杂模式。 </span><br><span class="line">-q 快速输出。只输出较少的协议信息。 </span><br><span class="line">-r 从指定的文件中读取包(这些包一般通过-w选项产生)。 </span><br><span class="line">-S 将tcp的序列号以绝对值形式输出，而不是相对值。 </span><br><span class="line">-s 从每个分组中读取最开始的snaplen个字节，而不是默认的68个字节。 </span><br><span class="line">-T 将监听到的包直接解释为指定的类型的报文，常见的类型有rpc远程过程调用）和snmp（简单网络管理协议；）。 </span><br><span class="line">-t 不在每一行中输出时间戳。 </span><br><span class="line">-tt 在每一行中输出非格式化的时间戳。 </span><br><span class="line">-ttt 输出本行和前面一行之间的时间差。 </span><br><span class="line">-tttt 在每一行中输出由date处理的默认格式的时间戳。 </span><br><span class="line">-u 输出未解码的NFS句柄。 </span><br><span class="line">-v 输出一个稍微详细的信息，例如在ip包中可以包括ttl和服务类型的信息。 </span><br><span class="line">-vv 输出详细的报文信息。 </span><br><span class="line">-w 直接将分组写入文件中，而不是不分析并打印出来。</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li>监视第一个网络接口上所有流过的数据包:tcpdump</li><li>监视指定主机的数据包:tcpdump host &lt;host_ip&gt;</li><li>监视指定网络接口的数据包:tcpdump -i &lt;网卡&gt;</li><li>监视主机hostname发送的所有数据:tcpdump -i &lt;网卡&gt; src host <hostname></hostname></li><li>监视指定主机和端口的数据包:tcpdump port <port> and host &lt;host_ip&gt;</port></li></ul></li></ul><h4 id="Netstat-网络统计"><a href="#Netstat-网络统计" class="headerlink" title="Netstat - 网络统计"></a>Netstat - 网络统计</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat [参数]</span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>用于监视传入和传出网络数据包统计信息以及接口统计信息。</p></li><li><p>3.命令参数：</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-a (all)显示所有选项，netstat默认不显示LISTEN相关</span><br><span class="line">-t (tcp)仅显示tcp相关选项</span><br><span class="line">-u (udp)仅显示udp相关选项</span><br><span class="line">-n 拒绝显示别名，能显示数字的全部转化成数字。(重要)</span><br><span class="line">-l 仅列出有在 Listen (监听) 的服務状态</span><br><span class="line"></span><br><span class="line">-p 显示建立相关链接的程序名(macOS中表示协议 -p protocol)</span><br><span class="line">-r 显示路由信息，路由表</span><br><span class="line">-e 显示扩展信息，例如uid等</span><br><span class="line">-s 按各个协议进行统计 (重要)</span><br><span class="line">-c 每隔一个固定时间，执行该netstat命令。</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li>netstat<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Active Internet connections (w/o servers)</span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State      </span><br><span class="line">tcp        0      0 VM_0_4_centos:51354     169.254.0.55:lsi-bobcat ESTABLISHED</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一行 </span></span><br><span class="line"><span class="comment"># Ative Internet connections - 有源TCP连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二行 </span></span><br><span class="line"><span class="comment"># Proto - 协议</span></span><br><span class="line"><span class="comment"># Recv-Q - 接收队列</span></span><br><span class="line"><span class="comment"># Send-Q - 发送队列</span></span><br><span class="line"><span class="comment"># Local Address - 本机的地址与端口</span></span><br><span class="line"><span class="comment"># Foreign Address - 外部的地址与端口</span></span><br><span class="line"><span class="comment"># State - 套接口当前的状态：LISTENING，ESTABLISHED，TIME_WAIT</span></span><br><span class="line"></span><br><span class="line">Active UNIX domain sockets (w/o servers)</span><br><span class="line">Proto RefCnt Flags       Type       State         I-Node   Path</span><br><span class="line">unix  3      [ ]         STREAM     CONNECTED     12869199 /usr/<span class="built_in">local</span>/yd.socket.client</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一行</span></span><br><span class="line"><span class="comment"># Active UNIX domain sockets - 有源Unix域套接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二行</span></span><br><span class="line"><span class="comment"># Proto - 显示连接使用的协议</span></span><br><span class="line"><span class="comment"># RefCnt - 表示连接到本套接口上的进程数量</span></span><br><span class="line"><span class="comment"># Types - 套接口的类型</span></span><br><span class="line"><span class="comment"># State - 套接口当前的状态</span></span><br><span class="line"><span class="comment"># I-Node - 索引节点</span></span><br><span class="line"><span class="comment"># Path - 连接到套接口的其它进程使用的路径名</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><ul><li><p>列出所有端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">列出所有端口:     netstat -a</span><br><span class="line">列出所有tcp端口:  netstat -at</span><br><span class="line">列出所有udp端口:  netstat -au</span><br></pre></td></tr></table></figure></li><li><p>列出所有处于监听状态的 Sockets</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">只显示监听端口:          netstat -l</span><br><span class="line">只列出所有监听tcp端口:   netstat -lt</span><br><span class="line">只列出所有监听udp端口:   netstat -lu</span><br><span class="line">只列出所有监听UNIX端口:  netstat -lx</span><br></pre></td></tr></table></figure></li><li><p>显示每个协议的统计信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">显示所有端口的统计信息     netstat -s</span><br><span class="line">显示TCP或UDP端口的统计信息 netstat -st 或 -su</span><br></pre></td></tr></table></figure></li><li><p>显示 PID 和进程名称:netstat -p</p></li><li>不显示主机，端口和用户名:netstat -an</li><li>持续输出 netstat 信息：netstat -t -c 2</li><li>显示核心路由信息：netstat -rn</li><li>找出程序运行的端口：netstat -apn</li><li>显示网络接口列表：netstat -ie</li></ul><h3 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h3><h4 id="Htop-Linux进程监控"><a href="#Htop-Linux进程监控" class="headerlink" title="Htop - Linux进程监控"></a>Htop - Linux进程监控</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">htop [参数]</span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>强化版本的top</p></li><li><p>3.命令参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-s 选项 : 按指定的列排序</span><br><span class="line">-u 选项 : 显示指定的用户的进程信息列表。</span><br><span class="line">-d 选项 : 设置刷新的延迟时间。例如 htop -d 100 命令会使输出在1秒后才会刷新（参数 -d 的单位是10微秒）。</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li><p>显示进程信息：htop</p><p><img src="/image/Linux系统监控工具_001.png" alt=""> </p></li><li><p>按 PID 列的大小排序来显示:htop -s <pid></pid></p></li><li>显示指定的用户的进程信息列表:htop -u &lt;user_name&gt;</li></ul></li><li><p>5.交互命令</p></li></ul><table><thead><tr><th>交互命令</th><th>交互命令</th><th>作用</th></tr></thead><tbody><tr><td>h, ?</td><td>F1</td><td>查看htop使用说明</td></tr><tr><td>S</td><td>F2</td><td>htop 设定</td></tr><tr><td>/</td><td>F3</td><td>搜索进程</td></tr><tr><td>\</td><td>F4</td><td>增量进程过滤器</td></tr><tr><td>t</td><td>F5</td><td>显示树形结构</td></tr><tr><td>&lt;, &gt;</td><td>F6</td><td>选择排序方式</td></tr><tr><td>[</td><td>F7</td><td>可减少nice值可以提高对应进程的优先级</td></tr><tr><td>]</td><td>F8</td><td>可增加nice值，降低对应进程的优先级</td></tr><tr><td>k</td><td>F9</td><td>可对进程传递信号</td></tr><tr><td>q</td><td>F10</td><td>结束htop</td></tr><tr><td>u</td><td>只显示一个给定的用户的过程   </td></tr><tr><td>U</td><td>取消标记所有的进程   </td></tr><tr><td>H</td><td>显示或隐藏用户线程   </td></tr><tr><td>K</td><td>显示或隐藏内核线程   </td></tr><tr><td>F</td><td>跟踪进程    </td></tr><tr><td>P</td><td>按CPU 使用排序   </td></tr><tr><td>M</td><td>按内存使用排序   </td></tr><tr><td>T</td><td>按Time+ 使用排序   </td></tr><tr><td>l</td><td>显示进程打开的文件   </td></tr><tr><td>I</td><td>倒转排序顺序    </td></tr><tr><td>s</td><td>选择某进程，按s:用strace追踪进程的系统调用   </td></tr></tbody></table><h4 id="Sar-系统活动情况报告"><a href="#Sar-系统活动情况报告" class="headerlink" title="Sar - 系统活动情况报告"></a>Sar - 系统活动情况报告</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sar [options] [-A] [-o file] t [n]</span><br><span class="line"></span><br><span class="line"><span class="comment"># t为采样间隔，n为采样次数，默认值是1；</span></span><br><span class="line"><span class="comment"># -o file表示将命令结果以二进制格式存放在文件中，file 是文件名。</span></span><br></pre></td></tr></table></figure></li><li><p>2.命令功能：<br>可以从多方面对系统的活动进行报告，包括：文件的读写情况、 系统调用的使用情况、磁盘I/O、CPU效率、内存使用状况、进程活动及IPC有关的活动等。本文主要以CentOS 6.3 x64系统为例，介绍sar命令</p></li><li><p>3.命令参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-A - 所有报告的总和</span><br><span class="line">-u - 输出CPU使用情况的统计信息</span><br><span class="line">-v - 输出inode、文件和其他内核表的统计信息</span><br><span class="line">-d - 输出每一个块设备的活动信息</span><br><span class="line">-r - 输出内存和交换空间的统计信息</span><br><span class="line">-b - 显示I/O和传送速率的统计信息</span><br><span class="line">-a - 文件读写情况</span><br><span class="line">-c - 输出进程统计信息，每秒创建的进程数</span><br><span class="line">-R - 输出内存页面的统计信息</span><br><span class="line">-y - 终端设备活动情况</span><br><span class="line">-w - 输出系统交换活动信息</span><br></pre></td></tr></table></figure></li><li><p>4.实例</p><ul><li>查看内存使用情况：sar -r</li><li>查看内存页面交换发生状况：sar -W</li><li>查看带宽信息：sar -n DEV</li></ul></li></ul><h4 id="IPTraf-实时IP局域网监控"><a href="#IPTraf-实时IP局域网监控" class="headerlink" title="IPTraf - 实时IP局域网监控"></a>IPTraf - 实时IP局域网监控</h4><ul><li><p>1.命令格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptraf-ng [options]</span><br></pre></td></tr></table></figure><p><img src="/image/Linux系统监控工具_002.png" alt=""></p></li><li><p>2.命令功能：<br>收集TCP，UDP，IP，ICMP，非IP，IP校验和错误，接口活动等通用和详细的接口统计信息。</p></li></ul>]]></content>
      
      
        <tags>
            
            <tag> 监控 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>性能工具wrk</title>
      <link href="/2017/08/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7wrk/"/>
      <url>/2017/08/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7wrk/</url>
      <content type="html"><![CDATA[<p>wrk是一款开源的性能测试工具,支持使用lua脚本,底层封装了epoll(linux)和kqueue(bsd)。文章介绍使用wrk进行压力测试。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li><p>Unbuntu/Debian下的安装</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Unbuntu/Debian下的安装</span><br><span class="line">sudo apt-get install build-essential libssl-dev git -y</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/wg/wrk.git wrk</span><br><span class="line"><span class="built_in">cd</span> wrk</span><br><span class="line">make</span><br><span class="line"><span class="comment"># 把生成的wrk移到一个PATH目录下面, 比如</span></span><br><span class="line">sudo cp wrk /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure></li><li><p>Unbuntu/Debian下的安装</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum groupinstall <span class="string">'Development Tools'</span></span><br><span class="line">sudo yum install openssl-devel</span><br><span class="line">sudo yum install git</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/wg/wrk.git wrk</span><br><span class="line"><span class="built_in">cd</span> wrk</span><br><span class="line">make</span><br><span class="line"><span class="comment"># 把生成的wrk移到一个PATH目录下面, 比如</span></span><br><span class="line">sudo cp wrk /usr/<span class="built_in">local</span>/bin</span><br></pre></td></tr></table></figure></li></ul><h3 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">使用方法: wrk &lt;选项&gt; &lt;被测HTTP服务的URL&gt;                            </span><br><span class="line">Options:                                            </span><br><span class="line">-c, --connections &lt;N&gt;  跟服务器建立并保持的TCP连接数量  </span><br><span class="line">-d, --duration    &lt;T&gt;  压测时间           </span><br><span class="line">-t, --threads     &lt;N&gt;  使用多少个线程进行压测</span><br><span class="line">-s, --script      &lt;S&gt;  指定Lua脚本路径       </span><br><span class="line">-H, --header      &lt;H&gt;  为每一个HTTP请求添加HTTP头      </span><br><span class="line">    --latency          在压测结束后，打印延迟统计信息   </span><br><span class="line">    --timeout     &lt;T&gt;  超时时间     </span><br><span class="line">-v, --version          打印正在使用的wrk的详细版本信息</span><br><span class="line">                                                      </span><br><span class="line">&lt;N&gt;代表数字参数，支持国际单位 (1k, 1M, 1G)</span><br><span class="line">&lt;T&gt;代表时间参数，支持时间单位 (2s, 2m, 2h)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 例: 10并发 100连接数 持续访问30s</span></span><br><span class="line">wrk -t10 -c100 -d30s http://127.0.0.1:8888</span><br></pre></td></tr></table></figure><p><img src="/image/性能工具wrk_001.png" alt=""></p><ul><li>Latency：响应时间</li><li>Req/Sec：每个线程每秒钟的完成的请求数</li><li>Avg：平均</li><li>Max：最大</li><li>Stdev：标准差</li><li>+/- Stdev： 正负一个标准差占比</li></ul><h3 id="Lua脚本个性化"><a href="#Lua脚本个性化" class="headerlink" title="Lua脚本个性化"></a>Lua脚本个性化</h3><p>wrk支持在三个阶段对压测进行个性化，分别是启动阶段、运行阶段和结束阶段。每个测试线程，都拥有独立的Lua运行环境。</p><p><img src="/image/性能工具wrk_002.png" alt=""></p><ul><li><p>1.启动阶段</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 在脚本文件中实现setup方法，wrk就会在测试线程已经初始化但还没有启动的时候调用该方法。wrk会为每一个测试线程调用一次setup方法，并传入代表测试线程的对象thread作为参数。setup方法中可操作该thread对象，获取信息、存储信息、甚至关闭该线程。</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setup</span><span class="params">(thread)</span></span></span><br><span class="line"><span class="comment">-- thread提供了1个属性，3个方法</span></span><br><span class="line"><span class="comment">-- thread.addr 设置请求需要打到的ip</span></span><br><span class="line"><span class="comment">-- thread:get(name) 获取线程全局变量</span></span><br><span class="line"><span class="comment">-- thread:set(name, value) 设置线程全局变量</span></span><br><span class="line"><span class="comment">-- thread:stop() 终止线程</span></span><br></pre></td></tr></table></figure></li><li><p>2.运行阶段</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">(args)</span></span></span><br><span class="line"><span class="comment">-- 每个线程仅调用1次，args 用于获取命令行中传入的参数, 例如 --env=pre</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">delay</span><span class="params">()</span></span></span><br><span class="line"><span class="comment">-- 每次请求调用1次，发送下一个请求之前的延迟, 单位为ms</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">request</span><span class="params">()</span></span></span><br><span class="line"><span class="comment">-- 每次请求调用1次，返回http请求</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">(status, headers, body)</span></span></span><br><span class="line"><span class="comment">-- 每次请求调用1次，返回http响应，如果没有定义该方法，那么wrk不会解析headers和body</span></span><br></pre></td></tr></table></figure></li><li><p>3.结束阶段</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 该方法在整个测试过程中只会调用一次，可从参数给定的对象中，获取压测结果，生成定制化的测试报告。</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">done</span><span class="params">(summary, latency, requests)</span></span></span><br><span class="line"></span><br><span class="line">latency.<span class="built_in">min</span>              <span class="comment">-- minimum value seen</span></span><br><span class="line">latency.<span class="built_in">max</span>              <span class="comment">-- maximum value seen</span></span><br><span class="line">latency.mean             <span class="comment">-- average value seen</span></span><br><span class="line">latency.stdev            <span class="comment">-- standard deviation</span></span><br><span class="line">latency:percentile(<span class="number">99.0</span>) <span class="comment">-- 99th percentile value</span></span><br><span class="line">latency(i)               <span class="comment">-- raw value and count</span></span><br><span class="line"></span><br><span class="line">summary = &#123;</span><br><span class="line">  duration = N,  <span class="comment">-- run duration in microseconds</span></span><br><span class="line">  requests = N,  <span class="comment">-- total completed requests</span></span><br><span class="line">  bytes    = N,  <span class="comment">-- total bytes received</span></span><br><span class="line">  errors   = &#123;</span><br><span class="line">    connect = N, <span class="comment">-- total socket connection errors</span></span><br><span class="line">    <span class="built_in">read</span>    = N, <span class="comment">-- total socket read errors</span></span><br><span class="line">    <span class="built_in">write</span>   = N, <span class="comment">-- total socket write errors</span></span><br><span class="line">    <span class="built_in">status</span>  = N, <span class="comment">-- total HTTP status codes &gt; 399</span></span><br><span class="line">    timeout = N  <span class="comment">-- total request timeouts</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>4.样例</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> counter = <span class="number">1</span>  </span><br><span class="line"><span class="keyword">local</span> threads = &#123;&#125;  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setup</span><span class="params">(thread)</span></span>  </span><br><span class="line">   thread:set(<span class="string">"id"</span>, counter)  </span><br><span class="line">   <span class="built_in">table</span>.<span class="built_in">insert</span>(threads, thread)  </span><br><span class="line">   counter = counter + <span class="number">1</span>  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span><span class="params">(args)</span></span>  </span><br><span class="line">   requests  = <span class="number">0</span>  </span><br><span class="line">   responses = <span class="number">0</span>  </span><br><span class="line">   <span class="keyword">local</span> msg = <span class="string">"thread %d created"</span>  </span><br><span class="line">   <span class="built_in">print</span>(msg:<span class="built_in">format</span>(id))  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">request</span><span class="params">()</span></span>  </span><br><span class="line">   requests = requests + <span class="number">1</span>  </span><br><span class="line"><span class="keyword">return</span> wrk.request()  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">(status, headers, body)</span></span>  </span><br><span class="line">   responses = responses + <span class="number">1</span>  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">done</span><span class="params">(summary, latency, requests)</span></span>  </span><br><span class="line"><span class="keyword">for</span> index, thread <span class="keyword">in</span> <span class="built_in">ipairs</span>(threads) <span class="keyword">do</span>  </span><br><span class="line">      <span class="keyword">local</span> id        = thread:get(<span class="string">"id"</span>)  </span><br><span class="line">      <span class="keyword">local</span> requests  = thread:get(<span class="string">"requests"</span>)  </span><br><span class="line">      <span class="keyword">local</span> responses = thread:get(<span class="string">"responses"</span>)  </span><br><span class="line">      <span class="keyword">local</span> msg = <span class="string">"thread %d made %d requests and got %d responses"</span>  </span><br><span class="line">      <span class="built_in">print</span>(msg:<span class="built_in">format</span>(id, requests, responses))  </span><br><span class="line">   <span class="keyword">end</span>  </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li><li><p>5.自定义脚本中可访问的变量和方法</p><ul><li><p>wrk: 全局变量，修改后会影响所有请求</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wrk = &#123;</span><br><span class="line">   scheme  = <span class="string">"http"</span>,</span><br><span class="line">   host    = <span class="string">"localhost"</span>,</span><br><span class="line">   port    = <span class="literal">nil</span>,</span><br><span class="line">   method  = <span class="string">"GET"</span>,</span><br><span class="line">   <span class="built_in">path</span>    = <span class="string">"/"</span>,</span><br><span class="line">   headers = &#123;&#125;,</span><br><span class="line">   body    = <span class="literal">nil</span>,</span><br><span class="line">   thread  = &lt;userdata&gt;,</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li><li><p>wrk.fomat:根据参数和全局变量wrk，生成整个request的string</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrk.format</span><span class="params">(method, path, headers, body)</span></span></span><br><span class="line"><span class="comment">-- method: http方法, 如GET/POST/DELETE 等</span></span><br><span class="line"><span class="comment">-- path:   url的路径, 如 /index, /index?a=b&amp;c=d</span></span><br><span class="line"><span class="comment">-- headers: 一个header的table</span></span><br><span class="line"><span class="comment">-- body:    一个http body, 字符串类型</span></span><br></pre></td></tr></table></figure></li><li><p>wrk.lookup:获取域名的IP和端口，返回table，例如：返回 <code>{127.0.0.1:80}</code></p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrk.lookup</span><span class="params">(host, service)</span></span></span><br><span class="line"><span class="comment">-- host:一个主机名或者地址串(IPv4的点分十进制串或者IPv6的16进制串)</span></span><br><span class="line"><span class="comment">-- service：服务名可以是十进制的端口号，也可以是已定义的服务名称，如ftp、http等</span></span><br></pre></td></tr></table></figure></li><li><p>wrk.connect:判断addr是否能连接，例如：<code>127.0.0.1:80</code>，返回 true 或 false</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrk.connect</span><span class="params">(addr)</span></span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="Lua样例"><a href="#Lua样例" class="headerlink" title="Lua样例"></a>Lua样例</h3><ul><li><p>压测支持HTTP pipeline的服务</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">init = <span class="function"><span class="keyword">function</span><span class="params">(args)</span></span></span><br><span class="line">   <span class="keyword">local</span> r = &#123;&#125;</span><br><span class="line">   r[<span class="number">1</span>] = wrk.<span class="built_in">format</span>(<span class="literal">nil</span>, <span class="string">"/?foo"</span>)</span><br><span class="line">   r[<span class="number">2</span>] = wrk.<span class="built_in">format</span>(<span class="literal">nil</span>, <span class="string">"/?bar"</span>)</span><br><span class="line">   r[<span class="number">3</span>] = wrk.<span class="built_in">format</span>(<span class="literal">nil</span>, <span class="string">"/?baz"</span>)</span><br><span class="line"></span><br><span class="line">   req = <span class="built_in">table</span>.<span class="built_in">concat</span>(r)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">request = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">   <span class="keyword">return</span> req</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li><li><p>认证之后获取token以进行压测</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">token = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">path</span>  = <span class="string">"/authenticate"</span></span><br><span class="line"></span><br><span class="line">request = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">   <span class="keyword">return</span> wrk.<span class="built_in">format</span>(<span class="string">"GET"</span>, <span class="built_in">path</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">response = <span class="function"><span class="keyword">function</span><span class="params">(status, headers, body)</span></span></span><br><span class="line">   <span class="keyword">if</span> <span class="keyword">not</span> token <span class="keyword">and</span> <span class="built_in">status</span> == <span class="number">200</span> <span class="keyword">then</span></span><br><span class="line">      token = headers[<span class="string">"X-Token"</span>]</span><br><span class="line">      <span class="built_in">path</span>  = <span class="string">"/resource"</span></span><br><span class="line">      wrk.headers[<span class="string">"X-Token"</span>] = token</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li><li><p>获取cookie以进行压测</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span><span class="params">(cookies, name)</span></span>  </span><br><span class="line">  <span class="keyword">local</span> start = <span class="built_in">string</span>.<span class="built_in">find</span>(cookies, name .. <span class="string">"="</span>)  </span><br><span class="line"><span class="keyword">if</span> start == <span class="literal">nil</span> <span class="keyword">then</span>  </span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span>  </span><br><span class="line">  <span class="keyword">end</span>  </span><br><span class="line"><span class="keyword">return</span> <span class="built_in">string</span>.<span class="built_in">sub</span>(cookies, start + #name + <span class="number">1</span>, <span class="built_in">string</span>.<span class="built_in">find</span>(cookies, <span class="string">";"</span>, start) - <span class="number">1</span>)  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">response = <span class="function"><span class="keyword">function</span><span class="params">(status, headers, body)</span></span>  </span><br><span class="line">  <span class="keyword">local</span> token = getCookie(headers[<span class="string">"Set-Cookie"</span>], <span class="string">"token"</span>)  </span><br><span class="line"><span class="keyword">if</span> token ~= <span class="literal">nil</span> <span class="keyword">then</span>  </span><br><span class="line">    wrk.headers[<span class="string">"Cookie"</span>] = <span class="string">"token="</span> .. token  </span><br><span class="line">  <span class="keyword">end</span>  </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li><li><p>发送json</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">request = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> headers = &#123; &#125;</span><br><span class="line">    headers[<span class="string">'Content-Type'</span>] = <span class="string">"application/json"</span></span><br><span class="line">    body = &#123;</span><br><span class="line">        mobile=&#123;<span class="string">"1533899828"</span>&#125;,</span><br><span class="line">        params=&#123;code=<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">1000</span>,<span class="number">9999</span>)&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> cjson = <span class="built_in">require</span>(<span class="string">"cjson"</span>)</span><br><span class="line">    body_str = cjson.encode(body)</span><br><span class="line">    <span class="keyword">return</span> wrk.<span class="built_in">format</span>(<span class="string">'POST'</span>, <span class="literal">nil</span>, headers, body_str)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li></ul><p>More info: <a href="https://github.com/wg/wrk" target="_blank" rel="noopener">wrk GitHub</a></p>]]></content>
      
      
        <tags>
            
            <tag> 性能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>性能工具Locust</title>
      <link href="/2017/07/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7Locust/"/>
      <url>/2017/07/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7Locust/</url>
      <content type="html"><![CDATA[<p>Locust是一款开源的分布式负载测试工具。是用Python编写，易于使用，完全基于事件，即一个locust节点也可以在一个进程中支持数千并发用户，不使用回调，通过<a href="http://www.gevent.org/" target="_blank" rel="noopener">gevent</a>使用轻量级过程（即在自己的进程内运行）。本文章介绍在Windows7如何安装和使用Locust。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li><p>1.使用pip安装</p>  <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install  locust</span><br></pre></td></tr></table></figure></li><li><p>2.验证安装</p>  <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locust -V</span><br></pre></td></tr></table></figure></li></ul><h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><ul><li><p>1.创建一个demo</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> locust <span class="keyword">import</span> HttpLocust, TaskSet, task</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteTasks</span><span class="params">(TaskSet)</span>:</span> <span class="comment"># 继承了TaskSet类，用于定义测试任务的</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_start</span><span class="params">(self)</span>:</span>   <span class="comment"># 进行初始化,只执行一次</span></span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"test_user"</span>,</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"123456"</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">"User-Agent"</span>:<span class="string">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        self.client.post(<span class="string">"/login"</span>,data=payload,headers=header) <span class="comment"># self.client属性的调用和使用方法和requests完全一致</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @task(5)    # 通过@task()装饰的方法为一个事务，方法的参数用于指定该行为的执行权重，参数越大每次被虚拟用户执行的概率越高，默认为1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(self)</span>:</span>   <span class="comment"># 测试任务</span></span><br><span class="line">        self.client.get(<span class="string">"/"</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @task(1)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">about</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.client.get(<span class="string">"/about/"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteUser</span><span class="params">(HttpLocust)</span>:</span> <span class="comment"># 继承了HttpLocust类，为每个模拟用户的发送http请求和设置测试参数</span></span><br><span class="line">    host     = <span class="string">"https://github.com/"</span> <span class="comment"># 被测系统的host，在终端中启动locust时没有指定--host参数时才会用到</span></span><br><span class="line">    task_set = WebsiteTasks          <span class="comment"># TaskSet类，该类定义用户任务信息，必填。这里就是:WebsiteTasks类名,因为该类继承TaskSet；</span></span><br><span class="line">    min_wait = <span class="number">5000</span>  <span class="comment"># 每个用户执行两个任务间隔时间的上下限（毫秒）,具体数值在上下限中随机取值，若不指定默认间隔时间固定为1秒</span></span><br><span class="line">    max_wait = <span class="number">15000</span></span><br><span class="line">    weight = <span class="number">10</span> <span class="comment"># 同时运行多个Locust类时，用于控制不同类型的任务执行权重</span></span><br></pre></td></tr></table></figure></li><li><p>2.执行流程图<br>  <img src="/image/性能工具Locust_001.png" alt=""></p></li><li><p>3.使用下面命令启动,通过浏览器访问：<a href="http://localhost:8089" target="_blank" rel="noopener">http://localhost:8089</a>(Locust启动网络监控器，默认为端口号为:8089）</p>  <figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">rem 执行性能脚本</span></span><br><span class="line">locust -f &lt;性能测试脚本文件.py&gt; --host=&lt;被测试应用的URL地址,不填写就读取继承（HttpLocust）的类中定义的host值&gt;</span><br></pre></td></tr></table></figure><p>  <img src="/image/性能工具Locust_002.png" alt=""><br>  <img src="/image/性能工具Locust_003.png" alt=""></p></li><li><p>4.监控性能</p><ul><li>Type： 请求的类型，例如GET/POST。</li><li>Name：请求的路径。</li><li>Request：当前请求的数量。</li><li>Fails：当前请求失败的数量。</li><li>Median：中间值，单位毫秒，一半的服务器响应时间低于该值，而另一半高于该值。</li><li>Average：平均值，单位毫秒，所有请求的平均响应时间。</li><li>Min：请求的最小服务器响应时间，单位毫秒。</li><li>Max：请求的最大服务器响应时间，单位毫秒。</li><li>Average Size：平均每个请求的大小，单位字节。</li><li>Current RPS：每秒钟请求的个数。<br><img src="/image/性能工具Locust_003.png" alt=""></li></ul></li><li><p>5.no-web模式运行启动</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locust -f &lt;性能测试脚本文件.py&gt;  --no-web -c&lt;虚拟用户数&gt;  -r&lt;每秒启动虚拟用户数&gt; -t &lt;运行时间&gt; --csv=&lt;测试结果文件&gt;</span><br></pre></td></tr></table></figure></li><li><p>6.其他方式定义task</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> locust <span class="keyword">import</span> TaskSet</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_job1</span><span class="params">(obj)</span>:</span></span><br><span class="line">    obj.client.get(<span class="string">'/test1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_job2</span><span class="params">(obj)</span>:</span></span><br><span class="line">    obj.client.get(<span class="string">'/test2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserBehavior</span><span class="params">(TaskSet)</span>:</span></span><br><span class="line">    tasks = &#123;test_job1:<span class="number">1</span>, test_job2:<span class="number">3</span>&#125;</span><br><span class="line">    <span class="comment"># tasks = [(test_job1,1), (test_job1,3)] # 两种方式等价</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="参数化"><a href="#参数化" class="headerlink" title="参数化"></a>参数化</h3><ul><li><p>1.循环取数据，数据可重复使用</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> locust <span class="keyword">import</span> TaskSet, task, HttpLocust</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserBehavior</span><span class="params">(TaskSet)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_start</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.index = <span class="number">0</span></span><br><span class="line"><span class="meta">    @task</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_visit</span><span class="params">(self)</span>:</span></span><br><span class="line">        url = self.locust.share_data[self.index]</span><br><span class="line">        print(<span class="string">'visit url: %s'</span> % url)</span><br><span class="line">        self.index = (self.index + <span class="number">1</span>) % len(self.locust.share_data)</span><br><span class="line">        self.client.get(url)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteUser</span><span class="params">(HttpLocust)</span>:</span></span><br><span class="line">    host = <span class="string">'http://debugtalk.com'</span></span><br><span class="line">    task_set = UserBehavior</span><br><span class="line">    share_data = [<span class="string">'url1'</span>, <span class="string">'url2'</span>, <span class="string">'url3'</span>, <span class="string">'url4'</span>, <span class="string">'url5'</span>]</span><br><span class="line">    min_wait = <span class="number">1000</span></span><br><span class="line">    max_wait = <span class="number">3000</span></span><br></pre></td></tr></table></figure></li><li><p>2.保证并发测试数据唯一性，不循环取数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> locust <span class="keyword">import</span> TaskSet, task, HttpLocust</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserBehavior</span><span class="params">(TaskSet)</span>:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">    @task</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_register</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = self.locust.user_data_queue.get()</span><br><span class="line">        <span class="keyword">except</span> queue.Empty:</span><br><span class="line">            print(<span class="string">'account data run out, test ended'</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        print(<span class="string">'register with user: &#123;0&#125;, pwd: &#123;1&#125;'</span> .format(data[<span class="string">'username'</span>], data[<span class="string">'password'</span>]))</span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">'username'</span>: data[<span class="string">'username'</span>],</span><br><span class="line">            <span class="string">'password'</span>: data[<span class="string">'password'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        self.client.post(<span class="string">'/register'</span>, data=payload)</span><br><span class="line">        self.locust.user_data_queue.put_nowait(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteUser</span><span class="params">(HttpLocust)</span>:</span></span><br><span class="line">    host = <span class="string">'http://debugtalk.com'</span></span><br><span class="line">    task_set = UserBehavior</span><br><span class="line">    user_data_queue = queue.Queue()</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"test%04d"</span> % index,</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"pwd%04d"</span> % index,</span><br><span class="line">            <span class="string">"email"</span>: <span class="string">"test%04d@debugtalk.test"</span> % index,</span><br><span class="line">            <span class="string">"phone"</span>: <span class="string">"186%08d"</span> % index,</span><br><span class="line">        &#125;</span><br><span class="line">        user_data_queue.put_nowait(data)</span><br><span class="line">    min_wait = <span class="number">1000</span></span><br><span class="line">    max_wait = <span class="number">3000</span></span><br></pre></td></tr></table></figure></li><li><p>3.保证并发测试数据唯一性，循环取数据</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> locust <span class="keyword">import</span> TaskSet, task, HttpLocust</span><br><span class="line"><span class="keyword">import</span> queue</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserBehavior</span><span class="params">(TaskSet)</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @task</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_register</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = self.locust.user_data_queue.get()</span><br><span class="line">        <span class="keyword">except</span> queue.Empty:</span><br><span class="line">            print(<span class="string">'account data run out, test ended'</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">        print(<span class="string">'register with user: &#123;0&#125;, pwd: &#123;1&#125;'</span> .format(data[<span class="string">'username'</span>], data[<span class="string">'password'</span>]))</span><br><span class="line">        payload = &#123;</span><br><span class="line">            <span class="string">'username'</span>: data[<span class="string">'username'</span>],</span><br><span class="line">            <span class="string">'password'</span>: data[<span class="string">'password'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        self.client.post(<span class="string">'/register'</span>, data=payload)</span><br><span class="line">        self.locust.user_data_queue.put_nowait(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebsiteUser</span><span class="params">(HttpLocust)</span>:</span></span><br><span class="line"></span><br><span class="line">    host = <span class="string">'http://debugtalk.com'</span></span><br><span class="line">    task_set = UserBehavior</span><br><span class="line">    user_data_queue = queue.Queue()</span><br><span class="line">    <span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">"username"</span>: <span class="string">"test%04d"</span> % index,</span><br><span class="line">            <span class="string">"password"</span>: <span class="string">"pwd%04d"</span> % index,</span><br><span class="line">            <span class="string">"email"</span>: <span class="string">"test%04d@debugtalk.test"</span> % index,</span><br><span class="line">            <span class="string">"phone"</span>: <span class="string">"186%08d"</span> % index,</span><br><span class="line">        &#125;</span><br><span class="line">        user_data_queue.put_nowait(data)</span><br><span class="line">    min_wait = <span class="number">1000</span></span><br><span class="line">    max_wait = <span class="number">3000</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h3><p>python自带的断言assert失败后代码就不会向下走，且失败后不会被Locust报表统计进去。不写参数catch_response=False断言无效，将catch_response=True才生效。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> locust <span class="keyword">import</span> HttpLocust, TaskSet, task</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserTask</span><span class="params">(TaskSet)</span>:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @task</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">job</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> self.client.get(<span class="string">'/'</span>, catch_response = <span class="keyword">True</span>) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                response.success()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                response.failure(<span class="string">'Failed!'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(HttpLocust)</span>:</span></span><br><span class="line">    task_set = UserTask</span><br><span class="line">    min_wait = <span class="number">1000</span></span><br><span class="line">    max_wait = <span class="number">3000</span></span><br><span class="line">    host = <span class="string">"https://www.baidu.com"</span></span><br></pre></td></tr></table></figure><h3 id="分布式压测"><a href="#分布式压测" class="headerlink" title="分布式压测"></a>分布式压测</h3><ul><li><p>1.把主机中代码复制到多个从机中,主机负责收集测试数据，从机进行施压测试</p></li><li><p>2.启动主机</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locust -f &lt;性能测试脚本文件.py&gt;  --no-web -c&lt;虚拟用户数&gt;  -r&lt;每秒启动虚拟用户数&gt; -t &lt;运行时间&gt; --csv=&lt;测试结果文件&gt; --master</span><br></pre></td></tr></table></figure></li><li><p>3.启动从机</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">locust -f  &lt;性能测试脚本文件.py&gt; --slave --master-host=&lt;主机ip&gt;</span><br></pre></td></tr></table></figure></li></ul><p>More info: <a href="https://locust.io/" target="_blank" rel="noopener">官网</a></p>]]></content>
      
      
        <tags>
            
            <tag> 性能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>性能工具ab</title>
      <link href="/2017/06/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7ab/"/>
      <url>/2017/06/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7ab/</url>
      <content type="html"><![CDATA[<p>ab(apachebench)是apache自带的压力测试工具。ab非常实用，它不仅可以对apache服务器进行网站访问压力测试，也可以对或其它类型的服务器进行压力测试。文章介绍centos7.5环境下使用wrk进行压力测试。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line">yum -y install httpd-tools</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line">ab -V</span><br></pre></td></tr></table></figure><h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">格式：ab [options] [http://]hostname[:port]/path</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明：</span></span><br><span class="line">-n requests     Number of requests to perform                        （要执行的请求校验次数。默认请求一次）</span><br><span class="line">-c concurrency  Number of multiple requests to make                  （并发数，同一时间有多少请求发出去，默认是1）</span><br><span class="line">-t timelimit    Seconds to max. <span class="built_in">wait</span> <span class="keyword">for</span> responses                   （校验花费的最大时间，内部设置-n 50000 次。默认不开启）</span><br><span class="line">-b windowsize   Size of TCP send/receive buffer, <span class="keyword">in</span> bytes            （发送和接收的buffer大小，单位是 bytes）</span><br><span class="line">-p postfile     File containing data to POST. Remember also to <span class="built_in">set</span> -T（包含POST数据文件）</span><br><span class="line">-u putfile      File containing data to PUT. Remember also to <span class="built_in">set</span> -T （包含PUT数据文件）</span><br><span class="line">-T content-type Content-type header <span class="keyword">for</span> POSTing, eg.                 （头信息content-type，如 -T <span class="string">"application/x-www-form-urlencoded"</span> ）</span><br><span class="line">                <span class="string">'application/x-www-form-urlencoded'</span></span><br><span class="line">                Default is <span class="string">'text/plain'</span></span><br><span class="line">-v verbosity    How much troubleshooting info to <span class="built_in">print</span>               （设置输出等级， 4 输出头信息，3 输出响应码(404,200) 2 输出警告和信息）</span><br><span class="line">-w              Print out results <span class="keyword">in</span> HTML tables                     （以HTML表的格式输出结果。默认时，它是白色背景的两列宽度的一张表。）</span><br><span class="line">-i              Use HEAD instead of GET                              （执行HEAD请求，而不是GET）</span><br><span class="line">-x attributes   String to insert as table attributes</span><br><span class="line">-y attributes   String to insert as tr attributes</span><br><span class="line">-z attributes   String to insert as td or th attributes</span><br><span class="line">-C attribute    Add cookie, eg. -C <span class="string">"c1=1234,c2=2,c3=3"</span>. (repeatable) （对请求附加一个Cookie）提示：可以借助session实现原理传递 JSESSIONID参数， 实现保持会话的功能，如 -C ” c1=1234,c2=2,c3=3, JSESSIONID=FF056CD16DA9D71CB131C1D56F0319F8″ 。</span><br><span class="line">-H attribute    Add Arbitrary header line, eg. <span class="string">'Accept-Encoding: gzip'</span></span><br><span class="line">                Inserted after all normal header lines. (repeatable)</span><br><span class="line">-A attribute    Add Basic WWW Authentication, the attributes</span><br><span class="line">                are a colon separated username and password.</span><br><span class="line">-P attribute    Add Basic Proxy Authentication, the attributes        -P proxy-auth-username:password 对一个中转代理提供BASIC认证信任。用户名和密码由一个:隔开，并以base64编码形式发送。无论服务器是否需要(即, 是否发送了401认证需求代码)，此字符串都会被发送。</span><br><span class="line">                are a colon separated username and password.</span><br><span class="line">-X proxy:port   Proxyserver and port number to use</span><br><span class="line">-V              Print version number and <span class="built_in">exit</span></span><br><span class="line">-k              Use HTTP KeepAlive feature</span><br><span class="line">-d              Do not show percentiles served table.</span><br><span class="line">-S              Do not show confidence estimators and warnings.</span><br><span class="line">-g filename     Output collected data to gnuplot format file.         写所有有用的信息到TSV（Tab separate values）文件，可以轻松导入Excel等里面，label在文件第一行）</span><br><span class="line">-e filename     Output CSV file with percentages served               写一个逗号分隔的CSV文件，包含每个百分比(from 1% to 100%)服务器执行的时间(毫秒)，这个文件一般比<span class="string">'gunplot'</span>有用</span><br><span class="line">-r              Don<span class="string">'t exit on socket receive errors.                 （在socket错误的时候不退出）</span></span><br><span class="line"><span class="string">-h              Display usage information (this message)</span></span><br><span class="line"><span class="string">-Z ciphersuite  Specify SSL/TLS cipher suite (See openssl ciphers)</span></span><br><span class="line"><span class="string">-f protocol     Specify SSL/TLS protocol (SSL2, SSL3, TLS1, or ALL)  （指定 SSL/TLS 协议 (SSL2, SSL3, TLS1, or ALL).）</span></span><br></pre></td></tr></table></figure><h3 id="简单实例"><a href="#简单实例" class="headerlink" title="简单实例"></a>简单实例</h3><ul><li><p>并发10，请求100</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ab -n100 -c10 http://www.baidu.com/</span><br></pre></td></tr></table></figure></li><li><p>结果以html的形式输出</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ab -n100 -c10 -w http://www.baidu.com/</span><br></pre></td></tr></table></figure></li></ul><h3 id="测试结果说明"><a href="#测试结果说明" class="headerlink" title="测试结果说明"></a>测试结果说明</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">ab -n 100 -c 10  https://www.baidu.com/index.html</span><br><span class="line"></span><br><span class="line">This is ApacheBench, Version 2.3 &lt;<span class="variable">$Revision</span>: 1706008 $&gt;</span><br><span class="line">Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/</span><br><span class="line">Licensed to The Apache Software Foundation, http://www.apache.org/</span><br><span class="line"><span class="comment"># 以上为apache的版本信息，与本次测试无关</span></span><br><span class="line"></span><br><span class="line">Benchmarking www.baidu.com (be patient).....<span class="keyword">done</span></span><br><span class="line"><span class="comment"># 以上内容显示测试完成度，本次测试发起请求数量较少，完成较快，无中间过程显示。在请求数量很多时会分行显示当前完成数量。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Server Software:        bfe/1.0.8.14  <span class="comment"># 被测试的服务器所用的软件信息</span></span><br><span class="line">Server Hostname:        www.baidu.com  <span class="comment"># 被测主机名</span></span><br><span class="line">Server Port:            443  <span class="comment">#被测主机的服务端口号，一般http请求的默认端口号是80，https默认使用443端口</span></span><br><span class="line">SSL/TLS Protocol:       TLSv1.2,ECDHE-RSA-AES128-GCM-SHA256,2048,128  <span class="comment">#加密协议</span></span><br><span class="line"></span><br><span class="line">Document Path:          /index.html  <span class="comment"># 请求的具体文件</span></span><br><span class="line">Document Length:        227 bytes   <span class="comment"># 请求的文件index.html大小</span></span><br><span class="line"></span><br><span class="line">Concurrency Level:      10 <span class="comment"># 并发数</span></span><br><span class="line">Time taken <span class="keyword">for</span> tests:   1.093 seconds  <span class="comment"># 本次测试总共花费的时间</span></span><br><span class="line">Complete requests:      100  <span class="comment"># 本次测试总共发起的请求数量</span></span><br><span class="line">Failed requests:        0  <span class="comment"># 失败的请求数量。因网络原因或服务器性能原因，发起的请求并不一定全部成功，通过该数值和Complete requests相除可以计算请求的失败率，作为测试结果的重要参考。</span></span><br><span class="line">Total transferred:      103314 bytes  <span class="comment"># 总共传输的数据量，指的是ab从被测服务器接收到的总数据量，包括index.html的文本内容和请求头信息。</span></span><br><span class="line">HTML transferred:       22700 bytes  <span class="comment">#从服务器接收到的index.html文件的总大小，等于Document Length＊Complete requests＝227 bytes＊100＝22700 bytes</span></span><br><span class="line">Requests per second:    91.50 [<span class="comment">#/sec] (mean)  #平均(mean)每秒完成的请求数：QPS，这是一个平均值，等于Complete requests/Time taken for tests=100/1.093=91.50</span></span><br><span class="line">Time per request:       109.287 [ms] (mean)  <span class="comment"># 从用户角度看，完成一个请求所需要的时间（因用户数量不止一个，服务器完成10个请求，平均每个用户才接收到一个完整的返回，所以该值是下一项数值的10倍。）</span></span><br><span class="line">Time per request:       10.929 [ms] (mean, across all concurrent requests)  <span class="comment"># 服务器完成一个请求的时间。</span></span><br><span class="line">Transfer rate:          92.32 [Kbytes/sec] received  <span class="comment"># 网络传输速度。对于大文件的请求测试，这个值很容易成为系统瓶颈所在。要确定该值是不是瓶颈，需要了解客户端和被测服务器之间的网络情况，包括网络带宽和网卡速度等信息。</span></span><br><span class="line"></span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:       11   17  14.2     15     153</span><br><span class="line">Processing:     4    6   2.4      5      23</span><br><span class="line">Waiting:        4    6   2.1      5      23</span><br><span class="line">Total:         16   23  14.6     21     158</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这几行组成的表格主要是针对响应时间也就是第一个Time per request进行细分和统计。一个请求的响应时间可以分成网络链接（Connect），系统处理（Processing）和等待（Waiting）三个部分。表中min表示最小值;mean表示平均值;[+/-sd]表示标准差（Standard Deviation）,表示数据的离散程度，数值越大表示数据越分散，系统响应时间越不稳定;median表示中位数;max表示最大值了。</span></span><br><span class="line"></span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line">  50%     21</span><br><span class="line">  66%     22</span><br><span class="line">  75%     23</span><br><span class="line">  80%     23</span><br><span class="line">  90%     25</span><br><span class="line">  95%     32</span><br><span class="line">  98%     52</span><br><span class="line">  99%    158</span><br><span class="line"> 100%    158 (longest request)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这个表表示有百分之多少的请求都是在多少ms内完成的</span></span><br></pre></td></tr></table></figure><p>More info: <a href="http://httpd.apache.org/docs/2.0/programs/ab.html" target="_blank" rel="noopener">官网</a></p>]]></content>
      
      
        <tags>
            
            <tag> 性能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>性能测试（三）性能测试的执行与分析</title>
      <link href="/2017/05/15/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%9503/"/>
      <url>/2017/05/15/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%9503/</url>
      <content type="html"><![CDATA[<p>本文章介绍性能测试的执行与分析。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="性能测试执行"><a href="#性能测试执行" class="headerlink" title="性能测试执行"></a>性能测试执行</h3><ul><li>人工边执行边分析</li><li>无人值守执行性能测试：利用业务或者系统空闲时间测试</li></ul><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul><li>如果在线上或者uat，要考虑对业务的影响，跟开发及时沟通测试场景，尽量业务或者系统空闲时间测试</li><li>记录性能指标(数值和图片)：图片还是必须的记录，测试周期长可能存在记录错误或者争论</li><li>监控请求是否正常,分析失败原因</li><li>测试总体曲线是否呈现波峰或者随着请求量增大趋于水平</li></ul><h3 id="结果分析与调优"><a href="#结果分析与调优" class="headerlink" title="结果分析与调优"></a>结果分析与调优</h3><h4 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h4><ol><li>测试结果是否满足性能指标</li><li>满足，开始写性能报告；不满足，是否受到哪方面限制或者其他因素，跟需求方确实是否需要调优，调优进行下一节初步分析，然后跟架构师和开发确定方案。</li></ol><h5 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a>注意事项</h5><ul><li>1.测试曲线远离预想<ul><li>可能是被测系统接受的tps不同于实际执行机发出，在被测机器增加日志打印之类方式去统计接受到的需求</li><li>触发特殊的系统机制</li></ul></li><li>2.请求出现较高的错误率<ul><li>查看返回的错误信息</li><li>检查网络是否稳定</li><li>检查中间组件异常</li><li>检查数据库是否重启</li><li>集群检查每个节点是否正常</li></ul></li><li>3.集群测试平均性能小于单机<ul><li>负债均衡组件分发速度是否受到限制，处理太慢</li><li>分发规则是否对每一台单机发送的请求量大体一致 </li></ul></li></ul><h4 id="系统瓶颈分析"><a href="#系统瓶颈分析" class="headerlink" title="系统瓶颈分析"></a>系统瓶颈分析</h4><p>整体思路：从前到后，从表象到内部:</p><ul><li>1.首先排除压力机自身的问题，如CPU、内存，网络，脚本编写等</li><li>2.监控中间件的访问日志，观察响应时间，大体确定耗时处于哪一段</li><li>3.排查网络问题，监控压力机到后端服务器的网络，以及各服务器间的网络，是否达到网络上限</li><li>4.监控服务端所有机器的操作系统负载，如CPU、内存、磁盘、网络是否达到瓶颈</li><li>5.监控应用服务器的日志，查看是否存在ERROR日志，比如TimeOut或其他类型报错</li><li>6.监控各中间件的连接数，如nginx、tomcat、mysql等，是否达到上限</li><li>7.监控应用程序线程状态，使用jstack或jvisualvm查看是否有死锁、阻塞等情况</li><li>8.监控应用程序的jvm，使用jstat或者jmap查看GC情况，是否内存泄漏等</li><li>9.使用jprofiler监控应用程序，可以查看耗时比较长的代码方法</li><li><p>10.监控数据库，是否存在慢查询，一般数据库CPU高都是因为SQL语句效率低造成的</p><ul><li><p>在sql语句前加上explain，可以分析这条sql语句的执行情况 explain select * from t_order_loop_refund  where name = ‘小明’；</p><ul><li>Type列可能的值<pre><code>Const：表中只有一个匹配行，用到primary key或unique keyEq_ref：唯一性索引扫描，key的所有部分被连接联接查询使用，且key是unique或primary keyref：非唯一性索引扫描，或只使用了联合索引的最左前缀Range：索引范围扫描，在索引列上进行给定范围内的检索，如between，in（1,100）Index：遍历索引...All：全表扫描Prossible key：使用哪个索引能找到行Keys：sql语句使用的索引rows：mysql 根据索引选择情况，估算查找数据所需读取的行数</code></pre></li></ul><p><img src="/image/性能测试03_001.png" alt=""></p><ul><li>联合索引</li><li>连接数</li><li>数据库架构优化<ul><li>读写分离，主从配置</li><li>硬件调优 </li></ul></li></ul></li></ul></li><li>11.检查数据库执行计划，是否有全表扫描，以及索引不生效的情况</li><li>12.检查系统外部依赖情况，如果外部依赖系统性能差，也会造成本系统性能低</li><li>13.对于不好定位的问题，可以考虑采用模块隔离法来确定问题 </li></ul><h4 id="优化方案"><a href="#优化方案" class="headerlink" title="优化方案"></a>优化方案</h4><ul><li>sql<ol><li>在 where 及 order by 涉及的列上建立索引，避免全表扫描，索引不要太多，一个表一般不要<br>超过4个索引</li><li>避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描</li><li>查询语句中不要使用 *，减少内存使用</li><li>尽量减少子查询，使用关联查询（left join,right join,inner join）替代</li><li>减少使用IN或者NOT IN ,使用exists，not exists或者关联查询语句替代</li><li>or 的查询尽量用 union或者union all 代替(在确认没有重复数据或者不用剔除重复数据时，<br>union all会更好)</li><li>合理的增加冗余的字段（减少表的联接查询）</li><li>建表的时候能使用数字类型的字段就使用数字类型（type,status…），数字类型的字段作为条件查询比字符串的快</li></ol></li><li>代码<ol><li>使用对象池减少对重复对象的创建；</li><li>调整对后端的连接</li><li>增加本地缓存</li><li>如果不涉及事务的情况下，考虑使用Nosql进行存储</li><li>一次请求合并多次操作</li><li>由串行修改为并行操作</li><li>同步修改为异步</li></ol></li></ul><h3 id="测试报告与总结"><a href="#测试报告与总结" class="headerlink" title="测试报告与总结"></a>测试报告与总结</h3><ul><li>测试计划</li><li>业务流程</li><li>测试环境</li><li>测试场景：把测试场景罗列，并放上对于性能结果和资源占用率的图片</li><li>结果与分析：把测试性能指标与实际结果罗列对比，说明存在哪些问题</li><li>结论：问题和是否满足标准</li><li>风险点：存在哪些风险需要考虑，怎么去规避</li></ul>]]></content>
      
      
        <tags>
            
            <tag> 性能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>性能测试（二）性能测试方案设计</title>
      <link href="/2017/04/15/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%9502/"/>
      <url>/2017/04/15/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%9502/</url>
      <content type="html"><![CDATA[<p>本文章介绍性能测试方案设计。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="性能需求分析"><a href="#性能需求分析" class="headerlink" title="性能需求分析"></a>性能需求分析</h3><ol><li>系统信息调研：架构、平台、协议等</li><li>业务信息调研：基本业务、关键业务，用户行为</li><li>性能需求评估：明确是否需要做性能测试<ul><li>业务角度：对内或者对外，使用人数多少，需求是否必要</li><li>系统角度 ：<ul><li>系统架构：系统框架是否更换</li><li>数据库要求</li><li>系统特殊要求：秒杀或者对延时要求比较高</li></ul></li></ul></li><li>确定测试范围<ul><li>压力测试</li><li>负载测试</li><li>性能测试</li></ul></li><li>确定性能测试点</li><li>测试指标<ul><li>关键业务<ul><li>分析用户使用场景，掌握用户需求</li><li>提炼用户关注度较强的功能</li><li>分析用户操作频繁的功能</li><li>分析系统中可能的大数据量操作【文件读写，图片浏览，事务队列，事务机制】</li><li>分析系统关键功能【后台服务，缓存，调用的功能组件】</li><li>分析用户组合航警，操作比例以及操作时延</li></ul></li><li>日请求量</li><li>逻辑复杂度</li><li>营推广活动</li></ul></li><li>确定性能指标和通过标准<ul><li>性能指标：具体结合业务，例如页面就存在页面加载时间</li><li>通过标准<ul><li>线上数据高峰期间的峰值和平均流量</li><li>未来的规划和期望</li></ul></li></ul></li></ol><h3 id="性能测试准备"><a href="#性能测试准备" class="headerlink" title="性能测试准备"></a>性能测试准备</h3><h4 id="1-测试环境准备"><a href="#1-测试环境准备" class="headerlink" title="1.测试环境准备"></a>1.测试环境准备</h4><h5 id="系统运行环境-：与线上保持一致"><a href="#系统运行环境-：与线上保持一致" class="headerlink" title="系统运行环境 ：与线上保持一致"></a>系统运行环境 ：与线上保持一致</h5><ul><li>线上或者uat环境<ul><li>数据请求打标签,区分测试数据与真实数据</li><li>增加测试挡板</li><li>优点:不需要搭建环境和监控</li><li>缺点:只能选择流量空闲期,不能进行过高的压测,测试时候要及时跟开发沟通(线上异常警告)</li></ul></li><li>搭建环境<ul><li>组网模型: 需要评估测试组网与生产组网差异，至少满足最低配置要求<ul><li>组网类型：单机/双机/单机集群/双机集群/各种组合类型</li><li>硬件: cpu/内存/磁盘读写/网卡</li><li>软件：操作系统类型/服务/数据库/文件库/第三方组件</li><li>消息交互：同步/异步</li></ul></li></ul></li></ul><h5 id="执行机环境"><a href="#执行机环境" class="headerlink" title="执行机环境"></a>执行机环境</h5><ul><li>网络与用户保持一致</li><li>组网：单机（4U8G）一般只能支持2000tps左右），场景超过需要更高的配置</li><li><a href="https://blog.csdn.net/kaka1121/article/details/51496387" target="_blank" rel="noopener">调优</a><ul><li>网络设置</li><li>测试软件</li><li>系统对软件的限制</li></ul></li></ul><h4 id="2-测试场景设计"><a href="#2-测试场景设计" class="headerlink" title="2. 测试场景设计"></a>2. 测试场景设计</h4><p>根据性能需求分析来设计符合用户使用习惯的场景</p><ul><li>测试范围：根据需求分析确定的范围，确定测试场景范围</li><li>测试功能点： 具体业务场景</li><li>请求数据量：受到测试范围影响，如果算性能测试，就需要随着请求数据量变化下（从低到高）系统的性能指标</li><li>单次场景的请求持续时间</li><li>测试环境配置<ul><li>单机</li><li>集群 </li></ul></li><li>测试指标<ul><li>tps</li><li>请求平均耗时</li><li>请求最大耗时</li><li>成功率</li></ul></li><li>测试结果<ul><li>实际tps</li><li>请求平均耗时</li><li>请求最大耗时</li><li>请求的成功率</li><li>资源占用情况</li></ul></li></ul><p><img src="/image/性能测试02_001.png" alt=""></p><h4 id="3-性能工具准备-：与开发技术栈一致"><a href="#3-性能工具准备-：与开发技术栈一致" class="headerlink" title="3.性能工具准备 ：与开发技术栈一致"></a>3.性能工具准备 ：与开发技术栈一致</h4><h5 id="负载工具"><a href="#负载工具" class="headerlink" title="负载工具"></a>负载工具</h5><ul><li><strong>ApacheBench</strong>: Apache 服务器自带的一个web压力测试工具，简称ab<ul><li><a href="https://www.apachelounge.com/download/" target="_blank" rel="noopener">下载</a> </li><li><a href="http://httpd.apache.org/docs/2.4/programs/ab.html" target="_blank" rel="noopener">使用</a>     </li><li><a href="https://honglamp.com/2019/01/11/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7ab/" target="_blank" rel="noopener">教程</a>    </li></ul></li><li><strong>Wrk</strong>:一款针对 Http 协议的基准测试开源工具,支持lua脚本<ul><li><a href="https://github.com/wg/wrk" target="_blank" rel="noopener">源码</a> </li><li><a href="https://www.cnblogs.com/savorboard/p/wrk.html" target="_blank" rel="noopener">安装</a>     </li><li><a href="https://www.cnblogs.com/l199616j/p/12156600.html" target="_blank" rel="noopener">使用</a> </li><li><a href="https://honglamp.com/2018/12/21/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7wrk/" target="_blank" rel="noopener">教程</a>    </li></ul></li><li><strong>Apache JMeter(常用)</strong>: Java 编写的应用程序，支持插件和jar包.<ul><li><a href="http://jmeter.apache.org/download_jmeter.cgi" target="_blank" rel="noopener">下载</a> </li><li><a href="JMeter中文使用手册.pdf">使用</a>     </li></ul></li><li><strong>Locust </strong>:一个开源负载测试工具。使用 Python 代码定义用户行为，也可以仿真百万个用户。<ul><li><a href="https://github.com/locustio/locust" target="_blank" rel="noopener">源码</a> </li><li>安装:pip安装</li><li><a href="https://docs.locust.io/en/stable/index.html" target="_blank" rel="noopener">使用</a> </li><li>[教程](<a href="https://honglamp.com/2019/03/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7Locust/）" target="_blank" rel="noopener">https://honglamp.com/2019/03/15/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7Locust/）</a>    </li></ul></li><li><strong>LoadRunner(付费专业)</strong>:HP公司提供的一款性能测试工具，通过模拟成千上万个用户实施并发操作，测试系统的性能，并且提供详细的测试结果分析，协助用户查找问题。<ul><li><a href="http://www.51testing.com/zhuanti/LoadRunner.html" target="_blank" rel="noopener">相关资料</a> </li></ul></li><li><strong>Spirent(付费专业)</strong>:自带硬件的大流量网络测试仪</li></ul><h5 id="监控工具"><a href="#监控工具" class="headerlink" title="监控工具"></a>监控工具</h5><ul><li>Linux系统监控工具<ul><li><a href="https://honglamp.com/2018/10/21/Linux%E7%B3%BB%E7%BB%9F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7/" target="_blank" rel="noopener">教程</a> </li></ul></li><li>Node_Exporter+Prometheus+Grafana<ul><li><a href="https://honglamp.com/2019/02/11/%E9%83%A8%E7%BD%B2Prometheus/" target="_blank" rel="noopener">教程</a></li></ul></li></ul><h4 id="4-测试脚本准备"><a href="#4-测试脚本准备" class="headerlink" title="4.测试脚本准备"></a>4.测试脚本准备</h4><h4 id="5-测试数据准备"><a href="#5-测试数据准备" class="headerlink" title="5.测试数据准备"></a>5.测试数据准备</h4><ul><li>系统初始数据：<ul><li>分析系统上线后数据量/历史数据</li><li>计算出系统每个阶段数据容量，数据类型，数据比例</li><li>根据不同阶段分别进行数据预制</li></ul></li><li>测试新增数据：<ul><li>业务场景确定后根据具体业务场景定义输入和输出数据</li><li>结合具体的呼叫模型进行数据预制</li></ul></li></ul><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><ul><li>模拟与真实场景、真实组网和真实数据之间的差异性</li><li>测试过程中的执行模型问题（缓存）</li><li>测试执行过程中的资源监控问题</li><li>行业或者同行标准</li></ul><p><strong>否则结果与现实存在很大差距，测试结果不准确</strong></p>]]></content>
      
      
        <tags>
            
            <tag> 性能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>性能测试（一）性能测试的基本概念</title>
      <link href="/2017/03/15/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%9501/"/>
      <url>/2017/03/15/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%9501/</url>
      <content type="html"><![CDATA[<p><strong>性能测试</strong>：指通过<strong>自动化的测试工具</strong>模拟多种<strong>正常、峰值以及异常负载</strong>条件来对<strong>系统的各项性能指标</strong>进行测试。本文章介绍性能测试的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="性能要求"><a href="#性能要求" class="headerlink" title="性能要求"></a>性能要求</h3><ul><li>用户<ul><li>响应速度</li><li>稳定性</li></ul></li><li>开发<ul><li>架构是否合理</li><li>数据库设计</li><li>代码</li></ul></li><li>系统管理员<ul><li>资源利用率（合适的比例）</li><li>可扩展性</li><li>系统容量（可容纳的用户请求）</li><li>稳定性</li></ul></li></ul><h3 id="性能测试应用场景"><a href="#性能测试应用场景" class="headerlink" title="性能测试应用场景"></a><strong>性能测试应用场景</strong></h3><ul><li>能力验证 关注在给定的软硬件条件下，系统能否具有预期的能力表现</li><li>规划能力 关注如何使系统具有我们要求的性能能力</li><li>性能调优 主要用于对系统性能进行调优</li><li>缺陷发现 发现缺陷或问题重现、定位手段</li><li>性能基准比较 比较每次迭代中的性能表现变化，判断迭代是否达到了目标</li></ul><h3 id="性能测试类型"><a href="#性能测试类型" class="headerlink" title="性能测试类型"></a><strong>性能测试类型</strong></h3><ul><li><strong>基准测试</strong>：在给系统施加较低压力时，查看系统的运行状况并记录相关数做为基础参考。</li><li><strong>并发测试</strong>：测试多个用户同时访问同一个应用、同一个模块或者数据记录时是否存在死锁或者其他性能问题。</li><li><strong>负载测试</strong>：是指对系统不断地增加压力或增加一定压力下的持续时间，直到系统的某项或多项性能指标达到安全临界值，例如某种资源已经达到饱和状态等。</li><li><strong>压力测试</strong>：压力测试是评估系统处于或超过预期负载时系统的运行情况，关注点在于系统在峰值负载或超出最大载荷情况下的处理能力。</li><li><strong>稳定性测试</strong>：在给系统加载一定业务压力的情况下，使系统运行一段时间，以此检测系统是否稳定。</li></ul><h3 id="性能测试基本概念"><a href="#性能测试基本概念" class="headerlink" title="性能测试基本概念"></a><strong>性能测试基本概念</strong></h3><ul><li><strong>并发数</strong><ul><li><strong>并发用户数</strong>：某一物理时刻同时向系统提交请求的用户数，提交的请求可能是同一个场景或功能，也可以是不同场景或功能。</li><li><strong>在线用户数</strong>：某段时间内访问系统的用户数，这些用户并不一定同时向系统提交请求</li><li><strong>系统用户数</strong>：系统注册的总用户数据</li></ul></li><li><strong>吞吐量(TPS)</strong> ： 单位时间内系统处理的客户端请求的数量(完成一个业务事务的过程)</li><li><strong>响应时间</strong> ：从用户发送一个请求到用户接收到服务器返回的响应数据这段时间就是响应时间</li><li><strong>资源利用率</strong> ：指的是对不同系统资源的使用程度，通常以占用最大值的百分比来衡量<ul><li>CPU：就像人的大脑，主要负责相关事情的判断以及实际处理的机制</li><li>内存：大脑中的记忆块区，将眼睛，皮肤等收集到的信息记录起来的地方，以供cpu进行判断，但是是临时的，访问速度快，如果关机或断电这里的数据会消失。</li><li>磁盘IO：大脑中的记忆区块，将重要的数据保存起来（永久保存，关机或断电不会丢失，速度慢），以便将来再次使用这些数据。</li><li>网络：</li></ul></li></ul><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><p>模拟用户的真实、峰值和异常的请求量（单位时间的请求数量*单位请求内容大小）去访问系统，监控其性能情况（TPS、响应时间和资源利用率）并获取。</p>]]></content>
      
      
        <tags>
            
            <tag> 性能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>可靠性测试（一）可靠性测试的基本概念</title>
      <link href="/2017/02/15/%E5%8F%AF%E9%9D%A0%E6%80%A7%E6%B5%8B%E8%AF%9501/"/>
      <url>/2017/02/15/%E5%8F%AF%E9%9D%A0%E6%80%A7%E6%B5%8B%E8%AF%9501/</url>
      <content type="html"><![CDATA[<p>软件是一种逻辑实体，具有抽象性，没有明显的制造过程，虽然没有磨损、老化的问题，但为了适应硬件、环境以及需求的变化而进行修改，这些修改常常会引入错误，导致软件失效率升高，软件质量降低。因此大量的软件系统其可靠性得不到保证，几乎没有不存在错误的软件系统。<br>本文章主要介绍如何进行软件的可靠性测试。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>软件的可靠性：在各种异常情况下，产品的容错性和恢复能力。</p><h3 id="测试类型"><a href="#测试类型" class="headerlink" title="测试类型"></a>测试类型</h3><ul><li>外界输入，引起内部故障<ul><li>异常值输入：属于<strong>功能测试</strong>，一种使用系统不允许用户输入的数值（即异常值）作为测试输入的可靠性测试方法。</li><li>稳定性和压力测试：属于<strong>性能测试</strong></li></ul></li><li>环境因素<ul><li>故障注入： 把系统放在有问题的环境中进行测试的一种可靠性测试法 </li></ul></li></ul><h3 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h3><ul><li>组网方式跟生产一样：不同组件之间和同一组件内部</li><li>各个组件不可缺少</li></ul><h3 id="测试场景设计"><a href="#测试场景设计" class="headerlink" title="测试场景设计"></a>测试场景设计</h3><ul><li>从用户的业务环境中，筛选出哪些故障、错误或问题</li><li>常用环境因素考虑<ul><li>网络：弱网、断网</li><li>硬件（硬盘）：硬盘占满、内存占满、机器重启</li><li>软件：内存泄漏、内核故障、文件丢失</li></ul></li><li>组网方式：<ul><li>单点故障</li><li>集群故障</li></ul></li><li>影响级别<ul><li>造成重大损失，</li><li>造成较大损失</li><li>造成较小损失</li><li>不造成损失</li></ul></li></ul><h3 id="测试步骤"><a href="#测试步骤" class="headerlink" title="测试步骤"></a>测试步骤</h3><ol><li>验证功能是否正常</li><li>注入故障</li><li>验证功能是否受到影响</li><li>恢复故障</li><li>验证功能是否恢复</li></ol><h3 id="结果和分析"><a href="#结果和分析" class="headerlink" title="结果和分析"></a>结果和分析</h3><p>通过测试结果进行分析，生成可靠性评估报告</p>]]></content>
      
      
        <tags>
            
            <tag> 可靠性 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JavaScript（四）ECMAScript</title>
      <link href="/2017/01/15/JavaScript04/"/>
      <url>/2017/01/15/JavaScript04/</url>
      <content type="html"><![CDATA[<p><strong>ECMAScript是一种由Ecma国际（前身为欧洲计算机制造商协会,英文名称是European Computer Manufacturers Association）通过ECMA-262标准化的脚本程序设计语言。这种语言在万维网上应用广泛，它往往被称为JavaScript或JScript，所以它可以理解为是JavaScript的一个标准，但实际上后两者是ECMA-262标准的实现和扩展。 </strong>  本文章主要介绍 ECMAScript 的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、结构"><a href="#一、结构" class="headerlink" title="一、结构"></a>一、结构</h3><p>一个完整的 JavaScript 是由以下 3 个不同部分组成的：</p><ul><li><p>核心（ECMAScript）： 是一个重要的标准, 描述了语法和基本对象。 </p><ul><li>语法</li><li>类型</li><li>语句</li><li>关键字</li><li>保留字</li><li>运算符</li><li>对象</li></ul></li><li><p>文档对象模型（DOM）： HTML 和 XML 的应用程序接口（API）。DOM 将把整个页面规划成由节点层级构成的文档。HTML 或 XML 页面的每个部分都是一个节点的衍生物。 </p><ul><li>DOM 视图 - 描述跟踪文档的各种视图（即 CSS 样式化之前和 CSS 样式化之后的文档）</li><li>DOM 事件 - 描述事件的接口</li><li>DOM 样式 - 描述处理基于 CSS 样式的接口</li><li>DOM 遍历和范围 - 描述遍历和操作文档树的接口</li></ul></li><li><p>浏览器对象模型（BOM）： 对浏览器窗口进行访问和操作 </p><ul><li><a href="https://www.w3school.com.cn/jsref/dom_obj_window.asp" target="_blank" rel="noopener">Window 对象</a></li><li><a href="https://www.w3school.com.cn/jsref/dom_obj_navigator.asp" target="_blank" rel="noopener">Navigator 对象</a></li><li><a href="https://www.w3school.com.cn/jsref/dom_obj_screen.asp" target="_blank" rel="noopener">Screen 对象</a></li><li><a href="https://www.w3school.com.cn/jsref/dom_obj_history.asp" target="_blank" rel="noopener">History 对象</a></li><li><a href="https://www.w3school.com.cn/jsref/dom_obj_location.asp" target="_blank" rel="noopener">Location 对象</a></li></ul></li></ul><h3 id="二、ECMAScript的变量与类型"><a href="#二、ECMAScript的变量与类型" class="headerlink" title="二、ECMAScript的变量与类型"></a>二、ECMAScript的变量与类型</h3><p>注意事项：</p><ul><li>区分大小写</li><li>变量是弱类型的</li><li>每行结尾的分号可有可无</li><li>注释与 Java、C 和 PHP 语言的注释相同<ul><li>单行注释以双斜杠开头（//）</li><li>多行注释以单斜杠和星号开头（/<em>），以星号和单斜杠结尾（</em>/）</li></ul></li><li>括号表示代码块</li><li>ECMAScript 的解释程序遇到未声明过的标识符时，用该变量名创建一个全局变量，并将其初始化为指定的值。 </li></ul><h4 id="2-1-变量声明"><a href="#2-1-变量声明" class="headerlink" title="2.1.变量声明"></a>2.1.变量声明</h4><p><strong>使用 var 运算符声明变量。</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明变量</span></span><br><span class="line"><span class="keyword">var</span> test = <span class="string">"hi"</span>;</span><br><span class="line"><span class="keyword">var</span> test = <span class="string">"hi"</span>, age = <span class="number">25</span>;</span><br><span class="line"><span class="comment">// 变量并不一定要初始化</span></span><br><span class="line"><span class="keyword">var</span> test;</span><br></pre></td></tr></table></figure><h4 id="2-2-命名变量"><a href="#2-2-命名变量" class="headerlink" title="2.2.命名变量"></a>2.2.命名变量</h4><ul><li>第一个字符必须是字母、下划线（_）或美元符号（$）</li><li>余下的字符可以是下划线、美元符号或任何字母或数字字符</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Camel 标记法:首字母是小写的，接下来的字母都以大写字符开头</span></span><br><span class="line"><span class="keyword">var</span> myTestValue = <span class="number">0</span>, mySecondValue = <span class="string">"hi"</span>;</span><br><span class="line"><span class="comment">// Pascal 标记法:首字母是大写的，接下来的字母都以大写字符开头。</span></span><br><span class="line"><span class="keyword">var</span> MyTestValue = <span class="number">0</span>, MySecondValue = <span class="string">"hi"</span>;</span><br><span class="line"><span class="comment">// 匈牙利类型标记法:在以 Pascal 标记法命名的变量前附加一个小写字母（或小写字母序列），说明该变量的类型。</span></span><br><span class="line"><span class="keyword">var</span> iMyTestValue = <span class="number">0</span>, sMySecondValue = <span class="string">"hi"</span>;</span><br></pre></td></tr></table></figure><h4 id="2-3-关键字"><a href="#2-3-关键字" class="headerlink" title="2.3.关键字"></a>2.3.关键字</h4><p> 关键字标识了 ECMAScript 语句的开头和/或结尾。根据规定，关键字是保留的，不能用作变量名或函数名。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">break</span></span><br><span class="line"><span class="keyword">case</span></span><br><span class="line"><span class="keyword">catch</span></span><br><span class="line"><span class="keyword">continue</span></span><br><span class="line"><span class="keyword">default</span></span><br><span class="line"><span class="keyword">delete</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">finally</span></span><br><span class="line"><span class="keyword">for</span></span><br><span class="line"><span class="function"><span class="keyword">function</span></span></span><br><span class="line"><span class="function"><span class="title">if</span></span></span><br><span class="line"><span class="function"><span class="title">in</span></span></span><br><span class="line"><span class="function"><span class="title">instanceof</span></span></span><br><span class="line"><span class="function"><span class="title">new</span></span></span><br><span class="line"><span class="function"><span class="title">return</span></span></span><br><span class="line"><span class="function"><span class="title">switch</span></span></span><br><span class="line"><span class="function"><span class="title">this</span></span></span><br><span class="line"><span class="function"><span class="title">throw</span></span></span><br><span class="line"><span class="function"><span class="title">try</span></span></span><br><span class="line"><span class="function"><span class="title">typeof</span></span></span><br><span class="line"><span class="function"><span class="title">var</span></span></span><br><span class="line"><span class="function"><span class="title">void</span></span></span><br><span class="line"><span class="function"><span class="title">while</span></span></span><br><span class="line"><span class="function"><span class="title">with</span></span></span><br></pre></td></tr></table></figure><h4 id="2-4-保留字"><a href="#2-4-保留字" class="headerlink" title="2.4.保留字"></a>2.4.保留字</h4><p> 保留字在某种意思上是为将来的关键字而保留的单词。因此保留字不能被用作变量名或函数名。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">abstract</span><br><span class="line">boolean</span><br><span class="line">byte</span><br><span class="line">char</span><br><span class="line"><span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"><span class="title">const</span></span></span><br><span class="line"><span class="class"><span class="title">debugger</span></span></span><br><span class="line"><span class="class"><span class="title">double</span></span></span><br><span class="line"><span class="class"><span class="title">enum</span></span></span><br><span class="line"><span class="class"><span class="title">export</span></span></span><br><span class="line"><span class="class"><span class="keyword">extends</span></span></span><br><span class="line"><span class="class"><span class="title">final</span></span></span><br><span class="line"><span class="class"><span class="title">float</span></span></span><br><span class="line"><span class="class"><span class="title">goto</span></span></span><br><span class="line"><span class="class"><span class="title">implements</span></span></span><br><span class="line"><span class="class"><span class="title">import</span></span></span><br><span class="line"><span class="class"><span class="title">int</span></span></span><br><span class="line"><span class="class"><span class="title">interface</span></span></span><br><span class="line"><span class="class"><span class="title">long</span></span></span><br><span class="line"><span class="class"><span class="title">native</span></span></span><br><span class="line"><span class="class"><span class="title">package</span></span></span><br><span class="line"><span class="class"><span class="title">private</span></span></span><br><span class="line"><span class="class"><span class="title">protected</span></span></span><br><span class="line"><span class="class"><span class="title">public</span></span></span><br><span class="line"><span class="class"><span class="title">short</span></span></span><br><span class="line"><span class="class"><span class="title">static</span></span></span><br><span class="line"><span class="class"><span class="title">super</span></span></span><br><span class="line"><span class="class"><span class="title">synchronized</span></span></span><br><span class="line"><span class="class"><span class="title">throws</span></span></span><br><span class="line"><span class="class"><span class="title">transient</span></span></span><br><span class="line"><span class="class"><span class="title">volatile</span></span></span><br></pre></td></tr></table></figure><h4 id="2-5-原始值"><a href="#2-5-原始值" class="headerlink" title="2.5.原始值"></a>2.5.原始值</h4><p>原始值：存储在栈（stack）中的简单数据段，也就是说，它们的值直接存储在变量访问的位置。</p><ul><li>Undefined： 当声明的变量未初始化时，该变量的默认值 </li><li>Null： 表示尚未存在的对象 </li><li>Boolean：  true 和 false </li><li>Number ： <ul><li>32 位的整数</li><li>64 位的浮点数</li><li>八进制和十六进制</li><li>特殊 ： Number.MAX_VALUE 、Number.MIN_VALUE ；Number.POSITIVE_INFINITY（ 生成的数大于Number.Max_VALUE ）和Number.NEGATIVE_INFINITY （ 生成的数值小于 Number.MIN_VALUE ）； NaN （ 类型 String、Boolean 转换失败 ）</li></ul></li><li>String 型 ：由双引号（”）或单引号（’）声明的。字符字面量</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 类型检查</span></span><br><span class="line"><span class="keyword">var</span> sTemp = <span class="string">"test string"</span>;</span><br><span class="line">alert (<span class="keyword">typeof</span> sTemp);    <span class="comment">//输出 "string"</span></span><br><span class="line">alert (<span class="keyword">typeof</span> <span class="number">86</span>);    <span class="comment">//输出 "number"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 所有整数都可以表示为八进制或十六进制的字面量，但所有数学运算返回的都是十进制结果。</span></span><br><span class="line"><span class="keyword">var</span> iNum = <span class="number">070</span>;  <span class="comment">//070 等于十进制的 56</span></span><br><span class="line"><span class="keyword">var</span> iNum = <span class="number">0x1f</span>;  <span class="comment">//0x1f 等于十进制的 31</span></span><br><span class="line"><span class="comment">// 对于浮点字面量的有趣之处在于，用它进行计算前，真正存储的是字符串。</span></span><br><span class="line"><span class="keyword">var</span> fNum = <span class="number">5.0</span>;</span><br><span class="line"><span class="comment">// 科学计数法</span></span><br><span class="line"><span class="keyword">var</span> fNum = <span class="number">5.618e7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sColor1 = <span class="string">"red"</span>;</span><br><span class="line"><span class="keyword">var</span> sColor2 = <span class="string">'red'</span>;</span><br></pre></td></tr></table></figure><h4 id="2-6-引用值"><a href="#2-6-引用值" class="headerlink" title="2.6.引用值"></a>2.6.引用值</h4><p>引用值：存储在堆（heap）中的对象，也就是说，存储在变量处的值是一个指针（point），指向存储对象的内存处。通常叫做类（class）。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br></pre></td></tr></table></figure><ul><li>属性<ul><li>constructor：对创建对象的函数的引用（指针）。对于 Object 对象，该指针指向原始的 Object() 函数。</li><li>Prototype：对该对象的对象原型的引用。对于所有的对象，它默认返回 Object 对象的一个实例。</li></ul></li><li>方法<ul><li>hasOwnProperty(property)：判断对象是否有某个特定的属性。必须用字符串指定该属性。</li><li>IsPrototypeOf(object)：判断该对象是否为另一个对象的原型。</li><li>PropertyIsEnumerable：判断给定的属性是否可以用 for…in 语句进行枚举。</li><li>ToString()：返回对象的原始字符串表示。</li><li>ValueOf()：返回最适合该对象的原始值。</li></ul></li><li>类型<ul><li>Boolean 对象 ：用于提供将布尔值转换成字符串</li><li>Number 对象 ：用于提供将布尔值转换成数字<ul><li>toFixed() 方法 ：返回的是具有指定位数小数的数字的字符串</li><li>toExponential() 方法：返回的是用科学计数法表示的数字的字符串形式。</li><li>toPrecision() 方法：返回数字的预定形式或指数形式</li></ul></li><li>String 对象<ul><li>length 属性：符串中的字符个数</li><li>charAt(position)：获取字符串中的单个字符</li><li>charCodeAt(position)  ：获取字符串中的单个字符</li><li>concat()：把一个或多个字符串连接到 String 对象的原始值上</li><li>indexOf()：从字符串的开头（位置 0）开始检索字符串，返回位置值</li><li>lastIndexOf()：从字符串的结尾开始检索子串，返回位置值</li><li>localeCompare()：对字符串进行对比，入参大于对象返回1，等于返回0，小于返回-1</li><li>slice() ：截取字符串</li><li>substring()：截取字符串，会把负数作为0，把较小的数字作为起始位，较大的数字作为终止位。</li><li>toLowerCase()：小写</li><li>toLocaleLowerCase()：特定区域小写，建议是使用</li><li>toUpperCase()：大写</li><li>toLocaleUpperCase()：特定区域大写，建议是使用</li></ul></li></ul></li></ul><h4 id="2-7-类型转换"><a href="#2-7-类型转换" class="headerlink" title="2.7.类型转换"></a>2.7.类型转换</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转换成字符串</span></span><br><span class="line"><span class="keyword">var</span> bFound = <span class="literal">false</span>;</span><br><span class="line">alert(bFound.toString());<span class="comment">//输出 "false"</span></span><br><span class="line"><span class="keyword">var</span> iNum = <span class="number">10</span>;</span><br><span class="line">alert(iNum.toString(<span class="number">2</span>));<span class="comment">//输出 "1010"</span></span><br><span class="line">alert(iNum.toString(<span class="number">8</span>));<span class="comment">//输出 "12"</span></span><br><span class="line">alert(iNum.toString(<span class="number">16</span>));<span class="comment">//输出 "A"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换成整数</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">parseInt</span>(<span class="string">"12345red"</span>);<span class="comment">//返回 12345</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">parseInt</span>(<span class="string">"0xA"</span>);<span class="comment">//返回 10</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">parseInt</span>(<span class="string">"56.9"</span>);<span class="comment">//返回 56</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">parseInt</span>(<span class="string">"red"</span>);<span class="comment">//返回 NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换成浮点型</span></span><br><span class="line"><span class="keyword">var</span> fNum1 = <span class="built_in">parseFloat</span>(<span class="string">"12345red"</span>);<span class="comment">//返回 12345</span></span><br><span class="line"><span class="keyword">var</span> fNum2 = <span class="built_in">parseFloat</span>(<span class="string">"0xA"</span>);<span class="comment">//返回 NaN</span></span><br><span class="line"><span class="keyword">var</span> fNum3 = <span class="built_in">parseFloat</span>(<span class="string">"11.2"</span>);<span class="comment">//返回 11.2</span></span><br><span class="line"><span class="keyword">var</span> fNum4 = <span class="built_in">parseFloat</span>(<span class="string">"11.22.33"</span>);<span class="comment">//返回 11.22</span></span><br><span class="line"><span class="keyword">var</span> fNum5 = <span class="built_in">parseFloat</span>(<span class="string">"0102"</span>);<span class="comment">//返回 102</span></span><br><span class="line"><span class="keyword">var</span> fNum1 = <span class="built_in">parseFloat</span>(<span class="string">"red"</span>);<span class="comment">//返回 NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 强转</span></span><br><span class="line"><span class="comment">// 转换成布尔型</span></span><br><span class="line"><span class="keyword">var</span> b1 = <span class="built_in">Boolean</span>(<span class="string">""</span>);<span class="comment">//false - 空字符串</span></span><br><span class="line"><span class="keyword">var</span> b2 = <span class="built_in">Boolean</span>(<span class="string">"hello"</span>);<span class="comment">//true - 非空字符串</span></span><br><span class="line"><span class="keyword">var</span> b1 = <span class="built_in">Boolean</span>(<span class="number">50</span>);<span class="comment">//true - 非零数字</span></span><br><span class="line"><span class="keyword">var</span> b1 = <span class="built_in">Boolean</span>(<span class="literal">null</span>);<span class="comment">//false - null</span></span><br><span class="line"><span class="keyword">var</span> b1 = <span class="built_in">Boolean</span>(<span class="number">0</span>);<span class="comment">//false - 零</span></span><br><span class="line"><span class="keyword">var</span> b1 = <span class="built_in">Boolean</span>(<span class="keyword">new</span> object());<span class="comment">//true - 对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换成数字</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="literal">false</span>)<span class="comment">//0</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="literal">true</span>)<span class="comment">//1</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="literal">undefined</span>)<span class="comment">//NaN</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="literal">null</span>)<span class="comment">//0</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="string">"1.2"</span>)<span class="comment">//1.2</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="string">"12"</span>)<span class="comment">//12</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="string">"1.2.3"</span>)<span class="comment">//NaN</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="keyword">new</span> object())<span class="comment">//NaN</span></span><br><span class="line"><span class="keyword">var</span> iNum1 = <span class="built_in">Number</span>(<span class="number">50</span>)<span class="comment">//50</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换成字符串</span></span><br><span class="line"><span class="keyword">var</span> s1 = <span class="built_in">String</span>(<span class="literal">null</span>);<span class="comment">//"null"</span></span><br><span class="line"><span class="keyword">var</span> oNull = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> s2 = oNull.toString();<span class="comment">//会引发错误</span></span><br></pre></td></tr></table></figure><h4 id="2-8-类型转换"><a href="#2-8-类型转换" class="headerlink" title="2.8.类型转换"></a>2.8.类型转换</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// instanceof 判断类型</span></span><br><span class="line"><span class="keyword">var</span> oStringObject = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"hello world"</span>);</span><br><span class="line">alert(oStringObject <span class="keyword">instanceof</span> <span class="built_in">String</span>);<span class="comment">//输出 "true"</span></span><br></pre></td></tr></table></figure><h3 id="三、ECMAScript的运算符"><a href="#三、ECMAScript的运算符" class="headerlink" title="三、ECMAScript的运算符"></a>三、ECMAScript的运算符</h3><h4 id="一元运算符"><a href="#一元运算符" class="headerlink" title="一元运算符"></a>一元运算符</h4><p><strong>一元运算符只有一个参数，即要操作的对象或值。</strong> </p><ul><li>delete:运算符删除对以前定义的对象属性或方法的引用。 </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line">o.name = <span class="string">"David"</span>;</span><br><span class="line">alert(o.name);<span class="comment">//输出 "David"</span></span><br><span class="line"><span class="keyword">delete</span> o.name;</span><br><span class="line">alert(o.name);<span class="comment">//输出 "undefined"</span></span><br></pre></td></tr></table></figure><ul><li>void: 对任何值返回 undefined , 该运算符通常用于避免输出不应该输出的值 </li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(window.open('about:blank'))"</span>&gt;</span>Click me<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>前增量/前减量运算符: 注意增量和减量运算符都发生在计算表达式之前</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iNum = <span class="number">10</span>;</span><br><span class="line">++iNum;</span><br><span class="line">alert(iNum);<span class="comment">//输出 "11"</span></span><br><span class="line">--iNum;</span><br><span class="line">alert(iNum);<span class="comment">//输出 "10"</span></span><br><span class="line">alert(--iNum);<span class="comment">//输出 "9"</span></span><br><span class="line">alert(iNum);<span class="comment">//输出 "9"</span></span><br></pre></td></tr></table></figure><ul><li>后增量/后减量运算符:在计算过包含它们的表达式后才进行增量或减量运算的。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iNum = <span class="number">10</span>;</span><br><span class="line">iNum++;</span><br><span class="line">alert(iNum);<span class="comment">//输出 "11"</span></span><br><span class="line">iNum--;</span><br><span class="line">alert(iNum);<span class="comment">//输出 "10"</span></span><br><span class="line">alert(iNum--);<span class="comment">//输出 "10"</span></span><br><span class="line">alert(iNum);<span class="comment">//输出 "9"</span></span><br></pre></td></tr></table></figure><ul><li>一元加法和一元减法：对数字无任何影响，会把字符串转换成数字</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sNum = <span class="string">"20"</span>;</span><br><span class="line">alert(<span class="keyword">typeof</span> sNum);<span class="comment">//输出 "string"</span></span><br><span class="line"><span class="keyword">var</span> iNum = +sNum;</span><br><span class="line">alert(<span class="keyword">typeof</span> iNum);<span class="comment">//输出 "number"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sNum = <span class="string">"20"</span>;</span><br><span class="line">alert(<span class="keyword">typeof</span> sNum);<span class="comment">//输出 "string"</span></span><br><span class="line"><span class="keyword">var</span> iNum = -sNum;</span><br><span class="line">alert(iNum);<span class="comment">//输出 "-20"</span></span><br><span class="line">alert(<span class="keyword">typeof</span> iNum);<span class="comment">//输出 "number"</span></span><br></pre></td></tr></table></figure><h4 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h4><p>在数字底层（即表示数字的 32 个数位）进行操作的。</p><p>ECMAScript 整数有两种类型，即有符号整数（允许用正数和负数）和无符号整数（只允许用正数）。</p><p><img src="/image/JavaScript04/ct_js_integer_binary_signed_32bits.png" alt=""></p><p><strong>注意：所有整数字面量都默认存储为有符号整数。只有 ECMAScript 的位运算符才能创建无符号整数。</strong></p><ul><li>NOT：由否定号（~）表示<ul><li>把运算数转换成 32 位数字</li><li>把二进制数转换成它的二进制反码</li><li>把二进制数转换成浮点数</li></ul></li><li>AND：由和号（&amp;）表示</li><li>OR：由符号（|）表示</li><li>XOR： 由符号（^）表示，当只有一个数位存放的是 1 时，它才返回 1。</li><li>左移运算：由两个小于号表示（&lt;&lt;），数字中的所有数位向左移动指定的数量。</li><li>有符号右移运算：由两个大于号表示（&gt;&gt;），把 32 位数字中的所有数位整体右移，同时保留该数的符号（正号或负号）。负数（正数求反+1；带符号位移，左侧空位补1，-1求反，补充符号信息）</li><li>无符号右移运算：由三个大于号（&gt;&gt;&gt;）表示，它将无符号 32 位数的所有数位整体右移。</li></ul><h4 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h4><p>逻辑运算符有三种：</p><ul><li>NOT：！表示</li><li>AND：&amp;&amp; 表示</li><li>OR：|| 表示</li></ul><table><thead><tr><th style="text-align:left">参数类型</th><th style="text-align:left">结果</th></tr></thead><tbody><tr><td style="text-align:left">Undefined</td><td style="text-align:left">false</td></tr><tr><td style="text-align:left">Null</td><td style="text-align:left">false</td></tr><tr><td style="text-align:left">Boolean</td><td style="text-align:left">结果等于输入的参数（不转换）</td></tr><tr><td style="text-align:left">Number</td><td style="text-align:left">如果参数为 +0, -0 或 NaN，则结果为 false；否则为 true。</td></tr><tr><td style="text-align:left">String</td><td style="text-align:left">如果参数为空字符串，则结果为 false；否则为 true。</td></tr><tr><td style="text-align:left">Object</td><td style="text-align:left">true</td></tr></tbody></table><h4 id="乘性运算符"><a href="#乘性运算符" class="headerlink" title="乘性运算符"></a>乘性运算符</h4><ul><li>乘法运算符：由星号（*）表示，用于两数相乘。</li><li>除法运算符：由斜杠（/）表示，用第二个运算数除第一个运算数：</li><li>取模（余数）运算符：由百分号（%）表示<ul><li>如果被除数是 无穷大的数，或除数是 0，结果为 NaN。</li><li>无穷大的数 被 无穷大的数 除，结果为 NaN。</li><li>如果除数是无穷大的数，结果为被除数。</li><li>如果被除数为 0，结果为 0。     </li></ul></li></ul><h4 id="加性运算符"><a href="#加性运算符" class="headerlink" title="加性运算符"></a>加性运算符</h4><ul><li>加法运算符：由加号（+）表示<ul><li>某个运算数是 NaN，那么结果为 NaN。</li><li>-Infinity 加 -Infinity，结果为 -Infinity。</li><li>Infinity 加 -Infinity，结果为 NaN。</li><li>+0 加 +0，结果为 +0。</li><li>-0 加 +0，结果为 +0。</li><li>-0 加 -0，结果为 -0。</li><li>如果两个运算数都是字符串，把第二个字符串连接到第一个上。</li><li>如果只有一个运算数是字符串，把另一个运算数转换成字符串，结果是两个字符串连接成的字符串。</li></ul></li><li>减法运算符：由加号（-）表示<ul><li>某个运算数是 NaN，那么结果为 NaN。</li><li>Infinity 减 Infinity，结果为 NaN。</li><li>-Infinity 减 -Infinity，结果为 NaN。</li><li>Infinity 减 -Infinity，结果为 Infinity。</li><li>-Infinity 减 Infinity，结果为 -Infinity。</li><li>+0 减 +0，结果为 +0。</li><li>-0 减 -0，结果为 -0。</li><li>+0 减 -0，结果为 +0。</li><li>某个运算符不是数字，那么结果为 NaN。</li></ul></li></ul><h4 id="关系运算符"><a href="#关系运算符" class="headerlink" title="关系运算符"></a>关系运算符</h4><p>关系运算符小于、大于、小于等于和大于等于执行的是两个数的比较运算，每个关系运算符都返回一个布尔值。</p><ul><li>字符串相互比较：从左到右开始比较 字符串的ASCII大小</li><li>字符串和数字比较：把字符串转换成数字再比较大小，如果非数字字符串会转换为NaN，包含NaN结果为false</li></ul><h4 id="等性运算符"><a href="#等性运算符" class="headerlink" title="等性运算符"></a>等性运算符</h4><p>等号和非等号用于处理原始值，全等号和非全等号用于处理对象。</p><ul><li>等号：由双等号（==）表示，当且仅当两个运算数相等时，它返回 true。</li><li>非等号：由感叹号加等号（!=）表示，当且仅当两个运算数不相等时，它返回 true。</li></ul><p>为确定两个运算数是否相等，这两个运算符都会进行类型转换。执行类型转换的规则如下：</p><ul><li>如果一个运算数是 Boolean 值，在检查相等性之前，把它转换成数字值。false 转换成 0，true 为 1。</li><li>如果一个运算数是字符串，另一个是数字，在检查相等性之前，要尝试把字符串转换成数字。</li><li>如果一个运算数是对象，另一个是字符串，在检查相等性之前，要尝试把对象转换成字符串。</li><li>如果一个运算数是对象，另一个是数字，在检查相等性之前，要尝试把对象转换成数字</li></ul><p>在比较时，该运算符还遵守下列规则：</p><ul><li>值 null 和 undefined 相等。</li><li>在检查相等性时，不能把 null 和 undefined 转换成其他值。</li><li>如果某个运算数是 NaN，等号将返回 false，非等号将返回 true。</li><li><p>如果两个运算数都是对象，那么比较的是它们的引用值。如果两个运算数指向同一对象，那么等号返回 true，否则两个运算数不等。</p></li><li><p>全等号：由三个等号表示（===），只有在无需类型转换运算数就相等的情况下，才返回 true。</p></li><li>非全等号：由感叹号加两个等号（!==）表示，只有在无需类型转换运算数不相等的情况下，才返回 true。</li></ul><h4 id="条件运算符"><a href="#条件运算符" class="headerlink" title="条件运算符"></a>条件运算符</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable = boolean_expression ? true_value : false_value;</span><br></pre></td></tr></table></figure><p>该表达式主要是根据 <em>boolean_expression</em> 的计算结果有条件地为变量赋值。如果 <em>Boolean_expression</em> 为 true，就把 <em>true_value</em> 赋给变量；如果它是 false，就把 <em>false_value</em> 赋给变量。 </p><h4 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h4><p>赋值运算符由等号（=）实现，只是把等号右边的值赋予等号左边的变量。 </p><ul><li>简单赋值 (=)</li><li>乘法/赋值（*=）</li><li>除法/赋值（/=）</li><li>取模/赋值（%=）</li><li>加法/赋值（+=）</li><li>减法/赋值（-=）</li><li>左移/赋值（&lt;&lt;=）</li><li>有符号右移/赋值（&gt;&gt;=）</li><li>无符号右移/赋值（&gt;&gt;&gt;=）</li></ul><h4 id="逗号运算符"><a href="#逗号运算符" class="headerlink" title="逗号运算符"></a>逗号运算符</h4><p>用逗号运算符可以在一条语句中执行多个运算。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iNum1 = <span class="number">1</span>, iNum = <span class="number">2</span>, iNum3 = <span class="number">3</span>;</span><br></pre></td></tr></table></figure><h3 id="四、ECMAScript的语句"><a href="#四、ECMAScript的语句" class="headerlink" title="四、ECMAScript的语句"></a>四、ECMAScript的语句</h3><h4 id="if-语句"><a href="#if-语句" class="headerlink" title="if 语句"></a>if 语句</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果条件计算结果为 true，则执行 statement1；如果条件计算结果为 false，则执行 statement2。</span></span><br><span class="line"><span class="keyword">if</span> (condition) statement1 <span class="keyword">else</span> statement2;</span><br><span class="line"><span class="comment">// 如果 condition1 计算结果为 true，则执行 statement1；如果 condition1 计算结果为 false且 condition2条件为 true，则执行 statement2,否则执行 statement3。</span></span><br><span class="line"><span class="keyword">if</span> (condition1) statement1 <span class="keyword">else</span> <span class="keyword">if</span> (condition2) statement2 <span class="keyword">else</span> statement3;</span><br></pre></td></tr></table></figure><p><em>condition</em> 可以是任何表达式，计算的结果甚至不必是真正的 boolean 值，ECMAScript 会把它转换成 boolean 值。 </p><h4 id="迭代语句"><a href="#迭代语句" class="headerlink" title="迭代语句"></a>迭代语句</h4><p>迭代语句又叫循环语句，声明一组要反复执行的命令，直到满足某些条件为止。</p><ul><li>do-while 语句:后测试循环，即退出条件在执行循环内部的代码之后计算。这意味着在计算表达式之前，至少会执行循环主体一次。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;statement&#125; <span class="keyword">while</span> (expression);</span><br></pre></td></tr></table></figure><ul><li>while 语句:前测试循环。这意味着退出条件是在执行循环内部的代码之前计算的。因此，循环主体可能根本不被执行。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (expression) statement</span><br></pre></td></tr></table></figure><ul><li>for 语句:前测试循环，而且在进入循环之前，能够初始化变量，并定义循环后要执行的代码。 </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (initialization; expression; post-loop-expression) statement</span><br></pre></td></tr></table></figure><p> <strong>注意：post-loop-expression 之后不能写分号，否则无法运行。 </strong> </p><ul><li>for 语句是严格的迭代语句，用于枚举对象的属性。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (property <span class="keyword">in</span> expression) statement</span><br></pre></td></tr></table></figure><h4 id="标签语句"><a href="#标签语句" class="headerlink" title="标签语句"></a>标签语句</h4><p> 用下列语句给语句加标签，以便以后调用： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label : statement</span><br></pre></td></tr></table></figure><p>配合 break 或 continue 语句使用。 </p><h4 id="break-和-continue-语句"><a href="#break-和-continue-语句" class="headerlink" title="break 和 continue 语句"></a>break 和 continue 语句</h4><ul><li>break 语句: 可以立即退出循环，阻止再次反复执行任何代码。</li><li>continue 语句: 只是退出当前循环，根据控制表达式还允许继续进行下一次循环。</li></ul><p>break 语句和 continue 语句都可以与有标签的语句联合使用，返回代码中的特定位置。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iNum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">outermost:</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> j=<span class="number">0</span>; j&lt;<span class="number">10</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">5</span> &amp;&amp; j == <span class="number">5</span>) &#123;</span><br><span class="line">    <span class="keyword">break</span> outermost;</span><br><span class="line">  &#125;</span><br><span class="line">  iNum++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alert(iNum);<span class="comment">//输出 "55"</span></span><br><span class="line"></span><br><span class="line">iNum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">outermost:</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> j=<span class="number">0</span>; j&lt;<span class="number">10</span>; j++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">5</span> &amp;&amp; j == <span class="number">5</span>) &#123;</span><br><span class="line">    <span class="keyword">continue</span> outermost;</span><br><span class="line">  &#125;</span><br><span class="line">  iNum++;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alert(iNum);<span class="comment">//输出 "95"</span></span><br></pre></td></tr></table></figure><h4 id="with-语句"><a href="#with-语句" class="headerlink" title="with 语句"></a>with 语句</h4><p> with 语句:用于设置代码在特定对象中的作用域。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> (expression) statement</span><br><span class="line"><span class="keyword">var</span> sMessage = <span class="string">"hello"</span>;</span><br><span class="line"><span class="keyword">with</span>(sMessage) &#123;</span><br><span class="line">  alert(toUpperCase());<span class="comment">//输出 "HELLO"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>提示：</strong>with 语句是运行缓慢的代码块，尤其是在已设置了属性值时。大多数情况下，如果可能，最好避免使用它。 </p><h4 id="switch-语句"><a href="#switch-语句" class="headerlink" title="switch 语句"></a>switch 语句</h4><p> switch 语句是 if 语句的兄弟语句。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (expression)</span><br><span class="line">  <span class="keyword">case</span> value: statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> value: statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> value: statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> value: statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">...</span><br><span class="line">  <span class="keyword">case</span> value: statement;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">default</span>: statement;</span><br></pre></td></tr></table></figure><h3 id="五、ECMAScript-函数"><a href="#五、ECMAScript-函数" class="headerlink" title="五、ECMAScript 函数"></a>五、ECMAScript 函数</h3><p> 函数的基本语法是这样的： </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">functionName</span>(<span class="params">arg0, arg1, ... argN</span>) </span>&#123;</span><br><span class="line">  statements <span class="comment">// 可以return 返回值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>调用函数:通过其名字加上括号中的参数进行调用，如果有多个参数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">functionName(arg0, arg1, ... argN)</span><br></pre></td></tr></table></figure><p> 特殊对象 arguments，开发者<em>无需明确指出参数名</em>，就能访问它们。 </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 例如，在函数 sayHi() 中，第一个参数是 message。用 arguments[0] 也可以访问这个值，即第一个参数的值（第一个参数位于位置 0，第二个参数位于位置 1，依此类推）。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">arguments</span>[<span class="number">0</span>] == <span class="string">"bye"</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 检测参数个数</span></span><br><span class="line">alert(<span class="built_in">arguments</span>.length);</span><br><span class="line">  alert(<span class="built_in">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用 arguments 对象判断传递给函数的参数个数，即可模拟函数重载：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doAdd</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">arguments</span>.length == <span class="number">1</span>) &#123;</span><br><span class="line">    alert(<span class="built_in">arguments</span>[<span class="number">0</span>] + <span class="number">5</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">arguments</span>.length == <span class="number">2</span>) &#123;</span><br><span class="line">    alert(<span class="built_in">arguments</span>[<span class="number">0</span>] + <span class="built_in">arguments</span>[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">doAdd(<span class="number">10</span>);<span class="comment">//输出 "15"</span></span><br><span class="line">doAdd(<span class="number">40</span>, <span class="number">20</span>);<span class="comment">//输出 "60"</span></span><br></pre></td></tr></table></figure><p>Function 对象（类）</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> function_name = <span class="keyword">new</span> <span class="function"><span class="keyword">function</span>(<span class="params">arg1, arg2, ..., argN, function_body</span>)</span></span><br><span class="line"><span class="function">// 输入参数个数</span></span><br><span class="line"><span class="function"><span class="title">function_name</span>.<span class="title">length</span></span></span><br></pre></td></tr></table></figure><p>闭包，指的是词法表示包括不被计算的变量的函数，也就是说，函数可以使用函数之外定义的变量。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 简单</span></span><br><span class="line"><span class="keyword">var</span> sMessage = <span class="string">"hello world"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHelloWorld</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(sMessage);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayHelloWorld();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> iBaseNum = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addNum</span>(<span class="params">iNum1, iNum2</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">doAdd</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> iNum1 + iNum2 + iBaseNum;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> doAdd();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="六、对象"><a href="#六、对象" class="headerlink" title="六、对象"></a>六、对象</h3><h4 id="面向对象术语"><a href="#面向对象术语" class="headerlink" title="面向对象术语"></a>面向对象术语</h4><ul><li>对象： 属性的无序集合，每个属性存放一个原始值、对象或函数 </li><li>类： 对象的抽象化。不仅要定义对象的接口（interface）（开发者访问的属性和方法），还要定义对象的内部工作（使属性和方法发挥作用的代码）。</li><li>实例： 使用类创建对象时，生成的对象叫作类的实例（instance）</li></ul><p>基本能力：</p><ul><li>封装 - 把相关的信息（无论数据或方法）存储在对象中的能力</li><li>聚集 - 把一个对象存储在另一个对象内的能力</li><li>继承 - 由另一个类（或多个类）得来类的属性和方法的能力</li><li>多态 - 编写能以多种方法运行的函数或方法的能力</li></ul><p>对象的构成：<br>对象由特性（attribute）构成，特性可以是原始值，也可以是引用值。如果特性存放的是函数，它将被看作对象的方法（method），否则该特性被看作对象的属性（property）。</p><h4 id="对象应用"><a href="#对象应用" class="headerlink" title="对象应用"></a>对象应用</h4><p>对象的创建和销毁都在 JavaScript 执行过程中发生，理解这种范式的含义对理解整个语言至关重要。</p><ul><li>声明和实例化</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oObject = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line"><span class="keyword">var</span> oStringObject = <span class="keyword">new</span> <span class="built_in">String</span>();</span><br></pre></td></tr></table></figure><ul><li>对象废除<br>ECMAScript 拥有垃圾回收程序（garbage collection routine）,把对象的所有引用都设置为 null，可以强制性地废除对象。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oObject = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line"><span class="comment">// do something with the object here</span></span><br><span class="line">oObject = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><ul><li>早绑定和晚绑定<br>所谓绑定（binding），即把对象的接口与对象实例结合在一起的方法。</li></ul><p>早绑定（early binding 静态语言）是指在实例化对象之前定义它的属性和方法，这样编译器或解释程序就能够提前转换机器代码。</p><p>晚绑定（late binding 动态语言）指的是编译器或解释程序在运行前，不知道对象的类型。</p><h4 id="对象类型"><a href="#对象类型" class="headerlink" title="对象类型"></a>对象类型</h4><ul><li>本地对象( 引用类型 ):独立于宿主环境的 ECMAScript 实现提供的对象<ul><li>Object</li><li>Function</li><li>Array</li><li>String</li><li>Boolean</li><li>Number</li><li>Date</li><li>RegExp</li><li>Error</li><li>EvalError</li><li>RangeError</li><li>ReferenceError</li><li>SyntaxError</li><li>TypeError</li><li>URIError</li></ul></li><li>内置对象:由 ECMAScript 实现提供的、独立于宿主环境的所有对象<ul><li>Global  </li><li>Math  </li></ul></li><li>宿主对象<ul><li>BOM </li><li>DOM </li></ul></li></ul><h4 id="对象作用域"><a href="#对象作用域" class="headerlink" title="对象作用域"></a>对象作用域</h4><p>ECMAScript 只有公用作用域,由于缺少私有作用域，开发者确定了一个规约，说明哪些属性和方法应该被看做私有的。这种规约规定在属性前后加下划线.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj._color_ = <span class="string">"blue"</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关键字 this 总是指向调用该方法的对象</span></span><br><span class="line"><span class="keyword">var</span> oCar = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line">oCar.color = <span class="string">"red"</span>;</span><br><span class="line">oCar.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">oCar.showColor();<span class="comment">//输出 "red"</span></span><br></pre></td></tr></table></figure><h4 id="定义类或对象"><a href="#定义类或对象" class="headerlink" title="定义类或对象"></a>定义类或对象</h4><ul><li>工厂方式</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创造了能创建并返回特定类型的对象的工厂函数（factory function）。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> oTempCar = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line">oTempCar.color = <span class="string">"blue"</span>;</span><br><span class="line">oTempCar.doors = <span class="number">4</span>;</span><br><span class="line">oTempCar.mpg = <span class="number">25</span>;</span><br><span class="line">oTempCar.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">return</span> oTempCar;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> oCar1 = createCar();</span><br><span class="line"><span class="keyword">var</span> oCar2 = createCar();</span><br></pre></td></tr></table></figure><ul><li>构造函数方式</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 名字的首字母大写，以使它与首字母通常是小写的变量名分开,使用 this 关键字。使用 new 运算符构造函数时，在执行第一行代码前先创建一个对象，只有用 this 才能访问该对象。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">sColor,iDoors,iMpg</span>) </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.color = sColor;</span><br><span class="line"><span class="keyword">this</span>.doors = iDoors;</span><br><span class="line"><span class="keyword">this</span>.mpg = iMpg;</span><br><span class="line"><span class="keyword">this</span>.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> oCar1 = <span class="keyword">new</span> Car(<span class="string">"red"</span>,<span class="number">4</span>,<span class="number">23</span>);</span><br><span class="line"><span class="keyword">var</span> oCar2 = <span class="keyword">new</span> Car(<span class="string">"blue"</span>,<span class="number">3</span>,<span class="number">25</span>);</span><br></pre></td></tr></table></figure><ul><li>原型方式</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用空构造函数来设置类名。然后所有的属性和方法都被直接赋予 prototype 属性</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car.prototype.color = <span class="string">"blue"</span>;</span><br><span class="line">Car.prototype.doors = <span class="number">4</span>;</span><br><span class="line">Car.prototype.mpg = <span class="number">25</span>;</span><br><span class="line">Car.prototype.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> oCar1 = <span class="keyword">new</span> Car();</span><br><span class="line"><span class="keyword">var</span> oCar2 = <span class="keyword">new</span> Car();</span><br><span class="line"></span><br><span class="line"><span class="comment">//不同的实例修改属性值相互影响</span></span><br><span class="line">oCar1.drivers.push(<span class="string">"Bill"</span>);</span><br><span class="line"></span><br><span class="line">alert(oCar1.drivers);<span class="comment">//输出 "Mike,John,Bill"</span></span><br><span class="line">alert(oCar2.drivers);<span class="comment">//输出 "Mike,John,Bill"</span></span><br></pre></td></tr></table></figure><ul><li>混合的构造函数/原型方式</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 所有的非函数属性都在构造函数中创建，意味着又能够用构造函数的参数赋予属性默认值了。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">sColor,iDoors,iMpg</span>) </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.color = sColor;</span><br><span class="line"><span class="keyword">this</span>.doors = iDoors;</span><br><span class="line"><span class="keyword">this</span>.mpg = iMpg;</span><br><span class="line"><span class="keyword">this</span>.drivers = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"Mike"</span>,<span class="string">"John"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Car.prototype.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> oCar1 = <span class="keyword">new</span> Car(<span class="string">"red"</span>,<span class="number">4</span>,<span class="number">23</span>);</span><br><span class="line"><span class="keyword">var</span> oCar2 = <span class="keyword">new</span> Car(<span class="string">"blue"</span>,<span class="number">3</span>,<span class="number">25</span>);</span><br><span class="line"></span><br><span class="line">oCar1.drivers.push(<span class="string">"Bill"</span>);</span><br><span class="line"></span><br><span class="line">alert(oCar1.drivers);<span class="comment">//输出 "Mike,John,Bill"</span></span><br><span class="line">alert(oCar2.drivers);<span class="comment">//输出 "Mike,John"</span></span><br></pre></td></tr></table></figure><ul><li><p>动态原型方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params">sColor,iDoors,iMpg</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.color = sColor;</span><br><span class="line">  <span class="keyword">this</span>.doors = iDoors;</span><br><span class="line">  <span class="keyword">this</span>.mpg = iMpg;</span><br><span class="line">  <span class="keyword">this</span>.drivers = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"Mike"</span>,<span class="string">"John"</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> Car._initialized == <span class="string">"undefined"</span>) &#123;</span><br><span class="line">    Car.prototype.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      alert(<span class="keyword">this</span>.color);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    Car._initialized = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>混合工厂方式</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Car</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> oTempCar = <span class="keyword">new</span> <span class="built_in">Object</span>;</span><br><span class="line">oTempCar.color = <span class="string">"blue"</span>;</span><br><span class="line">oTempCar.doors = <span class="number">4</span>;</span><br><span class="line">oTempCar.mpg = <span class="number">25</span>;</span><br><span class="line">oTempCar.showColor = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> oTempCar;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> car = <span class="keyword">new</span> Car();</span><br></pre></td></tr></table></figure><h4 id="修改对象"><a href="#修改对象" class="headerlink" title="修改对象"></a>修改对象</h4><ul><li>创建新方法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过已有的方法创建新方法</span></span><br><span class="line"><span class="built_in">Number</span>.prototype.toHexString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.toString(<span class="number">16</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> iNum = <span class="number">15</span>;</span><br><span class="line">alert(iNum.toHexString());<span class="comment">//输出 "F"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 重命名已有方法</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.enqueue = <span class="function"><span class="keyword">function</span>(<span class="params">vItem</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.push(vItem);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Array</span>.prototype.dequeue = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.shift();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加与已有方法无关的方法</span></span><br><span class="line"><span class="built_in">Array</span>.prototype.indexOf = <span class="function"><span class="keyword">function</span> (<span class="params">vItem</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="keyword">this</span>.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (vItem == <span class="keyword">this</span>[i]) &#123;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> aColors = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"red"</span>,<span class="string">"green"</span>,<span class="string">"blue"</span>);</span><br><span class="line">alert(aColors.indexOf(<span class="string">"green"</span>));<span class="comment">//输出 "1"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 为本地对象添加新方法</span></span><br><span class="line"><span class="built_in">Object</span>.prototype.showValue = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="keyword">this</span>.valueOf());</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"hello"</span>;</span><br><span class="line"><span class="keyword">var</span> iNum = <span class="number">25</span>;</span><br><span class="line">str.showValue();<span class="comment">//输出 "hello"</span></span><br><span class="line">iNum.showValue();<span class="comment">//输出 "25"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 重定义已有方法</span></span><br><span class="line"><span class="built_in">Function</span>.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">"Function code hidden"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sayHi</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  alert(<span class="string">"hi"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">alert(sayHi.toString());<span class="comment">//输出 "Function code hidden"</span></span><br></pre></td></tr></table></figure><h3 id="七、继承机制实例"><a href="#七、继承机制实例" class="headerlink" title="七、继承机制实例"></a>七、继承机制实例</h3><h4 id="对象冒充"><a href="#对象冒充" class="headerlink" title="对象冒充"></a>对象冒充</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数使用 this 关键字给所有属性和方法赋值（即采用类声明的构造函数方式）。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassA</span>(<span class="params">sColor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.color = sColor;</span><br><span class="line">    <span class="keyword">this</span>.sayColor = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.color);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassB</span>(<span class="params">sColor, sName</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.newMethod = ClassA;</span><br><span class="line">    <span class="keyword">this</span>.newMethod(sColor);</span><br><span class="line">    <span class="keyword">delete</span> <span class="keyword">this</span>.newMethod;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.name = sName;</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="call"><a href="#call" class="headerlink" title="call()"></a>call()</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 与经典的对象冒充方法最相似的方法。它的第一个参数用作 this 的对象。其他参数都直接传递给函数自身。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassB</span>(<span class="params">sColor, sName</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//this.newMethod = ClassA;</span></span><br><span class="line">    <span class="comment">//this.newMethod(color);</span></span><br><span class="line">    <span class="comment">//delete this.newMethod;</span></span><br><span class="line">    ClassA.call(<span class="keyword">this</span>, sColor);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.name = sName;</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="apply"><a href="#apply" class="headerlink" title="apply()"></a>apply()</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有两个参数，用作 this 的对象和要传递给函数的参数的数组</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassB</span>(<span class="params">sColor, sName</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//this.newMethod = ClassA;</span></span><br><span class="line">    <span class="comment">//this.newMethod(color);</span></span><br><span class="line">    <span class="comment">//delete this.newMethod;</span></span><br><span class="line">    ClassA.apply(<span class="keyword">this</span>, <span class="keyword">new</span> <span class="built_in">Array</span>(sColor)); <span class="comment">// 或 ClassA.apply(this, arguments);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.name = sName;</span><br><span class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassA</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ClassA.prototype.color = <span class="string">"blue"</span>;</span><br><span class="line">ClassA.prototype.sayColor = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassB</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ClassB.prototype = <span class="keyword">new</span> ClassA();</span><br><span class="line"></span><br><span class="line">ClassB.prototype.name = <span class="string">""</span>;</span><br><span class="line">ClassB.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> objA = <span class="keyword">new</span> ClassA();</span><br><span class="line"><span class="keyword">var</span> objB = <span class="keyword">new</span> ClassB();</span><br><span class="line">objA.color = <span class="string">"blue"</span>;</span><br><span class="line">objB.color = <span class="string">"red"</span>;</span><br><span class="line">objB.name = <span class="string">"John"</span>;</span><br><span class="line">objA.sayColor();</span><br><span class="line">objB.sayColor();</span><br><span class="line">objB.sayName();</span><br></pre></td></tr></table></figure><h4 id="混合方式"><a href="#混合方式" class="headerlink" title="混合方式"></a>混合方式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassA</span>(<span class="params">sColor</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.color = sColor;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ClassA.prototype.sayColor = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.color);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ClassB</span>(<span class="params">sColor, sName</span>) </span>&#123;</span><br><span class="line">    ClassA.call(<span class="keyword">this</span>, sColor);</span><br><span class="line">    <span class="keyword">this</span>.name = sName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ClassB.prototype = <span class="keyword">new</span> ClassA();</span><br><span class="line"></span><br><span class="line">ClassB.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    alert(<span class="keyword">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> objA = <span class="keyword">new</span> ClassA(<span class="string">"blue"</span>);</span><br><span class="line"><span class="keyword">var</span> objB = <span class="keyword">new</span> ClassB(<span class="string">"red"</span>, <span class="string">"John"</span>);</span><br><span class="line">objA.sayColor();<span class="comment">//输出 "blue"</span></span><br><span class="line">objB.sayColor();<span class="comment">//输出 "red"</span></span><br><span class="line">objB.sayName();<span class="comment">//输出 "John"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://www.w3school.com.cn/js/pro_js_operators_boolean.asp" target="_blank" rel="noopener">ECMAScript</a> </p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JavaScript（三）JavaScript的基本知识(下)</title>
      <link href="/2016/12/15/JavaScript03/"/>
      <url>/2016/12/15/JavaScript03/</url>
      <content type="html"><![CDATA[<p>　　本文章主要介绍 JavaScript 的相关知识。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、execCommand函数命令"><a href="#一、execCommand函数命令" class="headerlink" title="一、execCommand函数命令"></a>一、execCommand函数命令</h3><p>execCommand方法是执行一个对当前文档，当前选择或者给出范围的命令。处理Html数据时常用</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.execCommand(sCommand[,交互方式, 动态参数])</span><br></pre></td></tr></table></figure><ul><li>sCommand为指令参数（如下例中的”2D-Position”）</li><li>交互方式参数如果是true的话将显示对话框，如果为false的话，则不显示对话框</li><li>动态参数一般为一可用值或属性值（如下例中的”true”）。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.execCommand(<span class="string">"2D-Position"</span>,<span class="string">"false"</span>,<span class="string">"true"</span>);</span><br></pre></td></tr></table></figure><h4 id="1-1-指令参数及意义"><a href="#1-1-指令参数及意义" class="headerlink" title="1.1.指令参数及意义"></a>1.1.指令参数及意义</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">2D-Position 允许通过拖曳移动绝对定位的对象。</span><br><span class="line">AbsolutePosition 设定元素的 position 属性为“absolute”(绝对)。</span><br><span class="line">BackColor 设置或获取当前选中区的背景颜色。</span><br><span class="line">BlockDirLTR 目前尚未支持。</span><br><span class="line">BlockDirRTL 目前尚未支持。</span><br><span class="line">Bold 切换当前选中区的粗体显示与否。</span><br><span class="line">BrowseMode 目前尚未支持。</span><br><span class="line">Copy 将当前选中区复制到剪贴板。</span><br><span class="line">CreateBookmark 创建一个书签锚或获取当前选中区或插入点的书签锚的名称。</span><br><span class="line">CreateLink 在当前选中区上插入超级链接，或显示一个对话框允许用户指定要为当前选中区插入的超级链接的 URL。</span><br><span class="line">Cut 将当前选中区复制到剪贴板并删除之。</span><br><span class="line">Delete 删除当前选中区。</span><br><span class="line">DirLTR 目前尚未支持。</span><br><span class="line">DirRTL 目前尚未支持。</span><br><span class="line">EditMode 目前尚未支持。</span><br><span class="line">FontName 设置或获取当前选中区的字体。</span><br><span class="line">FontSize 设置或获取当前选中区的字体大小。</span><br><span class="line">ForeColor 设置或获取当前选中区的前景(文本)颜色。</span><br><span class="line">FormatBlock 设置当前块格式化标签。</span><br><span class="line">Indent 增加选中文本的缩进。</span><br><span class="line">InlineDirLTR 目前尚未支持。</span><br><span class="line">InlineDirRTL 目前尚未支持。</span><br><span class="line">InsertButton 用按钮控件覆盖当前选中区。</span><br><span class="line">InsertFieldset 用方框覆盖当前选中区。</span><br><span class="line">InsertHorizontalRule 用水平线覆盖当前选中区。</span><br><span class="line">InsertIFrame 用内嵌框架覆盖当前选中区。</span><br><span class="line">InsertImage 用图像覆盖当前选中区。</span><br><span class="line">InsertInputButton 用按钮控件覆盖当前选中区。</span><br><span class="line">InsertInputCheckbox 用复选框控件覆盖当前选中区。</span><br><span class="line">InsertInputFileUpload 用文件上载控件覆盖当前选中区。</span><br><span class="line">InsertInputHidden 插入隐藏控件覆盖当前选中区。</span><br><span class="line">InsertInputImage 用图像控件覆盖当前选中区。</span><br><span class="line">InsertInputPassword 用密码控件覆盖当前选中区。</span><br><span class="line">InsertInputRadio 用单选钮控件覆盖当前选中区。</span><br><span class="line">InsertInputReset 用重置控件覆盖当前选中区。</span><br><span class="line">InsertInputSubmit 用提交控件覆盖当前选中区。</span><br><span class="line">InsertInputText 用文本控件覆盖当前选中区。</span><br><span class="line">InsertMarquee 用空字幕覆盖当前选中区。</span><br><span class="line">InsertOrderedList 切换当前选中区是编号列表还是常规格式化块。</span><br><span class="line">InsertParagraph 用换行覆盖当前选中区。</span><br><span class="line">InsertSelectDropdown 用下拉框控件覆盖当前选中区。</span><br><span class="line">InsertSelectListbox 用列表框控件覆盖当前选中区。</span><br><span class="line">InsertTextArea 用多行文本输入控件覆盖当前选中区。</span><br><span class="line">InsertUnorderedList 切换当前选中区是项目符号列表还是常规格式化块。</span><br><span class="line">Italic 切换当前选中区斜体显示与否。</span><br><span class="line">JustifyCenter 将当前选中区在所在格式化块置中。</span><br><span class="line">JustifyFull 目前尚未支持。</span><br><span class="line">JustifyLeft 将当前选中区所在格式化块左对齐。</span><br><span class="line">JustifyNone 目前尚未支持。</span><br><span class="line">JustifyRight 将当前选中区所在格式化块右对齐。</span><br><span class="line">LiveResize 迫使 MSHTML 编辑器在缩放或移动过程中持续更新元素外观，而不是只在移动或缩放完成后更新。</span><br><span class="line">MultipleSelection 允许当用户按住 Shift 或 Ctrl 键时一次选中多于一个站点可选元素。</span><br><span class="line">Open 目前尚未支持。</span><br><span class="line">Outdent 减少选中区所在格式化块的缩进。</span><br><span class="line">OverWrite 切换文本状态的插入和覆盖。</span><br><span class="line">Paste 用剪贴板内容覆盖当前选中区。</span><br><span class="line">PlayImage 目前尚未支持。</span><br><span class="line">Print 打开打印对话框以便用户可以打印当前页。</span><br><span class="line">Redo 目前尚未支持。</span><br><span class="line">Refresh 刷新当前文档。</span><br><span class="line">RemoveFormat 从当前选中区中删除格式化标签。</span><br><span class="line">RemoveParaFormat 目前尚未支持。</span><br><span class="line">SaveAs 将当前 Web 页面保存为文件。</span><br><span class="line">SelectAll 选中整个文档。</span><br><span class="line">SizeToControl 目前尚未支持。</span><br><span class="line">SizeToControlHeight 目前尚未支持。</span><br><span class="line">SizeToControlWidth 目前尚未支持。</span><br><span class="line">Stop 目前尚未支持。</span><br><span class="line">StopImage 目前尚未支持。</span><br><span class="line">StrikeThrough 目前尚未支持。</span><br><span class="line">Subscript 目前尚未支持。</span><br><span class="line">Superscript 目前尚未支持。</span><br><span class="line">UnBookmark 从当前选中区中删除全部书签。</span><br><span class="line">Underline 切换当前选中区的下划线显示与否。</span><br><span class="line">Undo 目前尚未支持。</span><br><span class="line">Unlink 从当前选中区中删除全部超级链接。</span><br><span class="line">Unselect 清除当前选中区的选中状态。</span><br></pre></td></tr></table></figure><h3 id="二、库"><a href="#二、库" class="headerlink" title="二、库"></a>二、库</h3><h4 id="2-1-jQuery"><a href="#2-1-jQuery" class="headerlink" title="2.1.jQuery"></a>2.1.jQuery</h4><p>jQuery 是目前最受欢迎的 JavaScript 框架。<br>它使用 CSS 选择器来访问和操作网页上的 HTML 元素（DOM 对象）。<br>jQuery 同时提供 companion UI（用户界面）和插件。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JavaScript </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> obj=<span class="built_in">document</span>.getElementById(<span class="string">"h01"</span>);</span><br><span class="line">    obj.innerHTML=<span class="string">"Hello jQuery"</span>;</span><br><span class="line">&#125;</span><br><span class="line">onload=myFunction;</span><br><span class="line"></span><br><span class="line"><span class="comment">//jQuery </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $(<span class="string">"#h01"</span>).html(<span class="string">"Hello jQuery"</span>);</span><br><span class="line">&#125;</span><br><span class="line">$(<span class="built_in">document</span>).ready(myFunction);</span><br></pre></td></tr></table></figure><h4 id="2-2-Prototype"><a href="#2-2-Prototype" class="headerlink" title="2.2.Prototype"></a>2.2.Prototype</h4><p>Prototype 提供的函数可使 HTML DOM 编程更容易。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JavaScript </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> obj=<span class="built_in">document</span>.getElementById(<span class="string">"h01"</span>);</span><br><span class="line">    obj.innerHTML=<span class="string">"Hello Prototype"</span>;</span><br><span class="line">&#125;</span><br><span class="line">onload=myFunction;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Prototype </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $(<span class="string">"h01"</span>).insert(<span class="string">"Hello Prototype!"</span>);</span><br><span class="line">&#125;</span><br><span class="line">Event.observe(<span class="built_in">window</span>,<span class="string">"load"</span>,myFunction);</span><br></pre></td></tr></table></figure><h4 id="2-3-MooTools"><a href="#2-3-MooTools" class="headerlink" title="2.3.MooTools"></a>2.3.MooTools</h4><p>虽然Mootools跟Prototype几乎拥有一样的语法，但是它提供了比Prototype多的功能，而且更强大，拥有实用而清晰的文档和示例帮助你轻松入门。</p><h3 id="二、调试"><a href="#二、调试" class="headerlink" title="二、调试"></a>二、调试</h3><h4 id="2-1-开启调试"><a href="#2-1-开启调试" class="headerlink" title="2.1.开启调试"></a>2.1.开启调试</h4><ul><li>Chrome 浏览器<ul><li>打开浏览器。</li><li>在菜单中选择工具。</li><li>在工具中选择开发者工具。</li><li>最后，选择 Console。</li></ul></li><li>Firefox 浏览器<ul><li>打开浏览器。</li><li>访问页面:<a href="http://www.getfirebug.com。" target="_blank" rel="noopener">http://www.getfirebug.com。</a></li><li>按照说明 :<br>安装 Firebug。</li></ul></li><li>Internet Explorer 浏览器。<ul><li>打开浏览器。</li><li>在菜单中选择工具。</li><li>在工具中选择开发者工具。</li><li>最后，选择 Console。</li></ul></li><li>Opera<ul><li>打开浏览器。</li><li>Opera 的内置调试工具为 Dragonfly，详细说明可访问页面:<a href="http://www.opera.com/dragonfly/。" target="_blank" rel="noopener">http://www.opera.com/dragonfly/。</a></li></ul></li><li>Safari<ul><li>打开浏览器。</li><li>访问页面:<a href="http://extentions.apple.com。" target="_blank" rel="noopener">http://extentions.apple.com。</a></li><li>按说明操作：install Firebug Lite。</li></ul></li></ul><h4 id="2-2-调试方法"><a href="#2-2-调试方法" class="headerlink" title="2.2.调试方法"></a>2.2.调试方法</h4><ul><li>console.log() 方法</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>My First Web Page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">a = 5;</span></span><br><span class="line"><span class="undefined">b = 6;</span></span><br><span class="line"><span class="undefined">c = a + b;</span></span><br><span class="line"><span class="javascript"><span class="built_in">console</span>.log(c);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>设置断点</li><li>debugger </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">15</span> * <span class="number">5</span>;</span><br><span class="line"><span class="keyword">debugger</span>;</span><br><span class="line"><span class="built_in">document</span>.getElementbyId(<span class="string">"demo"</span>).innerHTML = x; <span class="comment">//开启 debugger ，代码在第三行前停止执行。</span></span><br></pre></td></tr></table></figure><h3 id="三、代码规范"><a href="#三、代码规范" class="headerlink" title="三、代码规范"></a>三、代码规范</h3><p>规范的代码可以更易于阅读与维护。</p><h4 id="3-1-变量名"><a href="#3-1-变量名" class="headerlink" title="3.1.变量名"></a>3.1.变量名</h4><ul><li>推荐使用驼峰法来命名(camelCase):</li><li>变量名应该区分大小写，允许包含字母、数字、美元符号($)和下划线，但第一个字符不允许是数字，不允许包含空格和其他标点符号；</li><li>变量命名长度应该尽可能的短，并抓住要点，尽量在变量名中体现出值的类型；</li><li>变量名的命名应该是有意义的；</li><li>变量名不能为JavaScript中的关键词、保留字全名；</li><li>变量名命名方法常见的有匈牙利命名法、驼峰命名法和帕斯卡命名法。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">firstName = <span class="string">"John"</span>;</span><br><span class="line">lastName = <span class="string">"Doe"</span>;</span><br><span class="line"></span><br><span class="line">price = <span class="number">19.90</span>;</span><br><span class="line">tax = <span class="number">0.20</span>;</span><br><span class="line"></span><br><span class="line">fullPrice = price + (price * tax);</span><br></pre></td></tr></table></figure><h4 id="3-2-空格与运算符"><a href="#3-2-空格与运算符" class="headerlink" title="3.2.空格与运算符"></a>3.2.空格与运算符</h4><ul><li>通常运算符 ( = + - * / ) 前后需要添加空格:</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = y + z;</span><br><span class="line"><span class="keyword">var</span> values = [<span class="string">"Volvo"</span>, <span class="string">"Saab"</span>, <span class="string">"Fiat"</span>];</span><br></pre></td></tr></table></figure><ul><li>通常使用 4 个空格符号来缩进代码块：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toCelsius</span>(<span class="params">fahrenheit</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">5</span> / <span class="number">9</span>) * (fahrenheit - <span class="number">32</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="3-3-语句规则"><a href="#3-3-语句规则" class="headerlink" title="3.3.语句规则"></a>3.3.语句规则</h4><ul><li>一条简单语句通常以分号作为结束符。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> values = [<span class="string">"Volvo"</span>, <span class="string">"Saab"</span>, <span class="string">"Fiat"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    firstName: <span class="string">"John"</span>,</span><br><span class="line">    lastName: <span class="string">"Doe"</span>,</span><br><span class="line">    age: <span class="number">50</span>,</span><br><span class="line">    eyeColor: <span class="string">"blue"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>复杂语句的通用规则:<ul><li>将左花括号放在第一行的结尾。</li><li>左花括号前添加一空格。</li><li>将右花括号独立放在一行。</li><li>不要忘记以分号结束一个复杂的声明。</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toCelsius</span>(<span class="params">fahrenheit</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">5</span> / <span class="number">9</span>) * (fahrenheit - <span class="number">32</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>每行代码字符小于 80</li></ul><h4 id="3-5-对象规则"><a href="#3-5-对象规则" class="headerlink" title="3.5.对象规则"></a>3.5.对象规则</h4><p>对象定义的规则:</p><ul><li>将左花括号与类名放在同一行。</li><li>冒号与属性值间有个空格。</li><li>字符串使用双引号，数字不需要。</li><li>最后一个属性-值对后面不要添加逗号。</li><li>将右花括号独立放在一行，并以分号作为结束符号。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    firstName: <span class="string">"John"</span>,</span><br><span class="line">    lastName: <span class="string">"Doe"</span>,</span><br><span class="line">    age: <span class="number">50</span>,</span><br><span class="line">    eyeColor: <span class="string">"blue"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="3-6-命名规则"><a href="#3-6-命名规则" class="headerlink" title="3.6.命名规则"></a>3.6.命名规则</h4><ul><li>变量和函数为驼峰法（ camelCase）</li><li>全局变量为大写 (UPPERCASE )</li><li>常量 (如 PI) 为大写 (UPPERCASE )</li><li>使用简洁的格式载入 JavaScript 文件 ( type 属性不是必须的):</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"myscript.js"</span>&gt;</span><span class="undefined"></span></span><br></pre></td></tr></table></figure><ul><li>HTML 与 JavaScript 尽量使用相同的命名规则。</li><li>使用小写文件名</li></ul><h3 id="四、性能"><a href="#四、性能" class="headerlink" title="四、性能"></a>四、性能</h3><ul><li>不要使用 with() 语句<ul><li>因为 with() 语句将会在作用域链的开始添加额外的变量。</li><li>额外的变量意味着，当任何变量需要被访问的时候，JavaScript引擎都需要先扫描with()语句产生的变量，然后才是局部变量，最后是全局变量。  </li><li>因此with()语句同时给局部变量和全局变量的性能带来负面影响，最终使我们优化JavaScript性能的计划破产。</li></ul></li><li>避免全局查找</li><li><p>用”” + 1来将数字转换成字符串，虽然看起来比较丑一点，但事实上这个效率是最高的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(&quot;&quot; +) &gt; String() &gt; .toString() &gt; new String()</span><br></pre></td></tr></table></figure></li><li><p>通过模板元素clone，替代createElement</p></li><li>避免低效率的脚本位置</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--低效率--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Source Example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"script1.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"script2.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"script3.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"styles.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--推荐--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Source Example<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"styles.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello world!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Example of efficient script positioning --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"script1.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"script2.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"script3.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>小心使用闭包</li><li>在循环时将控制条件和控制变量合并起来</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误</span></span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">var</span> x = <span class="number">0</span>; x &lt; <span class="number">10</span>; x++ ) &#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//正确</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">9</span>;</span><br><span class="line"><span class="keyword">do</span> &#123; &#125; <span class="keyword">while</span>( x-- );</span><br></pre></td></tr></table></figure><ul><li>使用 XMLHttpRequest(XHR)对象<ul><li>优点:下载不立即执行的 JavaScript 代码。由于代码返回在&lt;script>标签之外（换句话说不受&lt;script>标签约束），它下载后不会自动执行，这使得您可以推迟执行，直到一切都准备好了。另一个优点是，同样的代码在所有现代浏览器中都不会引发异常。</li><li>缺点：JavaScript 文件必须与页面放置在同一个域内，不能从 CDN 下载（CDN 指”内容投递网络 Content Delivery Network）”，所以大型网页通常不采用 XHR 脚本注入技术。</li></ul></li><li>最小化访问NodeList的次数可以极大的改进脚本的性能</li><li>避免与null进行比较</li><li>尊重对象的所有权</li><li>避免循环引用</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误:init在执行的时候，当前上下文我们叫做context。这个时候，context引用了el，el引用了function，function引用了context。这时候形成了一个循环引用。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'MyElement'</span>);</span><br><span class="line">    el.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//……</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="comment">//正确:置空dom对象</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'MyElement'</span>);</span><br><span class="line">    el.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//……</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> el;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">finally</span> &#123;</span><br><span class="line">        el = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">init();</span><br><span class="line"></span><br><span class="line"><span class="comment">//正确:构造新的context</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">elClickHandler</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="comment">//……</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="built_in">document</span>.getElementById(<span class="string">'MyElement'</span>);</span><br><span class="line">    el.onclick = elClickHandler;</span><br><span class="line">&#125;</span><br><span class="line">init();</span><br></pre></td></tr></table></figure><ul><li>通过javascript创建的dom对象，必须append到页面中</li><li>字符串连接避免使用+=</li><li>使用直接量</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> aTest = <span class="keyword">new</span> <span class="built_in">Array</span>(); <span class="comment">//替换为</span></span><br><span class="line"><span class="keyword">var</span> aTest = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> aTest = <span class="keyword">new</span> <span class="built_in">Object</span>; <span class="comment">//替换为</span></span><br><span class="line"><span class="keyword">var</span> aTest = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(); <span class="comment">//替换为</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/../</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果要创建具有一些特性的一般对象，也可以使用字面量，如下：</span></span><br><span class="line"><span class="keyword">var</span> oFruit = <span class="keyword">new</span> O;</span><br><span class="line">oFruit.color = <span class="string">"red"</span>;</span><br><span class="line">oFruit.name = <span class="string">"apple"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//前面的代码可用对象字面量来改写成这样：</span></span><br><span class="line"><span class="keyword">var</span> oFruit = &#123; <span class="attr">color</span>: <span class="string">"red"</span>, <span class="attr">name</span>: <span class="string">"apple"</span> &#125;;</span><br></pre></td></tr></table></figure><ul><li>尽量少使用eval函数</li><li>不要给setTimeout或者setInterval传递字符串参数</li><li>缩短否定检测</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(oTest != <span class="string">'#ff0000'</span>)&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(oTest != <span class="literal">null</span>)&#123;</span><br><span class="line"><span class="comment">//do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(oTest != <span class="literal">false</span>)&#123;</span><br><span class="line">  <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//虽然这些都正确，但用逻辑非操作符来操作也有同样的效果：</span></span><br><span class="line"><span class="keyword">if</span>(!oTest)&#123;</span><br><span class="line"><span class="comment">//do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>释放javascript对象</li><li>尽量使用原生方法</li><li>switch语句相对if较快</li><li>位运算较快</li><li>巧用||和&amp;&amp;布尔运算符</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eventHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!e) e = <span class="built_in">window</span>.event;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//可以替换为：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eventHandler</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e = e || <span class="built_in">window</span>.event;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="五、注意事项"><a href="#五、注意事项" class="headerlink" title="五、注意事项"></a>五、注意事项</h3><ul><li>每条语句末尾须加分号</li><li>使用+号时需谨慎</li><li>使用return语句需要注意不要用()括号来括住返回值，如果返回表达式，则表达式应与return关键字在同一行，以避免压缩时，压缩工具自动加分号而造成返回与开发人员不一致的结果</li><li>在比较是否相等的情况下，最好使用全等运行符，也就是使用===和!==操作符会相对于==和!=会好点。==和!=操作符会进行类型强制转换</li><li>不要使用生偏语法，写让人迷惑的代码，虽然计算机能够正确识别并运行，但是晦涩难懂的代码不方便以后维护</li><li>函数返回统一类型</li><li>总是检查数据类型</li><li>在HTML中使用双引号，在JavaScript中使用单引号，但为了兼容各个浏览器，也为了解析时不会出错，定义JSON对象时，最好使用双引号</li><li>用JSLint运行JavaScript验证器来确保没有语法错误或者是代码没有潜在的问题。</li><li>部署之前推荐使用压缩工具将JS文件压缩。</li><li>文件编码统一用UTF-8。</li><li>JavaScript 程序应该尽量放在 .js 的文件中。</li></ul><p>More info: <a href="https://www.w3cschool.cn/javascrip" target="_blank" rel="noopener">JavaScript教程</a></p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JavaScript（二）JavaScript的基本知识(中)</title>
      <link href="/2016/11/15/JavaScript02/"/>
      <url>/2016/11/15/JavaScript02/</url>
      <content type="html"><![CDATA[<p>　　本文章主要介绍 JavaScript 的高级语法。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、HTML-DOM"><a href="#一、HTML-DOM" class="headerlink" title="一、HTML DOM"></a>一、HTML DOM</h3><p>通过 HTML DOM，可访问 JavaScript HTML 文档的所有元素。</p><ul><li>JavaScript 能够改变页面中的所有 HTML 元素</li><li>JavaScript 能够改变页面中的所有 HTML 属性</li><li>JavaScript 能够改变页面中的所有 CSS 样式</li><li>JavaScript 能够对页面中的所有事件做出反应</li></ul><h4 id="1-1-查找-HTML-元素"><a href="#1-1-查找-HTML-元素" class="headerlink" title="1.1.查找 HTML 元素"></a>1.1.查找 HTML 元素</h4><ul><li>通过 id 找到 HTML 元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x=<span class="built_in">document</span>.getElementById(<span class="string">"intro"</span>);</span><br></pre></td></tr></table></figure><ul><li>通过标签名找到 HTML 元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x=<span class="built_in">document</span>.getElementById(<span class="string">"main"</span>);</span><br><span class="line"><span class="keyword">var</span> y=x.getElementsByTagName(<span class="string">"p"</span>);</span><br></pre></td></tr></table></figure><ul><li>通过类名找到 HTML 元素</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x=<span class="built_in">document</span>.getElementsByClassName(<span class="string">"intro"</span>);</span><br></pre></td></tr></table></figure><p><img src="/image/JavaScript02/JavaScript02_001.png" alt=""></p><h4 id="1-2-改变-HTML-内容"><a href="#1-2-改变-HTML-内容" class="headerlink" title="1.2.改变 HTML 内容"></a>1.2.改变 HTML 内容</h4><ul><li>改变 HTML 输出流</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="built_in">Date</span>());</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>改变 HTML 输出流</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p1"</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">"p1"</span>).innerHTML=<span class="string">"New text!"</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>改变 HTML 输出流</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(id).attribute=<span class="keyword">new</span> value</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"image"</span> <span class="attr">src</span>=<span class="string">"smiley.gif"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">"image"</span>).src=<span class="string">"landscape.jpg"</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="1-2-改变-改变-CSS"><a href="#1-2-改变-改变-CSS" class="headerlink" title="1.2.改变 改变 CSS"></a>1.2.改变 改变 CSS</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(id).style.property=<span class="keyword">new</span> style</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p2"</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">"p2"</span>).style.color=<span class="string">"blue"</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The paragraph above was changed by a script.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="1-3-事件触发改变"><a href="#1-3-事件触发改变" class="headerlink" title="1.3.事件触发改变"></a>1.3.事件触发改变</h4><p>在事件发生时执行 JavaScript，比如当用户在 HTML 元素上点击时。</p><ul><li>当用户点击鼠标时</li><li>当网页已加载时</li><li>当图像已加载时</li><li>当鼠标移动到元素上时</li><li>当输入字段被改变时</li><li>当提交 HTML 表单时</li><li>当用户触发按键时</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onclick=JavaScript</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">onclick</span>=<span class="string">"this.innerHTML='Ooops!'"</span>&gt;</span>点击文本!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"displayDate()"</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">document.getElementById("myBtn").onclick=function()&#123;displayDate()&#125;;</span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"checkCookies()"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"fname"</span> <span class="attr">onchange</span>=<span class="string">"upperCase()"</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>HTML 事件属性</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onclick=<span class="string">"displayDate()"</span>&gt;点我&lt;<span class="regexp">/button&gt;</span></span><br></pre></td></tr></table></figure><ul><li>使用 HTML DOM 来分配事件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"myBtn"</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;displayDate()&#125;;</span><br></pre></td></tr></table></figure><ul><li>onload 和 onunload 事件:在用户进入或离开页面时被触发。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;body onload=<span class="string">"checkCookies()"</span>&gt;</span><br></pre></td></tr></table></figure><ul><li>onchange 事件</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> id=<span class="string">"fname"</span> onchange=<span class="string">"upperCase()"</span>&gt;</span><br></pre></td></tr></table></figure><h4 id="1-4-事件监听器"><a href="#1-4-事件监听器" class="headerlink" title="1.4.事件监听器"></a>1.4.事件监听器</h4><p>给页面的某些元素添加事件的监听器，当元素触发相应事件的时候监听器就会捕捉到这个事件并执行相应的代码。</p><ul><li>addEventListener() <ul><li>用于向指定元素添加事件句柄。</li><li>添加的事件句柄不会覆盖已存在的事件句柄。</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.addEventListener(event, <span class="function"><span class="keyword">function</span>, <span class="title">useCapture</span>);</span></span><br></pre></td></tr></table></figure><ul><li>第一个参数是事件的类型 (如 “click” 或 “mousedown”).</li><li>第二个参数是事件触发后调用的函数。</li><li>第三个参数是个布尔值用于描述事件是冒泡还是捕获。该参数是可选的。<ul><li>在冒泡中，内部元素的事件会先被触发，然后再触发外部元素，即： &lt;p> 元素的点击事件先触发，然后会触发 &lt;div> 元素的点击事件。</li><li>在捕获中，外部元素的事件会先被触发，然后才会触发内部元素的事件，即： &lt;div> 元素的点击事件先触发 ，然后再触发 &lt;p> 元素的点击事件。</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 向原元素添加事件句柄</span></span><br><span class="line">element.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; alert(<span class="string">"Hello World!"</span>); &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//向同一个元素中添加多个事件句柄</span></span><br><span class="line">element.addEventListener(<span class="string">"click"</span>, myFunction);</span><br><span class="line">element.addEventListener(<span class="string">"click"</span>, mySecondFunction);</span><br><span class="line">element.addEventListener(<span class="string">"mouseout"</span>, myThirdFunction);</span><br><span class="line"></span><br><span class="line"><span class="comment">//向 Window 对象添加事件句柄</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"resize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = sometext;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//传递参数</span></span><br><span class="line">element.addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; myFunction(p1, p2); &#125;);</span><br></pre></td></tr></table></figure><ul><li>removeEventListener() 方法:移除由 addEventListener() 方法添加的事件句柄</li></ul><p><strong>注意： IE 8 及更早 IE 版本，Opera 7.0及其更早版本不支持 addEventListener() 和 removeEventListener() 方法。</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element.attachEvent(event, <span class="function"><span class="keyword">function</span>);</span></span><br><span class="line"><span class="function"><span class="title">element</span>.<span class="title">detachEvent</span>(<span class="params">event, function</span>);</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element.removeEventListener(<span class="string">"mousemove"</span>, myFunction);</span><br></pre></td></tr></table></figure><h4 id="1-5-添加或删除-HTML-元素"><a href="#1-5-添加或删除-HTML-元素" class="headerlink" title="1.5.添加或删除 HTML 元素"></a>1.5.添加或删除 HTML 元素</h4><ul><li>创建新的 HTML 元素</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p1"</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p2"</span>&gt;</span>This is another paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> para=<span class="built_in">document</span>.createElement(<span class="string">"p"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> node=<span class="built_in">document</span>.createTextNode(<span class="string">"This is new."</span>);</span></span><br><span class="line"><span class="undefined">para.appendChild(node);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> element=<span class="built_in">document</span>.getElementById(<span class="string">"div1"</span>);</span></span><br><span class="line"><span class="undefined">element.appendChild(para);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>-删除已有的 HTML 元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p1"</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"p2"</span>&gt;</span>This is another paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> parent=<span class="built_in">document</span>.getElementById(<span class="string">"div1"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> child=<span class="built_in">document</span>.getElementById(<span class="string">"p1"</span>);</span></span><br><span class="line"><span class="undefined">parent.removeChild(child);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="二、表单"><a href="#二、表单" class="headerlink" title="二、表单"></a>二、表单</h3><h4 id="2-1-获取表单元素"><a href="#2-1-获取表单元素" class="headerlink" title="2.1.获取表单元素"></a>2.1.获取表单元素</h4><ul><li>select:下拉列表元素</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"os"</span>&gt;</span>Operating System<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"os"</span> <span class="attr">id</span>=<span class="string">"os"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>Choose<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optgroup</span> <span class="attr">label</span>=<span class="string">"Windows"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"7 Home Basic"</span>&gt;</span>7 Home Basic<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"7 Home Premium"</span>&gt;</span>7 Home Premium<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"7 Professional"</span>&gt;</span>7 Professional<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"7 Ultimate"</span>&gt;</span>7 Ultimate<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"Vista"</span>&gt;</span>Vista<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"XP"</span>&gt;</span>XP<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">optgroup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 取到用户选择的值</span></span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">document</span>.getElementById(<span class="string">'selectMenu'</span>).value;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 可以设置为多选</span></span><br><span class="line">&lt;select name=<span class="string">"categories"</span> id=<span class="string">"categories"</span> multiple&gt;</span><br><span class="line"><span class="keyword">var</span> selected = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, count = elem.options.length; i &lt; count; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (elem.options[i].selected) &#123;</span><br><span class="line">    selected.push(elem.options[i].value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>checkbox:多选框控件，每个选择框只有选中和不选中两种状态。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">name</span>=<span class="string">"toggle"</span> <span class="attr">id</span>=<span class="string">"toggle"</span> <span class="attr">value</span>=<span class="string">"toggle"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--checked属性返回一个布尔值，表示用户是否选中。--&gt;</span></span><br><span class="line">var which = document.getElementById('someCheckbox').checked;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--checked属性是可写的。--&gt;</span></span><br><span class="line">which.checked = true;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--value属性可以获取单选框的值。--&gt;</span></span><br><span class="line">if (which.checked) &#123;</span><br><span class="line">  var value = document.getElementById('someCheckbox').value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>radio:单选框控件，同一组选择框同时只能选中一个，选中元素的checked属性为true。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"Male"</span>&gt;</span> Male <span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"gender"</span> <span class="attr">value</span>=<span class="string">"Female"</span>&gt;</span> Female <span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> radios = <span class="built_in">document</span>.getElementsByName(<span class="string">'gender'</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> selected;</span></span><br><span class="line"><span class="javascript"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; radios.length; i++) &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (radios[i].checked) &#123;</span></span><br><span class="line"><span class="undefined">    selected = radios[i].value;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">break</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span> (selected) &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 用户选中了某个选项</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-2-表单的验证"><a href="#2-2-表单的验证" class="headerlink" title="2.2.表单的验证"></a>2.2.表单的验证</h4><p>所谓“表单验证”，指的是检查用户提供的数据是否符合要求。</p><ul><li>必填（或必选）项目</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateForm</span>(<span class="params"></span>) </span>&#123;        </span><br><span class="line">    <span class="keyword">var</span> x=<span class="built_in">document</span>.forms[<span class="string">"myForm"</span>][<span class="string">"fname"</span>].value;        </span><br><span class="line">    <span class="keyword">if</span> (x==<span class="literal">null</span> || x==<span class="string">""</span>)&#123;        </span><br><span class="line">        alert(<span class="string">"First name must be filled out"</span>);        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;        </span><br><span class="line">    &#125;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>E-mail 验证</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">validateForm</span>(<span class="params"></span>)</span>&#123;        </span><br><span class="line"><span class="keyword">var</span> x=<span class="built_in">document</span>.forms[<span class="string">"myForm"</span>][<span class="string">"email"</span>].value;        </span><br><span class="line"><span class="keyword">var</span> atpos=x.indexOf(<span class="string">"@"</span>);        </span><br><span class="line"><span class="keyword">var</span> dotpos=x.lastIndexOf(<span class="string">"."</span>);        </span><br><span class="line"><span class="keyword">if</span> (atpos&lt;<span class="number">1</span> || dotpos&lt;atpos+<span class="number">2</span> || dotpos+<span class="number">2</span>&gt;=x.length)&#123;        </span><br><span class="line">  alert(<span class="string">"Not a valid e-mail address"</span>);        </span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;        </span><br><span class="line">  &#125;       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>数字验证</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"myForm"</span> <span class="attr">action</span>=<span class="string">"demo_form.asp"</span> <span class="attr">onsubmit</span>=<span class="string">"return validateForm();"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>请输入1到10之间的数字：<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"number"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"myFunction()"</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="三、正则表达式"><a href="#三、正则表达式" class="headerlink" title="三、正则表达式"></a>三、正则表达式</h3><p>正则表达式（英语：Regular Expression，在代码中常简写为regex、regexp或RE）使用单个字符串来描述、匹配一系列符合某个句法规则的字符串搜索模式。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> patt = <span class="regexp">/w3cschool/i</span></span><br></pre></td></tr></table></figure><ul><li>/w3cschool/i  是一个正则表达式。</li><li>w3cschool  是一个模式 (用于检索)。</li><li>i 是一个修饰符 (搜索不区分大小写)。</li></ul><h4 id="3-1-方法"><a href="#3-1-方法" class="headerlink" title="3.1.方法"></a>3.1.方法</h4><h5 id="支持正则表达式的-String-对象的方法"><a href="#支持正则表达式的-String-对象的方法" class="headerlink" title="支持正则表达式的 String 对象的方法"></a>支持正则表达式的 String 对象的方法</h5><ul><li>search() 方法:用于检索字符串中指定的子字符串，或检索与正则表达式相匹配的子字符串，并返回子字符串的起始位置。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Visit w3cschool"</span>; </span><br><span class="line"><span class="keyword">var</span> n = str.search(<span class="regexp">/w3cschool/i</span>); <span class="comment">//输出结果为：6</span></span><br></pre></td></tr></table></figure><ul><li>replace() 方法: 用于在字符串中用一些字符替换另一些字符，或替换一个与正则表达式匹配的子字符串。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"Visit Microsoft!"</span>;</span><br><span class="line"><span class="keyword">var</span> res = str.replace(<span class="string">"Microsoft"</span>, <span class="string">"w3cschool"</span>);</span><br></pre></td></tr></table></figure><ul><li>match:替换与正则表达式匹配的子串。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">"The rain in SPAIN stays mainly in the plain"</span>;</span><br><span class="line"><span class="keyword">var</span> n=str.match(<span class="regexp">/ain/g</span>); <span class="comment">//输出结果为：[ain,ain,ain]</span></span><br></pre></td></tr></table></figure><ul><li>split:把字符串分割为字符串数组。    </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str=<span class="string">"How are you doing today?"</span>;</span><br><span class="line"><span class="keyword">var</span> n=str.split(<span class="string">" "</span>); <span class="comment">//输出结果为：[How,are,you,doing,today?]</span></span><br></pre></td></tr></table></figure><h5 id="对象方法"><a href="#对象方法" class="headerlink" title="对象方法"></a>对象方法</h5><ul><li>test():用于检测一个字符串是否匹配某个模式，如果字符串中含有匹配的文本，则返回 true，否则返回 false。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> patt = <span class="regexp">/e/</span>;</span><br><span class="line">patt.test(<span class="string">"The best things in life are free!"</span>); <span class="comment">// 输出结果:true</span></span><br></pre></td></tr></table></figure><ul><li>exec():用于检索字符串中的正则表达式的匹配。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/e/.exec(<span class="string">"The best things in life are free!"</span>); <span class="comment">// 输出结果:e</span></span><br></pre></td></tr></table></figure><ul><li>compile():既可以改变检索模式，也可以添加或删除第二个参数。</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> patt1=<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"e"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(patt1.test(<span class="string">"The best things in life are free"</span>)); <span class="comment">// true</span></span><br><span class="line">patt1.compile(<span class="string">"d"</span>);</span><br><span class="line"><span class="built_in">document</span>.write(patt1.test(<span class="string">"The best things in life are free"</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="3-2-正则表达式修饰符"><a href="#3-2-正则表达式修饰符" class="headerlink" title="3.2.正则表达式修饰符"></a>3.2.正则表达式修饰符</h4><p><strong>修饰符</strong> 可以在全局搜索中不区分大小写:</p><table><thead><tr><th style="text-align:left">修饰符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">i</td><td style="text-align:left">执行对大小写不敏感的匹配。</td></tr><tr><td style="text-align:left">g</td><td style="text-align:left">执行全局匹配（查找所有匹配而非在找到第一个匹配后停止）。</td></tr><tr><td style="text-align:left">m</td><td style="text-align:left">执行多行匹配。</td></tr></tbody></table><h4 id="3-3-正则表达式模式"><a href="#3-3-正则表达式模式" class="headerlink" title="3.3.正则表达式模式"></a>3.3.正则表达式模式</h4><p>方括号用于查找某个范围内的字符：</p><table><thead><tr><th style="text-align:left">表达式</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-charset.html" target="_blank" rel="noopener">[abc]</a></td><td style="text-align:left">查找方括号之间的任何字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-charset-not.html" target="_blank" rel="noopener">[^abc]</a></td><td style="text-align:left">查找任何不在方括号之间的字符。</td></tr><tr><td style="text-align:left">[0-9]</td><td style="text-align:left">查找任何从 0 至 9 的数字。</td></tr><tr><td style="text-align:left">[a-z]</td><td style="text-align:left">查找任何从小写 a 到小写 z 的字符。</td></tr><tr><td style="text-align:left">[A-Z]</td><td style="text-align:left">查找任何从大写 A 到大写 Z 的字符。</td></tr><tr><td style="text-align:left">[A-z]</td><td style="text-align:left">查找任何从大写 A 到小写 z 的字符。</td></tr><tr><td style="text-align:left">[adgk]</td><td style="text-align:left">查找给定集合内的任何字符。</td></tr><tr><td style="text-align:left">[^adgk]</td><td style="text-align:left">查找给定集合外的任何字符。</td></tr><tr><td style="text-align:left">(red\</td><td style="text-align:left">blue\</td><td>green)</td><td>查找任何指定的选项。</td></tr></tbody></table><p>元字符（Metacharacter）是拥有特殊含义的字符：</p><table><thead><tr><th style="text-align:left">元字符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-dot.html" target="_blank" rel="noopener">.</a></td><td style="text-align:left">查找单个字符，除了换行和行结束符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-wordchar.html" target="_blank" rel="noopener">\w</a></td><td style="text-align:left">查找单词字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-wordchar-non.html" target="_blank" rel="noopener">\W</a></td><td style="text-align:left">查找非单词字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-digit.html" target="_blank" rel="noopener">\d</a></td><td style="text-align:left">查找数字。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-digit-non.html" target="_blank" rel="noopener">\D</a></td><td style="text-align:left">查找非数字字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-whitespace.html" target="_blank" rel="noopener">\s</a></td><td style="text-align:left">查找空白字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-whitespace-non.html" target="_blank" rel="noopener">\S</a></td><td style="text-align:left">查找非空白字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-begin.html" target="_blank" rel="noopener">\b</a></td><td style="text-align:left">匹配单词边界。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-begin-not.html" target="_blank" rel="noopener">\B</a></td><td style="text-align:left">匹配非单词边界。</td></tr><tr><td style="text-align:left">\0</td><td style="text-align:left">查找 NUL 字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-newline.html" target="_blank" rel="noopener">\n</a></td><td style="text-align:left">查找换行符。</td></tr><tr><td style="text-align:left">\f</td><td style="text-align:left">查找换页符。</td></tr><tr><td style="text-align:left">\r</td><td style="text-align:left">查找回车符。</td></tr><tr><td style="text-align:left">\t</td><td style="text-align:left">查找制表符。</td></tr><tr><td style="text-align:left">\v</td><td style="text-align:left">查找垂直制表符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-octal.html" target="_blank" rel="noopener">\xxx</a></td><td style="text-align:left">查找以八进制数 xxx 规定的字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-hex.html" target="_blank" rel="noopener">\xdd</a></td><td style="text-align:left">查找以十六进制数 dd 规定的字符。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-unicode-hex.html" target="_blank" rel="noopener">\uxxxx</a></td><td style="text-align:left">查找以十六进制数 xxxx 规定的 Unicode 字符。</td></tr></tbody></table><table><thead><tr><th style="text-align:left">量词</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-onemore.html" target="_blank" rel="noopener">n+</a></td><td style="text-align:left">匹配任何包含至少一个 n 的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-zeromore.html" target="_blank" rel="noopener">n*</a></td><td style="text-align:left">匹配任何包含零个或多个 n 的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-zeroone.html" target="_blank" rel="noopener">n?</a></td><td style="text-align:left">匹配任何包含零个或一个 n 的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-nx.html" target="_blank" rel="noopener">n{X}</a></td><td style="text-align:left">匹配包含 X 个 n 的序列的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-nxy.html" target="_blank" rel="noopener">n{X,Y}</a></td><td style="text-align:left">匹配包含 X 至 Y 个 n 的序列的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-nxcomma.html" target="_blank" rel="noopener">n{X,}</a></td><td style="text-align:left">匹配包含至少 X 个 n 的序列的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-ndollar.html" target="_blank" rel="noopener">n$</a></td><td style="text-align:left">匹配任何结尾为 n 的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-ncaret.html" target="_blank" rel="noopener">^n</a></td><td style="text-align:left">匹配任何开头为 n 的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-nfollow.html" target="_blank" rel="noopener">?=n</a></td><td style="text-align:left">匹配任何其后紧接指定字符串 n 的字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-regexp-nfollow-not.html" target="_blank" rel="noopener">?!n</a></td><td style="text-align:left">匹配任何其后没有紧接指定字符串 n 的字符串。</td></tr></tbody></table><h3 id="四、JSON"><a href="#四、JSON" class="headerlink" title="四、JSON"></a>四、JSON</h3><p>JSON 英文全称 JavaScript Object Notation<br>JSON 是一种轻量级的数据交换格式。<br>JSON 是用于存储和传输数据的格式。<br>JSON 通常用于服务端向网页传递数据 。</p><h4 id="4-1-JSON-语法规则"><a href="#4-1-JSON-语法规则" class="headerlink" title="4.1.JSON 语法规则"></a>4.1.JSON 语法规则</h4><ul><li>数据为 键/值 对。</li><li>数据由逗号分隔。</li><li>大括号保存对象</li><li>方括号保存数组</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"employees":[        </span><br><span class="line">    &#123;"firstName":"John", "lastName":"Doe"&#125;,        </span><br><span class="line">    &#123;"firstName":"Anna", "lastName":"Smith"&#125;,     </span><br><span class="line">    &#123;<span class="attr">"firstName"</span>:<span class="string">"Peter"</span>, <span class="attr">"lastName"</span>:<span class="string">"Jones"</span>&#125;        </span><br><span class="line">]</span><br></pre></td></tr></table></figure><h4 id="4-2-JSON-字符串转换为-JavaScript-对象"><a href="#4-2-JSON-字符串转换为-JavaScript-对象" class="headerlink" title="4.2.JSON 字符串转换为 JavaScript 对象"></a>4.2.JSON 字符串转换为 JavaScript 对象</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(text);</span><br></pre></td></tr></table></figure><h3 id="五、对象"><a href="#五、对象" class="headerlink" title="五、对象"></a>五、对象</h3><p>对象只是一种特殊的数据。对象拥有属性和方法。<br>JavaScript 提供多个内建对象，比如 String、Date、Array 等等。 对象只是带有属性和方法的特殊数据类型。</p><ul><li>布尔型可以是一个对象。</li><li>数字型可以是一个对象。</li><li>字符串也可以是一个对象</li><li>日期是一个对象</li><li>数学和正则表达式也是对象</li><li>数组是一个对象</li><li>甚至函数也可以是对象</li></ul><h4 id="5-1-对象的属性和方法"><a href="#5-1-对象的属性和方法" class="headerlink" title="5.1.对象的属性和方法"></a>5.1.对象的属性和方法</h4><ul><li>访问对象的属性</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objectName.propertyName</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message=<span class="string">"Hello World!"</span>;</span><br><span class="line"><span class="keyword">var</span> x=message.length;</span><br></pre></td></tr></table></figure><ul><li>访问对象的方法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">objectName.methodName()</span><br><span class="line"></span><br><span class="line"> <span class="keyword">for</span> (variable <span class="keyword">in</span> object)</span><br><span class="line"> &#123;</span><br><span class="line">   <span class="comment">//code to be executed</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> message=<span class="string">"Hello world!"</span>;</span><br><span class="line"><span class="keyword">var</span> x=message.toUpperCase();</span><br></pre></td></tr></table></figure><h4 id="5-2-创建-JavaScript-对象"><a href="#5-2-创建-JavaScript-对象" class="headerlink" title="5.2.创建 JavaScript 对象"></a>5.2.创建 JavaScript 对象</h4><ul><li>定义并创建对象的实例</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">person=<span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">person.firstname=<span class="string">"John"</span>;</span><br><span class="line">person.lastname=<span class="string">"Doe"</span>;</span><br><span class="line">person.age=<span class="number">50</span>;</span><br><span class="line">person.eyecolor=<span class="string">"blue"</span>;</span><br></pre></td></tr></table></figure><ul><li>使用函数来定义对象，然后创建新的对象实例</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params">firstname,lastname,age,eyecolor</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.firstname=firstname;</span><br><span class="line">    <span class="keyword">this</span>.lastname=lastname;</span><br><span class="line">    <span class="keyword">this</span>.age=age;</span><br><span class="line">    <span class="keyword">this</span>.eyecolor=eyecolor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-3-给-JavaScript-增加属性和方法"><a href="#5-3-给-JavaScript-增加属性和方法" class="headerlink" title="5.3.给 JavaScript 增加属性和方法"></a>5.3.给 JavaScript 增加属性和方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把属性添加到 JavaScript 对象</span></span><br><span class="line">person.firstname=<span class="string">"John"</span>;</span><br><span class="line">person.lastname=<span class="string">"Doe"</span>;</span><br><span class="line">person.age=<span class="number">30</span>;</span><br><span class="line">person.eyecolor=<span class="string">"blue"</span>;</span><br><span class="line"></span><br><span class="line">x=person.firstname;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把方法添加到 JavaScript 对象</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params">firstname,lastname,age,eyecolor</span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="keyword">this</span>.firstname=firstname;</span><br><span class="line">     <span class="keyword">this</span>.lastname=lastname;</span><br><span class="line">     <span class="keyword">this</span>.age=age;</span><br><span class="line">     <span class="keyword">this</span>.eyecolor=eyecolor;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">this</span>.changeName=changeName;</span><br><span class="line">     <span class="function"><span class="keyword">function</span> <span class="title">changeName</span>(<span class="params">name</span>)</span></span><br><span class="line"><span class="function">     </span>&#123;</span><br><span class="line">           <span class="keyword">this</span>.lastname=name;</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h4 id="5-5-给-JavaScript-增加属性和方法"><a href="#5-5-给-JavaScript-增加属性和方法" class="headerlink" title="5.5.给 JavaScript 增加属性和方法"></a>5.5.给 JavaScript 增加属性和方法</h4><h5 id="Number-对象"><a href="#Number-对象" class="headerlink" title="Number 对象"></a>Number 对象</h5><p>JavaScript 的 Number 对象是经过封装的能让你处理数字值的对象，由 Number() 构造器创建。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">123</span>);</span><br><span class="line"><span class="keyword">typeof</span>(x) <span class="comment">// returns Number</span></span><br><span class="line"><span class="keyword">typeof</span>(y) <span class="comment">// returns Object</span></span><br></pre></td></tr></table></figure><ul><li>Infinity:当数字运算结果超过了JavaScript所能表示的数字上限（溢出），结果为一个特殊的无穷大（infinity）值</li><li><p>NaN 属性是代表非数字值的特殊值。该属性用于指示某个值不是数字。可以把 Number 对象设置为该值，来指示其不是数字值。</p></li><li><p>数字属性</p><ul><li>MAX_VALUE</li><li>MIN_VALUE</li><li>NEGATIVE_INFINITY</li><li>POSITIVE_INFINITY</li><li>NaN</li><li>prototype</li><li>constructor</li></ul></li><li>数字方法<ul><li>toExponential()</li><li>toFixed()</li><li>toPrecision()</li><li>toString()</li><li>valueOf()</li></ul></li></ul><h5 id="字符串（String）对象"><a href="#字符串（String）对象" class="headerlink" title="字符串（String）对象"></a>字符串（String）对象</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">'hello'</span>);</span><br></pre></td></tr></table></figure><ul><li>属性:<ul><li>length</li><li>prototype</li><li>constructor</li></ul></li><li>方法:<ul><li>charAt()</li><li>charCodeAt()</li><li>concat()</li><li>fromCharCode()</li><li>indexOf()</li><li>lastIndexOf()</li><li>match()</li><li>replace()</li><li>search()</li><li>slice()</li><li>split()</li><li>substr()</li><li>substring()</li><li>toLowerCase()</li><li>toUpperCase()</li><li>valueOf()</li></ul></li></ul><h5 id="Date（日期）对象"><a href="#Date（日期）对象" class="headerlink" title="Date（日期）对象"></a>Date（日期）对象</h5><ul><li>创建日期</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>() <span class="comment">// 当前日期和时间        </span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(milliseconds) <span class="comment">//返回从 1970 年 1 月 1 日至今的毫秒数        </span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(dateString)        </span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(year, month, day, hours, minutes, seconds, milliseconds)</span><br></pre></td></tr></table></figure><ul><li>设置日期</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myDate=<span class="keyword">new</span> <span class="built_in">Date</span>();        </span><br><span class="line">myDate.setFullYear(<span class="number">2010</span>,<span class="number">0</span>,<span class="number">14</span>);</span><br></pre></td></tr></table></figure><ul><li>两个日期比较</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x=<span class="keyword">new</span> <span class="built_in">Date</span>();        </span><br><span class="line">x.setFullYear(<span class="number">2100</span>,<span class="number">0</span>,<span class="number">4</span>);        </span><br><span class="line"><span class="keyword">var</span> today = <span class="keyword">new</span> <span class="built_in">Date</span>();                </span><br><span class="line"><span class="keyword">if</span> (x&gt;today)&#123;        </span><br><span class="line">  alert(<span class="string">"Today is before 14th January 2100"</span>);        </span><br><span class="line">&#125;        </span><br><span class="line"><span class="keyword">else</span>&#123;        </span><br><span class="line">  alert(<span class="string">"Today is after 14th January 2100"</span>);        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Date 对象属性</li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-constructor-date.html" target="_blank" rel="noopener">constructor</a></td><td style="text-align:left">返回对创建此对象的 Date 函数的引用。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-prototype-date.html" target="_blank" rel="noopener">prototype</a></td><td style="text-align:left">使您有能力向对象添加属性和方法。</td></tr></tbody></table><ul><li>Date 对象方法</li></ul><table><thead><tr><th style="text-align:left">方法</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getdate.html" target="_blank" rel="noopener">getDate()</a></td><td style="text-align:left">从 Date 对象返回一个月中的某一天 (1 ~ 31)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getday.html" target="_blank" rel="noopener">getDay()</a></td><td style="text-align:left">从 Date 对象返回一周中的某一天 (0 ~ 6)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getfullyear.html" target="_blank" rel="noopener">getFullYear()</a></td><td style="text-align:left">从 Date 对象以四位数字返回年份。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-gethours.html" target="_blank" rel="noopener">getHours()</a></td><td style="text-align:left">返回 Date 对象的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getmilliseconds.html" target="_blank" rel="noopener">getMilliseconds()</a></td><td style="text-align:left">返回 Date 对象的毫秒(0 ~ 999)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getminutes.html" target="_blank" rel="noopener">getMinutes()</a></td><td style="text-align:left">返回 Date 对象的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getmonth.html" target="_blank" rel="noopener">getMonth()</a></td><td style="text-align:left">从 Date 对象返回月份 (0 ~ 11)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getseconds.html" target="_blank" rel="noopener">getSeconds()</a></td><td style="text-align:left">返回 Date 对象的秒数 (0 ~ 59)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-gettime.html" target="_blank" rel="noopener">getTime()</a></td><td style="text-align:left">返回 1970 年 1 月 1 日至今的毫秒数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-gettimezoneoffset.html" target="_blank" rel="noopener">getTimezoneOffset()</a></td><td style="text-align:left">返回本地时间与格林威治标准时间 (GMT) 的分钟差。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcdate.html" target="_blank" rel="noopener">getUTCDate()</a></td><td style="text-align:left">根据世界时从 Date 对象返回月中的一天 (1 ~ 31)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcday.html" target="_blank" rel="noopener">getUTCDay()</a></td><td style="text-align:left">根据世界时从 Date 对象返回周中的一天 (0 ~ 6)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcfullyear.html" target="_blank" rel="noopener">getUTCFullYear()</a></td><td style="text-align:left">根据世界时从 Date 对象返回四位数的年份。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutchours.html" target="_blank" rel="noopener">getUTCHours()</a></td><td style="text-align:left">根据世界时返回 Date 对象的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcmilliseconds.html" target="_blank" rel="noopener">getUTCMilliseconds()</a></td><td style="text-align:left">根据世界时返回 Date 对象的毫秒(0 ~ 999)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcminutes.html" target="_blank" rel="noopener">getUTCMinutes()</a></td><td style="text-align:left">根据世界时返回 Date 对象的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcmonth.html" target="_blank" rel="noopener">getUTCMonth()</a></td><td style="text-align:left">根据世界时从 Date 对象返回月份 (0 ~ 11)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-getutcseconds.html" target="_blank" rel="noopener">getUTCSeconds()</a></td><td style="text-align:left">根据世界时返回 Date 对象的秒钟 (0 ~ 59)。</td></tr><tr><td style="text-align:left">getYear()</td><td style="text-align:left">已废弃。 请使用 <a href="https://www.w3cschool.cn/jsref/jsref-getfullyear.html" target="_blank" rel="noopener">getFullYear()</a> 方法代替。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-parse.html" target="_blank" rel="noopener">parse()</a></td><td style="text-align:left">返回1970年1月1日午夜到指定日期（字符串）的毫秒数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setdate.html" target="_blank" rel="noopener">setDate()</a></td><td style="text-align:left">设置 Date 对象中月的某一天 (1 ~ 31)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setfullyear.html" target="_blank" rel="noopener">setFullYear()</a></td><td style="text-align:left">设置 Date 对象中的年份（四位数字）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-sethours.html" target="_blank" rel="noopener">setHours()</a></td><td style="text-align:left">设置 Date 对象中的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setmilliseconds.html" target="_blank" rel="noopener">setMilliseconds()</a></td><td style="text-align:left">设置 Date 对象中的毫秒 (0 ~ 999)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setminutes.html" target="_blank" rel="noopener">setMinutes()</a></td><td style="text-align:left">设置 Date 对象中的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setmonth.html" target="_blank" rel="noopener">setMonth()</a></td><td style="text-align:left">设置 Date 对象中月份 (0 ~ 11)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setseconds.html" target="_blank" rel="noopener">setSeconds()</a></td><td style="text-align:left">设置 Date 对象中的秒钟 (0 ~ 59)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-settime.html" target="_blank" rel="noopener">setTime()</a></td><td style="text-align:left">setTime() 方法以毫秒设置 Date 对象。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutcdate.html" target="_blank" rel="noopener">setUTCDate()</a></td><td style="text-align:left">根据世界时设置 Date 对象中月份的一天 (1 ~ 31)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutcfullyear.html" target="_blank" rel="noopener">setUTCFullYear()</a></td><td style="text-align:left">根据世界时设置 Date 对象中的年份（四位数字）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutchours.html" target="_blank" rel="noopener">setUTCHours()</a></td><td style="text-align:left">根据世界时设置 Date 对象中的小时 (0 ~ 23)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutcmilliseconds.html" target="_blank" rel="noopener">setUTCMilliseconds()</a></td><td style="text-align:left">根据世界时设置 Date 对象中的毫秒 (0 ~ 999)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutcminutes.html" target="_blank" rel="noopener">setUTCMinutes()</a></td><td style="text-align:left">根据世界时设置 Date 对象中的分钟 (0 ~ 59)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutcmonth.html" target="_blank" rel="noopener">setUTCMonth()</a></td><td style="text-align:left">根据世界时设置 Date 对象中的月份 (0 ~ 11)。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-setutcseconds.html" target="_blank" rel="noopener">setUTCSeconds()</a></td><td style="text-align:left">setUTCSeconds() 方法用于根据世界时 (UTC) 设置指定时间的秒字段。</td></tr><tr><td style="text-align:left">setYear()</td><td style="text-align:left">已废弃。请使用 <a href="https://www.w3cschool.cn/jsref/jsref-setfullyear.html" target="_blank" rel="noopener">setFullYear()</a> 方法代替。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-todatestring.html" target="_blank" rel="noopener">toDateString()</a></td><td style="text-align:left">把 Date 对象的日期部分转换为字符串。</td></tr><tr><td style="text-align:left">toGMTString()</td><td style="text-align:left">已废弃。请使用 <a href="https://www.w3cschool.cn/jsref/jsref-toutcstring.html" target="_blank" rel="noopener">toUTCString()</a> 方法代替。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-toisostring.html" target="_blank" rel="noopener">toISOString()</a></td><td style="text-align:left">使用 ISO 标准返回字符串的日期格式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tojson.html" target="_blank" rel="noopener">toJSON()</a></td><td style="text-align:left">以 JSON 数据格式返回日期字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tolocaledatestring.html" target="_blank" rel="noopener">toLocaleDateString()</a></td><td style="text-align:left">根据本地时间格式，把 Date 对象的日期部分转换为字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tolocaletimestring.html" target="_blank" rel="noopener">toLocaleTimeString()</a></td><td style="text-align:left">根据本地时间格式，把 Date 对象的时间部分转换为字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tolocalestring.html" target="_blank" rel="noopener">toLocaleString()</a></td><td style="text-align:left">据本地时间格式，把 Date 对象转换为字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tostring-date.html" target="_blank" rel="noopener">toString()</a></td><td style="text-align:left">把 Date 对象转换为字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-totimestring.html" target="_blank" rel="noopener">toTimeString()</a></td><td style="text-align:left">把 Date 对象的时间部分转换为字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-toutcstring.html" target="_blank" rel="noopener">toUTCString()</a></td><td style="text-align:left">根据世界时，把 Date 对象转换为字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-utc.html" target="_blank" rel="noopener">UTC()</a></td><td style="text-align:left">根据世界时返回 1970 年 1 月 1 日 到指定日期的毫秒数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-valueof-date.html" target="_blank" rel="noopener">valueOf()</a></td><td style="text-align:left">返回 Date 对象的原始值。</td></tr></tbody></table><h5 id="Array（数组）对象"><a href="#Array（数组）对象" class="headerlink" title="Array（数组）对象"></a>Array（数组）对象</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cars = [<span class="string">"Saab"</span>, <span class="string">"Volvo"</span>, <span class="string">"BMW"</span>];</span><br></pre></td></tr></table></figure><ul><li>属性</li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-constructor-array.html" target="_blank" rel="noopener">constructor</a></td><td style="text-align:left">返回创建数组对象的原型函数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-length-array.html" target="_blank" rel="noopener">length</a></td><td style="text-align:left">设置或返回数组元素的个数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/project/jsref/jsref-prototype-array.html" target="_blank" rel="noopener">prototype</a></td><td style="text-align:left">允许你向数组对象添加属性或方法。</td></tr></tbody></table><hr><ul><li>方法</li></ul><table><thead><tr><th style="text-align:left">方法</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-concat-array.html" target="_blank" rel="noopener">concat()</a></td><td style="text-align:left">连接两个或更多的数组，并返回结果。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-conwithin-array.html?RECACHE=1" target="_blank" rel="noopener">copyWithin().</a></td><td style="text-align:left">从数组的指定位置拷贝元素到数组的另一个指定位置中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-7tuv3mlq.html?RECACHE=1" target="_blank" rel="noopener">entries().</a></td><td style="text-align:left">返回数组的可迭代对象。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-every.html" target="_blank" rel="noopener">every()</a></td><td style="text-align:left">检测数组元素的每个元素是否都符合条件。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-zg4t3mlr.html?RECACHE=1" target="_blank" rel="noopener">fill().</a></td><td style="text-align:left">使用一个固定值来填充数组。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-filter.html" target="_blank" rel="noopener">filter()</a></td><td style="text-align:left">检测数组元素，并返回符合条件所有元素的数组。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-kqcp3mls.html?RECACHE=1" target="_blank" rel="noopener">find().</a></td><td style="text-align:left">返回符合传入测试（函数）条件的数组元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-kyd23mlt.html?RECACHE=1" target="_blank" rel="noopener">findIndex().</a></td><td style="text-align:left">返回符合传入测试（函数）条件的数组元素索引。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/foreach.html?RECACHE=1" target="_blank" rel="noopener">forEach().</a></td><td style="text-align:left">数组每个元素都执行一次回调函数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-zlf73mlu.html?RECACHE=1" target="_blank" rel="noopener">from().</a></td><td style="text-align:left">通过给定的对象中创建一个数组。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-indexof-array.html" target="_blank" rel="noopener">indexOf()</a></td><td style="text-align:left">搜索数组中的元素，并返回它所在的位置。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-join.html" target="_blank" rel="noopener">join()</a></td><td style="text-align:left">把数组的所有元素放入一个字符串。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-lastindexof-array.html" target="_blank" rel="noopener">lastIndexOf()</a></td><td style="text-align:left">返回一个指定的字符串值最后出现的位置，在一个字符串中的指定位置从后向前搜索。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-map.html" target="_blank" rel="noopener">map()</a></td><td style="text-align:left">通过指定函数处理数组的每个元素，并返回处理后的数组。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-pop.html" target="_blank" rel="noopener">pop()</a></td><td style="text-align:left">删除数组的最后一个元素并返回删除的元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-push.html" target="_blank" rel="noopener">push()</a></td><td style="text-align:left">向数组的末尾添加一个或更多元素，并返回新的长度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-reverse.html" target="_blank" rel="noopener">reverse()</a></td><td style="text-align:left">反转数组的元素顺序。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-shift.html" target="_blank" rel="noopener">shift()</a></td><td style="text-align:left">删除数组的第一个元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-slice-array.html" target="_blank" rel="noopener">slice()</a></td><td style="text-align:left">选取数组的的一部分，并返回一个新数组。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-some.html" target="_blank" rel="noopener">some()</a></td><td style="text-align:left">检测数组元素中是否有元素符合指定条件。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-sort.html" target="_blank" rel="noopener">sort()</a></td><td style="text-align:left">对数组的元素进行排序。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-splice.html" target="_blank" rel="noopener">splice()</a></td><td style="text-align:left">从数组中添加或删除元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tostring-array.html" target="_blank" rel="noopener">toString()</a></td><td style="text-align:left">把数组转换为字符串，并返回结果。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-unshift.html" target="_blank" rel="noopener">unshift()</a></td><td style="text-align:left">向数组的开头添加一个或更多元素，并返回新的长度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-valueof-array.html" target="_blank" rel="noopener">valueOf()</a></td><td style="text-align:left">返回数组对象的原始值。</td></tr></tbody></table><h5 id="Boolean（布尔）对象"><a href="#Boolean（布尔）对象" class="headerlink" title="Boolean（布尔）对象"></a>Boolean（布尔）对象</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myBoolean=<span class="keyword">new</span> <span class="built_in">Boolean</span>();</span><br></pre></td></tr></table></figure><ul><li>Boolean 对象属性</li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-constructor-boolean.html" target="_blank" rel="noopener">constructor</a></td><td style="text-align:left">返回对创建此对象的 Boolean 函数的引用</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-prototype-boolean.html" target="_blank" rel="noopener">prototype</a></td><td style="text-align:left">使您有能力向对象添加属性和方法。</td></tr></tbody></table><ul><li>Boolean 对象方法</li></ul><table><thead><tr><th style="text-align:left">方法</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tostring-boolean.html" target="_blank" rel="noopener">toString()</a></td><td style="text-align:left">把布尔值转换为字符串，并返回结果。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-valueof-boolean.html" target="_blank" rel="noopener">valueOf()</a></td><td style="text-align:left">返回 Boolean 对象的原始值。</td></tr></tbody></table><h5 id="Math（算数）对象"><a href="#Math（算数）对象" class="headerlink" title="Math（算数）对象"></a>Math（算数）对象</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x=<span class="built_in">Math</span>.PI;</span><br><span class="line"><span class="keyword">var</span> y=<span class="built_in">Math</span>.sqrt(<span class="number">16</span>);</span><br></pre></td></tr></table></figure><ul><li>Math 对象属性</li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-e.html" target="_blank" rel="noopener">E</a></td><td style="text-align:left">返回算术常量 e，即自然对数的底数（约等于2.718）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-ln2.html" target="_blank" rel="noopener">LN2</a></td><td style="text-align:left">返回 2 的自然对数（约等于0.693）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-ln10.html" target="_blank" rel="noopener">LN10</a></td><td style="text-align:left">返回 10 的自然对数（约等于2.302）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-log2e.html" target="_blank" rel="noopener">LOG2E</a></td><td style="text-align:left">返回以 2 为底的 e 的对数（约等于 1.414）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-log10e.html" target="_blank" rel="noopener">LOG10E</a></td><td style="text-align:left">返回以 10 为底的 e 的对数（约等于0.434）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-pi.html" target="_blank" rel="noopener">PI</a></td><td style="text-align:left">返回圆周率（约等于3.14159）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-sqrt1-2.html" target="_blank" rel="noopener">SQRT1_2</a></td><td style="text-align:left">返回返回 2 的平方根的倒数（约等于 0.707）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-sqrt2.html" target="_blank" rel="noopener">SQRT2</a></td><td style="text-align:left">返回 2 的平方根（约等于 1.414）。</td></tr></tbody></table><ul><li>Math 对象方法</li></ul><table><thead><tr><th style="text-align:left">方法</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-abs.html" target="_blank" rel="noopener">abs(x)</a></td><td style="text-align:left">返回 x 的绝对值。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-acos.html" target="_blank" rel="noopener">acos(x)</a></td><td style="text-align:left">返回 x 的反余弦值。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-asin.html" target="_blank" rel="noopener">asin(x)</a></td><td style="text-align:left">返回 x 的反正弦值。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-atan.html" target="_blank" rel="noopener">atan(x)</a></td><td style="text-align:left">以介于 -PI/2 与 PI/2 弧度之间的数值来返回 x 的反正切值。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-atan2.html" target="_blank" rel="noopener">atan2(y,x)</a></td><td style="text-align:left">返回从 x 轴到点 (x,y) 的角度（介于 -PI/2 与 PI/2 弧度之间）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-ceil.html" target="_blank" rel="noopener">ceil(x)</a></td><td style="text-align:left">对数进行上舍入。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-cos.html" target="_blank" rel="noopener">cos(x)</a></td><td style="text-align:left">返回数的余弦。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-exp.html" target="_blank" rel="noopener">exp(x)</a></td><td style="text-align:left">返回 Ex 的指数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-floor.html" target="_blank" rel="noopener">floor(x)</a></td><td style="text-align:left">对 x 进行下舍入。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-log.html" target="_blank" rel="noopener">log(x)</a></td><td style="text-align:left">返回数的自然对数（底为e）。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-max.html" target="_blank" rel="noopener">max(x,y,z,…,n)</a></td><td style="text-align:left">返回 x,y,z,…,n 中的最高值。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-min.html" target="_blank" rel="noopener">min(x,y,z,…,n)</a></td><td style="text-align:left">返回 x,y,z,…,n中的最低值。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-pow.html" target="_blank" rel="noopener">pow(x,y)</a></td><td style="text-align:left">返回 x 的 y 次幂。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-random.html" target="_blank" rel="noopener">random()</a></td><td style="text-align:left">返回 0 ~ 1 之间的随机数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-round.html" target="_blank" rel="noopener">round(x)</a></td><td style="text-align:left">把数四舍五入为最接近的整数。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-sin.html" target="_blank" rel="noopener">sin(x)</a></td><td style="text-align:left">返回数的正弦。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-sqrt.html" target="_blank" rel="noopener">sqrt(x)</a></td><td style="text-align:left">返回数的平方根。</td></tr><tr><td style="text-align:left"><a href="https://www.w3cschool.cn/jsref/jsref-tan.html" target="_blank" rel="noopener">tan(x)</a></td><td style="text-align:left">返回角的正切。</td></tr></tbody></table><h5 id="Window对象"><a href="#Window对象" class="headerlink" title="Window对象"></a>Window对象</h5><p>Window 对象表示一个浏览器窗口或一个框架。在客户端 JavaScript 中，Window 对象是全局对象，所有的表达式都在当前的环境中计算。</p><ul><li>JavaScript document 对象</li><li>JavaScript frames 对象</li><li>JavaScript history 对象</li><li>JavaScript location 对象</li><li>JavaScript navigator 对象</li><li>JavaScript screen 对象</li></ul><p><img src="/image/JavaScript02/JavaScript02_002.png" alt=""></p><p><strong>JavaScript 是面向对象的语言，但 JavaScript 不使用类。</strong></p><p>More info: <a href="https://www.w3cschool.cn/javascript" target="_blank" rel="noopener">JavaScript教程</a></p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JavaScript（一）JavaScript的基本知识(上)</title>
      <link href="/2016/10/15/JavaScript01/"/>
      <url>/2016/10/15/JavaScript01/</url>
      <content type="html"><![CDATA[<p> <strong>JavaScript 是世界上最流行的脚本语言， 是属于 HTML 和 Web 的编程语言。</strong> 本文章主要介绍 JavaScript 的基本语法。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>JavaScript 是 web 开发者必学的三种语言之一：</p><ul><li>HTML 定义网页的内容</li><li>CSS 规定网页的布局</li><li>JavaScript 对网页行为进行编程</li></ul><h3 id="一、用途"><a href="#一、用途" class="headerlink" title="一、用途"></a>一、用途</h3><ul><li>JavaScript 能够改变 HTML 内容</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>JavaScript 能做什么<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>JavaScript 能够改变 HTML 内容。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">'document.getElementById("demo").innerHTML = "Hello JavaScript!"'</span>&gt;</span>点击我！<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>JavaScript 能够改变 HTML 属性</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>JavaScript 能做什么？<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>JavaScript 能够改变 HTML 属性值。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>在本例中，JavaScript 改变了图像的 src 属性值。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('myImage').src='/i/eg_bulbon.gif'"</span>&gt;</span>开灯<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"myImage"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">src</span>=<span class="string">"/i/eg_bulboff.gif"</span> <span class="attr">style</span>=<span class="string">"text-align:center;"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('myImage').src='/i/eg_bulboff.gif'"</span>&gt;</span>关灯<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>JavaScript 能够改变 HTML 样式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>JavaScript 能够做什么<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>JavaScript 能够改变 HTML 元素的样式。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('demo').style.fontSize='35px'"</span>&gt;</span></span><br><span class="line">点击我！</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>JavaScript 能够隐藏 HTML 元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>JavaScript 能够做什么<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>JavaScript 能够隐藏 HTML 元素。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('demo').style.display='none'"</span>&gt;</span></span><br><span class="line">点击我！</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>JavaScript 能够显示 HTML 元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>JavaScript 能够做什么<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>JavaScript 能够显示隐藏的 HTML 元素。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span> <span class="attr">style</span>=<span class="string">"display:none"</span>&gt;</span>Hello JavaScript!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"document.getElementById('demo').style.display='block'"</span>&gt;</span></span><br><span class="line">点击我！</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="二、使用"><a href="#二、使用" class="headerlink" title="二、使用"></a>二、使用</h3><p>在 HTML 中， 脚本可被放置与 HTML 页面的 <code>&lt;body&gt;</code> 或 <code>&lt;head&gt;</code> 部分中 <code>&lt;script&gt;</code> 与 <code>&lt;/script&gt;</code> 标签之间。</p><h4 id="内部引用"><a href="#内部引用" class="headerlink" title="内部引用"></a>内部引用</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = <span class="string">"段落被更改。"</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>一张网页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"myFunction()"</span>&gt;</span>试一试<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="外部引用"><a href="#外部引用" class="headerlink" title="外部引用"></a>外部引用</h4><ul><li><p>分离了 HTML 和代码</p></li><li><p>使 HTML 和 JavaScript 更易于阅读和维护</p></li><li><p>已缓存的 JavaScript 文件可加速页面加载</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 外部myScript.js</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = <span class="string">"段落被更改。"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"myScript.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="三、基本语法"><a href="#三、基本语法" class="headerlink" title="三、基本语法"></a>三、基本语法</h3><h4 id="3-1-输出"><a href="#3-1-输出" class="headerlink" title="3.1.输出"></a>3.1.输出</h4><ul><li>使用 window.alert() 写入警告框</li><li>使用 document.write() 写入 HTML 输出</li><li>使用 innerHTML 写入 HTML 元素</li><li>使用 console.log() 写入浏览器控制台</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一张网页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"> <span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = <span class="number">5</span> + <span class="number">6</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一张网页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"> <span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = <span class="number">5</span> + <span class="number">6</span>;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一张网页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.alert(<span class="number">5</span> + <span class="number">6</span>);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一张网页<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 在 debugger 中选择 "Console"。然后再次点击运行按钮。 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">console</span>.log(<span class="number">5</span> + <span class="number">6</span>);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-语句"><a href="#3-2-语句" class="headerlink" title="3.2.语句"></a>3.2.语句</h4><p>由 值、运算符、表达式、关键词和注释构成。</p><ul><li>关键词：代码内部用于标识被执行的动作</li><li>值：字面量（具体的数据）和变量值（存储字面量的名称）</li><li>运算符：如算数运算符（+ - * /）</li><li>表达式：变量和运算符的组合，计算结果是值</li><li>注释：代码描述说明</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x, y;<span class="comment">// 如何声明变量</span></span><br><span class="line">x = <span class="number">7</span>; y = <span class="number">8</span>;<span class="comment">// 如何赋值</span></span><br><span class="line">z = x + y;<span class="comment">// 如何计算值</span></span><br></pre></td></tr></table></figure><p>关键词指的是保留的单词。保留词无法用作变量名。</p><table><thead><tr><th style="text-align:left">关键词</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">break</td><td style="text-align:left">终止 switch 或循环。</td></tr><tr><td style="text-align:left">continue</td><td style="text-align:left">跳出循环并在顶端开始。</td></tr><tr><td style="text-align:left">debugger</td><td style="text-align:left">停止执行 JavaScript，并调用调试函数（如果可用）。</td></tr><tr><td style="text-align:left">do … while</td><td style="text-align:left">执行语句块，并在条件为真时重复代码块。</td></tr><tr><td style="text-align:left">for</td><td style="text-align:left">标记需被执行的语句块，只要条件为真。</td></tr><tr><td style="text-align:left">function</td><td style="text-align:left">声明函数。</td></tr><tr><td style="text-align:left">if … else</td><td style="text-align:left">标记需被执行的语句块，根据某个条件。</td></tr><tr><td style="text-align:left">return</td><td style="text-align:left">退出函数。</td></tr><tr><td style="text-align:left">switch</td><td style="text-align:left">标记需被执行的语句块，根据不同的情况。</td></tr><tr><td style="text-align:left">try … catch</td><td style="text-align:left">对语句块实现错误处理。</td></tr><tr><td style="text-align:left">var</td><td style="text-align:left">声明变量。</td></tr></tbody></table><p><strong>注意:</strong></p><ul><li>1.使用分号分隔语句</li><li>2.增加适当空格(符号之间或者代码块的缩进)提高可读性 </li><li>3.代码行控制在 80 个字符以内 </li><li>4.使用花括号包围代码块</li><li>5.双斜杠 // 或 /<em> 与 </em>/ 之间的代码被视为注释</li></ul><h4 id="3-3-标识符"><a href="#3-3-标识符" class="headerlink" title="3.3.标识符"></a>3.3.标识符</h4><p>标识符:有 变量 和 关键词。下面是命名规则：</p><ul><li>名称可包含字母、数字、下划线和美元符号</li><li>名称必须以字母开头</li><li>名称也可以 $ 和 _ 开头（一般不会这么做）</li><li>名称对大小写敏感（y 和 Y 是不同的变量）</li><li>保留字（比如 JavaScript 的关键词）无法用作变量名称</li></ul><h4 id="3-4-变量"><a href="#3-4-变量" class="headerlink" title="3.4.变量"></a>3.4.变量</h4><p>存储数据值的容器，变量必须以唯一的名称的标识。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 声明未定义,值为undefined</span></span><br><span class="line"><span class="keyword">var</span> carName;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明且定义</span></span><br><span class="line"><span class="keyword">var</span> carName = <span class="string">"porsche"</span>;</span><br><span class="line"><span class="keyword">var</span> person = <span class="string">"Bill Gates"</span>, carName = <span class="string">"porsche"</span>, price = <span class="number">15000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重复声明 </span></span><br><span class="line"><span class="keyword">var</span> carName = <span class="string">"porsche"</span>;</span><br><span class="line"><span class="keyword">var</span> carName;</span><br></pre></td></tr></table></figure><h4 id="3-5-数据类型"><a href="#3-5-数据类型" class="headerlink" title="3.5.数据类型"></a>3.5.数据类型</h4><p>变量可用作不同类型</p><ul><li>数据类型<ul><li><a href="#字符串值">字符串值</a></li><li><a href="#数值">数值</a></li><li><a href="#布尔值">布尔值</a></li><li>不包含任何值<ul><li><a href="#undefined">undefined</a></li><li>null</li></ul></li><li>function</li></ul></li><li>对象类型<ul><li><a href="#对象">object</a></li><li>Date</li><li>Array</li></ul></li></ul><h5 id="字符串值"><a href="#字符串值" class="headerlink" title="字符串值"></a>字符串值</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字符串</span></span><br><span class="line"><span class="keyword">var</span> answer = <span class="string">"It's alright"</span>;             <span class="comment">// 双引号内的单引号</span></span><br><span class="line"><span class="keyword">var</span> answer = <span class="string">"He is called 'Bill'"</span>;    <span class="comment">// 双引号内的单引号</span></span><br><span class="line"><span class="keyword">var</span> answer = <span class="string">'He is called "Bill"'</span>;    <span class="comment">// 单引号内的双引号</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">"中国是瓷器的故乡，因此 china 与\"China（中国）\"同名。"</span>  <span class="comment">// 转义字符\</span></span><br><span class="line"><span class="keyword">var</span> firstName = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"Bill"</span>)   <span class="comment">// 字符串对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串的长度</span></span><br><span class="line"><span class="keyword">var</span> sln = answer.length; </span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回字符串中指定文本首次出现的索引</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"The full name of China is the People's Republic of China."</span>;</span><br><span class="line"><span class="keyword">var</span> pos = str.indexOf(<span class="string">"China"</span>);  </span><br><span class="line"><span class="keyword">var</span> pos = str.indexOf(<span class="string">"China"</span>, <span class="number">18</span>);  <span class="comment">// 18是起始位</span></span><br><span class="line"><span class="keyword">var</span> pos = str.search(<span class="string">"locate"</span>); <span class="comment">// 支持正则</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回指定文本在字符串中最后一次出现的索引</span></span><br><span class="line"><span class="keyword">var</span> pos = str.lastIndexOf(<span class="string">"China"</span>);</span><br><span class="line"><span class="keyword">var</span> pos = str.lastIndexOf(<span class="string">"China"</span>, <span class="number">15</span>); <span class="comment">// 15是起始位</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 截取字符串</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"Apple, Banana, Mango"</span>;</span><br><span class="line"><span class="keyword">var</span> res = str.slice(<span class="number">7</span>,<span class="number">13</span>);</span><br><span class="line"><span class="keyword">var</span> res = str.slice(<span class="number">-13</span>,<span class="number">-7</span>);</span><br><span class="line"><span class="keyword">var</span> res = str.slice(<span class="number">7</span>);</span><br><span class="line"><span class="keyword">var</span> res = str.substring(<span class="number">7</span>,<span class="number">13</span>);  <span class="comment">// 无法接受负的索引</span></span><br><span class="line"><span class="keyword">var</span> res = str.substr(<span class="number">7</span>,<span class="number">6</span>);  <span class="comment">// 第二个参数规定被提取部分的长度</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取字符串字符</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"HELLO WORLD"</span>;</span><br><span class="line">str.charAt(<span class="number">0</span>);            <span class="comment">// 返回 H</span></span><br><span class="line">str.charCodeAt(<span class="number">0</span>);         <span class="comment">// 返回 unicode 编码 72</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 替换字符串,只替换首个匹配</span></span><br><span class="line"><span class="keyword">var</span> n1 = str.replace(<span class="string">"Banana"</span>, <span class="string">"W3School"</span>);</span><br><span class="line"><span class="keyword">var</span> n2 = str.replace(<span class="regexp">/BANANA/i</span>, <span class="string">"W3School"</span>); <span class="comment">//大小写不敏感的替换,正则不需要双引号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为大写和小写</span></span><br><span class="line"><span class="keyword">var</span> text2 = n1.toUpperCase();  <span class="comment">// BANANA</span></span><br><span class="line"><span class="keyword">var</span> text2 = n1.toLowerCase();  <span class="comment">// banana</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//连接两个或多个字符串</span></span><br><span class="line"><span class="keyword">var</span> text = <span class="string">"Hello"</span> + <span class="string">" "</span> + <span class="string">"World!"</span>;</span><br><span class="line"><span class="keyword">var</span> text = <span class="string">"Hello"</span>.concat(<span class="string">" "</span>,<span class="string">"World!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除字符串两端的空白符</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"       Hello World!        "</span>;</span><br><span class="line">alert(str.trim());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性访问</span></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">"HELLO WORLD"</span>;</span><br><span class="line">str[<span class="number">0</span>];                   <span class="comment">// 返回 H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把字符串转换为数组</span></span><br><span class="line"><span class="keyword">var</span> txt = <span class="string">"a,b,c,d,e"</span>;   <span class="comment">// 字符串</span></span><br><span class="line">txt.split(<span class="string">","</span>);          <span class="comment">// 用逗号分隔</span></span><br></pre></td></tr></table></figure><h5 id="数值"><a href="#数值" class="headerlink" title="数值"></a>数值</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数值:64 位的浮点数 </span></span><br><span class="line"><span class="keyword">var</span> x1 = <span class="number">34.00</span>;     <span class="comment">// 带小数点</span></span><br><span class="line"><span class="keyword">var</span> x2 = <span class="number">34</span>;        <span class="comment">// 不带小数点</span></span><br><span class="line"><span class="keyword">var</span> y = <span class="number">123e5</span>;      <span class="comment">// 12300000</span></span><br><span class="line"><span class="keyword">var</span> z = <span class="number">123e-5</span>;     <span class="comment">// 0.00123</span></span><br><span class="line"><span class="comment">// 整数（不使用指数或科学计数法）会被精确到 15 位 </span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">999999999999999</span>;   <span class="comment">// x 将是 999999999999999</span></span><br><span class="line"><span class="keyword">var</span> y = <span class="number">9999999999999999</span>;  <span class="comment">// y 将是 10000000000000000</span></span><br><span class="line"><span class="comment">// 小数的最大数是 17 位，但是浮点的算数并不总是 100% 精准</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">0.2</span> + <span class="number">0.1</span>;         <span class="comment">// x 将是 0.30000000000000004</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把要给数值放入引号中，其余数值会被视作字符串并被级联。</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">"Bill"</span> + <span class="string">" "</span> + <span class="string">"Gates"</span>;</span><br><span class="line"><span class="keyword">var</span> x = <span class="string">"8"</span> + <span class="number">3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 数字运算中（加法除外），将字符串转换为数字</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">"100"</span>;</span><br><span class="line"><span class="keyword">var</span> y = <span class="string">"10"</span>;</span><br><span class="line"><span class="keyword">var</span> z = x / y;       <span class="comment">// z 将是 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// NaN 属于 JavaScript 保留词，指示某个数不是合法数。</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">100</span> / <span class="string">"Apple"</span>;  <span class="comment">// x 将是 NaN（Not a Number）</span></span><br><span class="line"><span class="built_in">isNaN</span>(x);               <span class="comment">// 返回 true，因为 x 不是数</span></span><br><span class="line"><span class="keyword">var</span> y = <span class="string">"5"</span>;</span><br><span class="line"><span class="keyword">var</span> z = x + y;         <span class="comment">// z 将是 NaN5</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">NaN</span>;             <span class="comment">// 返回 "number"</span></span><br><span class="line"><span class="comment">// Infinity （或 -Infinity）是 JavaScript 在计算数时超出最大可能数范围时返回的值。</span></span><br><span class="line"><span class="keyword">var</span> x =  <span class="number">2</span> / <span class="number">0</span>;          <span class="comment">// x 将是 Infinity</span></span><br><span class="line"><span class="keyword">var</span> y = <span class="number">-2</span> / <span class="number">0</span>;          <span class="comment">// y 将是 -Infinity</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">Infinity</span>;        <span class="comment">// 返回 "number"</span></span><br><span class="line"><span class="comment">// 前缀为 0x 的数值常量解释为十六进制</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">0xFF</span>;             <span class="comment">// x 将是 255</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数字对象</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">123</span>);   <span class="comment">// typeof a 返回 object</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">500</span>;   </span><br><span class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">500</span>); <span class="comment">// (x == y) 为 true,因为 x 和 y 有相等的值(x === y) 为 false,类型不同</span></span><br><span class="line"><span class="keyword">var</span> z = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">500</span>); <span class="comment">// (y == z) 为 false,因为对象不可以比较</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为字符串</span></span><br><span class="line"><span class="keyword">var</span> myNumber = <span class="number">128</span>;</span><br><span class="line">myNumber.toString(<span class="number">16</span>);     <span class="comment">// 返回 80</span></span><br><span class="line">myNumber.toString(<span class="number">8</span>);      <span class="comment">// 返回 200</span></span><br><span class="line">myNumber.toString(<span class="number">2</span>);      <span class="comment">// 返回 10000000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回字符串值，它包含已被四舍五入并使用指数计数法的数字。</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">9.656</span>;</span><br><span class="line">x.toExponential(<span class="number">2</span>);     <span class="comment">// 返回 9.66e+0</span></span><br><span class="line">x.toExponential(<span class="number">4</span>);     <span class="comment">// 返回 9.6560e+0</span></span><br><span class="line">x.toExponential(<span class="number">6</span>);     <span class="comment">// 返回 9.656000e+0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回字符串值，它包含了指定位数小数的数字</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">9.656</span>;</span><br><span class="line">x.toFixed(<span class="number">0</span>);           <span class="comment">// 返回 10</span></span><br><span class="line">x.toFixed(<span class="number">2</span>);           <span class="comment">// 返回 9.66</span></span><br><span class="line">x.toFixed(<span class="number">4</span>);           <span class="comment">// 返回 9.6560</span></span><br><span class="line">x.toFixed(<span class="number">6</span>);           <span class="comment">// 返回 9.656000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回字符串值，它包含了指定长度的数字：</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="number">9.656</span>;</span><br><span class="line">x.toPrecision();        <span class="comment">// 返回 9.656</span></span><br><span class="line">x.toPrecision(<span class="number">2</span>);       <span class="comment">// 返回 9.7</span></span><br><span class="line">x.toPrecision(<span class="number">4</span>);       <span class="comment">// 返回 9.656</span></span><br><span class="line">x.toPrecision(<span class="number">6</span>);       <span class="comment">// 返回 9.65600</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  返回对象的原始值</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">123</span>);</span><br><span class="line">a.valueOf();   <span class="comment">// 从表达式 100 + 23 返回 123</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换为数字</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">"10"</span>);        <span class="comment">// 返回 10</span></span><br><span class="line">x = <span class="built_in">Number</span>(<span class="string">"10 20"</span>);        <span class="comment">// 返回 NaN</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"2019-04-15"</span>));    <span class="comment">// 返回 1506729600000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 解析一段字符串并返回数值。允许空格。只返回首个数字：</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">"10 years"</span>);   <span class="comment">// 返回 10</span></span><br><span class="line"><span class="built_in">parseInt</span>(<span class="string">"years 10"</span>);   <span class="comment">// 返回 NaN</span></span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="string">"10.33"</span>);     <span class="comment">// 返回 10.33</span></span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="string">"10 years"</span>);  <span class="comment">// 返回 10</span></span><br><span class="line"><span class="built_in">parseFloat</span>(<span class="string">"10 20 30"</span>);  <span class="comment">// 返回 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数值属性</span></span><br><span class="line">MAX_VALUE<span class="comment">// 返回 JavaScript 中可能的最大数。</span></span><br><span class="line">MIN_VALUE<span class="comment">// 返回 JavaScript 中可能的最小数。</span></span><br><span class="line">NEGATIVE_INFINITY<span class="comment">// 表示负的无穷大（溢出返回）。</span></span><br><span class="line"><span class="literal">NaN</span><span class="comment">// 表示非数字值（"Not-a-Number"）。</span></span><br><span class="line">POSITIVE_INFINITY<span class="comment">// 表示无穷大（溢出返回）。</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="built_in">Number</span>.MAX_VALUE; <span class="comment">// 数字属性不可用于变量</span></span><br></pre></td></tr></table></figure><h5 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 布尔值</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> y = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure><h5 id="undefined"><a href="#undefined" class="headerlink" title="undefined"></a>undefined</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 空</span></span><br><span class="line"><span class="keyword">var</span> person;                  <span class="comment">// 值是 undefined，类型是 undefined</span></span><br><span class="line">person = <span class="literal">undefined</span>;          <span class="comment">// 值是 undefined，类型是 undefined</span></span><br><span class="line"><span class="keyword">var</span> car = <span class="string">""</span>;                <span class="comment">// 值是 ""，类型是 "string"</span></span><br><span class="line"><span class="keyword">var</span> person = <span class="literal">null</span>;           <span class="comment">// 值是 null，但是类型仍然是对象</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">undefined</span>              <span class="comment">// undefined</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>                   <span class="comment">// object</span></span><br><span class="line"><span class="literal">null</span> === <span class="literal">undefined</span>            <span class="comment">// false</span></span><br><span class="line"><span class="literal">null</span> == <span class="literal">undefined</span>             <span class="comment">// true 等值不等型</span></span><br></pre></td></tr></table></figure><h5 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组:一种特殊类型的对象,使用数字索引</span></span><br><span class="line"><span class="keyword">var</span> array_name = [item1, item2, ...];</span><br><span class="line"><span class="keyword">var</span> cars = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="string">"Saab"</span>, <span class="string">"Volvo"</span>, <span class="string">"BMW"</span>);</span><br><span class="line"><span class="keyword">var</span> cars = [<span class="string">"Porsche"</span>, <span class="string">"Volvo"</span>, <span class="string">"BMW"</span>]; <span class="comment">// 请不要最后一个元素之后写逗号（比如 "BMW",）。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name = cars[<span class="number">0</span>]; <span class="comment">// Porsche 通过引用索引号（下标号）来引用某个数组元素</span></span><br><span class="line">cars[<span class="number">0</span>] = <span class="string">"Opel"</span>;  <span class="comment">// 改变数组元素</span></span><br><span class="line">cars.length;  <span class="comment">// 返回数组的长度（数组元素的数目）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fruits = [<span class="string">"Banana"</span>, <span class="string">"Orange"</span>, <span class="string">"Apple"</span>, <span class="string">"Mango"</span>];</span><br><span class="line">fruits.push(<span class="string">"Lemon"</span>);                <span class="comment">// 向 fruits 添加一个新元素 (Lemon),x 的值是 5(返回新数组的长度)</span></span><br><span class="line">fruits[fruits.length] = <span class="string">"Lemon"</span>;     <span class="comment">// 向 fruits 添加一个新元素 (Lemon)</span></span><br><span class="line"><span class="keyword">var</span> x = fruits.pop(); <span class="comment">// fruits 删除最后一个元素（"Mango"）,x 的值是 "Mango"</span></span><br><span class="line"><span class="keyword">var</span> x = fruits.shift();            <span class="comment">// 从 fruits 删除第一个元素 "Banana",x 的值是 "Banana</span></span><br><span class="line"><span class="keyword">delete</span> fruits[<span class="number">0</span>];           <span class="comment">// 把 fruits 中的首个元素改为 undefined</span></span><br><span class="line">fruits.unshift(<span class="string">"Lemon"</span>);    <span class="comment">// 向 fruits 添加新元素 "Lemon", 返回新数组的长度</span></span><br><span class="line"><span class="keyword">var</span> removed = fruits.splice(<span class="number">2</span>, <span class="number">2</span>, <span class="string">"Lemon"</span>, <span class="string">"Kiwi"</span>);  <span class="comment">// 从位置 2 开始删除 2 个元素 添加新元素 "Lemon,Kiwi", 返回删除元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组转换字符串</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = fruits.toString(); <span class="comment">// Banana,Orange,Apple,Mango</span></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = fruits.join(<span class="string">" * "</span>); <span class="comment">// Banana * Orange * Apple * Mango</span></span><br><span class="line"><span class="keyword">var</span> myGirls = [<span class="string">"Emma"</span>, <span class="string">"Isabella"</span>];</span><br><span class="line"><span class="keyword">var</span> myBoys = [<span class="string">"Jacob"</span>, <span class="string">"Michael"</span>, <span class="string">"Ethan"</span>];</span><br><span class="line"><span class="keyword">var</span> myChildren = myGirls.concat(myBoys);  <span class="comment">// Emma,Isabella,Jacob,Michael,Ethan</span></span><br><span class="line"><span class="keyword">var</span> arr1 = [<span class="string">"Cecilie"</span>, <span class="string">"Lone"</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = [<span class="string">"Emil"</span>, <span class="string">"Tobias"</span>, <span class="string">"Linus"</span>];</span><br><span class="line"><span class="keyword">var</span> arr3 = [<span class="string">"Robin"</span>, <span class="string">"Morgan"</span>];</span><br><span class="line"><span class="keyword">var</span> myChildren = arr1.concat(arr2, arr3);   <span class="comment">// 将arr1、arr2 与 arr3 连接在一起</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 切片新数组</span></span><br><span class="line"><span class="keyword">var</span> fruits = [<span class="string">"Banana"</span>, <span class="string">"Orange"</span>, <span class="string">"Lemon"</span>, <span class="string">"Apple"</span>, <span class="string">"Mango"</span>];</span><br><span class="line"><span class="keyword">var</span> citrus = fruits.slice(<span class="number">3</span>);  <span class="comment">// Apple,Mango</span></span><br><span class="line"><span class="keyword">var</span> citrus = fruits.slice(<span class="number">1</span>, <span class="number">3</span>); <span class="comment">// Orange,Lemon</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 最大值</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="built_in">Math</span>.max(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) <span class="comment">// 不允许直接放入数组</span></span><br><span class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, arr)</span><br><span class="line"><span class="built_in">Math</span>.min(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) </span><br><span class="line"><span class="built_in">Math</span>.min.apply(<span class="literal">null</span>, arr)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历数组</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; cars.length; i++) &#123;</span><br><span class="line">     text += <span class="string">"&lt;li&gt;"</span> + cars[i] + <span class="string">"&lt;/li&gt;"</span>;</span><br><span class="line">&#125; </span><br><span class="line">text1 = <span class="string">"&lt;ul&gt;"</span>;</span><br><span class="line">text2 = <span class="string">"&lt;ul&gt;"</span>;</span><br><span class="line">text3 = <span class="string">"&lt;ul&gt;"</span>;</span><br><span class="line">fruits.forEach(myFunction);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  text1 += <span class="string">"&lt;li&gt;"</span> + value + <span class="string">"&lt;/li&gt;"</span>; <span class="comment">// 项目值</span></span><br><span class="line">  text2 += <span class="string">"&lt;li&gt;"</span> + index + <span class="string">"&lt;/li&gt;"</span>; <span class="comment">// 项目索引</span></span><br><span class="line">  text3 += <span class="string">"&lt;li&gt;"</span> + array + <span class="string">"&lt;/li&gt;"</span>; <span class="comment">// 数组本身</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以字母顺序对数组进行排序：</span></span><br><span class="line">fruits.sort();            <span class="comment">// 对 fruits 中的元素进行排序</span></span><br><span class="line">fruits.reverse();         <span class="comment">// 反转元素顺序</span></span><br><span class="line"><span class="keyword">var</span> points = [<span class="number">40</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">25</span>, <span class="number">10</span>];</span><br><span class="line">points.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;<span class="keyword">return</span> a - b&#125;); <span class="comment">// 数字也会当作字符串比较,需要用比值函数</span></span><br><span class="line">points.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>)</span>&#123;<span class="keyword">return</span> <span class="number">0.5</span> - <span class="built_in">Math</span>.random()&#125;); <span class="comment">// 随机顺序排序数组</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> numbers = [<span class="number">45</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>];</span><br><span class="line"><span class="comment">// 对每个数组元素执行函数来创建新数组</span></span><br><span class="line"><span class="keyword">var</span> numbers2 = numbers.map(myFunction);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 过滤,创建一个包含通过测试的数组元素的新数组</span></span><br><span class="line"><span class="keyword">var</span> over18 = numbers.filter(myFunction);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 检查所有数组值是否通过测试</span></span><br><span class="line"><span class="keyword">var</span> allOver18 = numbers.every(myFunction); <span class="comment">// True</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 检查所有数组值是否通过测试</span></span><br><span class="line"><span class="keyword">var</span> allOver18 = numbers.every(myFunction); <span class="comment">// True</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 检查数组值是否有通过测试</span></span><br><span class="line"><span class="keyword">var</span> allOver18 = numbers.some(myFunction); <span class="comment">// True</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 返回通过测试函数的第一个数组元素的值</span></span><br><span class="line"><span class="keyword">var</span> first = numbers.find(myFunction);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 返回通过测试函数的第一个数组元素的索引</span></span><br><span class="line"><span class="keyword">var</span> first = numbers.findIndex(myFunction);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> value &gt; <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 在数组中搜索元素值并返回其位置</span></span><br><span class="line"><span class="keyword">var</span> a = points.indexOf(<span class="number">100</span>,<span class="number">0</span>)  <span class="comment">// a为1,第二个参数可选 是起始位,搜索到结尾</span></span><br><span class="line"><span class="keyword">var</span> a = fruits.lastIndexOf(<span class="number">100</span>);  <span class="comment">// a为1,第二个参数可选 是起始位,搜索到开头</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 递归</span></span><br><span class="line"><span class="keyword">var</span> sum = numbers.reduce(myFunction,<span class="number">100</span>); <span class="comment">// 100为初始值,可选填</span></span><br><span class="line"><span class="keyword">var</span> sum = numbers1.reduceRight(myFunction);  <span class="comment">// 在数组中从右到左工作</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">total, value, index, array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> total + value;  <span class="comment">// total:总数（初始值/先前返回的值）</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断是否数组</span></span><br><span class="line"><span class="built_in">Array</span>.isArray(fruits);     <span class="comment">// 返回 true</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isArray</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.constructor.toString().indexOf(<span class="string">"Array"</span>) &gt; <span class="number">-1</span>;</span><br><span class="line">&#125; <span class="comment">// 自定义</span></span><br><span class="line">fruits <span class="keyword">instanceof</span> <span class="built_in">Array</span>     <span class="comment">// 返回 true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 日期,格式Thu Dec 03 2020 20:32:48 GMT+0800 (中国标准时间)</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(); </span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month, day, hours, minutes, seconds, milliseconds)</span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2018</span>, <span class="number">11</span>);  <span class="comment">// year month</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">99</span>, <span class="number">11</span>, <span class="number">24</span>); <span class="comment">// 一位和两位数年份将被解释为 19xx 年</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2018</span>, <span class="number">11</span>, <span class="number">24</span>); <span class="comment">// year month day</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2018</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">10</span>); <span class="comment">// year month day hours</span></span><br><span class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"October 13, 2014 11:13:00"</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(milliseconds);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(date string);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象使用命名索引</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;<span class="attr">firstName</span>:<span class="string">"Bill"</span>, <span class="attr">lastName</span>:<span class="string">"Gates"</span>, <span class="attr">age</span>:<span class="number">62</span>, <span class="attr">eyeColor</span>:<span class="string">"blue"</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typeof</span> &#123;<span class="attr">name</span>:<span class="string">'Bill'</span>, <span class="attr">age</span>:<span class="number">62</span>&#125; <span class="comment">// 返回 "object"</span></span><br><span class="line"><span class="keyword">typeof</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]             <span class="comment">// 返回 "object" (数组也是对象)</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>                  <span class="comment">// 返回 "object"</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunc</span>(<span class="params"></span>)</span>&#123;&#125;   <span class="comment">// 返回 "function"</span></span><br><span class="line"><span class="comment">// 访问对象属性</span></span><br><span class="line">objectName.propertyName</span><br><span class="line">objectName[<span class="string">"propertyName"</span>]</span><br><span class="line"><span class="comment">// 访问对象方法</span></span><br><span class="line">objectName.methodName()</span><br><span class="line">name = person.fullName; <span class="comment">// 不使用 () 访问 fullName 方法，则将返回函数定义：</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:left">代码</th><th style="text-align:left">结果</th></tr></thead><tbody><tr><td style="text-align:left">\b</td><td style="text-align:left">退格键</td></tr><tr><td style="text-align:left">\f</td><td style="text-align:left">换页</td></tr><tr><td style="text-align:left">\n</td><td style="text-align:left">新行</td></tr><tr><td style="text-align:left">\r</td><td style="text-align:left">回车</td></tr><tr><td style="text-align:left">\t</td><td style="text-align:left">水平制表符</td></tr><tr><td style="text-align:left">\v</td><td style="text-align:left">垂直制表符</td></tr></tbody></table><h5 id="获取类型"><a href="#获取类型" class="headerlink" title="获取类型"></a>获取类型</h5><ul><li>typeof<ul><li>使用 typeof 操作符来查看 JavaScript 变量的数据类型。</li><li>NaN 的数据类型是 number</li><li>数组(Array)的数据类型是 object</li><li>日期(Date)的数据类型为 object</li><li>null 的数据类型是 object</li><li>未定义变量的数据类型为 undefined</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="string">"John"</span>                 <span class="comment">// 返回 string</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="number">3.14</span>                   <span class="comment">// 返回 number</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">NaN</span>                    <span class="comment">// 返回 number</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">false</span>                  <span class="comment">// 返回 boolean</span></span><br><span class="line"><span class="keyword">typeof</span> [ <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]              <span class="comment">// 返回 object</span></span><br><span class="line"><span class="keyword">typeof</span> &#123;<span class="attr">name</span>: <span class="string">'John'</span>, <span class="attr">age</span>:<span class="number">34</span>&#125;  <span class="comment">// 返回 object</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Date</span>()             <span class="comment">// 返回 object</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;         <span class="comment">// 返回 function</span></span><br><span class="line"><span class="keyword">typeof</span> myCar                  <span class="comment">// 返回 undefined (如果 myCar没有被实例化的话)</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span>                   <span class="comment">// 返回 object</span></span><br></pre></td></tr></table></figure><p>如果对象是 JavaScript Array 或 JavaScript Date ，我们就无法通过 <strong>typeof</strong> 来判断他们的类型，因为都是 返回 Object。</p><ul><li>constructor</li></ul><p>constructor 属性返回所有 JavaScript 变量的构造函数。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"John"</span>.constructor                 <span class="comment">// 返回函数 String()  &#123; [native code] &#125;</span></span><br><span class="line">(<span class="number">3.14</span>).constructor                 <span class="comment">// 返回函数 Number()  &#123; [native code] &#125;</span></span><br><span class="line"><span class="literal">false</span>.constructor                  <span class="comment">// 返回函数 Boolean() &#123; [native code] &#125;</span></span><br><span class="line">[<span class="number">1</span>,<span class="number">2</span>, <span class="number">3</span>,<span class="number">4</span>].constructor              <span class="comment">// 返回函数 Array()   &#123; [native code] &#125;</span></span><br><span class="line">&#123;<span class="attr">name</span>:<span class="string">'John'</span>, <span class="attr">age</span>:<span class="number">34</span>&#125;.constructor  <span class="comment">// 返回函数 Object()  &#123; [native code] &#125;</span></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Date</span>().constructor             <span class="comment">// 返回函数 Date()    &#123; [native code] &#125;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;.constructor         <span class="comment">// 返回函数 Function()&#123; [native code] &#125;</span></span><br></pre></td></tr></table></figure><h5 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h5><p>JavaScript 变量可以转换为新变量或其他数据类型：</p><ul><li>通过使用 JavaScript 函数</li><li>通过 JavaScript 自身自动转换</li></ul><h6 id="转换为字符串"><a href="#转换为字符串" class="headerlink" title="转换为字符串"></a>转换为字符串</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将数字转换为字符串</span></span><br><span class="line"><span class="built_in">String</span>(x)         <span class="comment">// 将变量 x 转换为字符串并返回</span></span><br><span class="line"><span class="built_in">String</span>(<span class="number">123</span>)       <span class="comment">// 将数字 123 转换为字符串并返回</span></span><br><span class="line"><span class="built_in">String</span>( <span class="number">100</span>+ <span class="number">23</span>)  <span class="comment">// 将数字表达式转换为字符串并返回</span></span><br><span class="line">x.toString()</span><br><span class="line">(<span class="number">123</span>).toString()</span><br><span class="line">(<span class="number">100</span> + <span class="number">23</span>).toString()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将布尔值转换为字符串</span></span><br><span class="line"><span class="built_in">String</span>(<span class="literal">false</span>)        <span class="comment">// 返回 "false"</span></span><br><span class="line"><span class="built_in">String</span>(<span class="literal">true</span>)         <span class="comment">// 返回 "true"</span></span><br><span class="line"><span class="literal">false</span>.toString()     <span class="comment">// 返回 "false"</span></span><br><span class="line"><span class="literal">true</span>.toString()      <span class="comment">// 返回 "true"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将日期转换为字符串</span></span><br><span class="line"><span class="built_in">String</span>(<span class="built_in">Date</span>())      <span class="comment">// 返回 Thu Jul 17 2014 15:38:19 GMT+0200 (W. Europe Daylight Time)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Date</span>().toString()   <span class="comment">// 返回 Thu Jul 17 2014 15:38:19 GMT+0200 (W. Europe Daylight Time)</span></span><br></pre></td></tr></table></figure><h6 id="转换为数字"><a href="#转换为数字" class="headerlink" title="转换为数字"></a>转换为数字</h6><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将字符串转换为数字</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">"3.14"</span>)    <span class="comment">// 返回 3.14</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">" "</span>)       <span class="comment">// 返回 0</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">""</span>)        <span class="comment">// 返回 0</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="string">"99 88"</span>)   <span class="comment">// 返回 NaN</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 一元运算符 +</span></span><br><span class="line"><span class="keyword">var</span> y = <span class="string">"5"</span>;      <span class="comment">// y 是一个字符串</span></span><br><span class="line"><span class="keyword">var</span> x = + y;      <span class="comment">// x 是一个数字</span></span><br><span class="line"><span class="keyword">var</span> y = <span class="string">"John"</span>;   <span class="comment">// y 是一个字符串</span></span><br><span class="line"><span class="keyword">var</span> x = + y;      <span class="comment">// x 是一个数字 (NaN)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//将布尔值转换为数字</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="literal">false</span>)     <span class="comment">// 返回 0</span></span><br><span class="line"><span class="built_in">Number</span>(<span class="literal">true</span>)      <span class="comment">// 返回 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//将日期转换为数字</span></span><br><span class="line">d = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="built_in">Number</span>(d)          <span class="comment">// 返回 1404568027739</span></span><br><span class="line">d = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">d.getTime()        <span class="comment">// 返回 1404568027739</span></span><br></pre></td></tr></table></figure><h6 id="自动转换类型"><a href="#自动转换类型" class="headerlink" title="自动转换类型"></a>自动转换类型</h6><p>当 JavaScript 尝试操作一个 “错误” 的数据类型时，会自动转换为 “正确” 的数据类型。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> + <span class="literal">null</span>    <span class="comment">// 返回 5         because null is converted to 0</span></span><br><span class="line"><span class="string">"5"</span> + <span class="literal">null</span>  <span class="comment">// 返回"5null"   because null is converted to "null"</span></span><br><span class="line"><span class="string">"5"</span> + <span class="number">1</span>     <span class="comment">// 返回 "51"      because 1 is converted to "1" </span></span><br><span class="line"><span class="string">"5"</span> - <span class="number">1</span>     <span class="comment">// 返回 4         because "5" is converted to 5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).innerHTML = myVar;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if myVar = &#123;name:"Fjohn"&#125;  // toString 转换为 "[object Object]"</span></span><br><span class="line"><span class="comment">// if myVar = [1,2,3,4]       // toString 转换为 "1,2,3,4"</span></span><br><span class="line"><span class="comment">// if myVar = new Date()      // toString 转换为 "Fri Jul 18 2014 09:08:55 GMT+0200"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// if myVar = 123             // toString 转换为 "123"</span></span><br><span class="line"><span class="comment">// if myVar = true            // toString 转换为 "true"</span></span><br><span class="line"><span class="comment">// if myVar = false           // toString 转换为 "false"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person = <span class="literal">null</span>; <span class="comment">// 值为 null(空), 但类型为对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person; <span class="comment">// 值为 undefined(空), 类型是undefined</span></span><br></pre></td></tr></table></figure><h4 id="3-6-运算符"><a href="#3-6-运算符" class="headerlink" title="3.6.运算符"></a>3.6.运算符</h4><ul><li><a href="#算数运算">算数运算</a></li><li><a href="#赋值运算">赋值运算</a></li><li><a href="#比较运算符">比较运算符</a></li><li><a href="#逻辑运算符">逻辑运算符</a></li><li><a href="#类型运算符">类型运算符</a></li><li><a href="#位运算符">位运算符</a></li><li><a href="#运算符优先级值">运算符优先级值</a></li></ul><h5 id="算数运算"><a href="#算数运算" class="headerlink" title="算数运算"></a>算数运算</h5><p>算数运算符用于对数字执行算数运算：</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">+</td><td style="text-align:left">加法</td></tr><tr><td style="text-align:left">-</td><td style="text-align:left">减法</td></tr><tr><td style="text-align:left">*</td><td style="text-align:left">乘法</td></tr><tr><td style="text-align:left">/</td><td style="text-align:left">除法</td></tr><tr><td style="text-align:left">%</td><td style="text-align:left">系数</td></tr><tr><td style="text-align:left">++</td><td style="text-align:left">递加</td></tr><tr><td style="text-align:left">–</td><td style="text-align:left">递减</td></tr></tbody></table><h5 id="赋值运算"><a href="#赋值运算" class="headerlink" title="赋值运算"></a>赋值运算</h5><p>赋值运算符向 JavaScript 变量赋值。</p><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">例子</th><th style="text-align:left">等同于</th></tr></thead><tbody><tr><td style="text-align:left">=</td><td style="text-align:left">x = y</td><td style="text-align:left">x = y</td></tr><tr><td style="text-align:left">+=</td><td style="text-align:left">x += y</td><td style="text-align:left">x = x + y</td></tr><tr><td style="text-align:left">-=</td><td style="text-align:left">x -= y</td><td style="text-align:left">x = x - y</td></tr><tr><td style="text-align:left">*=</td><td style="text-align:left">x *= y</td><td style="text-align:left">x = x * y</td></tr><tr><td style="text-align:left">/=</td><td style="text-align:left">x /= y</td><td style="text-align:left">x = x / y</td></tr><tr><td style="text-align:left">%=</td><td style="text-align:left">x %= y</td><td style="text-align:left">x = x % y</td></tr></tbody></table><h5 id="比较预算符"><a href="#比较预算符" class="headerlink" title="比较预算符"></a>比较预算符</h5><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">==</td><td style="text-align:left">等于</td></tr><tr><td style="text-align:left">===</td><td style="text-align:left">等值等型</td></tr><tr><td style="text-align:left">!=</td><td style="text-align:left">不相等</td></tr><tr><td style="text-align:left">!==</td><td style="text-align:left">不等值或不等型</td></tr><tr><td style="text-align:left">&gt;</td><td style="text-align:left">大于</td></tr><tr><td style="text-align:left">&lt;</td><td style="text-align:left">小于</td></tr><tr><td style="text-align:left">&gt;=</td><td style="text-align:left">大于或等于</td></tr><tr><td style="text-align:left">&lt;=</td><td style="text-align:left">小于或等于</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">三元运算符</td></tr></tbody></table><h5 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h5><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">&amp;&amp;</td><td style="text-align:left">逻辑与</td></tr><tr><td style="text-align:left">\</td><td style="text-align:left">\</td><td></td><td>逻辑或</td></tr><tr><td style="text-align:left">!</td><td style="text-align:left">逻辑非</td></tr></tbody></table><h5 id="类型运算符"><a href="#类型运算符" class="headerlink" title="类型运算符"></a>类型运算符</h5><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">typeof</td><td style="text-align:left">返回变量的类型。</td></tr><tr><td style="text-align:left">instanceof</td><td style="text-align:left">返回 true，如果对象是对象类型的实例。</td></tr></tbody></table><h5 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h5><table><thead><tr><th style="text-align:left">运算符</th><th style="text-align:left">描述</th><th style="text-align:left">例子</th><th style="text-align:left">等同于</th><th style="text-align:left">结果</th><th style="text-align:left">十进制</th></tr></thead><tbody><tr><td style="text-align:left">&amp;</td><td style="text-align:left">与</td><td style="text-align:left">5 &amp; 1</td><td style="text-align:left">0101 &amp; 0001</td><td style="text-align:left">0001</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left">\</td><td style="text-align:left"></td><td style="text-align:left">或</td><td style="text-align:left">5 \</td><td style="text-align:left">1</td><td style="text-align:left">0101 \</td><td>0001</td><td>0101</td><td>5</td></tr><tr><td style="text-align:left">~</td><td style="text-align:left">非</td><td style="text-align:left">~ 5</td><td style="text-align:left">~0101</td><td style="text-align:left">1010</td><td style="text-align:left">10</td></tr><tr><td style="text-align:left">^</td><td style="text-align:left">异或</td><td style="text-align:left">5 ^ 1</td><td style="text-align:left">0101 ^ 0001</td><td style="text-align:left">0100</td><td style="text-align:left">4</td></tr><tr><td style="text-align:left">&lt;&lt;</td><td style="text-align:left">零填充左位移</td><td style="text-align:left">5 &lt;&lt; 1</td><td style="text-align:left">0101 &lt;&lt; 1</td><td style="text-align:left">1010</td><td style="text-align:left">10</td></tr><tr><td style="text-align:left">&gt;&gt;</td><td style="text-align:left">有符号右位移</td><td style="text-align:left">5 &gt;&gt; 1</td><td style="text-align:left">0101 &gt;&gt; 1</td><td style="text-align:left">0010</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left">&gt;&gt;&gt;</td><td style="text-align:left">零填充右位移</td><td style="text-align:left">5 &gt;&gt;&gt; 1</td><td style="text-align:left">0101 &gt;&gt;&gt; 1</td><td style="text-align:left">0010</td><td style="text-align:left">2</td></tr></tbody></table><h5 id="运算符优先级值"><a href="#运算符优先级值" class="headerlink" title="运算符优先级值"></a>运算符优先级值</h5><table><thead><tr><th style="text-align:left">值</th><th style="text-align:left">运算符</th><th style="text-align:left">描述</th><th style="text-align:left">实例</th></tr></thead><tbody><tr><td style="text-align:left">20</td><td style="text-align:left">( )</td><td style="text-align:left">表达式分组</td><td style="text-align:left">(3 + 4)</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">19</td><td style="text-align:left">.</td><td style="text-align:left">成员</td><td style="text-align:left">person.name</td></tr><tr><td style="text-align:left">19</td><td style="text-align:left">[]</td><td style="text-align:left">成员</td><td style="text-align:left">person[“name”]</td></tr><tr><td style="text-align:left">19</td><td style="text-align:left">()</td><td style="text-align:left">函数调用</td><td style="text-align:left">myFunction()</td></tr><tr><td style="text-align:left">19</td><td style="text-align:left">new</td><td style="text-align:left">创建</td><td style="text-align:left">new Date()</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">17</td><td style="text-align:left">++</td><td style="text-align:left">后缀递增</td><td style="text-align:left">i++</td></tr><tr><td style="text-align:left">17</td><td style="text-align:left">–</td><td style="text-align:left">后缀递减</td><td style="text-align:left">i–</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">16</td><td style="text-align:left">++</td><td style="text-align:left">前缀递增</td><td style="text-align:left">++i</td></tr><tr><td style="text-align:left">16</td><td style="text-align:left">–</td><td style="text-align:left">前缀递减</td><td style="text-align:left">–i</td></tr><tr><td style="text-align:left">16</td><td style="text-align:left">!</td><td style="text-align:left">逻辑否</td><td style="text-align:left">!(x==y)</td></tr><tr><td style="text-align:left">16</td><td style="text-align:left">typeof</td><td style="text-align:left">类型</td><td style="text-align:left">typeof x</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">15</td><td style="text-align:left">**</td><td style="text-align:left">求幂 (ES7)</td><td style="text-align:left">10 ** 2</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">14</td><td style="text-align:left">*</td><td style="text-align:left">乘</td><td style="text-align:left">10 * 5</td></tr><tr><td style="text-align:left">14</td><td style="text-align:left">/</td><td style="text-align:left">除</td><td style="text-align:left">10 / 5</td></tr><tr><td style="text-align:left">14</td><td style="text-align:left">%</td><td style="text-align:left">模数除法</td><td style="text-align:left">10 % 5</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">13</td><td style="text-align:left">+</td><td style="text-align:left">加</td><td style="text-align:left">10 + 5</td></tr><tr><td style="text-align:left">13</td><td style="text-align:left">-</td><td style="text-align:left">减</td><td style="text-align:left">10 - 5</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">12</td><td style="text-align:left">&lt;&lt;</td><td style="text-align:left">左位移</td><td style="text-align:left">x &lt;&lt; 2</td></tr><tr><td style="text-align:left">12</td><td style="text-align:left">&gt;&gt;</td><td style="text-align:left">右位移</td><td style="text-align:left">x &gt;&gt; 2</td></tr><tr><td style="text-align:left">12</td><td style="text-align:left">&gt;&gt;&gt;</td><td style="text-align:left">右位移（无符号）</td><td style="text-align:left">x &gt;&gt;&gt; 2</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">&lt;</td><td style="text-align:left">小于</td><td style="text-align:left">x &lt; y</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">&lt;=</td><td style="text-align:left">小于或等于</td><td style="text-align:left">x &lt;= y</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">&gt;</td><td style="text-align:left">大于</td><td style="text-align:left">x &gt; y</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">&gt;=</td><td style="text-align:left">大于或等于</td><td style="text-align:left">x &gt;= y</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">in</td><td style="text-align:left">对象中的属性</td><td style="text-align:left">“PI” in Math</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">instanceof</td><td style="text-align:left">对象的实例</td><td style="text-align:left">instanceof Array</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">10</td><td style="text-align:left">==</td><td style="text-align:left">相等</td><td style="text-align:left">x == y</td></tr><tr><td style="text-align:left">10</td><td style="text-align:left">===</td><td style="text-align:left">严格相等</td><td style="text-align:left">x === y</td></tr><tr><td style="text-align:left">10</td><td style="text-align:left">!=</td><td style="text-align:left">不相等</td><td style="text-align:left">x != y</td></tr><tr><td style="text-align:left">10</td><td style="text-align:left">!==</td><td style="text-align:left">严格不相等</td><td style="text-align:left">x !== y</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">9</td><td style="text-align:left">&amp;</td><td style="text-align:left">按位与</td><td style="text-align:left">x &amp; y</td></tr><tr><td style="text-align:left">8</td><td style="text-align:left">^</td><td style="text-align:left">按位 XOR</td><td style="text-align:left">x ^ y</td></tr><tr><td style="text-align:left">7</td><td style="text-align:left">\</td><td style="text-align:left"></td><td style="text-align:left">按位或</td><td>x \</td><td>y</td></tr><tr><td style="text-align:left">6</td><td style="text-align:left">&amp;&amp;</td><td style="text-align:left">逻辑与</td><td style="text-align:left">x &amp;&amp; y</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left">\</td><td style="text-align:left">\</td><td style="text-align:left"></td><td>逻辑否</td><td>x \</td><td>\</td><td>y</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">? :</td><td style="text-align:left">条件</td><td style="text-align:left">? “Yes” : “No”</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">=</td><td style="text-align:left">赋值</td><td style="text-align:left">x = y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">+=</td><td style="text-align:left">赋值</td><td style="text-align:left">x += y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">-=</td><td style="text-align:left">赋值</td><td style="text-align:left">x -= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">*=</td><td style="text-align:left">赋值</td><td style="text-align:left">x *= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">%=</td><td style="text-align:left">赋值</td><td style="text-align:left">x %= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">&lt;&lt;=</td><td style="text-align:left">赋值</td><td style="text-align:left">x &lt;&lt;= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">&gt;&gt;=</td><td style="text-align:left">赋值</td><td style="text-align:left">x &gt;&gt;= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">&gt;&gt;&gt;=</td><td style="text-align:left">赋值</td><td style="text-align:left">x &gt;&gt;&gt;= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">&amp;=</td><td style="text-align:left">赋值</td><td style="text-align:left">x &amp;= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">^=</td><td style="text-align:left">赋值</td><td style="text-align:left">x ^= y</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">\</td><td style="text-align:left">=</td><td style="text-align:left">赋值</td><td>x \</td><td>= y</td></tr><tr><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td><td style="text-align:left"></td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">yield</td><td style="text-align:left">暂停函数</td><td style="text-align:left">yield x</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">,</td><td style="text-align:left">逗号</td><td style="text-align:left">7 , 8</td></tr></tbody></table><p><strong>提示：</strong>括号中的表达式会在值在表达式的其余部分中被使用之前进行完全计算。</p><h4 id="3-7-保留关键字"><a href="#3-7-保留关键字" class="headerlink" title="3.7.保留关键字"></a>3.7.保留关键字</h4><p>保留关键字在意思上表达成为将来的关键字而保留的单词。</p><h5 id="JavaScript-保留关键字"><a href="#JavaScript-保留关键字" class="headerlink" title="JavaScript 保留关键字"></a>JavaScript 保留关键字</h5><table><thead><tr><th>abstract</th><th>arguments</th><th>boolean</th><th>break</th><th>byte</th></tr></thead><tbody><tr><td>case</td><td>catch</td><td>char</td><td>class*</td><td>const</td></tr><tr><td>continue</td><td>debugger</td><td>default</td><td>delete</td><td>do</td></tr><tr><td>double</td><td>else</td><td>enum*</td><td>eval</td><td>export*</td></tr><tr><td>extends*</td><td>false</td><td>final</td><td>finally</td><td>float</td></tr><tr><td>for</td><td>function</td><td>goto</td><td>if</td><td>implements</td></tr><tr><td>import*</td><td>in</td><td>instanceof</td><td>int</td><td>interface</td></tr><tr><td>let</td><td>long</td><td>native</td><td>new</td><td>null</td></tr><tr><td>package</td><td>private</td><td>protected</td><td>public</td><td>return</td></tr><tr><td>short</td><td>static</td><td>super*</td><td>switch</td><td>synchronized</td></tr><tr><td>this</td><td>throw</td><td>throws</td><td>transient</td><td>true</td></tr><tr><td>try</td><td>typeof</td><td>var</td><td>void</td><td>volatile</td></tr><tr><td>while</td><td>with</td><td>yield</td><td></td></tr></tbody></table><p>* 标记的关键字是 ECMAScript5 中新添加的。</p><h5 id="JavaScript-对象、属性和方法"><a href="#JavaScript-对象、属性和方法" class="headerlink" title="JavaScript 对象、属性和方法"></a>JavaScript 对象、属性和方法</h5><table><thead><tr><th>Array</th><th>Date</th><th>eval</th><th>function</th><th>hasOwnProperty</th></tr></thead><tbody><tr><td>Infinity</td><td>isFinite</td><td>isNaN</td><td>isPrototypeOf</td><td>length</td></tr><tr><td>Math</td><td>NaN</td><td>name</td><td>Number</td><td>Object</td></tr><tr><td>prototype</td><td>String</td><td>toString</td><td>undefined</td><td>valueOf</td></tr></tbody></table><h5 id="Java-保留关键字"><a href="#Java-保留关键字" class="headerlink" title="Java 保留关键字"></a>Java 保留关键字</h5><p>JavaScript 经常与 Java 一起使用。您应该避免使用一些 Java 对象和属性作为 JavaScript 标识符：</p><table><thead><tr><th>getClass</th><th>java</th><th>JavaArray</th></tr></thead><tbody><tr><td>javaClass</td><td>JavaObject</td><td>JavaPackage</td></tr></tbody></table><h5 id="Windows-保留关键字"><a href="#Windows-保留关键字" class="headerlink" title="Windows 保留关键字"></a>Windows 保留关键字</h5><table><thead><tr><th>alert</th><th>all</th><th>anchor</th><th>anchors</th><th>area</th></tr></thead><tbody><tr><td>assign</td><td>blur</td><td>button</td><td>checkbox</td><td>clearInterval</td></tr><tr><td>clearTimeout</td><td>clientInformation</td><td>close</td><td>closed</td><td>confirm</td></tr><tr><td>constructor</td><td>crypto</td><td>decodeURI</td><td>decodeURIComponent</td><td>defaultStatus</td></tr><tr><td>document</td><td>element</td><td>elements</td><td>embed</td><td>embeds</td></tr><tr><td>encodeURI</td><td>encodeURIComponent</td><td>escape</td><td>event</td><td>fileUpload</td></tr><tr><td>focus</td><td>form</td><td>forms</td><td>frame</td><td>innerHeight</td></tr><tr><td>innerWidth</td><td>layer</td><td>layers</td><td>link</td><td>location</td></tr><tr><td>mimeTypes</td><td>navigate</td><td>navigator</td><td>frames</td><td>frameRate</td></tr><tr><td>hidden</td><td>history</td><td>image</td><td>images</td><td>offscreenBuffering</td></tr><tr><td>open</td><td>opener</td><td>option</td><td>outerHeight</td><td>outerWidth</td></tr><tr><td>packages</td><td>pageXOffset</td><td>pageYOffset</td><td>parent</td><td>parseFloat</td></tr><tr><td>parseInt</td><td>password</td><td>pkcs11</td><td>plugin</td><td>prompt</td></tr><tr><td>propertyIsEnum</td><td>radio</td><td>reset</td><td>screenX</td><td>screenY</td></tr><tr><td>scroll</td><td>secure</td><td>select</td><td>self</td><td>setInterval</td></tr><tr><td>setTimeout</td><td>status</td><td>submit</td><td>taint</td><td>text</td></tr><tr><td>textarea</td><td>top</td><td>unescape</td><td>untaint</td><td>window</td></tr></tbody></table><h5 id="HTML-事件句柄"><a href="#HTML-事件句柄" class="headerlink" title="HTML 事件句柄"></a>HTML 事件句柄</h5><table><thead><tr><th>onblur</th><th>onclick</th><th>onerror</th><th>onfocus</th></tr></thead><tbody><tr><td>onkeydown</td><td>onkeypress</td><td>onkeyup</td><td>onmouseover</td></tr><tr><td>onload</td><td>onmouseup</td><td>onmousedown</td><td>onsubmit</td></tr></tbody></table><p><strong>注意：</strong>在JavaScript中关键字不能用作变量名或者函数名，否则可能会得到错误消息，例如“”Identifier Expected”（应该有标识符、期望标识符）”。</p><h3 id="四、流程"><a href="#四、流程" class="headerlink" title="四、流程"></a>四、流程</h3><h4 id="4-1-条件"><a href="#4-1-条件" class="headerlink" title="4.1.条件"></a>4.1.条件</h4><p>通常在写代码时，您总是需要为不同的决定来执行不同的动作。您可以在代码中使用条件语句来完成该任务。</p><ul><li>if 语句 - 只有当指定条件为 true 时，使用该语句来执行代码</li><li>if…else 语句 - 当条件为 true 时执行代码，当条件为 false 时执行其他代码</li><li>JavaScript三目运算 - 当条件为true 时执行代码，当条件为 false 时执行其他代码</li><li>if…else if….else 语句- 使用该语句来选择多个代码块之一来执行</li><li>switch 语句 - 使用该语句来选择多个代码块之一来执行</li></ul><h5 id="if"><a href="#if" class="headerlink" title="if"></a>if</h5><p>只有当指定条件为 true 时，该语句才会执行代码。</p><ul><li>语法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (condition)&#123;</span><br><span class="line"> 当条件为 <span class="literal">true</span> 时执行的代码 </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (condition)  &#123;</span><br><span class="line">  当条件为 <span class="literal">true</span> 时执行的代码 </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;  </span><br><span class="line">  当条件不为 <span class="literal">true</span> 时执行的代码  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (condition1)&#123;</span><br><span class="line">  当条件 <span class="number">1</span> 为 <span class="literal">true</span> 时执行的代码 </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (condition2)&#123;</span><br><span class="line"> 当条件 <span class="number">2</span> 为 <span class="literal">true</span> 时执行的代码   </span><br><span class="line">&#125;  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  当条件 <span class="number">1</span> 和 条件 <span class="number">2</span> 都不为 <span class="literal">true</span> 时执行的代码  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>例子</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (time&lt;<span class="number">20</span>)&#123;</span><br><span class="line">  x=<span class="string">"Good day"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  x=<span class="string">"Good evening"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">5</span> &gt; <span class="number">3</span> ? alert(<span class="string">"5大于3"</span>) : alert(<span class="string">"5小于3"</span>);</span><br></pre></td></tr></table></figure><h5 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h5><p>switch 语句用于在不同的条件执行不同的动作。搭配case和default使用（default可以认为是一个特殊的case，case对应一种或多种（default）情况，Switch语句没有case是没有办法体现其功能的）。</p><ul><li><p>语法</p><ul><li>计算一次 switch 表达式</li><li>把表达式的值与每个case的值进行对比</li><li>如果存在匹配，则执行关联代码<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(n)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        执行代码块 <span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span>;      </span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:      </span><br><span class="line">        执行代码块 <span class="number">2</span>      </span><br><span class="line">        <span class="keyword">break</span>;      </span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        n 与 <span class="keyword">case</span> <span class="number">1</span> 和 <span class="keyword">case</span> <span class="number">2</span> 不同时执行的代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>例子</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="string">"0"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (x) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">        text = <span class="string">"Off"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"></span><br><span class="line">        text = <span class="string">"On"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line"></span><br><span class="line">        text = <span class="string">"No value found"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-2-循环"><a href="#4-2-循环" class="headerlink" title="4.2.循环"></a>4.2.循环</h4><p>循环可以将代码块执行指定的次数。</p><ul><li>for - 循环代码块一定的次数</li><li>for/in - 循环遍历对象的属性</li><li>while - 当指定的条件为 true 时循环指定的代码块</li><li>do/while - 同样当指定的条件为 true 时循环指定的代码块</li></ul><h5 id="for"><a href="#for" class="headerlink" title="for"></a>for</h5><ul><li>语法<ul><li>语句 1 （代码块）开始前执行 starts.</li><li>语句 2 定义运行循环（代码块）的条件</li><li>语句 3 在循环（代码块）已被执行之后执行</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (语句 <span class="number">1</span>; 语句 <span class="number">2</span>; 语句 <span class="number">3</span>)&#123;        </span><br><span class="line">  被执行的代码块        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>例子<ul><li>Statement 1 在循环开始之前设置变量 (var i=0)。</li><li>Statement 2 定义循环运行的条件（i 必须小于 5）。</li><li>Statement 3 在每次代码块已被执行后增加一个值 (i++)</li></ul></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line">  x=x + <span class="string">"The number is "</span> + i + <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i=<span class="number">0</span>,len=cars.length;</span><br><span class="line"><span class="keyword">for</span> (; i&lt;len; )&#123;</span><br><span class="line">    <span class="built_in">document</span>.write(cars[i] + <span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">    i++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="while"><a href="#while" class="headerlink" title="while"></a>while</h5><p>while 循环会在指定条件为真时循环执行代码块。</p><ul><li>语法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (条件)&#123;</span><br><span class="line"> 需要执行的代码</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">需要执行的代码</span><br><span class="line">&#125;<span class="keyword">while</span> (条件);</span><br></pre></td></tr></table></figure><ul><li>例子</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (i&lt;<span class="number">5</span>)&#123;</span><br><span class="line">  x=x + <span class="string">"The number is "</span> + i + <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  i++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">  x=x + <span class="string">"The number is "</span> + i + <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  i++;</span><br><span class="line">&#125;<span class="keyword">while</span> (i&lt;<span class="number">5</span>);</span><br></pre></td></tr></table></figure><h4 id="4-3-跳转"><a href="#4-3-跳转" class="headerlink" title="4.3.跳转"></a>4.3.跳转</h4><ul><li>return 用于结束当前函数,并返回内容</li><li>break 语句用于跳出循环。</li><li>continue 用于跳过循环中的一个迭代。</li></ul><h5 id="Break"><a href="#Break" class="headerlink" title="Break"></a>Break</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">  <span class="keyword">if</span> (i==<span class="number">3</span>)&#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  x=x + <span class="string">"The number is "</span> + i + <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Continue"><a href="#Continue" class="headerlink" title="Continue"></a>Continue</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;=<span class="number">10</span>;i++)&#123;</span><br><span class="line">    <span class="keyword">if</span> (i==<span class="number">3</span>) <span class="keyword">continue</span>;</span><br><span class="line">    x=x + <span class="string">"The number is "</span> + i + <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4-异常处理"><a href="#4-4-异常处理" class="headerlink" title="4.4.异常处理"></a>4.4.异常处理</h4><ul><li>try 语句测试代码块的错误。</li><li>catch 语句处理错误。</li><li>throw 语句创建自定义错误。</li></ul><h5 id="throw"><a href="#throw" class="headerlink" title="throw"></a>throw</h5><p>throw 语句允许我们创建自定义错误。</p><ul><li>语法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">throw</span> exception</span><br></pre></td></tr></table></figure><ul><li>例子</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x=<span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>).value;</span><br><span class="line"><span class="keyword">if</span>(x==<span class="string">""</span>)    <span class="keyword">throw</span> <span class="string">"empty"</span>;</span><br></pre></td></tr></table></figure><h5 id="try-和-catch"><a href="#try-和-catch" class="headerlink" title="try 和 catch"></a>try 和 catch</h5><ul><li>语法</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">   <span class="comment">//在这里运行代码</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">   <span class="comment">//在这里处理错误</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">   <span class="comment">//在这里运行代码</span></span><br><span class="line">&#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">   <span class="comment">//在这里处理错误</span></span><br><span class="line">&#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">  <span class="comment">//无论错误和失败都会运行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>实例</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> txt=<span class="string">""</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">message</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">      adddlert(<span class="string">"Welcome guest!"</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">      txt=<span class="string">"本页有一个错误。\n\n"</span>;</span><br><span class="line">      txt+=<span class="string">"错误描述："</span> + err.message + <span class="string">"\n\n"</span>;</span><br><span class="line">      txt+=<span class="string">"点击确定继续。\n\n"</span>;</span><br><span class="line">      alert(txt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="五、函数"><a href="#五、函数" class="headerlink" title="五、函数"></a>五、函数</h3><p>JavaScript 使用关键字 function 定义函数。函数可以通过声明定义，也可以是一个表达式。</p><h4 id="5-1-定义"><a href="#5-1-定义" class="headerlink" title="5.1.定义"></a>5.1.定义</h4><ul><li>函数声明</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>函数表达式</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;<span class="keyword">return</span> a * b&#125;;</span><br></pre></td></tr></table></figure><ul><li>构造函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myFunction = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"return a * b"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x = myFunction(<span class="number">4</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure><ul><li>函数提升</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 提升（Hoisting）是 JavaScript 默认将当前作用域提升到前面去的的行为</span></span><br><span class="line">myFunction(<span class="number">5</span>);               </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">y</span>) </span>&#123;        </span><br><span class="line">    <span class="keyword">return</span> y * y;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2-函数参数"><a href="#5-2-函数参数" class="headerlink" title="5.2.函数参数"></a>5.2.函数参数</h4><p>JavaScript 函数参数与大多数其他语言的函数参数的区别在于：它不会关注有多少个参数被传递，不关注传递的参数的数据类型。</p><ul><li>显式参数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">functionName(parameter1, parameter2, parameter3) &#123;</span><br><span class="line">    code to be executed</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>隐私参数 Arguments 包含了函数调用的参数数组</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">x = sumAll(<span class="number">1</span>, <span class="number">123</span>, <span class="number">500</span>, <span class="number">115</span>, <span class="number">44</span>, <span class="number">88</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sumAll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> i, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">        sum += <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>默认参数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">x, y</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (y === <span class="literal">undefined</span>) &#123;</span><br><span class="line">          y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>值传递</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 通过值传递参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">x</span>) </span>&#123;</span><br><span class="line">    x++; <span class="comment">//修改参数x的值，将不会修改在函数外定义的变量 x</span></span><br><span class="line">    <span class="built_in">console</span>.log(x);</span><br><span class="line">&#125;</span><br><span class="line">myFunction(x); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(x); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure><ul><li>对象传递参数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>:<span class="number">1</span>&#125;;</span><br><span class="line"><span class="comment">// 通过对象传递参数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    obj.x++; <span class="comment">//修改参数对象obj.x的值，函数外定义的obj也将会被修改</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj.x);</span><br><span class="line">&#125;</span><br><span class="line">myFunction(obj); <span class="comment">// 2</span></span><br><span class="line"><span class="built_in">console</span>.log(obj.x); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><h4 id="5-3-函数调用"><a href="#5-3-函数调用" class="headerlink" title="5.3.函数调用"></a>5.3.函数调用</h4><p>JavaScript 函数有 4 种调用方式。<br>每种方式的不同在于 this 的初始化。<br>一般而言，在Javascript中，this指向函数执行时的当前对象。</p><ul><li>作为一个函数调用</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br><span class="line">myFunction(<span class="number">10</span>, <span class="number">2</span>);           <span class="comment">// myFunction(10, 2) 返回 20</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line">myFunction();                <span class="comment">// 返回 window 对象</span></span><br></pre></td></tr></table></figure><ul><li>函数作为方法调用</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myObject = &#123;</span><br><span class="line">    firstName:<span class="string">"John"</span>,</span><br><span class="line">    lastName: <span class="string">"Doe"</span>,</span><br><span class="line">    fullName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="string">" "</span> + <span class="keyword">this</span>.lastName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">myObject.fullName();         <span class="comment">// 返回 "John Doe"</span></span><br></pre></td></tr></table></figure><ul><li>使用构造函数调用函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数:</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">arg1, arg2</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.firstName = arg1;</span><br><span class="line">    <span class="keyword">this</span>.lastName  = arg2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This creates a new object</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> myFunction(<span class="string">"John"</span>,<span class="string">"Doe"</span>);</span><br><span class="line">x.firstName;                             <span class="comment">// 返回 "John"</span></span><br></pre></td></tr></table></figure><ul><li>作为函数方法调用函数</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * b;</span><br><span class="line">&#125;</span><br><span class="line">myFunction.call(myObject, <span class="number">10</span>, <span class="number">2</span>);      <span class="comment">// 返回 20</span></span><br><span class="line"></span><br><span class="line">myArray = [<span class="number">10</span>,<span class="number">2</span>];</span><br><span class="line">myFunction.apply(myObject, myArray);   <span class="comment">// 返回 20</span></span><br></pre></td></tr></table></figure><h4 id="5-4-闭包"><a href="#5-4-闭包" class="headerlink" title="5.4.闭包"></a>5.4.闭包</h4><p>能访问函数内部的变量</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 只有调用函数才能累计</span></span><br><span class="line"><span class="keyword">var</span> add = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="keyword">return</span> counter += <span class="number">1</span>;&#125;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">add();</span><br><span class="line">add();</span><br><span class="line">add();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计数器为 3</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://www.w3school.com.cn/jsref/index.asp" target="_blank" rel="noopener">JavaScript 参考手册</a></p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> javascript </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTML（五）CSS3</title>
      <link href="/2016/09/15/Html05/"/>
      <url>/2016/09/15/Html05/</url>
      <content type="html"><![CDATA[<p>CSS3 是最新的 CSS 标准。本文章主要介绍 CSS3 的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>CSS3 完全向后兼容，因此您不必改变现有的设计。浏览器通常支持 CSS2。</p><h3 id="一、边框"><a href="#一、边框" class="headerlink" title="一、边框"></a>一、边框</h3><p>创建圆角边框，向矩形添加阴影，使用图片来绘制边框.</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-image.asp" target="_blank" rel="noopener">border-image</a></td><td style="text-align:left">设置所有 border-image-* 属性的简写属性。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-radius.asp" target="_blank" rel="noopener">border-radius</a></td><td style="text-align:left">设置所有四个 border-*-radius 属性的简写属性。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_box-shadow.asp" target="_blank" rel="noopener">box-shadow</a></td><td style="text-align:left">向方框添加一个或多个阴影。</td><td style="text-align:left">3</td></tr></tbody></table><ul><li><p>border-radius:圆角边框</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">text-align:center;</span></span><br><span class="line"><span class="undefined">border:2px solid #a1a1a1;</span></span><br><span class="line"><span class="undefined">padding:10px 40px; </span></span><br><span class="line"><span class="undefined">background:#dddddd;</span></span><br><span class="line"><span class="undefined">width:350px;</span></span><br><span class="line"><span class="undefined">border-radius:25px;</span></span><br><span class="line"><span class="undefined">-moz-border-radius:25px; /* 老的 Firefox */</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>border-radius 属性允许您向元素添加圆角。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>box-shadow:边框阴影</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">width:300px;</span></span><br><span class="line"><span class="undefined">height:100px;</span></span><br><span class="line"><span class="undefined">background-color:#ff9900;</span></span><br><span class="line"><span class="undefined">-moz-box-shadow: 10px 10px 5px #888888; /* 老的 Firefox */</span></span><br><span class="line"><span class="undefined">box-shadow: 10px 10px 5px #888888;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>border-image:边框图片</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">border:15px solid transparent;</span></span><br><span class="line"><span class="undefined">width:300px;</span></span><br><span class="line"><span class="undefined">padding:10px 20px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">#round</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">-moz-border-image:url(/i/border.png) 30 30 round;/* Old Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-border-image:url(/i/border.png) 30 30 round;/* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">-o-border-image:url(/i/border.png) 30 30 round;/* Opera */</span></span><br><span class="line"><span class="undefined">border-image:url(/i/border.png) 30 30 round;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">#stretch</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">-moz-border-image:url(/i/border.png) 30 30 stretch;/* Old Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-border-image:url(/i/border.png) 30 30 stretch;/* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">-o-border-image:url(/i/border.png) 30 30 stretch;/* Opera */</span></span><br><span class="line"><span class="undefined">border-image:url(/i/border.png) 30 30 stretch;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"round"</span>&gt;</span>在这里，图片铺满整个边框。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"stretch"</span>&gt;</span>在这里，图片被拉伸以填充该区域。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是我们使用的图片：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/border.png"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span> Internet Explorer 不支持 border-image 属性。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>border-image 属性规定了用作边框的图片。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="二、背景"><a href="#二、背景" class="headerlink" title="二、背景"></a>二、背景</h3><ul><li>background-size:规定背景图片的尺寸</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">body</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">background:url(/i/bg_flower.gif);</span></span><br><span class="line"><span class="undefined">background-size:63px 100px;</span></span><br><span class="line"><span class="undefined">-moz-background-size:63px 100px; /* 老版本的 Firefox */</span></span><br><span class="line"><span class="undefined">background-repeat:no-repeat;</span></span><br><span class="line"><span class="undefined">padding-top:80px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>上面是缩小的背景图片。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>原始图片：<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/bg_flower.gif"</span> <span class="attr">alt</span>=<span class="string">"Flowers"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>background-origin:规定背景图片的定位区域</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">border:1px solid black;</span></span><br><span class="line"><span class="undefined">padding:35px;</span></span><br><span class="line"><span class="undefined">background-image:url('/i/bg_flower.gif');</span></span><br><span class="line"><span class="undefined">background-repeat:no-repeat;</span></span><br><span class="line"><span class="undefined">background-position:left;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#div1</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">background-origin:border-box;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#div2</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">background-origin:content-box;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>background-origin:border-box:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span>&gt;</span></span><br><span class="line">这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>background-origin:content-box:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div2"</span>&gt;</span></span><br><span class="line">这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。这是文本。</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>background-image:使用多个背景图像<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">body</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">background-image:url(/i/bg_flower.gif),url(/i/bg_flower_2.gif);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="三、文本效果"><a href="#三、文本效果" class="headerlink" title="三、文本效果"></a>三、文本效果</h3><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_hanging-punctuation.asp" target="_blank" rel="noopener">hanging-punctuation</a></td><td style="text-align:left">规定标点字符是否位于线框之外。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_punctuation-trim.asp" target="_blank" rel="noopener">punctuation-trim</a></td><td style="text-align:left">规定是否对标点字符进行修剪。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left">text-align-last</td><td style="text-align:left">设置如何对齐最后一行或紧挨着强制换行符之前的行。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text-emphasis.asp" target="_blank" rel="noopener">text-emphasis</a></td><td style="text-align:left">向元素的文本应用重点标记以及重点标记的前景色。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text-justify.asp" target="_blank" rel="noopener">text-justify</a></td><td style="text-align:left">规定当 text-align 设置为 “justify” 时所使用的对齐方法。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text-outline.asp" target="_blank" rel="noopener">text-outline</a></td><td style="text-align:left">规定文本的轮廓。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text-overflow.asp" target="_blank" rel="noopener">text-overflow</a></td><td style="text-align:left">规定当文本溢出包含元素时发生的事情。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text-shadow.asp" target="_blank" rel="noopener">text-shadow</a></td><td style="text-align:left">向文本添加阴影。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text-wrap.asp" target="_blank" rel="noopener">text-wrap</a></td><td style="text-align:left">规定文本的换行规则。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_word-break.asp" target="_blank" rel="noopener">word-break</a></td><td style="text-align:left">规定非中日韩文本的换行规则。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_word-wrap.asp" target="_blank" rel="noopener">word-wrap</a></td><td style="text-align:left">允许对长的不可分割的单词进行分割并换行到下一行。</td><td style="text-align:left">3</td></tr></tbody></table><ul><li>text-shadow 可向文本应用阴影 </li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">h1</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">text-shadow: 5px 5px 5px #FF0000;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>文本阴影效果！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>word-wrap 属性允许您允许文本强制文本进行换行 - 即使这意味着会对单词进行拆分：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">p.test</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">width:11em; </span></span><br><span class="line"><span class="undefined">border:1px solid #000000;</span></span><br><span class="line"><span class="undefined">word-wrap:break-word;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"test"</span>&gt;</span>This paragraph contains a very long word: thisisaveryveryveryveryveryverylongword. The long word will break and wrap to the next line.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="四、字体"><a href="#四、字体" class="headerlink" title="四、字体"></a>四、字体</h3><p>在 CSS3 之前，web 设计师必须使用已在用户计算机上安装好的字体。</p><p>通过 CSS3，web 设计师可以使用他们喜欢的任意字体。将该字体文件存放到 web 服务器上，它会在需要时被自动下载到用户的计算机上。字体是通过 CSS3 @font-face 规则中定义的。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">@font-face</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">font-family: myFirstFont;/* 定义字体的名称 */</span></span><br><span class="line"><span class="undefined">src: url('/example/css3/Sansation_Light.ttf') /* 指向字体文件 */</span></span><br><span class="line"><span class="undefined">    ,url('/example/css3/Sansation_Light.eot'); /* IE9+ */</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">@font-face</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">font-family: myFirstFont;</span></span><br><span class="line"><span class="undefined">src: url('/example/css3/Sansation_Bold.ttf')</span></span><br><span class="line"><span class="undefined">    ,url('/example/css3/Sansation_Bold.eot'); /* IE9+ */</span></span><br><span class="line"><span class="undefined">font-weight:bold;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">font-family:myFirstFont;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">With CSS3, websites can <span class="tag">&lt;<span class="name">b</span>&gt;</span>finally<span class="tag">&lt;/<span class="name">b</span>&gt;</span> use fonts other than the pre-selected "web-safe" fonts.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>Internet Explorer 9+ 支持新的 @font-face 规则。Internet Explorer 8 以及更早的版本不支持新的 @font-face 规则。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>下面的表格列出了能够在 @font-face 规则中定义的所有字体描述符：</p><table><thead><tr><th style="text-align:left">描述符</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">font-family</td><td style="text-align:left"><em>name</em></td><td style="text-align:left">必需。规定字体的名称。</td></tr><tr><td style="text-align:left">src</td><td style="text-align:left"><em>URL</em></td><td style="text-align:left">必需。定义字体文件的 URL。</td></tr><tr><td style="text-align:left">font-stretch</td><td style="text-align:left">normalcondensedultra-condensedextra-condensedsemi-condensedexpandedsemi-expandedextra-expandedultra-expanded</td><td style="text-align:left">可选。定义如何拉伸字体。默认是 “normal”。</td></tr><tr><td style="text-align:left">font-style</td><td style="text-align:left">ormalitalicoblique</td><td style="text-align:left">可选。定义字体的样式。默认是 “normal”。</td></tr><tr><td style="text-align:left">font-weight</td><td style="text-align:left">normalbold100200300400500600700800900</td><td style="text-align:left">可选。定义字体的粗细。默认是 “normal”。</td></tr><tr><td style="text-align:left">unicode-range</td><td style="text-align:left"><em>unicode-range</em></td><td style="text-align:left">可选。定义字体支持的 UNICODE 字符范围。默认是 “U+0-10FFFF”。</td></tr></tbody></table><h3 id="五、转换"><a href="#五、转换" class="headerlink" title="五、转换"></a>五、转换</h3><p> 转换是使元素改变形状、尺寸和位置的一种效果。 </p><ul><li>2D 转换</li></ul><table><thead><tr><th style="text-align:left">转换属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transform.asp" target="_blank" rel="noopener">transform</a></td><td style="text-align:left">向元素应用 2D 或 3D 转换。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transform-origin.asp" target="_blank" rel="noopener">transform-origin</a></td><td style="text-align:left">允许你改变被转换元素的位置。</td><td style="text-align:left">3</td></tr></tbody></table><table><thead><tr><th style="text-align:left">2D转换函数</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">matrix(<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>)</td><td style="text-align:left">定义 2D 转换，使用六个值的矩阵。</td></tr><tr><td style="text-align:left">translate(<em>x</em>,<em>y</em>)</td><td style="text-align:left">定义 2D 转换，沿着 X 和 Y 轴移动元素。</td></tr><tr><td style="text-align:left">translateX(<em>n</em>)</td><td style="text-align:left">定义 2D 转换，沿着 X 轴移动元素。</td></tr><tr><td style="text-align:left">translateY(<em>n</em>)</td><td style="text-align:left">定义 2D 转换，沿着 Y 轴移动元素。</td></tr><tr><td style="text-align:left">scale(<em>x</em>,<em>y</em>)</td><td style="text-align:left">定义 2D 缩放转换，改变元素的宽度和高度。</td></tr><tr><td style="text-align:left">scaleX(<em>n</em>)</td><td style="text-align:left">定义 2D 缩放转换，改变元素的宽度。</td></tr><tr><td style="text-align:left">scaleY(<em>n</em>)</td><td style="text-align:left">定义 2D 缩放转换，改变元素的高度。</td></tr><tr><td style="text-align:left">rotate(<em>angle</em>)</td><td style="text-align:left">定义 2D 旋转，在参数中规定角度。</td></tr><tr><td style="text-align:left">skew(<em>x-angle</em>,<em>y-angle</em>)</td><td style="text-align:left">定义 2D 倾斜转换，沿着 X 和 Y 轴。</td></tr><tr><td style="text-align:left">skewX(<em>angle</em>)</td><td style="text-align:left">定义 2D 倾斜转换，沿着 X 轴。</td></tr><tr><td style="text-align:left">skewY(<em>angle</em>)</td><td style="text-align:left">定义 2D 倾斜转换，沿着 Y 轴。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">width:100px;</span></span><br><span class="line"><span class="undefined">height:75px;</span></span><br><span class="line"><span class="undefined">background-color:yellow;</span></span><br><span class="line"><span class="undefined">border:1px solid black;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">div#div2</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">transform:matrix(0.866,0.5,-0.5,0.866,0,0);</span></span><br><span class="line"><span class="undefined">-ms-transform:matrix(0.866,0.5,-0.5,0.866,0,0); /* IE 9 */</span></span><br><span class="line"><span class="undefined">-moz-transform:matrix(0.866,0.5,-0.5,0.866,0,0); /* Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-transform:matrix(0.866,0.5,-0.5,0.866,0,0); /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">-o-transform:matrix(0.866,0.5,-0.5,0.866,0,0); /* Opera */</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>你好。这是一个 div 元素。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div2"</span>&gt;</span>你好。这是一个 div 元素。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>3D 转换</li></ul><table><thead><tr><th style="text-align:left">转换属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transform.asp" target="_blank" rel="noopener">transform</a></td><td style="text-align:left">向元素应用 2D 或 3D 转换。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transform-origin.asp" target="_blank" rel="noopener">transform-origin</a></td><td style="text-align:left">允许你改变被转换元素的位置。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transform-style.asp" target="_blank" rel="noopener">transform-style</a></td><td style="text-align:left">规定被嵌套元素如何在 3D 空间中显示。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_perspective.asp" target="_blank" rel="noopener">perspective</a></td><td style="text-align:left">规定 3D 元素的透视效果。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_perspective-origin.asp" target="_blank" rel="noopener">perspective-origin</a></td><td style="text-align:left">规定 3D 元素的底部位置。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_backface-visibility.asp" target="_blank" rel="noopener">backface-visibility</a></td><td style="text-align:left">定义元素在不面对屏幕时是否可见。</td><td style="text-align:left">3</td></tr></tbody></table><table><thead><tr><th style="text-align:left">3D转换函数</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">matrix3d(<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>, <em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>,<em>n</em>)</td><td style="text-align:left">定义 3D 转换，使用 16 个值的 4x4 矩阵。</td></tr><tr><td style="text-align:left">translate3d(<em>x</em>,<em>y</em>,<em>z</em>)</td><td style="text-align:left">定义 3D 转化。</td></tr><tr><td style="text-align:left">translateX(<em>x</em>)</td><td style="text-align:left">定义 3D 转化，仅使用用于 X 轴的值。</td></tr><tr><td style="text-align:left">translateY(<em>y</em>)</td><td style="text-align:left">定义 3D 转化，仅使用用于 Y 轴的值。</td></tr><tr><td style="text-align:left">translateZ(<em>z</em>)</td><td style="text-align:left">定义 3D 转化，仅使用用于 Z 轴的值。</td></tr><tr><td style="text-align:left">scale3d(<em>x</em>,<em>y</em>,<em>z</em>)</td><td style="text-align:left">定义 3D 缩放转换。</td></tr><tr><td style="text-align:left">scaleX(<em>x</em>)</td><td style="text-align:left">定义 3D 缩放转换，通过给定一个 X 轴的值。</td></tr><tr><td style="text-align:left">scaleY(<em>y</em>)</td><td style="text-align:left">定义 3D 缩放转换，通过给定一个 Y 轴的值。</td></tr><tr><td style="text-align:left">scaleZ(<em>z</em>)</td><td style="text-align:left">定义 3D 缩放转换，通过给定一个 Z 轴的值。</td></tr><tr><td style="text-align:left">rotate3d(<em>x</em>,<em>y</em>,<em>z</em>,<em>angle</em>)</td><td style="text-align:left">定义 3D 旋转。</td></tr><tr><td style="text-align:left">rotateX(<em>angle</em>)</td><td style="text-align:left">定义沿 X 轴的 3D 旋转。</td></tr><tr><td style="text-align:left">rotateY(<em>angle</em>)</td><td style="text-align:left">定义沿 Y 轴的 3D 旋转。</td></tr><tr><td style="text-align:left">rotateZ(<em>angle</em>)</td><td style="text-align:left">定义沿 Z 轴的 3D 旋转。</td></tr><tr><td style="text-align:left">perspective(<em>n</em>)</td><td style="text-align:left">定义 3D 转换元素的透视视图。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">width:100px;</span></span><br><span class="line"><span class="undefined">height:75px;</span></span><br><span class="line"><span class="undefined">background-color:yellow;</span></span><br><span class="line"><span class="undefined">border:1px solid black;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">div#div2</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">transform:rotateY(130deg);</span></span><br><span class="line"><span class="undefined">-webkit-transform:rotateY(130deg); /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">-moz-transform:rotateY(130deg); /* Firefox */</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>你好。这是一个 div 元素。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div2"</span>&gt;</span>你好。这是一个 div 元素。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span> Internet Explorer 和 Opera 不支持 rotateX 方法。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="六、过渡"><a href="#六、过渡" class="headerlink" title="六、过渡"></a>六、过渡</h3><p>过渡是元素从一种样式逐渐改变为另一种的效果。</p><p>要实现这一点，必须规定两项内容：</p><ul><li>规定您希望把效果添加到哪个 CSS 属性上</li><li>规定效果的时长</li></ul><table><thead><tr><th style="text-align:left">转换属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transition.asp" target="_blank" rel="noopener">transition</a></td><td style="text-align:left">简写属性，用于在一个属性中设置四个过渡属性。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transition-property.asp" target="_blank" rel="noopener">transition-property</a></td><td style="text-align:left">规定应用过渡的 CSS 属性的名称。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transition-duration.asp" target="_blank" rel="noopener">transition-duration</a></td><td style="text-align:left">定义过渡效果花费的时间。默认是 0。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transition-timing-function.asp" target="_blank" rel="noopener">transition-timing-function</a></td><td style="text-align:left">规定过渡效果的时间曲线。默认是 “ease”。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_transition-delay.asp" target="_blank" rel="noopener">transition-delay</a></td><td style="text-align:left">规定过渡效果何时开始。默认是 0。</td><td style="text-align:left">3</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">/* 过渡前 */</span></span><br><span class="line"><span class="undefined">width:100px;</span></span><br><span class="line"><span class="undefined">height:100px;</span></span><br><span class="line"><span class="undefined">background:yellow;</span></span><br><span class="line"><span class="undefined">transition:width 2s, height 2s;</span></span><br><span class="line"><span class="undefined">-moz-transition:width 2s, height 2s, -moz-transform 2s; /* Firefox 4 */</span></span><br><span class="line"><span class="undefined">-webkit-transition:width 2s, height 2s, -webkit-transform 2s; /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">-o-transition:width 2s, height 2s, -o-transform 2s; /* Opera */</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">div:hover</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">/* 过渡后 */</span></span><br><span class="line"><span class="undefined">width:200px;</span></span><br><span class="line"><span class="undefined">height:200px;</span></span><br><span class="line"><span class="undefined">transform:rotate(180deg);</span></span><br><span class="line"><span class="undefined">-moz-transform:rotate(180deg); /* Firefox 4 */</span></span><br><span class="line"><span class="undefined">-webkit-transform:rotate(180deg); /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">-o-transform:rotate(180deg); /* Opera */</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>请把鼠标指针放到黄色的 div 元素上，来查看过渡效果。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>本例在 Internet Explorer 中无效。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="七、动画"><a href="#七、动画" class="headerlink" title="七、动画"></a>七、动画</h3><p>动画是使元素从一种样式逐渐变化为另一种样式的效果。</p><p>请用百分比来规定变化发生的时间，或用关键词 “from” 和 “to”，等同于 0% 和 100%。</p><p>0% 是动画的开始，100% 是动画的完成。</p><p>为了得到最佳的浏览器支持，您应该始终定义 0% 和 100% 选择器。</p><p>当您在 @keyframes 中创建动画时，请把它捆绑到某个选择器，否则不会产生动画效果。</p><p>通过规定至少以下两项 CSS3 动画属性，即可将动画绑定到选择器：</p><ul><li>规定动画的名称</li><li>规定动画的时长</li></ul><table><thead><tr><th style="text-align:left">动画属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_keyframes.asp" target="_blank" rel="noopener">@keyframes</a></td><td style="text-align:left">规定动画。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation.asp" target="_blank" rel="noopener">animation</a></td><td style="text-align:left">所有动画属性的简写属性，除了 animation-play-state 属性。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-name.asp" target="_blank" rel="noopener">animation-name</a></td><td style="text-align:left">规定 @keyframes 动画的名称。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-duration.asp" target="_blank" rel="noopener">animation-duration</a></td><td style="text-align:left">规定动画完成一个周期所花费的秒或毫秒。默认是 0。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-timing-function.asp" target="_blank" rel="noopener">animation-timing-function</a></td><td style="text-align:left">规定动画的速度曲线。默认是 “ease”。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-delay.asp" target="_blank" rel="noopener">animation-delay</a></td><td style="text-align:left">规定动画何时开始。默认是 0。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-iteration-count.asp" target="_blank" rel="noopener">animation-iteration-count</a></td><td style="text-align:left">规定动画被播放的次数。默认是 1。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-direction.asp" target="_blank" rel="noopener">animation-direction</a></td><td style="text-align:left">规定动画是否在下一周期逆向地播放。默认是 “normal”。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-play-state.asp" target="_blank" rel="noopener">animation-play-state</a></td><td style="text-align:left">规定动画是否正在运行或暂停。默认是 “running”。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_animation-fill-mode.asp" target="_blank" rel="noopener">animation-fill-mode</a></td><td style="text-align:left">规定对象动画时间之外的状态。</td><td style="text-align:left">3</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">width:100px;</span></span><br><span class="line"><span class="undefined">height:100px;</span></span><br><span class="line"><span class="undefined">background:red;</span></span><br><span class="line"><span class="undefined">position:relative;</span></span><br><span class="line"><span class="undefined">animation-name:myfirst;</span></span><br><span class="line"><span class="undefined">animation-duration:5s;</span></span><br><span class="line"><span class="undefined">animation-timing-function:linear;</span></span><br><span class="line"><span class="undefined">animation-delay:2s;</span></span><br><span class="line"><span class="undefined">animation-iteration-count:infinite;</span></span><br><span class="line"><span class="undefined">animation-direction:alternate;</span></span><br><span class="line"><span class="undefined">animation-play-state:running;</span></span><br><span class="line"><span class="undefined">/* Firefox: */</span></span><br><span class="line"><span class="undefined">-moz-animation-name:myfirst;</span></span><br><span class="line"><span class="undefined">-moz-animation-duration:5s;</span></span><br><span class="line"><span class="undefined">-moz-animation-timing-function:linear;</span></span><br><span class="line"><span class="undefined">-moz-animation-delay:2s;</span></span><br><span class="line"><span class="undefined">-moz-animation-iteration-count:infinite;</span></span><br><span class="line"><span class="undefined">-moz-animation-direction:alternate;</span></span><br><span class="line"><span class="undefined">-moz-animation-play-state:running;</span></span><br><span class="line"><span class="undefined">/* Safari and Chrome: */</span></span><br><span class="line"><span class="undefined">-webkit-animation-name:myfirst;</span></span><br><span class="line"><span class="undefined">-webkit-animation-duration:5s;</span></span><br><span class="line"><span class="undefined">-webkit-animation-timing-function:linear;</span></span><br><span class="line"><span class="undefined">-webkit-animation-delay:2s;</span></span><br><span class="line"><span class="undefined">-webkit-animation-iteration-count:infinite;</span></span><br><span class="line"><span class="undefined">-webkit-animation-direction:alternate;</span></span><br><span class="line"><span class="undefined">-webkit-animation-play-state:running;</span></span><br><span class="line"><span class="undefined">/* Opera: */</span></span><br><span class="line"><span class="undefined">-o-animation-name:myfirst;</span></span><br><span class="line"><span class="undefined">-o-animation-duration:5s;</span></span><br><span class="line"><span class="undefined">-o-animation-timing-function:linear;</span></span><br><span class="line"><span class="undefined">-o-animation-delay:2s;</span></span><br><span class="line"><span class="undefined">-o-animation-iteration-count:infinite;</span></span><br><span class="line"><span class="undefined">-o-animation-direction:alternate;</span></span><br><span class="line"><span class="undefined">-o-animation-play-state:running;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">@keyframes myfirst</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">0%   &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">25%  &#123;background:yellow; left:200px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">50%  &#123;background:blue; left:200px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">75%  &#123;background:green; left:0px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">100% &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">@-moz-keyframes myfirst /* Firefox */</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">0%   &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">25%  &#123;background:yellow; left:200px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">50%  &#123;background:blue; left:200px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">75%  &#123;background:green; left:0px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">100% &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">@-webkit-keyframes myfirst /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">0%   &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">25%  &#123;background:yellow; left:200px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">50%  &#123;background:blue; left:200px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">75%  &#123;background:green; left:0px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">100% &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">@-o-keyframes myfirst /* Opera */</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">0%   &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">25%  &#123;background:yellow; left:200px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">50%  &#123;background:blue; left:200px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">75%  &#123;background:green; left:0px; top:200px;&#125;</span></span><br><span class="line"><span class="undefined">100% &#123;background:red; left:0px; top:0px;&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>本例在 Internet Explorer 中无效。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="八、多列"><a href="#八、多列" class="headerlink" title="八、多列"></a>八、多列</h3><p> 创建多个列来对文本进行布局 </p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-count.asp" target="_blank" rel="noopener">column-count</a></td><td style="text-align:left">规定元素应该被分隔的列数。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-fill.asp" target="_blank" rel="noopener">column-fill</a></td><td style="text-align:left">规定如何填充列。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-gap.asp" target="_blank" rel="noopener">column-gap</a></td><td style="text-align:left">规定列之间的间隔。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-rule.asp" target="_blank" rel="noopener">column-rule</a></td><td style="text-align:left">设置所有 column-rule-* 属性的简写属性。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-rule-color.asp" target="_blank" rel="noopener">column-rule-color</a></td><td style="text-align:left">规定列之间规则的颜色。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-rule-style.asp" target="_blank" rel="noopener">column-rule-style</a></td><td style="text-align:left">规定列之间规则的样式。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-rule-width.asp" target="_blank" rel="noopener">column-rule-width</a></td><td style="text-align:left">规定列之间规则的宽度。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-span.asp" target="_blank" rel="noopener">column-span</a></td><td style="text-align:left">规定元素应该横跨的列数。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_column-width.asp" target="_blank" rel="noopener">column-width</a></td><td style="text-align:left">规定列的宽度。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_columns.asp" target="_blank" rel="noopener">columns</a></td><td style="text-align:left">规定设置 column-width 和 column-count 的简写属性。</td><td style="text-align:left">3</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">.newspaper</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">-moz-column-count:3; /* Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-column-count:3; /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">column-count:3;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">-moz-column-gap:40px; /* Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-column-gap:40px; /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">column-gap:40px;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">-moz-column-rule:4px outset #ff0000; /* Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-column-rule:4px outset #ff0000; /* Safari and Chrome */</span></span><br><span class="line"><span class="undefined">column-rule:4px outset #ff0000;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>Internet Explorer 不支持 column-count 属性。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"newspaper"</span>&gt;</span></span><br><span class="line">人民网北京2月24日电 (记者 刘阳)国家发展改革委近日发出通知，决定自2月25日零时起将汽、柴油价格每吨分别提高300元和290元，折算到90号汽油和0号柴油（全国平均）每升零售价格分别提高0.22元和0.25元。</span><br><span class="line"></span><br><span class="line">此次国内成品油价格调整幅度，是按照现行国内成品油价格形成机制，根据国际市场油价变化情况确定的。去年11月16日国内成品油价格调整以来，受市场预期欧美经济复苏前景向好以及中东局势持续动荡等因素影响，国际市场原油价格先抑后扬，2月上旬WTI和布伦特原油期货价格再次回升至每桶95美元和115美元以上。虽然近两日价格有所回落，但国内油价挂钩的国际市场三种原油连续22个工作日移动平均价格上涨幅度已超过4%，达到国内成品油价格调整的边界条件。</span><br><span class="line"></span><br><span class="line">通知指出，这次成品油调价后，国家将按照已建立的补贴机制，继续对种粮农民、渔业（含远洋渔业）、林业、城市公交、农村道路客运（含岛际和农村水路客运）等给予补贴。同时，为保证市场物价基本稳定，防止连锁涨价，对与居民生活密切相关的铁路客运、城市公交、农村道路客运（含岛际和农村水路客运）价格不作调整。</span><br><span class="line"></span><br><span class="line">通知要求，中石油、中石化、中海油三大公司要组织好成品油生产和调运，保持合理库存，加强综合协调和应急调度，保障成品油供应。各级价格主管部门要加大市场监督检查力度，依法查处不执行国家价格政策，以及囤积居奇、造谣惑众、合谋涨价、搭车涨价等违法行为，维护正常市场秩序。</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="九、用户界面"><a href="#九、用户界面" class="headerlink" title="九、用户界面"></a>九、用户界面</h3><p> 用户界面特性包括重设元素尺寸、盒尺寸以及轮廓等。 </p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_appearance.asp" target="_blank" rel="noopener">appearance</a></td><td style="text-align:left">允许您将元素设置为标准用户界面元素的外观</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_box-sizing.asp" target="_blank" rel="noopener">box-sizing</a></td><td style="text-align:left">允许您以确切的方式定义适应某个区域的具体内容。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_icon.asp" target="_blank" rel="noopener">icon</a></td><td style="text-align:left">为创作者提供使用图标化等价物来设置元素样式的能力。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_nav-down.asp" target="_blank" rel="noopener">nav-down</a></td><td style="text-align:left">规定在使用 arrow-down 导航键时向何处导航。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_nav-index.asp" target="_blank" rel="noopener">nav-index</a></td><td style="text-align:left">设置元素的 tab 键控制次序。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_nav-left.asp" target="_blank" rel="noopener">nav-left</a></td><td style="text-align:left">规定在使用 arrow-left 导航键时向何处导航。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_nav-right.asp" target="_blank" rel="noopener">nav-right</a></td><td style="text-align:left">规定在使用 arrow-right 导航键时向何处导航。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_nav-up.asp" target="_blank" rel="noopener">nav-up</a></td><td style="text-align:left">规定在使用 arrow-up 导航键时向何处导航。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_outline-offset.asp" target="_blank" rel="noopener">outline-offset</a></td><td style="text-align:left">对轮廓进行偏移，并在超出边框边缘的位置绘制轮廓。</td><td style="text-align:left">3</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_resize.asp" target="_blank" rel="noopener">resize</a></td><td style="text-align:left">规定是否可由用户对元素的尺寸进行调整。</td><td style="text-align:left">3</td></tr></tbody></table><ul><li>resize:是否可由用户调整元素尺寸</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">border:2px solid;</span></span><br><span class="line"><span class="undefined">padding:10px 40px; </span></span><br><span class="line"><span class="undefined">width:300px;</span></span><br><span class="line"><span class="undefined">resize:both;</span></span><br><span class="line"><span class="undefined">overflow:auto;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>resize 属性规定是否可由用户调整元素尺寸。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span> Firefox 4+、Safari 以及 Chrome 支持 resize 属性。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>box-sizing:以确切的方式定义适应某个区域的具体内容</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div.container</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">width:30em;</span></span><br><span class="line"><span class="undefined">border:1em solid;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">div.box</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">box-sizing:border-box;</span></span><br><span class="line"><span class="undefined">-moz-box-sizing:border-box; /* Firefox */</span></span><br><span class="line"><span class="undefined">-webkit-box-sizing:border-box; /* Safari */</span></span><br><span class="line"><span class="undefined">width:50%;</span></span><br><span class="line"><span class="undefined">border:1em solid red;</span></span><br><span class="line"><span class="undefined">float:left;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span>这个 div 占据左半部分。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span>这个 div 占据右半部分。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>outline-offset:对轮廓进行偏移，并在超出边框边缘的位置绘制轮廓</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"> </span></span><br><span class="line"><span class="undefined">div</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">margin:20px;</span></span><br><span class="line"><span class="undefined">width:150px; </span></span><br><span class="line"><span class="undefined">padding:10px;</span></span><br><span class="line"><span class="undefined">height:70px;</span></span><br><span class="line"><span class="undefined">border:2px solid black;</span></span><br><span class="line"><span class="undefined">outline:2px solid red;</span></span><br><span class="line"><span class="undefined">outline-offset:15px;</span></span><br><span class="line"><span class="undefined">&#125; </span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>Internet Explorer 和 Opera 不支持 support outline-offset 属性。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>这个 div 在边框边缘之外 15 像素处有一个轮廓。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://www.w3school.com.cn/cssref/index.asp" target="_blank" rel="noopener">CSS3 参考手册</a></p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTML（四）CSS</title>
      <link href="/2016/08/15/Html04/"/>
      <url>/2016/08/15/Html04/</url>
      <content type="html"><![CDATA[<p>层叠样式表(英文全称：Cascading Style Sheets)是一种用来表现HTML（标准通用标记语言的一个应用）或XML（标准通用标记语言的一个子集）等文件样式的计算机语言。CSS不仅可以静态地修饰网页，还可以配合各种脚本语言动态地对网页各元素进行格式化。本文章主要介绍 CSS 的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><p>样式定义如何显示 HTML 元素，样式通常存储在样式表中，CSS 指层叠样式表 (Cascading Style Sheets)</p><p>样式表允许以多种方式规定样式信息。数字越大，优先展示。</p><ol><li>浏览器缺省设置</li><li>外部样式表</li><li>内部样式表（位于<code>&lt;head&gt;</code> 标签内部）</li><li>内联样式（在 HTML 元素内部）</li></ol><h3 id="一、语法"><a href="#一、语法" class="headerlink" title="一、语法"></a>一、语法</h3><p>CSS 规则由两个主要的部分构成：</p><ul><li>选择器</li><li>一条或多条声明</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">selector &#123;declaration1; declaration2; ... declarationN &#125;</span><br></pre></td></tr></table></figure><p>每条声明由一个属性和一个值组成。 </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">selector</span> &#123;<span class="attribute">property</span>: value&#125;</span><br></pre></td></tr></table></figure><p><img src="/image/Html04/ct_css_selector.png" alt=""></p><p>样例：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--值的不同写法和单位--&gt;</span></span><br><span class="line">p &#123; color: #ff0000; &#125;</span><br><span class="line">p &#123; color: #f00; &#125;</span><br><span class="line">p &#123; color: rgb(255,0,0); &#125;</span><br><span class="line">p &#123; color: rgb(100%,0%,0%); &#125;</span><br><span class="line">p &#123;font-family: "sans serif";&#125;</span><br><span class="line"><span class="comment">&lt;!--值为若干单词，则要给值加引号--&gt;</span></span><br><span class="line">p &#123;font-family: "sans serif";&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--保持换行和末尾的';' 这样更好修改,避免错误--&gt;</span></span><br><span class="line">body &#123;</span><br><span class="line">  color: #000;</span><br><span class="line">  background: #fff;</span><br><span class="line">  margin: 0;</span><br><span class="line">  padding: 0;</span><br><span class="line">  font-family: Georgia, Palatino, serif;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="1-1-继承"><a href="#1-1-继承" class="headerlink" title="1.1.继承"></a>1.1.继承</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--通过 CSS 继承，子元素将继承最高级元素（在本例中是 body）所拥有的属性（这些子元素诸如 p, td, ul, ol, ul, li, dl, dt,和 dd）,除了部分浏览器不支持(Netscape 4  IE6 )--&gt;</span></span><br><span class="line">body  &#123;</span><br><span class="line">     font-family: Verdana, sans-serif;</span><br><span class="line">     &#125;</span><br><span class="line"><span class="comment">&lt;!--为了避免遇到不支持,下面做一下子元素设置--&gt;</span></span><br><span class="line">td, ul, ol, ul, li, dl, dt, dd  &#123;</span><br><span class="line">     font-family: Verdana, sans-serif;</span><br><span class="line">     &#125;</span><br><span class="line"><span class="comment">&lt;!--针对p元素设置一个独立的设置--&gt;</span></span><br><span class="line">p  &#123;</span><br><span class="line">     font-family: Times, "Times New Roman", serif;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><h3 id="二、创建-CSS"><a href="#二、创建-CSS" class="headerlink" title="二、创建 CSS"></a>二、创建 CSS</h3><ul><li><p>外部样式表：使用 <code>&lt;link&gt;</code> 标签链接到样式表</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"mystyle.css"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>内部样式表:使用 <code>&lt;style&gt;</code> 标签在文档头部定义内部样式表</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">  <span class="selector-tag">hr</span> &#123;<span class="attribute">color</span>: sienna;&#125;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">p</span> &#123;<span class="attribute">margin-left</span>: <span class="number">20px</span>;&#125;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">body</span> &#123;<span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">"images/back40.gif"</span>);&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>内联样式:相关的标签内使用样式（style）属性</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"color: sienna; margin-left: 20px"</span>&gt;</span></span><br><span class="line">This is a paragraph</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>多重样式：多种样式同时存在，取交集；同样的部分，优先级高覆盖低</p><h3 id="三、CSS-样式"><a href="#三、CSS-样式" class="headerlink" title="三、CSS 样式"></a>三、CSS 样式</h3><h4 id="3-1-背景"><a href="#3-1-背景" class="headerlink" title="3.1.背景"></a>3.1.背景</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_background.asp" target="_blank" rel="noopener">background</a></td><td style="text-align:left">简写属性，作用是将背景属性设置在一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_background-attachment.asp" target="_blank" rel="noopener">background-attachment</a></td><td style="text-align:left">背景图像是否固定或者随着页面的其余部分滚动。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_background-color.asp" target="_blank" rel="noopener">background-color</a></td><td style="text-align:left">设置元素的背景颜色。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_background-image.asp" target="_blank" rel="noopener">background-image</a></td><td style="text-align:left">把图像设置为背景。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_background-position.asp" target="_blank" rel="noopener">background-position</a></td><td style="text-align:left">设置背景图像的起始位置。支持位置关键字、百分比和长度值</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_background-repeat.asp" target="_blank" rel="noopener">background-repeat</a></td><td style="text-align:left">设置背景图像是否及如何重复。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span> &#123;<span class="attribute">background-color</span>: yellow&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">h1</span> &#123;<span class="attribute">background-color</span>: <span class="number">#00ff00</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">h2</span> &#123;<span class="attribute">background-color</span>: transparent&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123;<span class="attribute">background-color</span>: <span class="built_in">rgb</span>(250,0,255)&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.no2</span> &#123;<span class="attribute">background-color</span>: gray; <span class="attribute">padding</span>: <span class="number">20px</span>;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是标题 1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是标题 2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"no2"</span>&gt;</span>这个段落设置了内边距。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-2-文本"><a href="#3-2-文本" class="headerlink" title="3.2.文本"></a>3.2.文本</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_color.asp" target="_blank" rel="noopener">color</a></td><td style="text-align:left">设置文本颜色</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_direction.asp" target="_blank" rel="noopener">direction</a></td><td style="text-align:left">设置文本方向。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_line-height.asp" target="_blank" rel="noopener">line-height</a></td><td style="text-align:left">设置行高。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_letter-spacing.asp" target="_blank" rel="noopener">letter-spacing</a></td><td style="text-align:left">设置字符间距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_text-align.asp" target="_blank" rel="noopener">text-align</a></td><td style="text-align:left">对齐元素中的文本。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_text-decoration.asp" target="_blank" rel="noopener">text-decoration</a></td><td style="text-align:left">向文本添加修饰。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_text-indent.asp" target="_blank" rel="noopener">text-indent</a></td><td style="text-align:left">缩进元素中文本的首行。</td></tr><tr><td style="text-align:left">text-shadow</td><td style="text-align:left">设置文本阴影。CSS2 包含该属性，但是 CSS2.1 没有保留该属性。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_text-transform.asp" target="_blank" rel="noopener">text-transform</a></td><td style="text-align:left">控制元素中的字母。</td></tr><tr><td style="text-align:left">unicode-bidi</td><td style="text-align:left">设置文本方向。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_white-space.asp" target="_blank" rel="noopener">white-space</a></td><td style="text-align:left">设置元素中空白的处理方式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_text_word-spacing.asp" target="_blank" rel="noopener">word-spacing</a></td><td style="text-align:left">设置字间距。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123;<span class="attribute">text-indent</span>: <span class="number">1em</span>&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line">这是段落中的一些文本。</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-3-字体"><a href="#3-3-字体" class="headerlink" title="3.3.字体"></a>3.3.字体</h4><p>在 CSS 中，有两种不同类型的字体系列名称：</p><ul><li>通用字体系列 - 拥有相似外观的字体系统组合（比如 “Serif” 或 “Monospace”）</li><li>特定字体系列 - 具体的字体系列（比如 “Times” 或 “Courier”）</li></ul><p>除了各种特定的字体系列外，CSS 定义了 5 种通用字体系列：</p><ul><li>Serif 字体</li><li>Sans-serif 字体</li><li>Monospace 字体</li><li>Cursive 字体</li><li>Fantasy 字体</li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font.asp" target="_blank" rel="noopener">font</a></td><td style="text-align:left">简写属性。作用是把所有针对字体的属性设置在一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font-family.asp" target="_blank" rel="noopener">font-family</a></td><td style="text-align:left">设置字体系列。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font-size.asp" target="_blank" rel="noopener">font-size</a></td><td style="text-align:left">设置字体的尺寸。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font-size-adjust.asp" target="_blank" rel="noopener">font-size-adjust</a></td><td style="text-align:left">当首选字体不可用时，对替换字体进行智能缩放。（CSS2.1 已删除该属性。）</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font-stretch.asp" target="_blank" rel="noopener">font-stretch</a></td><td style="text-align:left">对字体进行水平拉伸。（CSS2.1 已删除该属性。）</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font-style.asp" target="_blank" rel="noopener">font-style</a></td><td style="text-align:left">设置字体风格。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_font-variant.asp" target="_blank" rel="noopener">font-variant</a></td><td style="text-align:left">以小型大写字体或者正常字体显示文本。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_font_weight.asp" target="_blank" rel="noopener">font-weight</a></td><td style="text-align:left">设置字体的粗细。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span> &#123;<span class="attribute">font-family</span>:sans-serif;&#125;</span></span><br><span class="line"><span class="undefined">p &#123;</span></span><br><span class="line"><span class="undefined">    font-family: Times, TimesNR, 'New Century Schoolbook', Georgia, 'New York', serif;</span></span><br><span class="line"><span class="css">    <span class="selector-tag">font-size</span><span class="selector-pseudo">:1em</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is heading 1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-family: Times, TimesNR, 'New Century Schoolbook', Georgia,</span></span></span><br><span class="line"><span class="tag"><span class="string"> 'New York', serif;"</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-链接"><a href="#3-4-链接" class="headerlink" title="3.4.链接"></a>3.4.链接</h4><p>链接的四种状态：</p><ul><li>a:link - 普通的、未被访问的链接</li><li>a:visited - 用户已访问的链接</li><li>a:hover - 鼠标指针位于链接的上方</li><li>a:active - 链接被点击的时刻</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span> &#123;<span class="attribute">color</span>:<span class="number">#FF0000</span>;&#125;    <span class="comment">/* 未被访问的链接 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span> &#123;<span class="attribute">color</span>:<span class="number">#00FF00</span>;&#125; <span class="comment">/* 已被访问的链接 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;<span class="attribute">color</span>:<span class="number">#FF00FF</span>;&#125;   <span class="comment">/* 鼠标指针移动到链接上 */</span></span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:active</span> &#123;<span class="attribute">color</span>:<span class="number">#0000FF</span>;&#125;  <span class="comment">/* 正在被点击的链接 */</span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/index.html"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>这是一个链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>为了使定义生效，a:hover 必须位于 a:link 和 a:visited 之后！！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>为了使定义生效，a:active 必须位于 a:hover 之后！！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-5-列表"><a href="#3-5-列表" class="headerlink" title="3.5.列表"></a>3.5.列表</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_list-style.asp" target="_blank" rel="noopener">list-style</a></td><td style="text-align:left">简写属性。用于把所有用于列表的属性设置于一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_list-style-image.asp" target="_blank" rel="noopener">list-style-image</a></td><td style="text-align:left">将图象设置为列表项标志。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_list-style-position.asp" target="_blank" rel="noopener">list-style-position</a></td><td style="text-align:left">设置列表中列表项标志的位置。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_list-style-type.asp" target="_blank" rel="noopener">list-style-type</a></td><td style="text-align:left">设置列表项标志的类型。</td></tr><tr><td style="text-align:left">marker-offset</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">ul</span><span class="selector-class">.disc</span> &#123;<span class="attribute">list-style-type</span>: disc&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">ul</span><span class="selector-class">.circle</span> &#123;<span class="attribute">list-style-type</span>: circle&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">ul</span><span class="selector-class">.square</span> &#123;<span class="attribute">list-style-type</span>: square&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">ul</span><span class="selector-class">.none</span> &#123;<span class="attribute">list-style-type</span>: none&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"disc"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>咖啡<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>茶<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>可口可乐<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"circle"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>咖啡<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>茶<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>可口可乐<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"square"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>咖啡<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>茶<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>可口可乐<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"none"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>咖啡<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>茶<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>可口可乐<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-6-表格"><a href="#3-6-表格" class="headerlink" title="3.6.表格"></a>3.6.表格</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_tab_border-collapse.asp" target="_blank" rel="noopener">border-collapse</a></td><td style="text-align:left">设置是否把表格边框合并为单一的边框。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_tab_border-spacing.asp" target="_blank" rel="noopener">border-spacing</a></td><td style="text-align:left">设置分隔单元格边框的距离。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_tab_caption-side.asp" target="_blank" rel="noopener">caption-side</a></td><td style="text-align:left">设置表格标题的位置。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_tab_empty-cells.asp" target="_blank" rel="noopener">empty-cells</a></td><td style="text-align:left">设置是否显示表格中的空单元格。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_tab_table-layout.asp" target="_blank" rel="noopener">table-layout</a></td><td style="text-align:left">设置显示单元、行和列的算法。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">table,td,th</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-tag">black</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">table</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">width</span><span class="selector-pseudo">:100</span>%;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">th</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">height</span><span class="selector-pseudo">:50px</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">td</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">height</span><span class="selector-pseudo">:50px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">vertical-align</span><span class="selector-pseudo">:bottom</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">text-align</span><span class="selector-pseudo">:right</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:15px</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>Firstname<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>Lastname<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>Steven<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>Jobs<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-7-轮廓"><a href="#3-7-轮廓" class="headerlink" title="3.7.轮廓"></a>3.7.轮廓</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_outline.asp" target="_blank" rel="noopener">outline</a></td><td style="text-align:left">在一个声明中设置所有的轮廓属性。</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_outline-color.asp" target="_blank" rel="noopener">outline-color</a></td><td style="text-align:left">设置轮廓的颜色。</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_outline-style.asp" target="_blank" rel="noopener">outline-style</a></td><td style="text-align:left">设置轮廓的样式。</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_outline-width.asp" target="_blank" rel="noopener">outline-width</a></td><td style="text-align:left">设置轮廓的宽度。</td><td style="text-align:left">2</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">p</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">border: red solid thin;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.dotted</span> &#123;<span class="attribute">outline-style</span>: dotted&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.dashed</span> &#123;<span class="attribute">outline-style</span>: dashed&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.solid</span> &#123;<span class="attribute">outline-style</span>: solid&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.double</span> &#123;<span class="attribute">outline-style</span>: double&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.groove</span> &#123;<span class="attribute">outline-style</span>: groove&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.ridge</span> &#123;<span class="attribute">outline-style</span>: ridge&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.inset</span> &#123;<span class="attribute">outline-style</span>: inset&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.outset</span> &#123;<span class="attribute">outline-style</span>: outset&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"dotted"</span>&gt;</span>A dotted outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"dashed"</span>&gt;</span>A dashed outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"solid"</span>&gt;</span>A solid outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"double"</span>&gt;</span>A double outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"groove"</span>&gt;</span>A groove outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"ridge"</span>&gt;</span>A ridge outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"inset"</span>&gt;</span>An inset outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"outset"</span>&gt;</span>An outset outline<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>只有在规定了 !DOCTYPE 时，Internet Explorer 8 （以及更高版本） 才支持 outline-style 属性。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="四、框模型"><a href="#四、框模型" class="headerlink" title="四、框模型"></a>四、框模型</h3><p> <strong>CSS 框模型 (Box Model) 规定了元素框处理元素内容、<a href="#4.1.内边距">内边距</a>、<a href="#4.2.边框">边框</a> 和 <a href="#4.3.外边距">外边距</a> 的方式。</strong> </p><p><img src="/image/Html04/ct_boxmodel.png" alt=""></p><h4 id="4-1-内边距"><a href="#4-1-内边距" class="headerlink" title="4.1.内边距"></a>4.1.内边距</h4><p> <strong>元素边框与元素内容之间的空白区域。</strong> </p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_padding.asp" target="_blank" rel="noopener">padding</a></td><td style="text-align:left">简写属性。作用是在一个声明中设置元素的所内边距属性。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_padding-bottom.asp" target="_blank" rel="noopener">padding-bottom</a></td><td style="text-align:left">设置元素的下内边距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_padding-left.asp" target="_blank" rel="noopener">padding-left</a></td><td style="text-align:left">设置元素的左内边距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_padding-right.asp" target="_blank" rel="noopener">padding-right</a></td><td style="text-align:left">设置元素的右内边距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_padding-top.asp" target="_blank" rel="noopener">padding-top</a></td><td style="text-align:left">设置元素的上内边距。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">td</span><span class="selector-class">.test1</span> &#123;<span class="attribute">padding</span>: <span class="number">1.5cm</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">td</span><span class="selector-class">.test2</span> &#123;<span class="attribute">padding</span>: <span class="number">0.5cm</span> <span class="number">2.5cm</span>&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"test1"</span>&gt;</span></span><br><span class="line">这个表格单元的每个边拥有相等的内边距。</span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"test2"</span>&gt;</span></span><br><span class="line">这个表格单元的上和下内边距是 0.5cm，左和右内边距是 2.5cm。</span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-2-边框"><a href="#4-2-边框" class="headerlink" title="4.2.边框"></a>4.2.边框</h4><h2 id="CSS-边框属性"><a href="#CSS-边框属性" class="headerlink" title="CSS 边框属性"></a>CSS 边框属性</h2><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border.asp" target="_blank" rel="noopener">border</a></td><td style="text-align:left">简写属性，用于把针对四个边的属性设置在一个声明。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-style.asp" target="_blank" rel="noopener">border-style</a></td><td style="text-align:left">用于设置元素所有边框的样式，或者单独地为各边设置边框样式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-width.asp" target="_blank" rel="noopener">border-width</a></td><td style="text-align:left">简写属性，用于为元素的所有边框设置宽度，或者单独地为各边边框设置宽度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-color.asp" target="_blank" rel="noopener">border-color</a></td><td style="text-align:left">简写属性，设置元素的所有边框中可见部分的颜色，或为 4 个边分别设置颜色。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-bottom.asp" target="_blank" rel="noopener">border-bottom</a></td><td style="text-align:left">简写属性，用于把下边框的所有属性设置到一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-bottom_color.asp" target="_blank" rel="noopener">border-bottom-color</a></td><td style="text-align:left">设置元素的下边框的颜色。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-bottom_style.asp" target="_blank" rel="noopener">border-bottom-style</a></td><td style="text-align:left">设置元素的下边框的样式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-bottom_width.asp" target="_blank" rel="noopener">border-bottom-width</a></td><td style="text-align:left">设置元素的下边框的宽度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-left.asp" target="_blank" rel="noopener">border-left</a></td><td style="text-align:left">简写属性，用于把左边框的所有属性设置到一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-left_color.asp" target="_blank" rel="noopener">border-left-color</a></td><td style="text-align:left">设置元素的左边框的颜色。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-left_style.asp" target="_blank" rel="noopener">border-left-style</a></td><td style="text-align:left">设置元素的左边框的样式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-left_width.asp" target="_blank" rel="noopener">border-left-width</a></td><td style="text-align:left">设置元素的左边框的宽度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-right.asp" target="_blank" rel="noopener">border-right</a></td><td style="text-align:left">简写属性，用于把右边框的所有属性设置到一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-right_color.asp" target="_blank" rel="noopener">border-right-color</a></td><td style="text-align:left">设置元素的右边框的颜色。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-right_style.asp" target="_blank" rel="noopener">border-right-style</a></td><td style="text-align:left">设置元素的右边框的样式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-right_width.asp" target="_blank" rel="noopener">border-right-width</a></td><td style="text-align:left">设置元素的右边框的宽度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-top.asp" target="_blank" rel="noopener">border-top</a></td><td style="text-align:left">简写属性，用于把上边框的所有属性设置到一个声明中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-top_color.asp" target="_blank" rel="noopener">border-top-color</a></td><td style="text-align:left">设置元素的上边框的颜色。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-top_style.asp" target="_blank" rel="noopener">border-top-style</a></td><td style="text-align:left">设置元素的上边框的样式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_border-top_width.asp" target="_blank" rel="noopener">border-top-width</a></td><td style="text-align:left">设置元素的上边框的宽度。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">p </span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-style</span><span class="selector-pseudo">:solid</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">border-left</span><span class="selector-pseudo">:thick</span> <span class="selector-tag">double</span> <span class="selector-id">#ff0000</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is some text in a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-3-外边距"><a href="#4-3-外边距" class="headerlink" title="4.3.外边距"></a>4.3.外边距</h4><p> <strong>围绕在元素边框的空白区域是外边距。</strong> </p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_margin.asp" target="_blank" rel="noopener">margin</a></td><td style="text-align:left">简写属性。在一个声明中设置所有外边距属性。margin: top right bottom left</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_margin-bottom.asp" target="_blank" rel="noopener">margin-bottom</a></td><td style="text-align:left">设置元素的下外边距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_margin-left.asp" target="_blank" rel="noopener">margin-left</a></td><td style="text-align:left">设置元素的左外边距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_margin-right.asp" target="_blank" rel="noopener">margin-right</a></td><td style="text-align:left">设置元素的右外边距。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_margin-top.asp" target="_blank" rel="noopener">margin-top</a></td><td style="text-align:left">设置元素的上外边距。</td></tr></tbody></table><p>外边距少于 4 个值。规则如下：</p><ul><li>如果缺少左外边距的值，则使用右外边距的值。</li><li>如果缺少下外边距的值，则使用上外边距的值。</li><li>如果缺少右外边距的值，则使用上外边距的值。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.margin</span> &#123;<span class="attribute">margin</span>: <span class="number">2cm</span>&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这个段落没有指定外边距。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"margin"</span>&gt;</span>这个段落带有指定的外边距。这个段落带有指定的外边距。这个段落带有指定的外边距。这个段落带有指定的外边距。这个段落带有指定的外边距。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这个段落没有指定外边距。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>当两个垂直外边距相遇时，它们将形成一个外边距。</strong>  <strong>合并后的外边距的高度等于两个发生合并的外边距的高度中的较大者。</strong> </p><p><img src="/image/Html04/ct_css_margin_collapsing_example_1.png" alt=""><br><img src="/image/Html04/ct_css_margin_collapsing_example_2.png" alt=""><br><img src="/image/Html04/ct_css_margin_collapsing_example_3.png" alt=""><br><img src="/image/Html04/ct_css_margin_collapsing_example_4.png" alt=""></p><h3 id="五、定位"><a href="#五、定位" class="headerlink" title="五、定位"></a>五、定位</h3><p>定位属性允许你对元素进行定位。 </p><ul><li><a href="#5.1.相对定位">普通流</a>： 普通流中的元素的位置由元素在 (X)HTML 中的位置决定。 </li><li><a href="#5.2.绝对定位">绝对定位</a></li><li><a href="#5.3.浮动">浮动</a></li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_position.asp" target="_blank" rel="noopener">position</a></td><td style="text-align:left">把元素放置到一个静态的、相对的、绝对的、或固定的位置中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_top.asp" target="_blank" rel="noopener">top</a></td><td style="text-align:left">定义了一个定位元素的上外边距边界与其包含块上边界之间的偏移。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_right.asp" target="_blank" rel="noopener">right</a></td><td style="text-align:left">定义了定位元素右外边距边界与其包含块右边界之间的偏移。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_bottom.asp" target="_blank" rel="noopener">bottom</a></td><td style="text-align:left">定义了定位元素下外边距边界与其包含块下边界之间的偏移。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_left.asp" target="_blank" rel="noopener">left</a></td><td style="text-align:left">定义了定位元素左外边距边界与其包含块左边界之间的偏移。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_overflow.asp" target="_blank" rel="noopener">overflow</a></td><td style="text-align:left">设置当元素的内容溢出其区域时发生的事情。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_clip.asp" target="_blank" rel="noopener">clip</a></td><td style="text-align:left">设置元素的形状。元素被剪入这个形状之中，然后显示出来。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_vertical-align.asp" target="_blank" rel="noopener">vertical-align</a></td><td style="text-align:left">设置元素的垂直对齐方式。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pos_z-index.asp" target="_blank" rel="noopener">z-index</a></td><td style="text-align:left">设置元素的堆叠顺序。</td></tr></tbody></table><h4 id="5-1-相对定位"><a href="#5-1-相对定位" class="headerlink" title="5.1.相对定位"></a>5.1.相对定位</h4><p> 相对定位实际上被看作普通流定位模型的一部分，因为元素的位置相对于它在普通流中的位置。 </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">h2</span><span class="selector-class">.pos_left</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">position</span><span class="selector-pseudo">:relative</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">left</span><span class="selector-pseudo">:-20px</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">h2</span><span class="selector-class">.pos_right</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">position</span><span class="selector-pseudo">:relative</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">left</span><span class="selector-pseudo">:20px</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是位于正常位置的标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"pos_left"</span>&gt;</span>这个标题相对于其正常位置向左移动<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"pos_right"</span>&gt;</span>这个标题相对于其正常位置向右移动<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>相对定位会按照元素的原始位置对该元素进行移动。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>样式 "left:-20px" 从元素的原始左侧位置减去 20 像素。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>样式 "left:20px" 向元素的原始左侧位置增加 20 像素。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="5-2-绝对定位"><a href="#5-2-绝对定位" class="headerlink" title="5.2.绝对定位"></a>5.2.绝对定位</h4><p> 绝对定位使元素的位置与文档流无关，  普通流中其它元素的布局就像绝对定位的元素不存在一样 。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">h2</span><span class="selector-class">.pos_abs</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">position</span><span class="selector-pseudo">:absolute</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">left</span><span class="selector-pseudo">:100px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">top</span><span class="selector-pseudo">:150px</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"pos_abs"</span>&gt;</span>这是带有绝对定位的标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>通过绝对定位，元素可以放置到页面上的任何位置。下面的标题距离页面左侧 100px，距离页面顶部 150px。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="5-3-浮动"><a href="#5-3-浮动" class="headerlink" title="5.3.浮动"></a>5.3.浮动</h4><p><strong>浮动的框可以向左或向右移动，直到它的外边缘碰到包含框或另一个浮动框的边框为止。</strong></p><p><strong>由于浮动框不在文档的普通流中，所以文档的普通流中的块框表现得就像浮动框不存在一样。</strong></p><ul><li><strong>float</strong> ：元素的浮动。</li><li><strong>clear</strong>：元素的哪一侧不允许其他浮动元素</li></ul><p><img src="/image/Html04/ct_css_positioning_floating_right_example.png" alt=""></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">img </span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">float</span><span class="selector-pseudo">:right</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>在下面的段落中，我们添加了一个样式为 <span class="tag">&lt;<span class="name">b</span>&gt;</span>float:right<span class="tag">&lt;/<span class="name">b</span>&gt;</span> 的图像。结果是这个图像会浮动到段落的右侧。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/eg_cute.gif"</span> /&gt;</span></span><br><span class="line">This is some text. This is some text. This is some text.</span><br><span class="line">This is some text. This is some text. This is some text.</span><br><span class="line">This is some text. This is some text. This is some text.</span><br><span class="line">This is some text. This is some text. This is some text.</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">img</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">float</span><span class="selector-pseudo">:left</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">clear</span><span class="selector-pseudo">:both</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/eg_smile.gif"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/eg_smile.gif"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="六、选择器"><a href="#六、选择器" class="headerlink" title="六、选择器"></a>六、选择器</h3><h4 id="6-1-元素选择器"><a href="#6-1-元素选择器" class="headerlink" title="6.1.元素选择器"></a>6.1.元素选择器</h4><p>元素选择器又称为类型选择器（type selector）。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">html</span> &#123;<span class="attribute">color</span>:black;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123;<span class="attribute">color</span>:blue;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">h2</span> &#123;<span class="attribute">color</span>:silver;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 heading 1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是 heading 2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一段普通的段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-2-选择器的分组"><a href="#6-2-选择器的分组" class="headerlink" title="6.2.选择器的分组"></a>6.2.选择器的分组</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">h1,h2,h3,h4,h5,h6 &#123;</span><br><span class="line">  color: green;</span><br><span class="line">  &#125;</span><br><span class="line">* &#123;color:red;&#125;</span><br></pre></td></tr></table></figure><h4 id="6-3-派生选择器"><a href="#6-3-派生选择器" class="headerlink" title="6.3.派生选择器"></a>6.3.派生选择器</h4><p>根据文档的上下文关系来确定某个标签的样式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">li strong &#123;</span><br><span class="line">    font-style: italic;</span><br><span class="line">    font-weight: normal;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>我是粗体字，不是斜体字，因为我不在列表当中，所以这个规则对我不起作用<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>我是斜体字。这是因为 strong 元素位于 li 元素内。<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>我是正常的字体。<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-4-类选择器"><a href="#6-4-类选择器" class="headerlink" title="6.4.类选择器"></a>6.4.类选择器</h4><p>在 CSS 中，类选择器以一个点号显示：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.center &#123;text-align: center&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">This heading will be center-aligned</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">This paragraph will also be center-aligned.</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 与派生器结合--&gt;</span></span><br><span class="line">.fancy td &#123;</span><br><span class="line">color: #f60;</span><br><span class="line">background: #666;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">td.fancy &#123;</span><br><span class="line">color: #f60;</span><br><span class="line">background: #666;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 多类选择器:通过把两个类选择器链接在一起，选择同时包含这些类名的元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.important</span> &#123;<span class="attribute">font-weight</span>:bold;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.warning</span> &#123;<span class="attribute">font-style</span>:italic;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.important</span><span class="selector-class">.warning</span> &#123;<span class="attribute">background</span>:silver;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"important"</span>&gt;</span>This paragraph is very important.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"warning"</span>&gt;</span>This is a warning.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"important urgent warning"</span>&gt;</span>This paragraph is a very important warning.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-5-id-选择器"><a href="#6-5-id-选择器" class="headerlink" title="6.5.id 选择器"></a>6.5.id 选择器</h4><p>为标有特定 id 的 HTML 元素指定特定的样式。以 “#” 来定义。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#red &#123;color:red;&#125;</span><br><span class="line">#green &#123;color:green;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"red"</span>&gt;</span>这个段落是红色。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"green"</span>&gt;</span>这个段落是绿色。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 与派生器结合--&gt;</span></span><br><span class="line">#sidebar p &#123;</span><br><span class="line">font-style: italic;</span><br><span class="line">text-align: right;</span><br><span class="line">margin-top: 0.5em;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意事项:</p><ul><li>只能在文档中使用一次</li><li>不能使用 ID 词列表</li><li>区分大小写</li></ul><h4 id="6-6-属性选择器"><a href="#6-6-属性选择器" class="headerlink" title="6.6.属性选择器"></a>6.6.属性选择器</h4><p>为拥有指定属性的 HTML 元素设置样式，而不仅限于 class 和 id 属性。<br>只有在规定了 !DOCTYPE 时，IE7 和 IE8 才支持属性选择器。在 IE6 及更低的版本中，不支持属性选择。</p><table><thead><tr><th style="text-align:left">选择器</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/selector_attribute.asp" target="_blank" rel="noopener">[<em>attribute</em>]</a></td><td style="text-align:left">用于选取带有指定属性的元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/selector_attribute_value.asp" target="_blank" rel="noopener">[<em>attribute</em>=<em>value</em>]</a></td><td style="text-align:left">用于选取带有指定属性和值的元素。属性与属性值必须完全匹配</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/selector_attribute_value_contain.asp" target="_blank" rel="noopener">[<em>attribute</em>~=<em>value</em>]</a></td><td style="text-align:left">用于选取属性值中包含指定词汇的元素。</td></tr><tr><td style="text-align:left">[[<em>attribute</em>\</td><td style="text-align:left">=<em>value</em>]](<a href="https://www.w3school.com.cn/cssref/selector_attribute_value_start.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/cssref/selector_attribute_value_start.asp</a>)</td><td>用于选取带有以指定值开头的属性值的元素，该值必须是整个单词。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/selector_attr_begin.asp" target="_blank" rel="noopener">[<em>attribute</em>^=<em>value</em>]</a></td><td style="text-align:left">匹配属性值以指定值开头的每个元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/selector_attr_end.asp" target="_blank" rel="noopener">[<em>attribute</em>$=<em>value</em>]</a></td><td style="text-align:left">匹配属性值以指定值结尾的每个元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/selector_attr_contain.asp" target="_blank" rel="noopener">[<em>attribute**=</em>value*]</a></td><td style="text-align:left">匹配属性值中包含指定值的每个元素。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">*[title] &#123;color:red;&#125;</span><br><span class="line">a[href][title] &#123;color:red;&#125;</span><br><span class="line">[title=W3School]</span><br><span class="line">&#123;</span><br><span class="line">border:5px solid blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-7-后代选择器"><a href="#6-7-后代选择器" class="headerlink" title="6.7.后代选择器"></a>6.7.后代选择器</h4><p> 在后代选择器中，规则左边的选择器一端包括两个或多个用空格分隔的选择器。选择器之间的空格是一种结合符（combinator）。每个空格结合符可以解释为“… 在 … 找到”、“… 作为 … 的一部分”、“… 作为 … 的后代”，但是要求必须从右向左读选择器。 </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">ul</span> <span class="selector-tag">em</span> &#123;<span class="attribute">color</span>:red; <span class="attribute">font-weight</span>:bold;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1</span><br><span class="line">    <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1-1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1-2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1-3</span><br><span class="line">        <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1-3-1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item <span class="tag">&lt;<span class="name">em</span>&gt;</span>1-3-2<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1-3-3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1-4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-8-子元素选择器"><a href="#6-8-子元素选择器" class="headerlink" title="6.8.子元素选择器"></a>6.8.子元素选择器</h4><p> <strong>选择作为某元素子元素的元素，子选择器使用了大于号（子结合符）。 </strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--选择只作为 h1 元素子元素的 strong 元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">h1</span> &gt; <span class="selector-tag">strong</span> &#123;<span class="attribute">color</span>:red;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is <span class="tag">&lt;<span class="name">strong</span>&gt;</span>very<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> <span class="tag">&lt;<span class="name">strong</span>&gt;</span>very<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> important.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is <span class="tag">&lt;<span class="name">em</span>&gt;</span>really <span class="tag">&lt;<span class="name">strong</span>&gt;</span>very<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">em</span>&gt;</span> important.<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-9-相邻兄弟选择器"><a href="#6-9-相邻兄弟选择器" class="headerlink" title="6.9.相邻兄弟选择器"></a>6.9.相邻兄弟选择器</h4><p> <strong>选择紧接在另一元素后的元素，且二者有相同父元素。</strong>  相邻兄弟选择器使用了加号（+），即相邻兄弟结合符（Adjacent sibling combinator）。 </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>List item 3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-10-伪类-Pseudo-classes"><a href="#6-10-伪类-Pseudo-classes" class="headerlink" title="6.10.伪类 (Pseudo-classes)"></a>6.10.伪类 (Pseudo-classes)</h4><p> <strong>用于向某些选择器添加特殊的效果。</strong> </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">selector : pseudo-class &#123;property: value&#125;</span><br><span class="line">selector.class : pseudo-class &#123;property: value&#125;</span><br></pre></td></tr></table></figure><p><em>W3C</em>：”W3C” 列指示出该属性在哪个 CSS 版本中定义（CSS1 还是 CSS2）。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_active.asp" target="_blank" rel="noopener">:active</a></td><td style="text-align:left">向被激活的元素添加样式。</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_focus.asp" target="_blank" rel="noopener">:focus</a></td><td style="text-align:left">向拥有键盘输入焦点的元素添加样式。</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_hover.asp" target="_blank" rel="noopener">:hover</a></td><td style="text-align:left">当鼠标悬浮在元素上方时，向元素添加样式。</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_link.asp" target="_blank" rel="noopener">:link</a></td><td style="text-align:left">向未被访问的链接添加样式。</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_visited.asp" target="_blank" rel="noopener">:visited</a></td><td style="text-align:left">向已被访问的链接添加样式。</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_first-child.asp" target="_blank" rel="noopener">:first-child</a></td><td style="text-align:left">向元素的第一个子元素添加样式。</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_lang.asp" target="_blank" rel="noopener">:lang</a></td><td style="text-align:left">向带有指定 lang 属性的元素添加样式。</td><td style="text-align:left">2</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:link</span> &#123;<span class="attribute">color</span>: <span class="number">#FF0000</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span> &#123;<span class="attribute">color</span>: <span class="number">#00FF00</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;<span class="attribute">color</span>: <span class="number">#FF00FF</span>&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">a</span><span class="selector-pseudo">:active</span> &#123;<span class="attribute">color</span>: <span class="number">#0000FF</span>&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/index.html"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>这是一个链接。<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>在 CSS 定义中，a:hover 必须位于 a:link 和 a:visited 之后，这样才能生效！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>在 CSS 定义中，a:active 必须位于 a:hover 之后，这样才能生效！<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>注： 伪类名称对大小写不敏感。 </strong></p><h4 id="6-11-伪元素-Pseudo-elements"><a href="#6-11-伪元素-Pseudo-elements" class="headerlink" title="6.11.伪元素 (Pseudo-elements)"></a>6.11.伪元素 (Pseudo-elements)</h4><p>用于向某些选择器设置特殊效果。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">selector:pseudo-element &#123;property:value;&#125;</span><br><span class="line">selector.class:pseudo-element &#123;property:value;&#125;</span><br></pre></td></tr></table></figure><p><em>W3C</em>：”W3C” 列指示出该属性在哪个 CSS 版本中定义（CSS1 还是 CSS2）。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th><th style="text-align:left">CSS</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_first-letter.asp" target="_blank" rel="noopener">:first-letter</a></td><td style="text-align:left">向文本的第一个字母添加特殊样式。</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_first-line.asp" target="_blank" rel="noopener">:first-line</a></td><td style="text-align:left">向文本的首行添加特殊样式。</td><td style="text-align:left">1</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_before.asp" target="_blank" rel="noopener">:before</a></td><td style="text-align:left">在元素之前添加内容。</td><td style="text-align:left">2</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_pseudo_after.asp" target="_blank" rel="noopener">:after</a></td><td style="text-align:left">在元素之后添加内容。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-pseudo">:first-letter</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">color</span>:<span class="selector-id">#ff0000</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">font-size</span><span class="selector-pseudo">:xx-large</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-pseudo">:first-line</span> </span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">color</span>:<span class="selector-id">#0000ff</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">font-variant</span><span class="selector-pseudo">:small-caps</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>You can combine the :first-letter and :first-line pseudo-elements to add a special effect to the first letter and the first line of a text!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="七、高级"><a href="#七、高级" class="headerlink" title="七、高级"></a>七、高级</h3><h4 id="7-1-对齐"><a href="#7-1-对齐" class="headerlink" title="7.1.对齐"></a>7.1.对齐</h4><p>使用多种属性来水平对齐元素。</p><ul><li><p>对齐块元素</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>margin 属性来水平对齐</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.center</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">margin</span><span class="selector-pseudo">:auto</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:70</span>%;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>:<span class="selector-id">#b0e0e6</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。这是一个段落。这是一个段落。这是一个段落。这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。这是一个段落。这是一个段落。这是一个段落。这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>除非已经声明了 !DOCTYPE，否则使用 margin:auto 在 IE8 以及更早的版本中是无效的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>position 属性进行左和右对齐</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">body</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">margin</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.container</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">position</span><span class="selector-pseudo">:relative</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:100</span>%;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">position</span><span class="selector-pseudo">:absolute</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">right</span><span class="selector-pseudo">:0px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:300px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>:<span class="selector-id">#b0e0e6</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>当使用 position 属性进行对齐时，请始终包含 !DOCTYPE 声明！如果省略，则会在 IE 浏览器中产生奇怪的结果。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>float 属性来进行左和右对齐</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">body</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">margin</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-class">.right</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">float</span><span class="selector-pseudo">:right</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:300px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>:<span class="selector-id">#b0e0e6</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>当使用 float 属性进行对齐时，请始终包含 !DOCTYPE 声明！如果省略，则会在 IE 浏览器中产生奇怪的结果。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="7-2-尺寸"><a href="#7-2-尺寸" class="headerlink" title="7.2.尺寸"></a>7.2.尺寸</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_height.asp" target="_blank" rel="noopener">height</a></td><td style="text-align:left">设置元素的高度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_line-height.asp" target="_blank" rel="noopener">line-height</a></td><td style="text-align:left">设置行高。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_max-height.asp" target="_blank" rel="noopener">max-height</a></td><td style="text-align:left">设置元素的最大高度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_max-width.asp" target="_blank" rel="noopener">max-width</a></td><td style="text-align:left">设置元素的最大宽度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_min-height.asp" target="_blank" rel="noopener">min-height</a></td><td style="text-align:left">设置元素的最小高度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_min-width.asp" target="_blank" rel="noopener">min-width</a></td><td style="text-align:left">设置元素的最小宽度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_dim_width.asp" target="_blank" rel="noopener">width</a></td><td style="text-align:left">设置元素的宽度。</td></tr></tbody></table><h4 id="7-3-分类"><a href="#7-3-分类" class="headerlink" title="7.3 分类"></a>7.3 分类</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_clear.asp" target="_blank" rel="noopener">clear</a></td><td style="text-align:left">设置一个元素的侧面是否允许其他的浮动元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_cursor.asp" target="_blank" rel="noopener">cursor</a></td><td style="text-align:left">规定当指向某元素之上时显示的指针类型。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_display.asp" target="_blank" rel="noopener">display</a></td><td style="text-align:left">设置是否及如何显示元素。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_float.asp" target="_blank" rel="noopener">float</a></td><td style="text-align:left">定义元素在哪个方向浮动。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_position.asp" target="_blank" rel="noopener">position</a></td><td style="text-align:left">把元素放置到一个静态的、相对的、绝对的、或固定的位置中。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/cssref/pr_class_visibility.asp" target="_blank" rel="noopener">visibility</a></td><td style="text-align:left">设置元素是否可见或不可见。</td></tr></tbody></table><h4 id="7-4-导航条"><a href="#7-4-导航条" class="headerlink" title="7.4.导航条"></a>7.4.导航条</h4><ul><li>链接列表</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#news"</span>&gt;</span>News<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#contact"</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>我们使用在测试链接中使用了 href="#"。在真实的网站中，应该是真实的 URL。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>垂直导航栏</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">ul</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">list-style-type</span><span class="selector-pseudo">:none</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">margin</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">a</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">display</span><span class="selector-pseudo">:block</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:60px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>:<span class="selector-id">#dddddd</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#news"</span>&gt;</span>News<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#contact"</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>为了显示出链接区域，我们为链接添加了背景色。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>请注意，全部链接区域都是可点击的，不仅仅是文本。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>水平导航栏</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">ul</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">list-style-type</span><span class="selector-pseudo">:none</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">margin</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">li</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">display</span><span class="selector-pseudo">:inline</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#news"</span>&gt;</span>News<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#contact"</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>对列表项进行浮动</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">ul</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">list-style-type</span><span class="selector-pseudo">:none</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">margin</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">padding</span><span class="selector-pseudo">:0</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">overflow</span><span class="selector-pseudo">:hidden</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">li</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">float</span><span class="selector-pseudo">:left</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">a</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">display</span><span class="selector-pseudo">:block</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">width</span><span class="selector-pseudo">:60px</span>;</span></span><br><span class="line"><span class="css"><span class="selector-tag">background-color</span>:<span class="selector-id">#dddddd</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#news"</span>&gt;</span>News<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#contact"</span>&gt;</span>Contact<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#about"</span>&gt;</span>About<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>如果没有规定 !DOCTYPE，则浮动项目会产生意想不到的结果。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>为了显示出链接区域，我们为链接添加了背景色。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>向 ul 元素添加 overflow:hidden，是为了防止 li 元素出现在列表之外。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="7-5-图片库"><a href="#7-5-图片库" class="headerlink" title="7.5.图片库"></a>7.5.图片库</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.img</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">margin</span><span class="selector-pseudo">:3px</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-id">#bebebe</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">height</span><span class="selector-pseudo">:auto</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">width</span><span class="selector-pseudo">:auto</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">float</span><span class="selector-pseudo">:left</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">text-align</span><span class="selector-pseudo">:center</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.img</span> <span class="selector-tag">img</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">display</span><span class="selector-pseudo">:inline</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">margin</span><span class="selector-pseudo">:3px</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-id">#bebebe</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.img</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">img</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">border</span><span class="selector-pseudo">:1px</span> <span class="selector-tag">solid</span> <span class="selector-id">#333333</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.desc</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">text-align</span><span class="selector-pseudo">:center</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">font-weight</span><span class="selector-pseudo">:normal</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">width</span><span class="selector-pseudo">:150px</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">font-size</span><span class="selector-pseudo">:12px</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">margin</span><span class="selector-pseudo">:10px</span> 5<span class="selector-tag">px</span> 10<span class="selector-tag">px</span> 5<span class="selector-tag">px</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"/i/tulip_ballade.jpg"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/tulip_ballade_s.jpg"</span> <span class="attr">alt</span>=<span class="string">"Ballade"</span> <span class="attr">width</span>=<span class="string">"160"</span> <span class="attr">height</span>=<span class="string">"160"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"desc"</span>&gt;</span>在此处添加对图像的描述<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"/i/tulip_flaming_club.jpg"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/tulip_flaming_club_s.jpg"</span> <span class="attr">alt</span>=<span class="string">"Ballade"</span> <span class="attr">width</span>=<span class="string">"160"</span> <span class="attr">height</span>=<span class="string">"160"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"desc"</span>&gt;</span>在此处添加对图像的描述<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"/i/tulip_fringed_family.jpg"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/tulip_fringed_family_s.jpg"</span> <span class="attr">alt</span>=<span class="string">"Ballade"</span> <span class="attr">width</span>=<span class="string">"160"</span> <span class="attr">height</span>=<span class="string">"160"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"desc"</span>&gt;</span>在此处添加对图像的描述<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"img"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">href</span>=<span class="string">"/i/tulip_peach_blossom.jpg"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/tulip_peach_blossom_s.jpg"</span> <span class="attr">alt</span>=<span class="string">"Ballade"</span> <span class="attr">width</span>=<span class="string">"160"</span> <span class="attr">height</span>=<span class="string">"160"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"desc"</span>&gt;</span>在此处添加对图像的描述<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="7-6-透明"><a href="#7-6-透明" class="headerlink" title="7.6.透明"></a>7.6.透明</h4><ul><li><p>图片透明</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">img</span><br><span class="line">&#123;</span><br><span class="line">opacity:0.4;</span><br><span class="line">filter:alpha(opacity=40); /* 针对 IE8 以及更早的版本 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>图片透明，当指针在上面不透明</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">img</span><br><span class="line">&#123;</span><br><span class="line">opacity:0.4;</span><br><span class="line">filter:alpha(opacity=40); /* 针对 IE8 以及更早的版本 */</span><br><span class="line">&#125;</span><br><span class="line">img:hover</span><br><span class="line">&#123;</span><br><span class="line">opacity:1.0;</span><br><span class="line">filter:alpha(opacity=100); /* 针对 IE8 以及更早的版本 */</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>透明框中的文本</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.background</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">  width: 400px;</span></span><br><span class="line"><span class="undefined">  height: 266px;</span></span><br><span class="line"><span class="undefined">  background: url('/i/tulip_peach_blossom_w.jpg') no-repeat;</span></span><br><span class="line"><span class="undefined">  border: 1px solid black;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.transbox</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">  width: 338px;</span></span><br><span class="line"><span class="undefined">  height: 204px;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">margin</span><span class="selector-pseudo">:30px</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">background-color</span>: <span class="selector-id">#ffffff</span>;</span></span><br><span class="line"><span class="undefined">  border: 1px solid black;</span></span><br><span class="line"><span class="css">  <span class="comment">/* for IE */</span></span></span><br><span class="line"><span class="undefined">  filter:alpha(opacity=60);</span></span><br><span class="line"><span class="css">  <span class="comment">/* CSS3 standard */</span></span></span><br><span class="line"><span class="css">  <span class="selector-tag">opacity</span><span class="selector-pseudo">:0.6</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-tag">div</span><span class="selector-class">.transbox</span> <span class="selector-tag">p</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">  margin: 30px 40px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"background"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"transbox"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">This is some text that is placed in the transparent box.</span><br><span class="line">This is some text that is placed in the transparent box.</span><br><span class="line">This is some text that is placed in the transparent box.</span><br><span class="line">This is some text that is placed in the transparent box.</span><br><span class="line">This is some text that is placed in the transparent box.</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="7-7-媒介类型"><a href="#7-7-媒介类型" class="headerlink" title="7.7.媒介类型"></a>7.7.媒介类型</h4><p> <strong>允许你定义以何种媒介来提交文档。文档可以被显示在显示器、纸媒介或者听觉浏览器等等。</strong> </p><p><strong>注释：</strong>媒介类型名称对大小写不敏感。</p><table><thead><tr><th style="text-align:left">媒介类型</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">all</td><td style="text-align:left">用于所有的媒介设备。</td></tr><tr><td style="text-align:left">aural</td><td style="text-align:left">用于语音和音频合成器。</td></tr><tr><td style="text-align:left">braille</td><td style="text-align:left">用于盲人用点字法触觉回馈设备。</td></tr><tr><td style="text-align:left">embossed</td><td style="text-align:left">用于分页的盲人用点字法打印机。</td></tr><tr><td style="text-align:left">handheld</td><td style="text-align:left">用于小的手持的设备。</td></tr><tr><td style="text-align:left">print</td><td style="text-align:left">用于打印机。</td></tr><tr><td style="text-align:left">projection</td><td style="text-align:left">用于方案展示，比如幻灯片。</td></tr><tr><td style="text-align:left">screen</td><td style="text-align:left">用于电脑显示器。</td></tr><tr><td style="text-align:left">tty</td><td style="text-align:left">用于使用固定密度字母栅格的媒介，比如电传打字机和终端。</td></tr><tr><td style="text-align:left">tv</td><td style="text-align:left">用于电视机类型的设备。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--浏览器在显示器上显示 14 像素的 Verdana 字体。但是假如页面需要被打印，将使用 10 个像素的 Times 字体。注意：font-weight 被设置为粗体，不论显示器还是纸媒介--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">@<span class="keyword">media</span> screen</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.test</span> &#123;<span class="attribute">font-family</span>:verdana,sans-serif; <span class="attribute">font-size</span>:<span class="number">14px</span>&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">@<span class="keyword">media</span> print</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.test</span> &#123;<span class="attribute">font-family</span>:times,serif; <span class="attribute">font-size</span>:<span class="number">10px</span>&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="css">@<span class="keyword">media</span> screen,print</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span><span class="selector-class">.test</span> &#123;<span class="attribute">font-weight</span>:bold&#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>....<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="八、注意事项"><a href="#八、注意事项" class="headerlink" title="八、注意事项"></a>八、注意事项</h3><ul><li>避免使用Internet Explorer Behaviors：只有 Internet Explorer 支持 behavior 属性。</li></ul><p>More info: <a href="https://www.w3school.com.cn/cssref/index.asp" target="_blank" rel="noopener">CSS 参考手册</a></p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTML（三）HTML5</title>
      <link href="/2016/07/15/Html03/"/>
      <url>/2016/07/15/Html03/</url>
      <content type="html"><![CDATA[<p>HTML5 将成为 HTML、XHTML 以及 HTML DOM 的新标准， 是 W3C 与 WHATWG 合作的结果。 本文章主要介绍 HTML5 的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、-声明"><a href="#一、-声明" class="headerlink" title="一、 声明"></a>一、 声明</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Title of the document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Content of the document......</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="二、浏览器支持"><a href="#二、浏览器支持" class="headerlink" title="二、浏览器支持"></a>二、浏览器支持</h3><p>所有现代浏览器都支持 HTML5，都会自动把未识别元素当做行内元素来处理。但是Internet Explorer 8 以及更早的版本，不允许对未知元素添加样式，使用 HTML5 Enabling JavaScript 取解决。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Styling HTML5<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="comment">  &lt;script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">  &lt;![endif]--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>My First Article<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">article</span>&gt;</span></span><br><span class="line">London is the capital city of England. </span><br><span class="line">It is the most populous city in the United Kingdom, </span><br><span class="line">with a metropolitan area of over 13 million inhabitants.</span><br><span class="line"><span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="三、语义元素"><a href="#三、语义元素" class="headerlink" title="三、语义元素"></a>三、语义元素</h3><table><thead><tr><th style="text-align:left">类型</th><th style="text-align:left">示例</th></tr></thead><tbody><tr><td style="text-align:left">Empty</td><td style="text-align:left"><code>&lt;input type=&quot;text&quot; value=&quot;John Doe&quot; disabled&gt;</code></td></tr><tr><td style="text-align:left">Unquoted</td><td style="text-align:left"><code>&lt;input type=&quot;text&quot; value=John Doe&gt;</code></td></tr><tr><td style="text-align:left">Double-quoted</td><td style="text-align:left"><code>&lt;input type=&quot;text&quot; value=&quot;John Doe&quot;&gt;</code></td></tr><tr><td style="text-align:left">Single-quoted</td><td style="text-align:left"><code>&lt;input type=&quot;text&quot; value=&#39;John Doe&#39;&gt;</code></td></tr></tbody></table><h3 id="四、语义元素"><a href="#四、语义元素" class="headerlink" title="四、语义元素"></a>四、语义元素</h3><p>HTML5 提供了定义页面不同部分的新语义元素：<br><img src="/image/Html03/ct_sem_elements.png" alt=""></p><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;article&gt;</code></td><td style="text-align:left">定义文档内的文章。</td></tr><tr><td style="text-align:left"><code>&lt;aside&gt;</code></td><td style="text-align:left">定义页面内容之外的内容。</td></tr><tr><td style="text-align:left"><code>&lt;bdi&gt;</code></td><td style="text-align:left">定义与其他文本不同的文本方向。</td></tr><tr><td style="text-align:left"><code>&lt;details&gt;</code></td><td style="text-align:left">定义用户可查看或隐藏的额外细节。</td></tr><tr><td style="text-align:left"><code>&lt;dialog&gt;</code></td><td style="text-align:left">定义对话框或窗口。</td></tr><tr><td style="text-align:left"><code>&lt;figcaption&gt;</code></td><td style="text-align:left">定义 <code>&lt;figure&gt;</code> 元素的标题。</td></tr><tr><td style="text-align:left"><code>&lt;figure&gt;</code></td><td style="text-align:left">定义自包含内容，比如图示、图表、照片、代码清单等等。</td></tr><tr><td style="text-align:left"><code>&lt;footer&gt;</code></td><td style="text-align:left">定义文档或节的页脚。</td></tr><tr><td style="text-align:left"><code>&lt;header&gt;</code></td><td style="text-align:left">定义文档或节的页眉。</td></tr><tr><td style="text-align:left"><code>&lt;main&gt;</code></td><td style="text-align:left">定义文档的主内容。</td></tr><tr><td style="text-align:left"><code>&lt;mark&gt;</code></td><td style="text-align:left">定义重要或强调的内容。</td></tr><tr><td style="text-align:left"><code>&lt;menuitem&gt;</code></td><td style="text-align:left">定义用户能够从弹出菜单调用的命令/菜单项目。</td></tr><tr><td style="text-align:left"><code>&lt;meter&gt;</code></td><td style="text-align:left">定义已知范围（尺度）内的标量测量。</td></tr><tr><td style="text-align:left"><code>&lt;nav&gt;</code></td><td style="text-align:left">定义文档内的导航链接。</td></tr><tr><td style="text-align:left"><code>&lt;progress&gt;</code></td><td style="text-align:left">定义任务进度。</td></tr><tr><td style="text-align:left"><code>&lt;rp&gt;</code></td><td style="text-align:left">定义在不支持 ruby 注释的浏览器中显示什么。</td></tr><tr><td style="text-align:left"><code>&lt;rt&gt;</code></td><td style="text-align:left">定义关于字符的解释/发音（用于东亚字体）。</td></tr><tr><td style="text-align:left"><code>&lt;ruby&gt;</code></td><td style="text-align:left">定义 ruby 注释（用于东亚字体）。</td></tr><tr><td style="text-align:left"><code>&lt;section&gt;</code></td><td style="text-align:left">定义文档中的节。</td></tr><tr><td style="text-align:left"><code>&lt;summary&gt;</code></td><td style="text-align:left">定义 <code>&lt;details&gt;</code> 元素的可见标题。</td></tr><tr><td style="text-align:left"><code>&lt;time&gt;</code></td><td style="text-align:left">定义日期/时间。</td></tr><tr><td style="text-align:left"><code>&lt;wbr&gt;</code></td><td style="text-align:left">定义可能的折行（line-break）。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>WWF<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">The World Wide Fund for Nature (WWF) is an international organization working on issues regarding the conservation, research and restoration of the environment, formerly named the World Wildlife Fund. WWF was founded in 1961.</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>WWF's Panda symbol<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">The Panda has become the symbol of WWF. The well-known panda logo of WWF originated from a panda named Chi Chi that was transferred from the Beijing Zoo to the London Zoo in the same year of the establishment of WWF.</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="五、图形"><a href="#五、图形" class="headerlink" title="五、图形"></a>五、图形</h3><ul><li><code>&lt;canvas&gt;</code>：使用 JavaScript 在网页上绘制图像。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"myCanvas"</span> <span class="attr">width</span>=<span class="string">"200"</span> <span class="attr">height</span>=<span class="string">"100"</span> <span class="attr">style</span>=<span class="string">"border:1px solid #c3c3c3;"</span>&gt;</span></span><br><span class="line">Your browser does not support the canvas element.</span><br><span class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> c=<span class="built_in">document</span>.getElementById(<span class="string">"myCanvas"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> cxt=c.getContext(<span class="string">"2d"</span>);</span></span><br><span class="line"><span class="javascript">cxt.fillStyle=<span class="string">"#FF0000"</span>;</span></span><br><span class="line"><span class="undefined">cxt.beginPath();</span></span><br><span class="line"><span class="javascript">cxt.arc(<span class="number">70</span>,<span class="number">18</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="built_in">Math</span>.PI*<span class="number">2</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="undefined">cxt.closePath();</span></span><br><span class="line"><span class="undefined">cxt.fill();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;svg&gt;</code>:使用 XML 描述 2D 图形的语言</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">version</span>=<span class="string">"1.1"</span> <span class="attr">height</span>=<span class="string">"190"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">polygon</span> <span class="attr">points</span>=<span class="string">"100,10 40,180 190,60 10,60 160,180"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">"fill:lime;stroke:purple;stroke-width:5;fill-rule:evenodd;"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="六、媒体"><a href="#六、媒体" class="headerlink" title="六、媒体"></a>六、媒体</h3><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;audio&gt;</code></td><td style="text-align:left">标签定义声音，比如音乐或其他音频流。</td></tr><tr><td style="text-align:left"><code>&lt;video&gt;</code></td><td style="text-align:left">标签定义视频。</td></tr><tr><td style="text-align:left"><code>&lt;embed&gt;</code></td><td style="text-align:left">标签定义嵌入的内容，比如插件。</td></tr></tbody></table><ul><li><code>&lt;video&gt;</code> 标签的属性</li></ul><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_autoplay.asp" target="_blank" rel="noopener">autoplay</a></td><td style="text-align:left">autoplay</td><td style="text-align:left">如果出现该属性，则视频在就绪后马上播放。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_controls.asp" target="_blank" rel="noopener">controls</a></td><td style="text-align:left">controls</td><td style="text-align:left">如果出现该属性，则向用户显示控件，比如播放按钮。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_height.asp" target="_blank" rel="noopener">height</a></td><td style="text-align:left"><em>pixels</em></td><td style="text-align:left">设置视频播放器的高度。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_loop.asp" target="_blank" rel="noopener">loop</a></td><td style="text-align:left">loop</td><td style="text-align:left">如果出现该属性，则当媒介文件完成播放后再次开始播放。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_preload.asp" target="_blank" rel="noopener">preload</a></td><td style="text-align:left">preload</td><td style="text-align:left">如果出现该属性，则视频在页面加载时进行加载，并预备播放。如果使用 “autoplay”，则忽略该属性。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_src.asp" target="_blank" rel="noopener">src</a></td><td style="text-align:left"><em>url</em></td><td style="text-align:left">要播放的视频的 URL。</td></tr><tr><td style="text-align:left"><a href="https://www.w3school.com.cn/tags/att_video_width.asp" target="_blank" rel="noopener">width</a></td><td style="text-align:left"><em>pixels</em></td><td style="text-align:left">设置视频播放器的宽度。</td></tr></tbody></table><ul><li><p><code>&lt;audio&gt;</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">controls</span>=<span class="string">"controls"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"/i/song.ogg"</span> <span class="attr">type</span>=<span class="string">"audio/ogg"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"/i/song.mp3"</span> <span class="attr">type</span>=<span class="string">"audio/mpeg"</span>&gt;</span></span><br><span class="line">Your browser does not support the audio element.</span><br><span class="line"><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p><code>&lt;video&gt;</code></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">width</span>=<span class="string">"320"</span> <span class="attr">height</span>=<span class="string">"240"</span> <span class="attr">controls</span>=<span class="string">"controls"</span> <span class="attr">autoplay</span>=<span class="string">"autoplay"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"/i/movie.ogg"</span> <span class="attr">type</span>=<span class="string">"video/ogg"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"/i/movie.mp4"</span> <span class="attr">type</span>=<span class="string">"video/mp4"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"/i/movie.webm"</span> <span class="attr">type</span>=<span class="string">"video/webm"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="七、API"><a href="#七、API" class="headerlink" title="七、API"></a>七、API</h3><h4 id="地理位置"><a href="#地理位置" class="headerlink" title="地理位置"></a>地理位置</h4><p>getCurrentPosition():获得用户的地理位置</p><table><thead><tr><th style="text-align:left">返回对象的属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">coords.latitude</td><td style="text-align:left">十进制数的纬度</td></tr><tr><td style="text-align:left">coords.longitude</td><td style="text-align:left">十进制数的经度</td></tr><tr><td style="text-align:left">coords.accuracy</td><td style="text-align:left">位置精度</td></tr><tr><td style="text-align:left">coords.altitude</td><td style="text-align:left">海拔，海平面以上以米计</td></tr><tr><td style="text-align:left">coords.altitudeAccuracy</td><td style="text-align:left">位置的海拔精度</td></tr><tr><td style="text-align:left">coords.heading</td><td style="text-align:left">方向，从正北开始以度计</td></tr><tr><td style="text-align:left">coords.speed</td><td style="text-align:left">速度，以米/每秒计</td></tr><tr><td style="text-align:left">timestamp</td><td style="text-align:left">响应的日期/时间</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"demo"</span>&gt;</span>点击这个按钮，获得您的坐标：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"getLocation()"</span>&gt;</span>试一下<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> x=<span class="built_in">document</span>.getElementById(<span class="string">"demo"</span>);</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">getLocation</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (navigator.geolocation)</span></span><br><span class="line"><span class="undefined">    &#123;</span></span><br><span class="line"><span class="undefined">    navigator.geolocation.getCurrentPosition(showPosition,showError);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">else</span>&#123;x.innerHTML=<span class="string">"Geolocation is not supported by this browser."</span>;&#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">showPosition</span>(<span class="params">position</span>)</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  x.innerHTML=<span class="string">"Latitude: "</span> + position.coords.latitude + </span></span><br><span class="line"><span class="javascript">  <span class="string">"&lt;br /&gt;Longitude: "</span> + position.coords.longitude;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">showError</span>(<span class="params">error</span>)</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">switch</span>(error.code) </span></span><br><span class="line"><span class="undefined">    &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">case</span> error.PERMISSION_DENIED:</span></span><br><span class="line"><span class="javascript">      x.innerHTML=<span class="string">"User denied the request for Geolocation."</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">case</span> error.POSITION_UNAVAILABLE:</span></span><br><span class="line"><span class="javascript">      x.innerHTML=<span class="string">"Location information is unavailable."</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">case</span> error.TIMEOUT:</span></span><br><span class="line"><span class="javascript">      x.innerHTML=<span class="string">"The request to get user location timed out."</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">case</span> error.UNKNOWN_ERROR:</span></span><br><span class="line"><span class="javascript">      x.innerHTML=<span class="string">"An unknown error occurred."</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">break</span>;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="拖放"><a href="#拖放" class="headerlink" title="拖放"></a>拖放</h4><ul><li>把元素设置为可拖放:draggable=”true”</li><li>拖放的内容:ondragstart 规定拖动什么数据。,dataTransfer.setData()设置拖动数据的数据类型和值</li><li>拖到何处:ondragover规定被拖动的数据能够被放置到何处</li><li>进行放置:ondrop</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">#div1, #div2</span></span><br><span class="line"><span class="undefined">&#123;float:left; width:198px; height:66px; margin:10px;padding:10px;border:1px solid #aaaaaa;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">allowDrop</span>(<span class="params">ev</span>)</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">ev.preventDefault();</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">drag</span>(<span class="params">ev</span>)</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="javascript">ev.dataTransfer.setData(<span class="string">"Text"</span>,ev.target.id);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">drop</span>(<span class="params">ev</span>)</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 调用 preventDefault() 来阻止数据的浏览器默认处理方式（drop 事件的默认行为是以链接形式打开） --&gt;</span></span></span><br><span class="line"><span class="undefined">ev.preventDefault();</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 通过 dataTransfer.getData() 方法获得被拖的数据。该方法将返回在 setData() 方法中设置为相同类型的任何数据 --&gt;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> data=ev.dataTransfer.getData(<span class="string">"Text"</span>);</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- 被拖数据是被拖元素的 id ("drag1"),把被拖元素追加到放置元素中 --&gt;</span></span></span><br><span class="line"><span class="javascript">ev.target.appendChild(<span class="built_in">document</span>.getElementById(data));</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div1"</span> <span class="attr">ondrop</span>=<span class="string">"drop(event)"</span> <span class="attr">ondragover</span>=<span class="string">"allowDrop(event)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/i/eg_dragdrop_w3school.gif"</span> <span class="attr">draggable</span>=<span class="string">"true"</span> <span class="attr">ondragstart</span>=<span class="string">"drag(event)"</span> <span class="attr">id</span>=<span class="string">"drag1"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"div2"</span> <span class="attr">ondrop</span>=<span class="string">"drop(event)"</span> <span class="attr">ondragover</span>=<span class="string">"allowDrop(event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="应用程序缓存"><a href="#应用程序缓存" class="headerlink" title="应用程序缓存"></a>应用程序缓存</h4><p>HTML5 引入了应用程序缓存，这意味着 web 应用可进行缓存，并可在没有因特网连接时进行访问。通过创建 cache manifest 文件，可以轻松地创建 web 应用的离线版本。</p><p>应用程序缓存为应用带来三个优势：</p><ul><li>离线浏览 - 用户可在应用离线时使用它们</li><li>速度 - 已缓存资源加载得更快</li><li><p>减少服务器负载 - 浏览器将只从服务器下载更新过或更改过的资源。</p></li><li><p>浏览器支持：所有主流浏览器均支持应用程序缓存，除了 Internet Explorer。</p></li></ul><ul><li>样例<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">manifest</span>=<span class="string">"demo.appcache"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">The content of the document......</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p><strong>请注意，manifest 文件需要配置正确的 MIME-type，即 “text/cache-manifest”。必须在 web 服务器上进行配置。</strong></p><p>manifest 文件是简单的文本文件，它告知浏览器被缓存的内容（以及不缓存的内容）。manifest 文件可分为三个部分：</p><ul><li>CACHE MANIFEST - 在此标题下列出的文件将在首次下载后进行缓存</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CACHE MANIFEST</span><br><span class="line">/theme.css</span><br><span class="line">/logo.gif</span><br><span class="line">/main.js</span><br></pre></td></tr></table></figure><ul><li>NETWORK - 在此标题下列出的文件需要与服务器的连接，且不会被缓存</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NETWORK:</span><br><span class="line">login.asp</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NETWORK:</span><br><span class="line">*</span><br></pre></td></tr></table></figure><ul><li>FALLBACK - 在此标题下列出的文件规定当页面无法访问时的回退页面（比如 404 页面）</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FALLBACK:</span><br><span class="line">/html5/ /404.html</span><br></pre></td></tr></table></figure><ul><li>更新缓存:一旦应用被缓存，它就会保持缓存直到发生下列情况<ul><li>用户清空浏览器缓存</li><li>manifest 文件被修改</li><li>由程序来更新应用缓存</li></ul></li></ul><p><strong>重要的提示：如果您编辑了一幅图片，或者修改了一个 JavaScript 函数，这些改变都不会被重新缓存。以 “#” 开头的是注释行，更新注释行中的日期和版本号是一种使浏览器重新缓存文件的办法。</strong></p><h4 id="Web-Workers"><a href="#Web-Workers" class="headerlink" title="Web Workers"></a>Web Workers</h4><p>当在 HTML 页面中执行脚本时，页面的状态是不可响应的，直到脚本已完成。web worker 是运行在后台的 JavaScript，独立于其他脚本，不会影响页面的性能。您可以继续做任何愿意做的事情：点击、选取内容等等，而此时 web worker 在后台运行。</p><p>浏览器支持：所有主流浏览器均支持 web worker，除了 Internet Explorer。</p><ul><li>1.创建 web worker 文件：demo_workers.js</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timedCount</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">i=i+<span class="number">1</span>;</span><br><span class="line">postMessage(i);</span><br><span class="line">setTimeout(<span class="string">"timedCount()"</span>,<span class="number">500</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">timedCount();</span><br></pre></td></tr></table></figure><ul><li>2.创建 Web Worker 对象</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>计数: <span class="tag">&lt;<span class="name">output</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">output</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"startWorker()"</span>&gt;</span>开始 Worker<span class="tag">&lt;/<span class="name">button</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"stopWorker()"</span>&gt;</span>停止 Worker<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> w;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">startWorker</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="javascript"><span class="comment">// 检测用户的浏览器是否支持它</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span>(<span class="keyword">typeof</span>(Worker)!==<span class="string">"undefined"</span>)</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span>(<span class="keyword">typeof</span>(w)==<span class="string">"undefined"</span>)</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 创建 Web Worker 对象</span></span></span><br><span class="line"><span class="javascript">  w=<span class="keyword">new</span> Worker(<span class="string">"/example/html5/demo_workers.js"</span>);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript">  w.onmessage = <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">"result"</span>).innerHTML=event.data;</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">else</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"result"</span>).innerHTML=<span class="string">"Sorry, your browser does not support Web Workers..."</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="javascript"><span class="comment">// 终止 Web Worker</span></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">stopWorker</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="undefined">&#123; </span></span><br><span class="line"><span class="undefined">w.terminate();</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="服务器发送事件"><a href="#服务器发送事件" class="headerlink" title="服务器发送事件"></a>服务器发送事件</h4><p>服务器发送事件（server-sent event）允许网页获得来自服务器的更新。</p><ul><li><p>浏览器支持：所有主流浏览器均支持服务器发送事件，除了 Internet Explorer。</p></li><li><p>1.创建服务器端实例:把 “Content-Type” 报头设置为 “text/event-stream”.</p></li></ul><p>demo_sse.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">'Content-Type: text/event-stream'</span>);</span><br><span class="line">header(<span class="string">'Cache-Control: no-cache'</span>);</span><br><span class="line"></span><br><span class="line">$time = date(<span class="string">'r'</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"data: The server time is: &#123;$time&#125;\n\n"</span>;</span><br><span class="line">flush();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>demo_sse.asp<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">Response.ContentType=&quot;text/event-stream&quot;</span><br><span class="line">Response.Expires=-1</span><br><span class="line">Response.Write(&quot;data: &quot; &amp; now())</span><br><span class="line">Response.Flush()</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></p><ul><li>2.创建Server-Sent 事件<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>获得服务器更新<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 检测服务器发送事件的浏览器支持情况</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span>(<span class="keyword">typeof</span>(EventSource)!==<span class="string">"undefined"</span>)</span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 接收 Server-Sent 事件通知</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> source=<span class="keyword">new</span> EventSource(<span class="string">"/example/html5/demo_sse.php"</span>);</span></span><br><span class="line"><span class="javascript">  source.onmessage=<span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span></span></span><br><span class="line"><span class="undefined">    &#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">"result"</span>).innerHTML+=event.data + <span class="string">"&lt;br /&gt;"</span>;</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">else</span></span></span><br><span class="line"><span class="undefined">  &#123;</span></span><br><span class="line"><span class="javascript">  <span class="built_in">document</span>.getElementById(<span class="string">"result"</span>).innerHTML=<span class="string">"抱歉，您的浏览器不支持 server-sent 事件 ..."</span>;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>在上面的例子中，我们使用 onmessage 事件来获取消息。不过还可以使用其他事件：</p><table><thead><tr><th style="text-align:left">事件</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">onopen</td><td style="text-align:left">当通往服务器的连接被打开</td></tr><tr><td style="text-align:left">onmessage</td><td style="text-align:left">当接收到消息</td></tr><tr><td style="text-align:left">onerror</td><td style="text-align:left">当错误发生</td></tr></tbody></table><h3 id="八、表单"><a href="#八、表单" class="headerlink" title="八、表单"></a>八、表单</h3><p>HTML 表单用于搜集不同类型的用户输入。<code>&lt;form&gt;</code> 元素用于定义 HTML 表单。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line"> .</span><br><span class="line">form elements</span><br><span class="line"> .</span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;input&gt;</code> 元素:表单 输入元素</li></ul><p>新增类型：</p><table><thead><tr><th style="text-align:left">类型</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">color</td><td style="text-align:left">设置输入类型为颜色</td></tr><tr><td style="text-align:left">date</td><td style="text-align:left">设置输入类型为日期</td></tr><tr><td style="text-align:left">datetime</td><td style="text-align:left">设置输入类型为日期和时间（有时区）</td></tr><tr><td style="text-align:left">datetime-local</td><td style="text-align:left">设置输入类型为日期和时间（无时区）</td></tr><tr><td style="text-align:left">email</td><td style="text-align:left">设置输入类型为邮箱，被提交时自动对电子邮件地址进行验证</td></tr><tr><td style="text-align:left">month</td><td style="text-align:left">设置输入类型为年月</td></tr><tr><td style="text-align:left">number</td><td style="text-align:left">设置输入类型为数字</td></tr><tr><td style="text-align:left">range</td><td style="text-align:left">设置输入类型为一定范围内的值，配合属性来规定限制：min、max、step、value</td></tr><tr><td style="text-align:left">search</td><td style="text-align:left">设置输入类型为搜索</td></tr><tr><td style="text-align:left">tel</td><td style="text-align:left">设置输入类型为电话</td></tr><tr><td style="text-align:left">time</td><td style="text-align:left">设置输入类型为时间（无时区）</td></tr><tr><td style="text-align:left">url</td><td style="text-align:left">设置输入类型为网站，提交时能够自动验证</td></tr><tr><td style="text-align:left">week</td><td style="text-align:left">设置输入类型为周和年</td></tr></tbody></table><p>新增设置属性：</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">autocomplete</td><td style="text-align:left">规定form 或 input 域的自动完成：提交表单，重新加载</td></tr><tr><td style="text-align:left">autofocus</td><td style="text-align:left">规定 页面加载时，input 域 自动地获得焦点</td></tr><tr><td style="text-align:left">form</td><td style="text-align:left">规定 input 域 所属的一个或多个表单</td></tr><tr><td style="text-align:left">form overrides</td><td style="text-align:left">规定 input 域 的表单重写属性</td></tr><tr><td style="text-align:left">height and width</td><td style="text-align:left">规定 input 域 的高度和宽度</td></tr><tr><td style="text-align:left">list</td><td style="text-align:left">规定 input 域 的的选项列表</td></tr><tr><td style="text-align:left">min, max and step</td><td style="text-align:left">规定 input 域 的最大、最小、数字间隔</td></tr><tr><td style="text-align:left">multiple</td><td style="text-align:left">规定 input 域 中可选择多个值</td></tr><tr><td style="text-align:left">novalidate</td><td style="text-align:left">规定在提交表单时不应该验证 form 或 input 域</td></tr><tr><td style="text-align:left">pattern</td><td style="text-align:left">规定检查 input 域 是否满足正则表达式。</td></tr><tr><td style="text-align:left">placeholder</td><td style="text-align:left">提供一种提示（hint），描述 input 域 所期待的值</td></tr><tr><td style="text-align:left">required</td><td style="text-align:left">规定 input 域 是必需的（必需填写）。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/example/html5/demo_form.asp"</span> <span class="attr">method</span>=<span class="string">"get"</span> <span class="attr">autocomplete</span>=<span class="string">"on"</span>&gt;</span></span><br><span class="line">First name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"fname"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">Last name: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"lname"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">E-mail: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>请填写并提交此表单，然后重载页面，来查看自动完成功能是如何工作的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>请注意，表单的自动完成功能是打开的，而 e-mail 域是关闭的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="新的表单元素"><a href="#新的表单元素" class="headerlink" title="新的表单元素"></a>新的表单元素</h4><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;datalist&gt;</code></td><td style="text-align:left">定义输入控件的预定义选项。</td></tr><tr><td style="text-align:left"><code>&lt;keygen&gt;</code></td><td style="text-align:left">定义键对生成器字段（用于表单）。</td></tr><tr><td style="text-align:left"><code>&lt;output&gt;</code></td><td style="text-align:left">定义计算结果。</td></tr></tbody></table><ul><li><code>&lt;datalist&gt;</code> :为 <code>&lt;input&gt;</code> 元素规定预定义选项列表。元素的 list 属性必须引用 <code>&lt;datalist&gt;</code> 元素的 id 属性。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/demo/demo_form.asp"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"cars"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"volvo"</span>&gt;</span>Volvo<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"saab"</span>&gt;</span>Saab<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"fiat"</span>&gt;</span>Fiat<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"audi"</span>&gt;</span>Audi<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;keygen &gt;</code>:密钥对生成器（key-pair generator）。当提交表单时，会生成两个键，一个是私钥，一个公钥。私钥（private key）存储于客户端，公钥（public key）则被发送到服务器。公钥可用于之后验证用户的客户端证书（client certificate）。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/example/html5/demo_form.asp"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></span><br><span class="line">Username: <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"usr_name"</span> /&gt;</span></span><br><span class="line">Encryption: <span class="tag">&lt;<span class="name">keygen</span> <span class="attr">name</span>=<span class="string">"security"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;output &gt;</code>:用于不同类型的输出</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">resCalc</span>(<span class="params"></span>)</span></span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="javascript">numA=<span class="built_in">document</span>.getElementById(<span class="string">"num_a"</span>).value;</span></span><br><span class="line"><span class="javascript">numB=<span class="built_in">document</span>.getElementById(<span class="string">"num_b"</span>).value;</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">"result"</span>).value=<span class="built_in">Number</span>(numA)+<span class="built_in">Number</span>(numB);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>使用 output 元素的简易计算器：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onsubmit</span>=<span class="string">"return false"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"num_a"</span> /&gt;</span> +</span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"num_b"</span> /&gt;</span> =</span><br><span class="line"> <span class="tag">&lt;<span class="name">output</span> <span class="attr">id</span>=<span class="string">"result"</span> <span class="attr">onforminput</span>=<span class="string">"resCalc()"</span>&gt;</span><span class="tag">&lt;/<span class="name">output</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="九、HTML5-迁移"><a href="#九、HTML5-迁移" class="headerlink" title="九、HTML5 迁移"></a>九、HTML5 迁移</h3><h4 id="元素切换"><a href="#元素切换" class="headerlink" title="元素切换"></a>元素切换</h4><table><thead><tr><th style="text-align:center">典型的 HTML4</th><th style="text-align:center">典型的 HTML5</th></tr></thead><tbody><tr><td style="text-align:center"><code>&lt;div id=&quot;header&quot;&gt;</code></td><td style="text-align:center"><code>&lt;header&gt;</code></td></tr><tr><td style="text-align:center"><code>&lt;div id=&quot;menu&quot;&gt;</code></td><td style="text-align:center"><code>&lt;nav&gt;</code></td></tr><tr><td style="text-align:center"><code>&lt;div id=&quot;content&quot;&gt;</code></td><td style="text-align:center"><code>&lt;section&gt;</code></td></tr><tr><td style="text-align:center"><code>&lt;div id=&quot;post&quot;&gt;</code></td><td style="text-align:center"><code>&lt;article&gt;</code></td></tr><tr><td style="text-align:center"><code>&lt;div id=&quot;footer&quot;&gt;</code></td><td style="text-align:center"><code>&lt;footer&gt;</code></td></tr></tbody></table><h4 id="更改Doctype"><a href="#更改Doctype" class="headerlink" title="更改Doctype"></a>更改Doctype</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br></pre></td></tr></table></figure><h4 id="更改编码"><a href="#更改编码" class="headerlink" title="更改编码"></a>更改编码</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="添加-shiv"><a href="#添加-shiv" class="headerlink" title="添加 shiv"></a>添加 shiv</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--[if lt IE 9]&gt;</span></span><br><span class="line"><span class="comment">  &lt;script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="comment">&lt;![endif]--&gt;</span></span><br></pre></td></tr></table></figure><h4 id="为语义元素添加-CSS"><a href="#为语义元素添加-CSS" class="headerlink" title="为语义元素添加 CSS"></a>为语义元素添加 CSS</h4><h3 id="代码规范"><a href="#代码规范" class="headerlink" title="代码规范"></a>代码规范</h3><ul><li>请使用正确的文档类型</li><li>请使用小写元素名</li><li>关闭所有 HTML 元素</li><li>关闭空的 HTML 元素</li><li>使用小写属性名</li><li>属性值加引号：属性值有空格需要引号</li><li>必需的属性：始终对图像使用 alt 属性</li><li>空格和等号：等号两边不要空格</li><li>避免长代码行：代码行超过 80 个字符</li><li>空行和缩进：请勿使用没有必要的空行和缩进。没有必要在短的和相关项目之间使用空行，也没有必要缩进每个元素</li><li>不推荐省略 <code>&lt;html&gt;</code> 和 <code>&lt;body&gt;</code> 标签。</li><li><code>&lt;title&gt;</code>是必须的</li><li>注释规范:短注释应该在单行中书写，并在 <!-- 之后增加一个空格，在 <!-- 之前增加一个空格;长注释，跨越多行，应该通过 <!-- 和 --> 在独立的行中书写</li><li>请使用简单的语法来链接样式表<ul><li>开括号与选择器位于同一行</li><li>在开括号之前用一个空格</li><li>使用两个字符的缩进</li><li>在每个属性与其值之间使用冒号加一个空格</li><li>在每个逗号或分号之后使用空格</li><li>在每个属性值对（包括最后一个）之后使用分号</li><li>只在值包含空格时使用引号来包围值</li><li>把闭括号放在新的一行，之前不用空格</li><li>避免每行超过 80 个字符     </li></ul></li><li>使用简单的语法来加载外部脚本</li><li>在 HTML 中使用（与 JavaScript）相同的命名约定</li><li>使用小写文件名</li><li>文件扩展名要规范：html文件 .html; css文件 .css ;JavaScript .js</li></ul>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTML（二）XHTML</title>
      <link href="/2016/06/15/Html02/"/>
      <url>/2016/06/15/Html02/</url>
      <content type="html"><![CDATA[<p><strong>XHTML 是以 XML 格式编写的 HTML。</strong><br>XHTML 于2000年的1月26日成为 W3C 标准，W3C 将 XHTML 定义为最新的HTML版本。XHTML 将逐渐取代 HTML。本文章主要介绍 XHTML 的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、为什么要使用XHTML"><a href="#一、为什么要使用XHTML" class="headerlink" title="一、为什么要使用XHTML"></a>一、为什么要使用XHTML</h3><p>万维网上的许多页面都包含着糟糕的 HTML 代码，市场中存在着不同的浏览器技术，某些浏览器没有能力和手段来解释糟糕的标记语言。<br>XML 是一种必须正确标记且格式良好的标记语言。通过结合 XML 和 HTML 的长处，开发出了 XHTML。</p><h3 id="二、文档结构"><a href="#二、文档结构" class="headerlink" title="二、文档结构"></a>二、文档结构</h3><ul><li>XHTML DOCTYPE 是<em>强制性的</em></li><li><code>&lt;html&gt;</code> 中的 XML namespace 属性是<em>强制性的</em></li><li><code>&lt;html&gt;</code>、<code>&lt;head&gt;</code>、<code>&lt;title&gt;</code> 以及 <code>&lt;body&gt;</code> 也是<em>强制性的</em></li></ul><p>一个 XHTML 文档有三个主要的部分：</p><ul><li>DOCTYPE:文档类型声明, DTD 规定了使用通用标记语言(SGML)的网页的语法 <ul><li>STRICT（严格类型）: 需要干净的标记，避免表现上的混乱。请与层叠样式表配合使用。 </li><li>TRANSITIONAL（过渡类型）: 当需要利用 HTML 在表现上的特性时，并且当需要为那些不支持层叠样式表的浏览器编写 XHTML 时。 </li><li>FRAMESET（框架类型）: 需要使用HTML框架将浏览器窗口分割为两部分或更多框架时。 </li></ul></li><li>Head</li><li>Body</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文档类型声明定义文档的类型 --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html</span></span><br><span class="line"><span class="meta">PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"</span></span><br><span class="line"><span class="meta">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>simple document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>a simple paragraph<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="三、语法"><a href="#三、语法" class="headerlink" title="三、语法"></a>三、语法</h3><h4 id="元素语法"><a href="#元素语法" class="headerlink" title="元素语法"></a>元素语法</h4><ul><li>XHTML 元素必须<em>正确嵌套</em></li><li>XHTML 元素必须始终<em>关闭</em></li><li>XHTML 元素必须<em>小写</em></li><li>XHTML 文档必须有<em>一个根元素</em></li><li>XHTML DTD 定义了强制使用的 HTML 元素</li></ul><h4 id="属性语法"><a href="#属性语法" class="headerlink" title="属性语法"></a>属性语法</h4><ul><li>XHTML 属性必须使用<em>小写</em></li><li>XHTML 属性值必须用<em>引号包围</em></li><li>XHTML 属性最小化也是<em>禁止的</em></li><li>用 Id 属性代替 name 属性</li></ul><h3 id="四、HTML升级至-XHTML"><a href="#四、HTML升级至-XHTML" class="headerlink" title="四、HTML升级至 XHTML"></a>四、HTML升级至 XHTML</h3><ol><li>向每张页面的第一行添加 XHTML &lt;!DOCTYPE&gt;</li><li>向每张页面的 html 元素添加 xmlns 属性</li><li>把所有元素名改为小写</li><li>关闭所有空元素：<code>&lt;hr&gt;</code> 和 <code>&lt;br&gt;</code> 标签应该被替换为 <code>&lt;hr /&gt;</code> 和 <code>&lt;br /&gt;</code></li><li>把所有属性名改为小写</li><li>为所有属性值加引号</li><li>验证站点:<ol><li>通过 DTD 验证 XHTML</li><li>使用 W3C 验证器：<a href="http://validator.w3.org/check?uri=https://www.baidu.com" target="_blank" rel="noopener">http://validator.w3.org/check?uri=https://www.baidu.com</a> （uri=被验证网页）</li></ol></li></ol><h3 id="五、模块"><a href="#五、模块" class="headerlink" title="五、模块"></a>五、模块</h3><p>XHTML 是简单而庞大的语言。XHTML 包含了网站开发者需要的大多数功能。对于某些特殊的用途，XHTML 太大且太复杂，而对于其他的用途，它又太简单了。</p><p>通过将 XHTML 分为若干模块，W3C 已经创造出数套小巧且定义良好的 XHTML 元素，这些元素既可被独立应用于简易设备，又可以与其他 XML 标准并入大型且更复杂的应用程序。</p><p>通过使用模块化的 XHTML，产品和软件设计者可以：</p><ul><li>选择被某种设备所支持的元素。</li><li>在不打破 XHTML 标准的情况下，使用 XML 对 XHTML 进行扩展。</li><li>针对小型设备，对 XHTML 进行简化。</li><li>通过添加新的 XML 功能（比如 MathML, SVG, 语音和多媒体），针对复杂的应用对 XHTML 进行扩展。</li><li>定义 XHTML 框架，比如 XHTML BASIC （针对移动设备的 XHTML 子集）。</li></ul><p>W3C 已将 XHTML 的定义分为28种模型：</p><table><thead><tr><th style="text-align:left">模块名称</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">Applet Module (Applet模块)</td><td style="text-align:left">定义已被废弃的applet元素。</td></tr><tr><td style="text-align:left">Base Module (基础模块)</td><td style="text-align:left">定义基本元素。</td></tr><tr><td style="text-align:left">Basic Forms Module (基础表单模块)</td><td style="text-align:left">定义基本的表单元素 (forms)。</td></tr><tr><td style="text-align:left">Basic Tables Module (基础表格模块)</td><td style="text-align:left">定义基本的表格元素 (table)。</td></tr><tr><td style="text-align:left">Bi-directional Text Module (双向文本模块)</td><td style="text-align:left">定义bdo元素。</td></tr><tr><td style="text-align:left">Client Image Map Module(客户端图像映射模块)</td><td style="text-align:left">定义浏览器端图像映射元素(image map elements)。</td></tr><tr><td style="text-align:left">Edit Module (编辑模块)</td><td style="text-align:left">定义编辑元素删除和插入。</td></tr><tr><td style="text-align:left">Forms Module (表单模块)</td><td style="text-align:left">定义所有在表单中使用的元素。</td></tr><tr><td style="text-align:left">Frames Module (框架模块)</td><td style="text-align:left">定义frameset元素。</td></tr><tr><td style="text-align:left">Hypertext Module (超文本模块)</td><td style="text-align:left">定义a元素。</td></tr><tr><td style="text-align:left">Iframe Module (内联框架模块)</td><td style="text-align:left">定义iframe元素。</td></tr><tr><td style="text-align:left">Image Module (图像模块)</td><td style="text-align:left">定义图像元素 (img)。</td></tr><tr><td style="text-align:left">Intrinsic Events Module ()</td><td style="text-align:left">定义事件属性 (event)，比如onblur和onchange。</td></tr><tr><td style="text-align:left">Legacy Module (遗留模块)</td><td style="text-align:left">定义被废弃的元素和属性。</td></tr><tr><td style="text-align:left">Link Module (链接模块)</td><td style="text-align:left">定义链接 (link)元素。</td></tr><tr><td style="text-align:left">List Module (列表模块)</td><td style="text-align:left">定义列表元素ol, li, ul, dd, dt,和dl。</td></tr><tr><td style="text-align:left">Metainformation Module (元信息模块)</td><td style="text-align:left">定义meta元素。</td></tr><tr><td style="text-align:left">Name Identification Module (名称识别模块)</td><td style="text-align:left">定义已被废弃的name属性。</td></tr><tr><td style="text-align:left">Object Module (对象模块)</td><td style="text-align:left">定义对象元素 (object)和param元素。</td></tr><tr><td style="text-align:left">Presentation Module (表现模块)</td><td style="text-align:left">定义表现元素比如b和i。</td></tr><tr><td style="text-align:left">Scripting Module (脚本模块)</td><td style="text-align:left">定义脚本 (script)和无脚本 (noscript)元素。</td></tr><tr><td style="text-align:left">Server Image Map Module(服务器端图像映射模块)</td><td style="text-align:left">定义服务器端图像映射(server side image map)元素</td></tr><tr><td style="text-align:left">Structure Module (结构模块)</td><td style="text-align:left">定义以下元素：html, head, title and body。</td></tr><tr><td style="text-align:left">Style Attribute Module (样式属性模块)</td><td style="text-align:left">定义样式属性。</td></tr><tr><td style="text-align:left">Style Sheet Module (样式表模块)</td><td style="text-align:left">定义样式元素。</td></tr><tr><td style="text-align:left">Tables Module (表格模块)</td><td style="text-align:left">定义用于表格中的元素。</td></tr><tr><td style="text-align:left">Target Module (Target模块)</td><td style="text-align:left">定义target属性。</td></tr><tr><td style="text-align:left">Text Module (文本模块)</td><td style="text-align:left">定义文本容器元素 (text container)，比如p和h1。</td></tr></tbody></table><h3 id="六、标准属性"><a href="#六、标准属性" class="headerlink" title="六、标准属性"></a>六、标准属性</h3><h4 id="核心属性"><a href="#核心属性" class="headerlink" title="核心属性"></a>核心属性</h4><p>以下标签不提供下面的属性：base, head, html, meta, param, script, style, 以及 title 元素。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">class</td><td style="text-align:left">class_rule 或 style_rule</td><td style="text-align:left">元素的类(class)</td></tr><tr><td style="text-align:left">id</td><td style="text-align:left">id_name</td><td style="text-align:left">元素的某个特定id</td></tr><tr><td style="text-align:left">style</td><td style="text-align:left">样式定义</td><td style="text-align:left">内联样式定义</td></tr><tr><td style="text-align:left">title</td><td style="text-align:left">提示文本</td><td style="text-align:left">显示于提示工具中的文本</td></tr></tbody></table><h4 id="语言属性-Language-Attributes"><a href="#语言属性-Language-Attributes" class="headerlink" title="语言属性 (Language Attributes)"></a>语言属性 (Language Attributes)</h4><p>以下标签不提供下面的属性：base, br, frame, frameset, hr, iframe, param, 以及 script 元素。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">dir</td><td style="text-align:left">ltr \</td><td style="text-align:left">rtl</td><td>设置文本的方向</td></tr><tr><td style="text-align:left">lang</td><td style="text-align:left">语言代码</td><td style="text-align:left">设置语言代码</td></tr></tbody></table><h4 id="键盘属性-Keyboard-Attributes"><a href="#键盘属性-Keyboard-Attributes" class="headerlink" title="键盘属性 (Keyboard Attributes)"></a>键盘属性 (Keyboard Attributes)</h4><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">accesskey</td><td style="text-align:left">字符</td><td style="text-align:left">设置访问某元素的键盘快捷键</td></tr><tr><td style="text-align:left">tabindex</td><td style="text-align:left">数</td><td style="text-align:left">设置某元素的Tab次序</td></tr></tbody></table><h3 id="七、事件"><a href="#七、事件" class="headerlink" title="七、事件"></a>七、事件</h3><p>在现代浏览器中都内置有大量的事件处理器。这些处理器会监视特定的条件或用户行为，例如鼠标单击或浏览器窗口中完成加载某个图像。通过使用客户端的 JavaScript，可以将某些特定的事件处理器作为属性添加给特定的标签，并可以在事件发生时执行一个或多个 JavaScript 命令或函数。</p><p>事件处理器的值是一个或一系列以分号隔开的 Javascript 表达式、方法和函数调用，并用引号引起来。当事件发生时，浏览器会执行这些代码。例如，当您把鼠标移动到一个超链接时，会启动一个 JavaScript 函数。支持 JavaScript 的浏览器支持 <a> 标签中的一个特殊的 “mouse over”事件处理器 - 被称为 onmouseover 来完成这项工作：</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/index.html"</span> <span class="attr">onmouseover</span>=<span class="string">"alert('Welcome');return false"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="窗口事件-Window-Events"><a href="#窗口事件-Window-Events" class="headerlink" title="窗口事件 (Window Events)"></a>窗口事件 (Window Events)</h4><p>仅在 body 和 frameset 元素中有效。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">onload</td><td style="text-align:left">脚本</td><td style="text-align:left">当文档被载入时执行脚本</td></tr><tr><td style="text-align:left">onunload</td><td style="text-align:left">脚本</td><td style="text-align:left">当文档被卸下时执行脚本</td></tr></tbody></table><h4 id="表单元素事件-Form-Element-Events"><a href="#表单元素事件-Form-Element-Events" class="headerlink" title="表单元素事件 (Form Element Events)"></a>表单元素事件 (Form Element Events)</h4><p>仅在表单元素中有效。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">onchange</td><td style="text-align:left">脚本</td><td style="text-align:left">当元素改变时执行脚本</td></tr><tr><td style="text-align:left">onsubmit</td><td style="text-align:left">脚本</td><td style="text-align:left">当表单被提交时执行脚本</td></tr><tr><td style="text-align:left">onreset</td><td style="text-align:left">脚本</td><td style="text-align:left">当表单被重置时执行脚本</td></tr><tr><td style="text-align:left">onselect</td><td style="text-align:left">脚本</td><td style="text-align:left">当元素被选取时执行脚本</td></tr><tr><td style="text-align:left">onblur</td><td style="text-align:left">脚本</td><td style="text-align:left">当元素失去焦点时执行脚本</td></tr><tr><td style="text-align:left">onfocus</td><td style="text-align:left">脚本</td><td style="text-align:left">当元素获得焦点时执行脚本</td></tr></tbody></table><h4 id="键盘事件-Keyboard-Events"><a href="#键盘事件-Keyboard-Events" class="headerlink" title="键盘事件 (Keyboard Events)"></a>键盘事件 (Keyboard Events)</h4><p>在下列元素中无效：base, bdo, br, frame, frameset, head, html, iframe, meta, param, script, style, 以及 title 元素。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">onkeydown</td><td style="text-align:left">脚本</td><td style="text-align:left">当键盘被按下时执行脚本</td></tr><tr><td style="text-align:left">onkeypress</td><td style="text-align:left">脚本</td><td style="text-align:left">当键盘被按下后又松开时执行脚本</td></tr><tr><td style="text-align:left">onkeyup</td><td style="text-align:left">脚本</td><td style="text-align:left">当键盘被松开时执行脚本</td></tr></tbody></table><h4 id="鼠标事件-Mouse-Events"><a href="#鼠标事件-Mouse-Events" class="headerlink" title="鼠标事件 (Mouse Events)"></a>鼠标事件 (Mouse Events)</h4><p>在下列元素中无效：base, bdo, br, frame, frameset, head, html, iframe, meta, param, script, style, title 元素。</p><table><thead><tr><th style="text-align:left">属性</th><th style="text-align:left">值</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">onclick</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标被单击时执行脚本</td></tr><tr><td style="text-align:left">ondblclick</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标被双击时执行脚本</td></tr><tr><td style="text-align:left">onmousedown</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标按钮被按下时执行脚本</td></tr><tr><td style="text-align:left">onmousemove</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标指针移动时执行脚本</td></tr><tr><td style="text-align:left">onmouseout</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标指针移出某元素时执行脚本</td></tr><tr><td style="text-align:left">onmouseover</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标指针悬停于某元素之上时执行脚本</td></tr><tr><td style="text-align:left">onmouseup</td><td style="text-align:left">脚本</td><td style="text-align:left">当鼠标按钮被松开时执行脚本</td></tr></tbody></table><h3 id="八、结构化"><a href="#八、结构化" class="headerlink" title="八、结构化"></a>八、结构化</h3><ul><li>使用恰当的文档类型声明和命名空间。</li><li>使用 meta 元素声明你的内容类型。</li><li>使用小写字母书写所有的元素和属性。</li><li>为所有的属性值加引号。</li><li>为所有的属性分配值。</li><li>关闭所有的标签。</li><li>使用空格和斜线关闭空标签。</li><li>不要在注释中写双下划线。</li><li>确保小于号及和号为 &lt; 和 &amp;</li><li>为表达语义而标记文档，而不是为了样式：最大限度地使用 CSS 来进行布局<ul><li>根据它们的意义使用元素，而不是根据它们的外观</li><li>使用结构化元素，而不是无意义的垃圾 ：ul、li</li></ul></li><li>div、id 和其他帮手</li></ul>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTML（一）HTML的基本概念</title>
      <link href="/2016/05/15/Html01/"/>
      <url>/2016/05/15/Html01/</url>
      <content type="html"><![CDATA[<p>HTML 是一种超文本标记语言 (Hyper Text Markup Language)。本文章主要介绍 HTML 的基本概念。</p><a id="more"></a><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="一、HTML-标签"><a href="#一、HTML-标签" class="headerlink" title="一、HTML 标签"></a>一、HTML 标签</h3><p>标记语言使用标记标签(markup tag)来描述网页 。HTML 标记标签通常被称为 HTML 标签 (HTML tag)。</p><ul><li><p>HTML 标签是由尖括号包围的关键词，比如 <code>&lt;html&gt;</code></p></li><li><p>HTML 标签通常是成对出现的，比如 <code>&lt;b&gt;</code> 和 <code>&lt;/b&gt;</code></p></li><li><p>标签对中的第一个标签是开始标签，第二个标签是结束标签</p></li><li><p>开始和结束标签也被称为开放标签和闭合标签</p></li><li><p>HTML 标签对大小写不敏感 ，万维网联盟（W3C）在 HTML 4 中推荐使用小写，而在未来 (X)HTML 版本中强制使用小写。 </p></li></ul><p><a href="https://www.w3school.com.cn/tags/html_ref_byfunc.asp" target="_blank" rel="noopener">HTML 标签参考手册</a></p><h4 id="1-HTML-的-基本标签"><a href="#1-HTML-的-基本标签" class="headerlink" title="1.HTML 的 基本标签"></a>1.HTML 的 基本标签</h4><ul><li>1.HTML 标题（Heading）：是通过 <h1> - <h6> 等标签进行定义的。</h6></h1></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>2.HTML 段落:通过 <p> 标签进行定义的。</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is a paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>This is another paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>3.HTML 链接:通过 <a> 标签进行定义的。在 href 属性中指定链接的地址。</a></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://www.baidu.com/"</span>&gt;</span>This is a link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>4.HTML 图像:通过 <img> 标签进行定义的。图像的名称和尺寸是以属性的形式提供的。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"w3school.jpg"</span> <span class="attr">width</span>=<span class="string">"104"</span> <span class="attr">height</span>=<span class="string">"142"</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-HTML-标题标签"><a href="#2-HTML-标题标签" class="headerlink" title="2.HTML 标题标签"></a>2.HTML 标题标签</h4><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;html&gt;</code></td><td style="text-align:left">定义 HTML 文档。</td></tr><tr><td style="text-align:left"><code>&lt;body&gt;</code></td><td style="text-align:left">定义文档的主体。</td></tr><tr><td style="text-align:left"><code>&lt;h1&gt; to &lt;h6&gt;</code></td><td style="text-align:left">定义 HTML 标题</td></tr><tr><td style="text-align:left"><code>&lt;hr&gt;</code></td><td style="text-align:left">定义水平线。</td></tr><tr><td style="text-align:left"><code>&lt;!--&gt;</code></td><td style="text-align:left">定义注释。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- &lt;h1&gt; 定义最大的标题。&lt;h6&gt; 定义最小的标题 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 水平线</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--[if IE 8]&gt;</span></span><br><span class="line"><span class="comment">    .... 只有 Internet Explorer 显示注释....</span></span><br><span class="line"><span class="comment">&lt;![endif]--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-HTML-段落标签"><a href="#3-HTML-段落标签" class="headerlink" title="3.HTML 段落标签"></a>3.HTML 段落标签</h4><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;p&gt;</code></td><td style="text-align:left">定义段落。</td></tr><tr><td style="text-align:left"><code>&lt;br /&gt;</code></td><td style="text-align:left">插入单个折行（换行）。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="4-HTML-格式化标签"><a href="#4-HTML-格式化标签" class="headerlink" title="4.HTML 格式化标签"></a>4.HTML 格式化标签</h4><ul><li>文本格式化</li></ul><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;b&gt;</code></td><td style="text-align:left">定义粗体文本。</td></tr><tr><td style="text-align:left"><code>&lt;big&gt;</code></td><td style="text-align:left">定义大号字。</td></tr><tr><td style="text-align:left"><code>&lt;em&gt;</code></td><td style="text-align:left">定义着重文字。</td></tr><tr><td style="text-align:left"><code>&lt;i&gt;</code></td><td style="text-align:left">定义斜体字。</td></tr><tr><td style="text-align:left"><code>&lt;small&gt;</code></td><td style="text-align:left">定义小号字。</td></tr><tr><td style="text-align:left"><code>&lt;strong&gt;</code></td><td style="text-align:left">定义加重语气。</td></tr><tr><td style="text-align:left"><code>&lt;sub&gt;</code></td><td style="text-align:left">定义下标字。</td></tr><tr><td style="text-align:left"><code>&lt;sup&gt;</code></td><td style="text-align:left">定义上标字。</td></tr><tr><td style="text-align:left"><code>&lt;ins&gt;</code></td><td style="text-align:left">定义插入字。</td></tr><tr><td style="text-align:left"><code>&lt;del&gt;</code></td><td style="text-align:left">定义删除字。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>This text is bold<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>This text is strong<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">big</span>&gt;</span>This text is big<span class="tag">&lt;/<span class="name">big</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span>This text is emphasized<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>This text is italic<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">small</span>&gt;</span>This text is small<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">This text contains</span><br><span class="line"><span class="tag">&lt;<span class="name">sub</span>&gt;</span>subscript<span class="tag">&lt;/<span class="name">sub</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">This text contains</span><br><span class="line"><span class="tag">&lt;<span class="name">sup</span>&gt;</span>superscript<span class="tag">&lt;/<span class="name">sup</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>计算机输出</li></ul><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;code&gt;</code></td><td style="text-align:left">定义计算机代码。</td></tr><tr><td style="text-align:left"><code>&lt;kbd&gt;</code></td><td style="text-align:left">定义键盘码。</td></tr><tr><td style="text-align:left"><code>&lt;samp&gt;</code></td><td style="text-align:left">定义计算机代码样本。</td></tr><tr><td style="text-align:left"><code>&lt;tt&gt;</code></td><td style="text-align:left">定义打字机代码。</td></tr><tr><td style="text-align:left"><code>&lt;var&gt;</code></td><td style="text-align:left">定义变量。</td></tr><tr><td style="text-align:left"><code>&lt;pre&gt;</code></td><td style="text-align:left">定义预格式文本。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">code</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line">var person = &#123;</span><br><span class="line">    firstName:"Bill",</span><br><span class="line">    lastName:"Gates",</span><br><span class="line">    age:50,</span><br><span class="line">    eyeColor:"blue"</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">kbd</span>&gt;</span>Keyboard input<span class="tag">&lt;/<span class="name">kbd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tt</span>&gt;</span>Teletype text<span class="tag">&lt;/<span class="name">tt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">samp</span>&gt;</span>Sample text<span class="tag">&lt;/<span class="name">samp</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">var</span>&gt;</span>Computer variable<span class="tag">&lt;/<span class="name">var</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>这些标签常用于显示计算机/编程代码。</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>引用、引用和术语定义<br>| 标签  | 描述               |<br>| :————————————— | :—————– |<br>| <code>&lt;abbr&gt;</code>       | 定义缩写。         |<br>| <code>&lt;acronym&gt;</code>       | 定义首字母缩写。   |<br>| <code>&lt;address&gt;</code>      | 定义地址。         |<br>| <code>&lt;bdo&gt;</code>            | 定义文字方向。     |<br>| <code>&lt;blockquote&gt;</code>    | 定义长的引用。     |<br>| <code>&lt;q&gt;</code>           | 定义短的引用语。   |<br>| <code>&lt;cite&gt;</code> | 定义引用、引证。   |<br>| <code>&lt;dfn&gt;</code> | 定义一个定义项目。 |</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>WWF 的目标是：<span class="tag">&lt;<span class="name">q</span>&gt;</span>构建人与自然和谐共存的世界。<span class="tag">&lt;/<span class="name">q</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>以下内容引用自 WWF 的网站：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">blockquote</span> <span class="attr">cite</span>=<span class="string">"http://www.worldwildlife.org/who/index.html"</span>&gt;</span></span><br><span class="line">五十年来，WWF 一直致力于保护自然界的未来。</span><br><span class="line">世界领先的环保组织，WWF 工作于 100 个国家，</span><br><span class="line">并得到美国一百二十万会员及全球近五百万会员的支持。</span><br><span class="line"><span class="tag">&lt;/<span class="name">blockquote</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">abbr</span> <span class="attr">title</span>=<span class="string">"World Health Organization"</span>&gt;</span>WHO<span class="tag">&lt;/<span class="name">abbr</span>&gt;</span> 成立于 1948 年。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">dfn</span>&gt;</span><span class="tag">&lt;<span class="name">abbr</span> <span class="attr">title</span>=<span class="string">"World Health Organization"</span>&gt;</span>WHO<span class="tag">&lt;/<span class="name">abbr</span>&gt;</span><span class="tag">&lt;/<span class="name">dfn</span>&gt;</span> 成立于 1948 年。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span></span><br><span class="line">Written by Donald Duck.<span class="tag">&lt;<span class="name">br</span>&gt;</span> </span><br><span class="line">Visit us at:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Example.com<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Box 564, Disneyland<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">USA</span><br><span class="line"><span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">cite</span>&gt;</span>The Scream<span class="tag">&lt;/<span class="name">cite</span>&gt;</span> by Edward Munch. Painted in 1893.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bdo</span> <span class="attr">dir</span>=<span class="string">"rtl"</span>&gt;</span>This text will be written from right to left<span class="tag">&lt;/<span class="name">bdo</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-HTML-链接标签"><a href="#5-HTML-链接标签" class="headerlink" title="5.HTML 链接标签"></a>5.HTML 链接标签</h3><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>href</code></td><td style="text-align:left">定义锚。</td></tr></tbody></table><p>HTML 使用超级链接与网络上的另一个文档相连，点击链接可以从一张页面跳转到另一张页面。<br>有两种使用 <a> 标签的方式：</a></p><ul><li>通过使用 href 属性 - 创建指向另一个文档的链接</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://www.baidu.com/"</span>&gt;</span>百度一下<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>通过使用 name 属性 - 创建文档内的书签</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">name</span>=<span class="string">"tips"</span>&gt;</span>基本的注意事项<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-HTML-图像标签"><a href="#6-HTML-图像标签" class="headerlink" title="6.HTML 图像标签"></a>6.HTML 图像标签</h3><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;img&gt;</code></td><td style="text-align:left">定义图像。</td></tr><tr><td style="text-align:left"><code>&lt;map&gt;</code></td><td style="text-align:left">定义图像地图。</td></tr><tr><td style="text-align:left"><code>&lt;area&gt;</code></td><td style="text-align:left">定义图像地图中的可点击区域。</td></tr></tbody></table><p>通过使用 HTML，可以在文档中显示图像。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"planets.jpg"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">usemap</span>=<span class="string">"#planetmap"</span> <span class="attr">alt</span>=<span class="string">"Planets"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span> <span class="attr">name</span>=<span class="string">"planetmap"</span> <span class="attr">id</span>=<span class="string">"planetmap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">"circle"</span> <span class="attr">coords</span>=<span class="string">"180,139,14"</span> <span class="attr">href</span> =<span class="string">"venus.html"</span> <span class="attr">alt</span>=<span class="string">"Venus"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">"circle"</span> <span class="attr">coords</span>=<span class="string">"129,161,10"</span> <span class="attr">href</span> =<span class="string">"mercur.html"</span> <span class="attr">alt</span>=<span class="string">"Mercury"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">"rect"</span> <span class="attr">coords</span>=<span class="string">"0,0,110,260"</span> <span class="attr">href</span> =<span class="string">"sun.html"</span> <span class="attr">alt</span>=<span class="string">"Sun"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="HTML-文件路径"><a href="#HTML-文件路径" class="headerlink" title="HTML 文件路径"></a>HTML 文件路径</h4><table><thead><tr><th style="text-align:left">路径</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;img src=&quot;picture.jpg&quot;&gt;</code></td><td style="text-align:left">picture.jpg 位于与当前网页相同的文件夹</td></tr><tr><td style="text-align:left"><code>&lt;img src=&quot;images/picture.jpg&quot;&gt;</code></td><td style="text-align:left">picture.jpg 位于当前文件夹的 images 文件夹中</td></tr><tr><td style="text-align:left"><code>&lt;img src=&quot;/images/picture.jpg&quot;&gt;</code></td><td style="text-align:left">picture.jpg 当前站点根目录的 images 文件夹中</td></tr><tr><td style="text-align:left"><code>&lt;img src=&quot;../picture.jpg&quot;&gt;</code></td><td style="text-align:left">picture.jpg 位于当前文件夹的上一级文件夹中</td></tr></tbody></table><h3 id="7-HTML表格-标签"><a href="#7-HTML表格-标签" class="headerlink" title="7.HTML表格 标签"></a>7.HTML表格 标签</h3><table><thead><tr><th style="text-align:left">表格</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;table&gt;</code></td><td style="text-align:left">定义表格</td></tr><tr><td style="text-align:left"><code>&lt;caption&gt;</code></td><td style="text-align:left">定义表格标题。</td></tr><tr><td style="text-align:left"><code>&lt;th&gt;</code></td><td style="text-align:left">定义表格的表头。</td></tr><tr><td style="text-align:left"><code>&lt;tr&gt;</code></td><td style="text-align:left">定义表格的行。</td></tr><tr><td style="text-align:left"><code>&lt;td&gt;</code></td><td style="text-align:left">定义表格单元。</td></tr><tr><td style="text-align:left"><code>&lt;thead&gt;</code></td><td style="text-align:left">定义表格的页眉。</td></tr><tr><td style="text-align:left"><code>&lt;tbody&gt;</code></td><td style="text-align:left">定义表格的主体。</td></tr><tr><td style="text-align:left"><code>&lt;tfoot&gt;</code></td><td style="text-align:left">定义表格的页脚。</td></tr><tr><td style="text-align:left"><code>&lt;col&gt;</code></td><td style="text-align:left">定义用于表格列的属性。</td></tr><tr><td style="text-align:left"><code>&lt;colgroup&gt;</code></td><td style="text-align:left">定义表格列的组。</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">caption</span>&gt;</span>横跨两列的单元格<span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">"2"</span>&gt;</span>电话<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 854<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 855<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">"1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">caption</span>&gt;</span>横跨两行的单元格<span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">rowspan</span>=<span class="string">"2"</span>&gt;</span>电话<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 854<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 855<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-HTML-列表标签"><a href="#8-HTML-列表标签" class="headerlink" title="8.HTML 列表标签"></a>8.HTML 列表标签</h3><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;ol&gt;</code></td><td style="text-align:left">定义有序列表。</td></tr><tr><td style="text-align:left"><code>&lt;ul&gt;</code></td><td style="text-align:left">定义无序列表。</td></tr><tr><td style="text-align:left"><code>&lt;li&gt;</code></td><td style="text-align:left">定义列表项。</td></tr><tr><td style="text-align:left"><code>&lt;dl&gt;</code></td><td style="text-align:left">定义定义列表。</td></tr><tr><td style="text-align:left"><code>&lt;dt&gt;</code></td><td style="text-align:left">定义定义项目。</td></tr><tr><td style="text-align:left"><code>&lt;dd&gt;</code></td><td style="text-align:left">定义定义的描述。</td></tr></tbody></table><ul><li>无序列表：始于 <code>&lt;ul&gt;</code> 标签，每个列表项始于 <code>&lt;li&gt;</code>。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Coffee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Milk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>有序列表:始于 <code>&lt;ol&gt;</code> 标签,每个列表项始于 <code>&lt;li&gt;</code> 标签。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Coffee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Milk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="二、HTML-元素"><a href="#二、HTML-元素" class="headerlink" title="二、HTML 元素"></a>二、HTML 元素</h3><p>HTML 元素是由 HTML 标签 和 纯文本 构成。<br>HTML 元素：是从开始标签（start tag 或者叫做 开放标签（opening tag） ）到结束标签（end tag 或者叫做 闭合标签（closing tag） ）的所有代码。</p><table><thead><tr><th style="text-align:left">开始标签</th><th style="text-align:left">元素内容</th><th style="text-align:left">结束标签</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;p&gt;</code></td><td style="text-align:left">This is a paragraph</td><td style="text-align:left"><code>&lt;/p&gt;</code></td></tr><tr><td style="text-align:left"><code>&lt;a href=&quot;default.htm&quot; &gt;</code></td><td style="text-align:left">This is a link</td><td style="text-align:left"><code>&lt;/a&gt;</code></td></tr><tr><td style="text-align:left"><code>&lt;br /&gt;</code></td><td style="text-align:left"></td></tr></tbody></table><h3 id="三、HTML-文档"><a href="#三、HTML-文档" class="headerlink" title="三、HTML 文档"></a>三、HTML 文档</h3><p>HTML 文档是由嵌套的 HTML 元素构成，用来描述网页。Web 浏览器的作用是读取 HTML 文档，并以网页的形式显示出它们。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Title of the document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">The content of the document......</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="HTML-文档类型"><a href="#HTML-文档类型" class="headerlink" title="HTML 文档类型"></a>HTML 文档类型</h4><p>&lt;!DOCTYPE&gt; 声明帮助浏览器正确地显示网页。</p><ul><li><p>HTML5</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>HTML 4.01</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"</span></span><br><span class="line"><span class="meta">"http://www.w3.org/TR/html4/loose.dtd"&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>XHTML 1.0</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"</span></span><br><span class="line"><span class="meta">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="HTML-头部元素"><a href="#HTML-头部元素" class="headerlink" title="HTML 头部元素"></a>HTML 头部元素</h4><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;head&gt;</code></td><td style="text-align:left">定义关于文档的信息。</td></tr><tr><td style="text-align:left"><code>title</code></td><td style="text-align:left">定义文档标题。</td></tr><tr><td style="text-align:left"><code>base</code></td><td style="text-align:left">定义页面上所有链接的默认地址或默认目标。</td></tr><tr><td style="text-align:left"><code>link</code></td><td style="text-align:left">定义文档与外部资源之间的关系。</td></tr><tr><td style="text-align:left"><code>&lt;meta&gt;</code></td><td style="text-align:left">定义关于 HTML 文档的元数据。</td></tr><tr><td style="text-align:left"><code>&lt;script&gt;</code></td><td style="text-align:left">定义客户端脚本。</td></tr><tr><td style="text-align:left"><code>&lt;style&gt;</code></td><td style="text-align:left">定义文档的样式信息。</td></tr></tbody></table><h3 id="四、HTML-编写网页"><a href="#四、HTML-编写网页" class="headerlink" title="四、HTML 编写网页"></a>四、HTML 编写网页</h3><h4 id="选择合适的编辑器"><a href="#选择合适的编辑器" class="headerlink" title="选择合适的编辑器"></a>选择合适的编辑器</h4><ul><li>文本编辑器<ul><li>Notepad (PC) </li><li>TextEdit (Mac)</li></ul></li><li>专业的 HTML 编辑器<ul><li>Adobe Dreamweaver</li><li>Microsoft Expression Web</li><li>CoffeeCup HTML Editor</li></ul></li></ul><h4 id="遍写步骤"><a href="#遍写步骤" class="headerlink" title="遍写步骤"></a>遍写步骤</h4><ul><li>1.启动编辑器</li><li><p>2.在编辑器中键入 HTML 代码，如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>3.保存为HTML文件(后缀为 .htm 或者 .html )</p></li><li>4.在浏览器中运行这个 HTML 文件</li></ul><h3 id="五、HTML-属性"><a href="#五、HTML-属性" class="headerlink" title="五、HTML 属性"></a>五、HTML 属性</h3><p>HTML 标签拥有属性。属性提供了有关 HTML 元素的更多信息。<br>属性总是以名称/值对的形式出现，比如：name=”value”。<br>属性总是在 HTML 元素的开始标签中规定。</p><p>例如：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span>&gt;</span>This is a link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p> <a href="https://www.w3school.com.cn/tags/html_ref_standardattributes.asp" target="_blank" rel="noopener">HTML 标准属性参考手册</a> </p><h3 id="六、HTML-样式"><a href="#六、HTML-样式" class="headerlink" title="六、HTML 样式"></a>六、HTML 样式</h3><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;style&gt;</code></td><td style="text-align:left">定义样式定义。</td></tr><tr><td style="text-align:left"><code>&lt;link&gt;</code></td><td style="text-align:left">定义资源引用。</td></tr></tbody></table><p>定义HTML 元素的样式:</p><ul><li>style 属性(内联样式)</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--background-color 属性为元素定义了背景颜色 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">"background-color:yellow"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- text-align 属性规定了元素中文本的水平对齐方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">"text-align:center"</span>&gt;</span>This is a heading<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--font-family、color 以及 font-size 属性分别定义元素中文本的字体系列、颜色和字体尺寸--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"font-family:arial;color:red;font-size:20px;"</span>&gt;</span>A paragraph.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>独立的样式表中（CSS 文件）<ul><li>外部样式表<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"mystyle.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><pre><code>- 内部样式表<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">body &#123;background-color: red&#125;</span></span><br><span class="line"><span class="undefined">p &#123;margin-left: 20px&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure></code></pre><h4 id="HTML-类"><a href="#HTML-类" class="headerlink" title="HTML 类"></a>HTML 类</h4><p>对 HTML 块级元素 进行分类（设置类），使我们能够为元素的类定义 CSS 样式。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">.cities &#123;</span></span><br><span class="line"><span class="undefined">    background-color:black;</span></span><br><span class="line"><span class="undefined">    color:white;</span></span><br><span class="line"><span class="undefined">    margin:20px;</span></span><br><span class="line"><span class="undefined">    padding:20px;</span></span><br><span class="line"><span class="undefined">&#125; </span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cities"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>London<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>London is the capital city of England. </span><br><span class="line">It is the most populous city in the United Kingdom, </span><br><span class="line">with a metropolitan area of over 13 million inhabitants.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cities"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Paris<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Paris is the capital and most populous city of France.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cities"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Tokyo<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Tokyo is the capital of Japan, the center of the Greater Tokyo Area,</span><br><span class="line">and the most populous metropolitan area in the world.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>分类行内元素：例如设置 <span> 元素的类，能够为相同的 <span> 元素设置相同的样式。</span></span></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  span.red &#123;color:red;&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>My <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"red"</span>&gt;</span>Important<span class="tag">&lt;/<span class="name">span</span>&gt;</span> Heading<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="HTML-颜色"><a href="#HTML-颜色" class="headerlink" title="HTML 颜色"></a>HTML 颜色</h4><p>可以通过颜色值和颜色名设置</p><ul><li>颜色值：由红色、绿色和蓝色的值组成（RGB）</li></ul><table><thead><tr><th style="text-align:left">Color</th><th style="text-align:left">Color HEX</th><th style="text-align:left">Color RGB</th></tr></thead><tbody><tr><td style="text-align:left">黑色</td><td style="text-align:left">#000000</td><td style="text-align:left">rgb(0,0,0)</td></tr><tr><td style="text-align:left">红色</td><td style="text-align:left">#FF0000</td><td style="text-align:left">rgb(255,0,0)</td></tr><tr><td style="text-align:left">绿色</td><td style="text-align:left">#00FF00</td><td style="text-align:left">rgb(0,255,0)</td></tr><tr><td style="text-align:left">蓝色</td><td style="text-align:left">#0000FF</td><td style="text-align:left">rgb(0,0,255)</td></tr><tr><td style="text-align:left">黄色</td><td style="text-align:left">#FFFF00</td><td style="text-align:left">rgb(255,255,0)</td></tr><tr><td style="text-align:left">浅蓝色</td><td style="text-align:left">#00FFFF</td><td style="text-align:left">rgb(0,255,255)</td></tr><tr><td style="text-align:left">紫色</td><td style="text-align:left">#FF00FF</td><td style="text-align:left">rgb(255,0,255)</td></tr><tr><td style="text-align:left">灰色</td><td style="text-align:left">#C0C0C0</td><td style="text-align:left">rgb(192,192,192)</td></tr><tr><td style="text-align:left">白色</td><td style="text-align:left">#FFFFFF</td><td style="text-align:left">rgb(255,255,255)</td></tr></tbody></table><ul><li>颜色名：仅仅有 16 种颜色名被 W3C 的 HTML4.0 标准所支持。它们是：aqua, black, blue, fuchsia, gray, green, lime, maroon, navy, olive, purple, red, silver, teal, white, yellow。如果需要使用其它的颜色，需要使用十六进制的颜色值。</li></ul><table><thead><tr><th style="text-align:left">Color</th><th style="text-align:left">Color HEX</th><th style="text-align:left">Color Name</th></tr></thead><tbody><tr><td style="text-align:left">爱丽丝蓝</td><td style="text-align:left">#F0F8FF</td><td style="text-align:left">AliceBlue</td></tr><tr><td style="text-align:left">古董白</td><td style="text-align:left">#FAEBD7</td><td style="text-align:left">AntiqueWhite</td></tr><tr><td style="text-align:left">蓝晶</td><td style="text-align:left">#7FFFD4</td><td style="text-align:left">Aquamarine</td></tr><tr><td style="text-align:left">黑色</td><td style="text-align:left">#000000</td><td style="text-align:left">Black</td></tr><tr><td style="text-align:left">蓝色</td><td style="text-align:left">#0000FF</td><td style="text-align:left">Blue</td></tr><tr><td style="text-align:left">紫罗兰</td><td style="text-align:left">#8A2BE2</td><td style="text-align:left">BlueViolet</td></tr><tr><td style="text-align:left">棕色</td><td style="text-align:left">#A52A2A</td><td style="text-align:left">Brown</td></tr></tbody></table><p><a href="https://www.w3school.com.cn/html/html_colornames.asp" target="_blank" rel="noopener">颜色列表</a></p><h3 id="七、HTML-布局"><a href="#七、HTML-布局" class="headerlink" title="七、HTML 布局"></a>七、HTML 布局</h3><h4 id="HTML-块"><a href="#HTML-块" class="headerlink" title="HTML 块"></a>HTML 块</h4><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;div&gt;</code></td><td style="text-align:left">定义文档中的分区或节（division/section）。</td></tr><tr><td style="text-align:left"><code>&lt;span&gt;</code></td><td style="text-align:left">定义 span，用来组合文档中的行内元素。</td></tr></tbody></table><ul><li><code>&lt;div&gt;</code> 元素:块级元素，它是可用于组合其他 HTML 元素的容器。用途是文档布局,如果与 CSS 一同使用，可用于对大的内容块设置样式属性。</li><li><code>&lt;span&gt;</code> 元素:内联元素，可用作文本的容器。与 CSS 一同使用时，可用于为部分文本设置样式属性。</li></ul><h4 id="HTML5-语义元素"><a href="#HTML5-语义元素" class="headerlink" title="HTML5 语义元素"></a>HTML5 语义元素</h4><table><thead><tr><th>语义元素</th><th>说明</th></tr></thead><tbody><tr><td>header</td><td>定义文档或节的页眉</td></tr><tr><td>nav</td><td>定义导航链接的容器</td></tr><tr><td>section</td><td>定义文档中的节</td></tr><tr><td>article</td><td>定义独立的自包含文章</td></tr><tr><td>aside</td><td>定义内容之外的内容（比如侧栏）</td></tr><tr><td>footer</td><td>定义文档或节的页脚</td></tr><tr><td>details</td><td>定义额外的细节</td></tr><tr><td>summary</td><td>定义 details 元素的标题</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">#header &#123;</span></span><br><span class="line"><span class="undefined">    background-color:black;</span></span><br><span class="line"><span class="undefined">    color:white;</span></span><br><span class="line"><span class="undefined">    text-align:center;</span></span><br><span class="line"><span class="undefined">    padding:5px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#nav &#123;</span></span><br><span class="line"><span class="undefined">    line-height:30px;</span></span><br><span class="line"><span class="undefined">    background-color:#eeeeee;</span></span><br><span class="line"><span class="undefined">    height:300px;</span></span><br><span class="line"><span class="undefined">    width:100px;</span></span><br><span class="line"><span class="undefined">    float:left;</span></span><br><span class="line"><span class="undefined">    padding:5px;      </span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#section &#123;</span></span><br><span class="line"><span class="undefined">    width:350px;</span></span><br><span class="line"><span class="undefined">    float:left;</span></span><br><span class="line"><span class="undefined">    padding:10px;  </span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">#footer &#123;</span></span><br><span class="line"><span class="undefined">    background-color:black;</span></span><br><span class="line"><span class="undefined">    color:white;</span></span><br><span class="line"><span class="undefined">    clear:both;</span></span><br><span class="line"><span class="undefined">    text-align:center;</span></span><br><span class="line"><span class="undefined">   padding:5px;  </span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"header"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>The Title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"nav"</span>&gt;</span></span><br><span class="line">File<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">View<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Help<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"section"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">GoodBye</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="使用表格的-HTML-布局"><a href="#使用表格的-HTML-布局" class="headerlink" title="使用表格的 HTML 布局"></a>使用表格的 HTML 布局</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">table.lamp &#123;</span></span><br><span class="line"><span class="undefined">    width:100%;</span></span><br><span class="line"><span class="undefined">    border:1px solid #d4d4d4;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">table.lamp th, td &#123; </span></span><br><span class="line"><span class="undefined">    padding:10px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">table.lamp th &#123;</span></span><br><span class="line"><span class="undefined">    width:40px;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"lamp"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/images/lamp.jpg"</span> <span class="attr">alt</span>=<span class="string">"Note"</span> <span class="attr">style</span>=<span class="string">"height:32px;width:32px"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">    The table element was not designed to be a layout tool.</span><br><span class="line">  <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="八、HTML-响应式-Web-设计"><a href="#八、HTML-响应式-Web-设计" class="headerlink" title="八、HTML 响应式 Web 设计"></a>八、HTML 响应式 Web 设计</h3><ul><li>RWD 指的是响应式 Web 设计（Responsive Web Design）</li><li>RWD 能够以可变尺寸传递网页</li><li>RWD 对于平板和移动设备是必需的</li></ul><h4 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a>自定义</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en-US"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">.city &#123;</span></span><br><span class="line"><span class="undefined">float: left;</span></span><br><span class="line"><span class="undefined">margin: 5px;</span></span><br><span class="line"><span class="undefined">padding: 15px;</span></span><br><span class="line"><span class="undefined">width: 300px;</span></span><br><span class="line"><span class="undefined">height: 300px;</span></span><br><span class="line"><span class="undefined">border: 1px solid black;</span></span><br><span class="line"><span class="undefined">&#125; </span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>W3School Demo<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Resize this responsive page!<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"city"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>London<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>London is the capital city of England.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>It is the most populous city in the United Kingdom,</span><br><span class="line">with a metropolitan area of over 13 million inhabitants.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"city"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Paris<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Paris is the capital and most populous city of France.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"city"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>Tokyo<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Tokyo is the capital of Japan, the center of the Greater Tokyo Area,</span><br><span class="line">and the most populous metropolitan area in the world.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="使用-Bootstrap"><a href="#使用-Bootstrap" class="headerlink" title="使用 Bootstrap"></a>使用 Bootstrap</h4><p>Bootstrap 是最流行的开发响应式 web 的 HTML, CSS, 和 JS 框架。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">href</span>=<span class="string">"http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jumbotron"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>W3School Demo<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Resize this responsive page!<span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>London<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>London is the capital city of England.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>It is the most populous city in the United Kingdom,</span><br><span class="line">    with a metropolitan area of over 13 million inhabitants.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Paris<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paris is the capital and most populous city of France.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-md-4"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Tokyo<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Tokyo is the capital of Japan, the center of the Greater Tokyo Area,</span><br><span class="line">    and the most populous metropolitan area in the world.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="九、HTML-框架"><a href="#九、HTML-框架" class="headerlink" title="九、HTML 框架"></a>九、HTML 框架</h3><h4 id="HTML-Frameset"><a href="#HTML-Frameset" class="headerlink" title="HTML Frameset"></a>HTML Frameset</h4><p>通过使用框架，你可以在同一个浏览器窗口中显示不止一个页面。每份HTML文档称为一个框架，并且每个框架都独立于其他的框架。</p><p>使用框架的坏处：</p><ul><li>开发人员必须同时跟踪更多的HTML文档</li><li>很难打印整张页面</li></ul><p>框架结构标签（<code>&lt;frameset&gt;</code>）<br>框架结构标签（<code>&lt;frameset&gt;</code>）定义如何将窗口分割为框架,每个 frameset 定义了一系列行或列,rows/columns 的值规定了每行或每列占据屏幕的面积.</p><ul><li><p>竖直框架</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">frameset</span> <span class="attr">cols</span>=<span class="string">"25%,50%,25%"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"/example/html/frame_a.html"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"/example/html/frame_b.html"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"/example/html/frame_c.html"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">noframes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>您的浏览器无法处理框架！<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">noframes</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>水平框架</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">frameset</span> <span class="attr">rows</span>=<span class="string">"25%,50%,25%"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"/example/html/frame_a.html"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"/example/html/frame_b.html"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">frame</span> <span class="attr">src</span>=<span class="string">"/example/html/frame_c.html"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">frameset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="HTML-Iframe"><a href="#HTML-Iframe" class="headerlink" title="HTML Iframe"></a>HTML Iframe</h4><p>iframe 用于在网页内显示网页。</p><ul><li><p>设置高度和宽度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=&quot;demo_iframe.htm&quot; width=&quot;200&quot; height=&quot;200&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></li><li><p>删除边框</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=&quot;demo_iframe.htm&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></li><li><p>可用作链接的目标</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=&quot;demo_iframe.htm&quot; name=&quot;iframe_a&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=&quot;http://www.baidu.com&quot; target=&quot;iframe_a&quot;&gt;baidu&lt;/a&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure></li></ul><h3 id="十、HTML-脚本"><a href="#十、HTML-脚本" class="headerlink" title="十、HTML 脚本"></a>十、HTML 脚本</h3><p><code>&lt;script&gt;</code> 标签用于定义客户端脚本，比如 JavaScript。script 元素既可包含脚本语句，也可通过 src 属性指向外部脚本文件。必需的 type 属性规定脚本的 MIME 类型。</p><p>JavaScript 最常用于图片操作、表单验证以及内容动态更新。</p><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;script&gt;</code></td><td style="text-align:left">定义客户端脚本。</td></tr><tr><td style="text-align:left"><code>&lt;noscript&gt;</code></td><td style="text-align:left">为不支持客户端脚本的浏览器定义替代内容。</td></tr></tbody></table><p>下面的脚本会向浏览器输出“Hello World!”：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">"Hello World!"</span>)</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span>Your browser does not support JavaScript!<span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="十一、HTML-转换"><a href="#十一、HTML-转换" class="headerlink" title="十一、HTML 转换"></a>十一、HTML 转换</h3><h4 id="HTML-字符实体"><a href="#HTML-字符实体" class="headerlink" title="HTML 字符实体"></a>HTML 字符实体</h4><p>HTML 中的预留字符要在页面展示，必须被替换为字符实体。</p><p><strong>注释：</strong>实体名称对大小写敏感！</p><table><thead><tr><th style="text-align:left">显示结果</th><th style="text-align:left">描述</th><th style="text-align:left">实体名称</th><th style="text-align:left">实体编号</th></tr></thead><tbody><tr><td style="text-align:left"></td><td style="text-align:left">空格</td><td style="text-align:left">&nbsp;</td><td style="text-align:left">&#160;</td></tr><tr><td style="text-align:left">&lt;</td><td style="text-align:left">小于号</td><td style="text-align:left">&lt;</td><td style="text-align:left">&#60;</td></tr><tr><td style="text-align:left">&gt;</td><td style="text-align:left">大于号</td><td style="text-align:left">&gt;</td><td style="text-align:left">&#62;</td></tr><tr><td style="text-align:left">&amp;</td><td style="text-align:left">和号</td><td style="text-align:left">&amp;</td><td style="text-align:left">&#38;</td></tr><tr><td style="text-align:left">“</td><td style="text-align:left">引号</td><td style="text-align:left">&quot;</td><td style="text-align:left">&#34;</td></tr><tr><td style="text-align:left">‘</td><td style="text-align:left">撇号</td><td style="text-align:left">&apos; (IE不支持)</td><td style="text-align:left">&#39;</td></tr><tr><td style="text-align:left">￠</td><td style="text-align:left">分（cent）</td><td style="text-align:left">&cent;</td><td style="text-align:left">&#162;</td></tr><tr><td style="text-align:left">£</td><td style="text-align:left">镑（pound）</td><td style="text-align:left">&pound;</td><td style="text-align:left">&#163;</td></tr><tr><td style="text-align:left">¥</td><td style="text-align:left">元（yen）</td><td style="text-align:left">&yen;</td><td style="text-align:left">&#165;</td></tr><tr><td style="text-align:left">€</td><td style="text-align:left">欧元（euro）</td><td style="text-align:left">&euro;</td><td style="text-align:left">&#8364;</td></tr><tr><td style="text-align:left">§</td><td style="text-align:left">小节</td><td style="text-align:left">&sect;</td><td style="text-align:left">&#167;</td></tr><tr><td style="text-align:left">©</td><td style="text-align:left">版权（copyright）</td><td style="text-align:left">&copy;</td><td style="text-align:left">&#169;</td></tr><tr><td style="text-align:left">®</td><td style="text-align:left">注册商标</td><td style="text-align:left">&reg;</td><td style="text-align:left">&#174;</td></tr><tr><td style="text-align:left">™</td><td style="text-align:left">商标</td><td style="text-align:left">&trade;</td><td style="text-align:left">&#8482;</td></tr><tr><td style="text-align:left">×</td><td style="text-align:left">乘号</td><td style="text-align:left">&times;</td><td style="text-align:left">&#215;</td></tr><tr><td style="text-align:left">÷</td><td style="text-align:left">除号</td><td style="text-align:left">&divide;</td><td style="text-align:left">&#247;</td></tr></tbody></table><p> <a href="https://www.w3school.com.cn/tags/html_ref_entities.html" target="_blank" rel="noopener">HTML 实体符号参考手册</a></p><h4 id="HTML-URL"><a href="#HTML-URL" class="headerlink" title="HTML URL"></a>HTML URL</h4><p>URL（Uniform Resource Locator,统一资源定位器） 也被称为网址。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scheme://host.domain:port/path/filename</span><br></pre></td></tr></table></figure><p>解释：</p><ul><li>scheme - 定义因特网服务的类型。最常见的类型是 http</li><li>host - 定义域主机（http 的默认主机是 www）</li><li>domain - 定义因特网域名，比如 w3school.com.cn</li><li>:port - 定义主机上的端口号（http 的默认端口号是 80）</li><li>path - 定义服务器上的路径（如果省略，则文档必须位于网站的根目录中）。</li><li>filename - 定义文档/资源的名称</li></ul><p>以下是其中一些最流行的 scheme：</p><table><thead><tr><th style="text-align:left">Scheme</th><th style="text-align:left">访问</th><th style="text-align:left">用于…</th></tr></thead><tbody><tr><td style="text-align:left">http</td><td style="text-align:left">超文本传输协议</td><td style="text-align:left">以 http:// 开头的普通网页。不加密。</td></tr><tr><td style="text-align:left">https</td><td style="text-align:left">安全超文本传输协议</td><td style="text-align:left">安全网页。加密所有信息交换。</td></tr><tr><td style="text-align:left">ftp</td><td style="text-align:left">文件传输协议</td><td style="text-align:left">用于将文件下载或上传至网站。</td></tr><tr><td style="text-align:left">file</td><td style="text-align:left"></td><td style="text-align:left">您计算机上的文件。</td></tr></tbody></table><ul><li>URL 编码：URL 只能使用 ASCII 字符集来通过因特网进行发送。ASCII 集合之外的字符，使用 “%” 其后跟随两位的十六进制数来替换。URL 不能包含空格。URL 编码通常使用 + 来替换空格。</li></ul><table><thead><tr><th style="text-align:left">字符</th><th style="text-align:left">URL 编码</th></tr></thead><tbody><tr><td style="text-align:left">€</td><td style="text-align:left">%80</td></tr><tr><td style="text-align:left">£</td><td style="text-align:left">%A3</td></tr><tr><td style="text-align:left">©</td><td style="text-align:left">%A9</td></tr><tr><td style="text-align:left">®</td><td style="text-align:left">%AE</td></tr><tr><td style="text-align:left">À</td><td style="text-align:left">%C0</td></tr><tr><td style="text-align:left">Á</td><td style="text-align:left">%C1</td></tr><tr><td style="text-align:left">Â</td><td style="text-align:left">%C2</td></tr><tr><td style="text-align:left">Ã</td><td style="text-align:left">%C3</td></tr><tr><td style="text-align:left">Ä</td><td style="text-align:left">%C4</td></tr><tr><td style="text-align:left">Å</td><td style="text-align:left">%C5</td></tr></tbody></table><p><a href="https://www.w3school.com.cn/tags/html_ref_urlencode.html" target="_blank" rel="noopener">URL 编码参考手册</a>。</p><h3 id="十二、HTML-表单"><a href="#十二、HTML-表单" class="headerlink" title="十二、HTML 表单"></a>十二、HTML 表单</h3><p>HTML 表单用于搜集不同类型的用户输入。<form> 元素用于定义 HTML 表单。</form></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form&gt;</span><br><span class="line"> .</span><br><span class="line">form elements</span><br><span class="line"> .</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure><ul><li><code>&lt;input&gt;</code> 元素:表单 输入元素</li></ul><p>使用的类型：</p><table><thead><tr><th style="text-align:left">类型</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">text</td><td style="text-align:left">定义常规文本输入。</td></tr><tr><td style="text-align:left">password</td><td style="text-align:left">密码字段,加密显示</td></tr><tr><td style="text-align:left">radio</td><td style="text-align:left">定义单选按钮输入（选择多个选择之一）</td></tr><tr><td style="text-align:left">checkbox</td><td style="text-align:left">定义复选框</td></tr><tr><td style="text-align:left">submit</td><td style="text-align:left">定义提交按钮（提交表单）</td></tr><tr><td style="text-align:left">button</td><td style="text-align:left">定义按钮</td></tr></tbody></table><p>设置属性：<br>| 属性      | 描述                               |<br>| :——– | :——————————— |<br>| disabled  | 规定输入字段应该被禁用。           |<br>| maxlength | 规定输入字段的最大字符数。         |<br>| readonly  | 规定输入字段为只读（无法修改）。   |<br>| size      | 规定输入字段的宽度（以字符计）。   |<br>| value     | 规定输入字段的默认值。             |</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">name:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"male"</span> <span class="attr">checked</span>&gt;</span>Male</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"sex"</span> <span class="attr">value</span>=<span class="string">"female"</span>&gt;</span>Female</span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>请注意表单本身是不可见的。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>同时请注意文本字段的默认宽度是 20 个字符。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;select&gt;</code>:下拉列表</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/demo/demo_form.asp"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"cars"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"volvo"</span>&gt;</span>Volvo<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"saab"</span>&gt;</span>Saab<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"fiat"</span>&gt;</span>Fiat<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"audi"</span>&gt;</span>Audi<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;textarea&gt;</code>: 定义多行输入字段（文本域）</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">"message"</span> <span class="attr">rows</span>=<span class="string">"10"</span> <span class="attr">cols</span>=<span class="string">"30"</span>&gt;</span></span><br><span class="line">The cat was playing in the garden.</span><br><span class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;button&gt;</code>:定义可点击的按钮<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">onclick</span>=<span class="string">"alert('Hello World!')"</span>&gt;</span>点击我！<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="十三、HTML媒体"><a href="#十三、HTML媒体" class="headerlink" title="十三、HTML媒体"></a>十三、HTML媒体</h3><p>Web 上的多媒体指的是音效、音乐、视频和动画。</p><ul><li>视频格式</li></ul><table><thead><tr><th style="text-align:left">格式</th><th style="text-align:left">文件</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">AVI</td><td style="text-align:left">.avi</td><td style="text-align:left">AVI (Audio Video Interleave) 格式是由微软开发的。所有运行 Windows 的计算机都支持 AVI 格式。它是因特网上很常见的格式，但非 Windows 计算机并不总是能够播放。</td></tr><tr><td style="text-align:left">WMV</td><td style="text-align:left">.wmv</td><td style="text-align:left">Windows Media 格式是由微软开发的。Windows Media 在因特网上很常见，但是如果未安装额外的（免费）组件，就无法播放 Windows Media 电影。一些后期的 Windows Media 电影在所有非 Windows 计算机上都无法播放，因为没有合适的播放器。</td></tr><tr><td style="text-align:left">MPEG</td><td style="text-align:left">.mpg.mpeg</td><td style="text-align:left">MPEG (Moving Pictures Expert Group) 格式是因特网上最流行的格式。它是跨平台的，得到了所有最流行的浏览器的支持。</td></tr><tr><td style="text-align:left">QuickTime</td><td style="text-align:left">.mov</td><td style="text-align:left">QuickTime 格式是由苹果公司开发的。QuickTime 是因特网上常见的格式，但是 QuickTime 电影不能在没有安装额外的（免费）组件的 Windows 计算机上播放。</td></tr><tr><td style="text-align:left">RealVideo</td><td style="text-align:left">.rm.ram</td><td style="text-align:left">RealVideo 格式是由 Real Media 针对因特网开发的。该格式允许低带宽条件下（在线视频、网络电视）的视频流。由于是低带宽优先的，质量常会降低。</td></tr><tr><td style="text-align:left">Flash</td><td style="text-align:left">.swf.flv</td><td style="text-align:left">Flash (Shockwave) 格式是由 Macromedia 开发的。Shockwave 格式需要额外的组件来播放。但是该组件会预装到 Firefox 或 IE 之类的浏览器上。</td></tr><tr><td style="text-align:left">Mpeg-4</td><td style="text-align:left">.mp4</td><td style="text-align:left">Mpeg-4 (with H.264 video compression) 是一种针对因特网的新格式。事实上，YouTube 推荐使用 MP4。YouTube 接收多种格式，然后全部转换为 .flv 或 .mp4 以供分发。越来越多的视频发布者转到 MP4，将其作为 Flash 播放器和 HTML5 的因特网共享格式。</td></tr></tbody></table><ul><li>声音格式</li></ul><table><thead><tr><th style="text-align:left">格式</th><th style="text-align:left">文件</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">MIDI</td><td style="text-align:left">.mid.midi</td><td style="text-align:left">MIDI (Musical Instrument Digital Interface) 是一种针对电子音乐设备（比如合成器和声卡）的格式。MIDI 文件不含有声音，但包含可被电子产品（比如声卡）播放的数字音乐指令。因为 MIDI 格式仅包含指令，所以 MIDI 文件极其小巧。上面的例子只有 23k 的大小，但却能播放将近 5 分钟。MIDI 得到了广泛的平台上的大量软件的支持。大多数流行的网络浏览器都支持 MIDI。</td></tr><tr><td style="text-align:left">RealAudio</td><td style="text-align:left">.rm.ram</td><td style="text-align:left">RealAudio 格式是由 Real Media 针对因特网开发的。该格式也支持视频。该格式允许低带宽条件下的音频流（在线音乐、网络音乐）。由于是低带宽优先的，质量常会降低。</td></tr><tr><td style="text-align:left">Wave</td><td style="text-align:left">.wav</td><td style="text-align:left">Wave (waveform) 格式是由 IBM 和微软开发的。所有运行 Windows 的计算机和所有网络浏览器（除了 Google Chrome）都支持它。</td></tr><tr><td style="text-align:left">WMA</td><td style="text-align:left">.wma</td><td style="text-align:left">WMA 格式 (Windows Media Audio)，质量优于 MP3，兼容大多数播放器，除了 iPod。WMA 文件可作为连续的数据流来传输，这使它对于网络电台或在线音乐很实用。</td></tr><tr><td style="text-align:left">MP3</td><td style="text-align:left">.mp3.mpga</td><td style="text-align:left">MP3 文件实际上是 MPEG 文件的声音部分。MPEG 格式最初是由运动图像专家组开发的。MP3 是其中最受欢迎的针对音乐的声音格式。期待未来的软件系统都支持它。</td></tr></tbody></table><h4 id="如何播放"><a href="#如何播放" class="headerlink" title="如何播放"></a>如何播放</h4><table><thead><tr><th style="text-align:left">标签</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left"><code>&lt;applet&gt;</code></td><td style="text-align:left">不赞成。定义内嵌 applet。</td></tr><tr><td style="text-align:left"><code>&lt;embed&gt;</code></td><td style="text-align:left">HTML4 中不赞成，HTML5 中允许。定义内嵌对象。</td></tr><tr><td style="text-align:left"><code>&lt;object&gt;</code></td><td style="text-align:left">定义内嵌对象。</td></tr><tr><td style="text-align:left"><code>&lt;param&gt;</code></td><td style="text-align:left">定义对象的参数。</td></tr></tbody></table><ul><li><code>&lt;object&gt;</code>:使用辅助程序</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">width</span>=<span class="string">"420"</span> <span class="attr">height</span>=<span class="string">"360"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">classid</span>=<span class="string">"clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"</span> </span></span><br><span class="line"><span class="tag"> <span class="attr">codebase</span>=<span class="string">"http://www.apple.com/qtactivex/qtplugin.cab"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"src"</span> <span class="attr">value</span>=<span class="string">"/i/bird.wav"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"controller"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">height</span>=<span class="string">"40"</span></span></span><br><span class="line"><span class="tag"><span class="attr">classid</span>=<span class="string">"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"</span></span></span><br><span class="line"><span class="tag"><span class="attr">codebase</span>=<span class="string">"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"SRC"</span> <span class="attr">value</span>=<span class="string">"bookmark.swf"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">"/i/bookmark.swf"</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;embed&gt;</code>：定义外部（非 HTML）内容的容器</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">height</span>=<span class="string">"100"</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">src</span>=<span class="string">"/i/horse.mp3"</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>注释：<span class="tag">&lt;/<span class="name">b</span>&gt;</span>浏览器可能需要安装插件以后，才能播放该文件。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><code>&lt;herf&gt;</code>:也可以使用超链接,配合js脚本或者辅助应用程序</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/i/song.mp3"</span>&gt;</span>播放 mp3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/i/bird.wav"</span>&gt;</span>播放 wav<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://mediaplayer.yahoo.com/js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://www.w3school.com.cn/html/html_quick.asp" target="_blank" rel="noopener">HTML 速查手册</a><br><a href="https://www.w3school.com.cn/tags/index.asp" target="_blank" rel="noopener">HTML 参考手册</a></p>]]></content>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> html </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署GitLab</title>
      <link href="/2016/04/21/%E9%83%A8%E7%BD%B2GitLab/"/>
      <url>/2016/04/21/%E9%83%A8%E7%BD%B2GitLab/</url>
      <content type="html"><![CDATA[<p>GitLab是利用 Ruby on Rails 一个开源的版本管理系统，实现一个自托管的Git项目仓库，可通过Web界面进行访问公开的或者私人项目,适合大规模。文章介绍在Centos7.5环境下搭建GitLab。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><ul><li>1.配置需求(<a href="https://docs.gitlab.com/ce/install/requirements.html" target="_blank" rel="noopener">官方配置</a>推荐2C8G,硬盘至少有 5-10 GB)</li></ul><ul><li><p>2.系统防火墙中打开HTTP和SSH访问</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y curl policycoreutils-python openssh-server</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">sudo systemctl start sshd</span><br><span class="line">sudo firewall-cmd --permanent --add-service=http</span><br><span class="line">sudo systemctl reload firewalld</span><br></pre></td></tr></table></figure></li><li><p>3.安装Postfix以发送通知电子邮件</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install postfix</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> postfix</span><br><span class="line">sudo systemctl start postfix</span><br></pre></td></tr></table></figure></li></ul><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li><p>1.添加GitLab包存储库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ee/script.rpm.sh | sudo bash</span><br></pre></td></tr></table></figure></li><li><p>2.设置GitLab实例的URL</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo EXTERNAL_URL=<span class="string">"http://&lt;server_ip:port&gt;"</span> yum install -y gitlab-ee</span><br></pre></td></tr></table></figure></li><li><p>3.启动并查看</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl reconfigure</span><br><span class="line">sudo gitlab-ctl status</span><br></pre></td></tr></table></figure><p>  <img src="/image/部署GitLab_001.png" alt=""></p></li><li><p>4.用浏览器访问刚才配置的gitlab中的EXTERNAL_URL</p></li><li><p>5.设置新密码,用root用户和新密码登录<br><img src="/image/部署GitLab_002.png" alt=""><br><img src="/image/部署GitLab_003.png" alt=""><br><img src="/image/部署GitLab_004.png" alt=""></p></li></ul><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl start <span class="comment"># 启动</span></span><br><span class="line">sudo gitlab-ctl stop <span class="comment"># 停止</span></span><br><span class="line">sudo gitlab-ctl status <span class="comment"># 查看状态</span></span><br><span class="line">sudo gitlab-ctl restart <span class="comment"># 重启</span></span><br><span class="line">sudo gitlab-ctl reconfigure <span class="comment"># 修改后直接编译启动</span></span><br><span class="line">sudo vim /etc/gitlab/gitlab.rb  <span class="comment"># 修改默认的配置文件</span></span><br><span class="line">gitlab-rake gitlab:check SANITIZE=<span class="literal">true</span> --trace    <span class="comment"># 检查gitlab</span></span><br><span class="line">sudo gitlab-ctl tail <span class="comment"># 查看所有日志</span></span><br><span class="line">sudo gitlab-ctl tail nginx/gitlab_access.log <span class="comment"># 查看nginx访问日志</span></span><br><span class="line">cat /opt/gitlab/embedded/service/gitlab-rails/VERSION <span class="comment"># 查看gitlab版本</span></span><br></pre></td></tr></table></figure><h3 id="服务构成"><a href="#服务构成" class="headerlink" title="服务构成"></a>服务构成</h3><p><img src="/image/部署GitLab_005.png" alt=""></p><ul><li>nginx：静态Web服务器</li><li>gitlab-shell：用于处理Git命令和修改authorized keys列表</li><li>gitlab-workhorse:轻量级的反向代理服务器</li><li>logrotate：日志文件管理工具</li><li>postgresql：数据库</li><li>redis：缓存数据库</li><li>sidekiq：用于在后台执行队列任务（异步执行）</li><li>unicorn：An HTTP server for Rack applications，GitLab Rails应用是托管在这个服务器上面的。</li></ul><h3 id="卸载GitLab"><a href="#卸载GitLab" class="headerlink" title="卸载GitLab"></a>卸载GitLab</h3><ul><li><p>1.停止GitLab</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl stop</span><br></pre></td></tr></table></figure></li><li><p>2.停止GitLab</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -e gitlab-ee</span><br></pre></td></tr></table></figure></li><li><p>3.查看进程</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep gitlab|grep service</span><br></pre></td></tr></table></figure></li><li><p>4.停止进程</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">kill</span> -9 &lt;查看到的进程PID&gt;</span><br><span class="line">ps aux | grep gitlab|grep service <span class="comment"># 检查进程</span></span><br></pre></td></tr></table></figure></li><li><p>5.删除所有包含gitlab文件</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name gitlab | xargs rm -rf</span><br></pre></td></tr></table></figure></li></ul><h3 id="Docker方式安装"><a href="#Docker方式安装" class="headerlink" title="Docker方式安装"></a>Docker方式安装</h3><ul><li><p>1.下拉镜像</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull gitlab/gitlab-ce:latest</span><br></pre></td></tr></table></figure></li><li><p>2.启动容器</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run --detach \</span><br><span class="line">--hostname &lt;server_ip&gt; \</span><br><span class="line">--publish 444:443 --publish 8880:80 --publish 2222:22 \</span><br><span class="line">--name gitlab \</span><br><span class="line">--restart always \</span><br><span class="line">gitlab/gitlab-ce:latest</span><br></pre></td></tr></table></figure></li><li><p>3.用浏览器访问http://&lt;server_ip&gt;:8880,使用root登录配置,可以参考<a href="https://docs.gitlab.com/omnibus/docker/" target="_blank" rel="noopener">官方文档</a></p></li></ul><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ul><li><p>1.错误信息为:GitLab is taking too much time to respond,返回502</p><ul><li><p>处理步骤:</p><ul><li><p>1.查看日志,发现unicorn端口被占用</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl tail</span><br></pre></td></tr></table></figure><p><img src="/image/部署GitLab_006.png" alt=""></p></li><li><p>2.修改unicorn端口</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl stop <span class="comment"># 停止gitlab</span></span><br><span class="line">vi /etc/gitlab/gitlab.rb <span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="/image/部署GitLab_007.png" alt=""><br><img src="/image/部署GitLab_008.png" alt=""><br><img src="/image/部署GitLab_009.png" alt=""></p></li><li><p>3.应用配置,检查是否生效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo gitlab-ctl reconfigure <span class="comment"># 应用配置</span></span><br><span class="line">sudo gitlab-ctl restart <span class="comment"># 重启服务</span></span><br><span class="line">lsof -i:8081 <span class="comment"># 检查是否生效</span></span><br></pre></td></tr></table></figure></li></ul></li></ul></li></ul><p>More info: <a href="https://about.gitlab.com/install/" target="_blank" rel="noopener">GitLab官网</a></p>]]></content>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 环境部署 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署Gitea</title>
      <link href="/2016/03/04/%E9%83%A8%E7%BD%B2Gitea/"/>
      <url>/2016/03/04/%E9%83%A8%E7%BD%B2Gitea/</url>
      <content type="html"><![CDATA[<p>Gitea是一个极易安装，运行非常快速，安装和使用体验良好的自建Git服务,支持Linux、macOS和Windows以及各种架构(x86，amd64，还包括ARM和 PowerPC)。文章介绍在Centos7.5环境下搭建Gitea。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><ul><li><p>1.安装MySQL/Mariadb(版本大于5.5.3)</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Centos系统</span></span><br><span class="line">yum install -y mariadb-server <span class="comment"># 安装mariadb-server</span></span><br><span class="line">systemctl start mariadb.service <span class="comment"># 启动服务</span></span><br><span class="line">systemctl <span class="built_in">enable</span> mariadb.service <span class="comment"># 添加到开机启动</span></span><br><span class="line">mysql <span class="comment"># 本地登录Mariadb</span></span><br></pre></td></tr></table></figure>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UPDATE mysql.user SET password = PASSWORD('123') WHERE USER = 'root'; # 修改密码</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure><h1 id="Ubuntu系统和Debian系统"><a href="#Ubuntu系统和Debian系统" class="headerlink" title="Ubuntu系统和Debian系统"></a>Ubuntu系统和Debian系统</h1>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O install.sh http://download.bt.cn/install/install-ubuntu.sh &amp;&amp; sudo bash install.sh</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>2.安装Git</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS系统</span></span><br><span class="line">yum -y install git</span><br><span class="line"></span><br><span class="line"><span class="comment"># Debian和Ubuntu系统</span></span><br><span class="line">apt-get -y install git</span><br></pre></td></tr></table></figure></li></ul><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><ul><li><p>1.安装Gitea</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget -O gitea https://dl.gitea.io/gitea/1.4.0/gitea-1.4.0-linux-amd64</span><br><span class="line">chmod +x gitea</span><br><span class="line">./gitea web</span><br></pre></td></tr></table></figure></li><li><p>2.用浏览器访问http://&lt;server_ip&gt;:3000进行初始配置登录</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo EXTERNAL_URL=<span class="string">"http://&lt;server_ip:port&gt;"</span> yum install -y gitlab-ee</span><br></pre></td></tr></table></figure><p>  <img src="/image/部署Gitea_001.png" alt=""><br>  <img src="/image/部署Gitea_002.png" alt=""></p></li></ul><h3 id="Docker方式安装"><a href="#Docker方式安装" class="headerlink" title="Docker方式安装"></a>Docker方式安装</h3><ul><li><p>1.预置</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装并启动Docker</span></span><br><span class="line">curl -sSL https://get.docker.com/ | sh</span><br><span class="line">service docker start</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装Docker Compose</span></span><br><span class="line">curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line">chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure></li><li><p>2.创建并进入gitea目录</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建并进入gitea目录</span></span><br><span class="line">mkdir gitea &amp;&amp; <span class="built_in">cd</span> gitea</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并编辑docker-compose.yml文件</span></span><br><span class="line">nano docker-compose.yml</span><br></pre></td></tr></table></figure></li><li><p>3.创建并编辑docker-compose.yml文件(配置内容复制进去)</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano docker-compose.yml</span><br></pre></td></tr></table></figure>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">"2"</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line"><span class="attr"> gitea:</span></span><br><span class="line"><span class="attr">   external:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr"> server:</span></span><br><span class="line"><span class="attr">   image:</span> <span class="string">gitea/gitea:latest</span></span><br><span class="line"><span class="attr">   environment:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">USER_UID=1000</span></span><br><span class="line">    <span class="string">+</span> <span class="string">USER_GID=1000</span></span><br><span class="line"><span class="attr">   restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">   networks:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">gitea</span></span><br><span class="line"><span class="attr">   volumes:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">./gitea:/data</span></span><br><span class="line"><span class="attr">   ports:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">"3000:3000"</span></span><br><span class="line">    <span class="string">+</span> <span class="string">"222:22"</span></span><br><span class="line"><span class="attr">   depends_on:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">db</span></span><br><span class="line"></span><br><span class="line"><span class="attr"> db:</span></span><br><span class="line"><span class="attr">   image:</span> <span class="attr">mysql:5.7</span></span><br><span class="line"><span class="attr">   restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">   environment:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">MYSQL_ROOT_PASSWORD=gitea</span></span><br><span class="line">    <span class="string">+</span> <span class="string">MYSQL_USER=gitea</span></span><br><span class="line">    <span class="string">+</span> <span class="string">MYSQL_PASSWORD=gitea</span></span><br><span class="line">    <span class="string">+</span> <span class="string">MYSQL_DATABASE=gitea</span></span><br><span class="line"><span class="attr">   networks:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">gitea</span></span><br><span class="line"><span class="attr">   volumes:</span></span><br><span class="line">    <span class="string">+</span> <span class="string">./mysql:/var/lib/mysql</span></span><br></pre></td></tr></table></figure></li><li><p>3.运行docker-compose.yml文件</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></li><li><p>4.用浏览器访问http://&lt;server_ip&gt;:3000进行初始配置登录</p></li></ul><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><ul><li><p>1.访问http://&lt;server_ip&gt;:3000失败</p><ul><li>原因:需要关闭防火墙，或者打开对应的3000端口  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CentOS 7</span></span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其它系统</span></span><br><span class="line">iptables -I INPUT -p tcp --dport 3000 -j ACCEPT</span><br><span class="line">service iptables save                              </span><br><span class="line">service iptables restart</span><br></pre></td></tr></table></figure></li></ul></li><li><p>2.ERROR: Failed to Setup IP tables: Unable to enable SKIP DNAT rule</p><ul><li>原因:端口被占用重启docker服务，或者修改配置  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker restart</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>More info: <a href="https://github.com/go-gitea/gitea" target="_blank" rel="noopener">Github地址</a></p>]]></content>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> 环境部署 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>GitHub使用指导</title>
      <link href="/2016/02/13/GitHub%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AF%BC/"/>
      <url>/2016/02/13/GitHub%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AF%BC/</url>
      <content type="html"><![CDATA[<p>GitHub是一个面向开源及私有软件项目的托管平台，因为只支持Git作为唯一的版本库格式进行托管，故名GitHub。文章介绍Git的使用指导。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h3><h4 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h4><p><a href="https://github.com/" target="_blank" rel="noopener">注册账户</a></p><h3 id="寻找牛人"><a href="#寻找牛人" class="headerlink" title="寻找牛人"></a>寻找牛人</h3><ul><li>GitHub上的代码库本身：尤其是：<a href="https://github.com/explore" target="_blank" rel="noopener">Explore</a>、<a href="https://github.com/popular/watched" target="_blank" rel="noopener">热门关注信息库</a>两个栏目</li><li>GitHub官方推荐：<a href="https://github.com/blog" target="_blank" rel="noopener">GitHub自身的官方博客</a>与GitHub员工们的个人博客推荐的项目与开发者</li><li>各类社交媒体上提到的的GitHub库：尤其是<a href="https://hackernews.cc/" target="_blank" rel="noopener">Hacker News上提到的GitHub库</a>。</li></ul><h3 id="搜索小技巧"><a href="#搜索小技巧" class="headerlink" title="搜索小技巧"></a>搜索小技巧</h3><table><thead><tr><th>使用场景</th><th>使用方法</th><th>样例</th></tr></thead><tbody><tr><td>搜索百科大全</td><td>xxx awesome</td><td>java awesome</td></tr><tr><td>找例子</td><td>xxx simple</td><td>java email simple</td></tr><tr><td>找空项目架子</td><td>xxx starter</td><td>SpringBoot starter</td></tr><tr><td>找技术教程</td><td>xxx tutorial</td><td>python tutorial</td></tr></tbody></table><h3 id="生产力小技巧"><a href="#生产力小技巧" class="headerlink" title="生产力小技巧"></a>生产力小技巧</h3><h4 id="给git库做标签"><a href="#给git库做标签" class="headerlink" title="给git库做标签"></a>给git库做标签</h4><ul><li><strong>codeshelver：</strong></li></ul><p>观察的项目如果多了，怎么管理？用<a href="https://www.codeshelver.com/" target="_blank" rel="noopener">codeshelver</a>，安装扩展之后，可以对GitHub项目做标签。</p><h4 id="利用git与github做wiki"><a href="#利用git与github做wiki" class="headerlink" title="利用git与github做wiki"></a>利用git与github做wiki</h4><ul><li><strong>gollum：</strong></li></ul><p><a href="https://github.com/github/gollum" target="_blank" rel="noopener">gollum</a>是一个基于git的轻型wiki系统。</p><h4 id="监测重点项目"><a href="#监测重点项目" class="headerlink" title="监测重点项目"></a>监测重点项目</h4><ul><li><strong>GitHubwatcher:</strong></li></ul><p><a href="https://github.com/DAddYE/githubwatcher" target="_blank" rel="noopener">GitHubwatcher</a>适用于通知不频繁的情景。</p><h4 id="GitHub官方资源"><a href="#GitHub官方资源" class="headerlink" title="GitHub官方资源"></a>GitHub官方资源</h4><p>GitHub官方列出了<a href="http://help.github.com/userscripts-and-bookmarklets/" target="_blank" rel="noopener">一些有用的脚本与书签</a>。</p><h4 id="社区驱动的安装与配置文件"><a href="#社区驱动的安装与配置文件" class="headerlink" title="社区驱动的安装与配置文件"></a>社区驱动的安装与配置文件</h4><p>GitHub中各类配置文件层出不穷，一些常用的：</p><ul><li><a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">osh-my-zsh</a>：将终端从bash改为zsh之后，可考虑安装社区驱动的zsh配置文件，含有多个插件。可参考旧文<a href="http://www.yangzhiping.com/tech/zsh-oh-my-zsh.html" target="_blank" rel="noopener">zsh与oh-my-zsh</a></li><li><a href="https://github.com/GitHub/gitignore" target="_blank" rel="noopener">gitignore</a>：GitHub官方出品</li><li><a href="https://github.com/ericpaulbishop/yourchili" target="_blank" rel="noopener">yourchili</a>:服务器各类安装shell，比如安装nginx等。</li></ul><h3 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h3><h4 id="写作"><a href="#写作" class="headerlink" title="写作"></a>写作</h4><p>早在2008年，就有技术图书作者<a href="https://github.com/blog/91-not-just-code" target="_blank" rel="noopener">通过Git来写作</a>，以下是示范：</p><ul><li><a href="https://github.com/ManuelKiessling/NodeBeginnerBook" target="_blank" rel="noopener">Node.js初学者教材</a>，中文版<a href="http://www.nodebeginner.org/index-zh-cn.html" target="_blank" rel="noopener">在这里</a>。</li><li><a href="https://github.com/addyosmani/backbone-fundamentals" target="_blank" rel="noopener">backbone基础</a></li><li><a href="https://github.com/cschneid/sinatra-book" target="_blank" rel="noopener">Sinatra教程</a></li></ul><p>你能想到的技术前沿话题，大多能在GitHub找到相应的培训材料或者开源图书。</p><p>个人写作照样适用。在前文<a href="http://www.yangzhiping.com/tech/writing-space.html" target="_blank" rel="noopener">理想的写作环境：Git+GitHub+Markdown+Jekyll</a>，我已经格外赞美过这些美好事物了。</p><p>暖色调的灯光，足够宽度的工作台，听着清脆的键盘声音，基于Git、GitHub、Markdown与Jekyll来写作，不担心写废与排版，只关注最纯粹的写作，是一种享受。我有时候会想，如果Git、Github、Markdown、Jekyll，再加上Yaml、Json的作者，让这些作者们重新来设计今天互联网基础架构偏文本的部分，会诞生一些什么？</p><h4 id="个人博客"><a href="#个人博客" class="headerlink" title="个人博客"></a>个人博客</h4><p>可以在Github上快速搭建一个基于jekyll的博客系统</p><ul><li>Jekyll：参考<a href="http://www.yangzhiping.com/tech/wordpress-to-jekyll.html" target="_blank" rel="noopener">告别wordpress，拥抱jekyll</a></li><li>Octopress：参考<a href="http://www.yangzhiping.com/tech/octopress.html" target="_blank" rel="noopener">Ruby开源项目介绍(1)：octopress——像黑客一样写博客</a></li><li>GitHub Pages：参考<a href="http://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a></li></ul><h4 id="演讲"><a href="#演讲" class="headerlink" title="演讲"></a>演讲</h4><p>借助于GitHub，可以享受更纯粹、更酷的演讲</p><ul><li>通过<a href="http://speakerdeck.com/" target="_blank" rel="noopener">speakerdeck</a>更好的分享ppt文档</li><li>使用GitHub著名传教士、Progit作者Scott Chacon开发的<a href="https://github.com/schacon/showoff" target="_blank" rel="noopener">showoff</a></li><li>来自开源社区的其他演讲库<a href="https://github.com/bartaz/impress.js" target="_blank" rel="noopener">impress.js</a></li></ul><h4 id="找工作"><a href="#找工作" class="headerlink" title="找工作"></a>找工作</h4><p>因为GitHub上的代码无法造假，也容易通过你关注的项目来了解知识面的宽度与深度。现在越来越多知名公司活跃在GitHub，发布开源库并招募各类人才</p><p>fredwu是Ruby中文社区活跃份子，他的开源项目<a href="https://github.com/fredwu/angel_nest" target="_blank" rel="noopener">angel_nest</a>，一个天使投资与创业者对接的网站，适合Ruby初学者升级为Ruby中级开发者时学习，也在Hacker News上被<a href="http://news.ycombinator.com/item?id=2895133" target="_blank" rel="noopener">热烈讨论</a>过，让我们来看看他的简历：<a href="http://resume.github.com/?fredwu" target="_blank" rel="noopener">http://resume.GitHub.com/?fredwu</a></p><p>简历生成器:登陆网站<a href="http://resume.github.com/" target="_blank" rel="noopener">GitHub简历生成器</a>，填入你的GitHub网站用户名即可。</p><p>第三方网站提供基于GitHub的人才招聘服务，例如：</p><ul><li><a href="http://githire.com/" target="_blank" rel="noopener">GitHire</a>:通过它，可以找出你所在地区的程序员。</li><li><a href="http://www.gitalytics.com/" target="_blank" rel="noopener">Gitalytics.com</a>：通过它，能评估某位程序员在GitHub、LinkedIn、StackOverflow、hackernews等多个网站的影响力。</li></ul><h3 id="链接与资源"><a href="#链接与资源" class="headerlink" title="链接与资源"></a>链接与资源</h3><ul><li>图形化客户端<ul><li><a href="http://mac.github.com/" target="_blank" rel="noopener">GitHub for Mac (OSX, 免费)</a></li></ul></li><li>指南和手册<ul><li><a href="http://help.github.com/" target="_blank" rel="noopener">GitHub 帮助</a></li></ul></li></ul><p>More info: <a href="http://rogerdudler.github.io/git-guide/index.zh.html" target="_blank" rel="noopener">Github 简明指南</a> <a href="http://www.yangzhiping.com/tech/github.html" target="_blank" rel="noopener">如何高效利用GitHub</a></p>]]></content>
      
      
        <tags>
            
            <tag> git </tag>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Git流程</title>
      <link href="/2016/01/13/Git%E6%B5%81%E7%A8%8B/"/>
      <url>/2016/01/13/Git%E6%B5%81%E7%A8%8B/</url>
      <content type="html"><![CDATA[<p>文章介绍Git的项目工作流程。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="基本流程"><a href="#基本流程" class="headerlink" title="基本流程"></a>基本流程</h3><h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><p><img src="/image/Git流程/Git流程_001.png" alt=""></p><ul><li>Workspace：工作区 就是你在电脑里能看到的目录。</li><li>Index / Stage：暂存区 英文叫stage, 或index。一般存放在 “.git目录下” 下的index文件（.git/index）中，所以我们把暂存区有时也叫作索引（index）。</li><li>Repository：仓库区（或本地仓库） 工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。</li><li>Remote：远程仓库 Git服务器的仓库(自己搭建或者托管平台),存储对应项目代码</li></ul><h4 id="一般工作流程如下"><a href="#一般工作流程如下" class="headerlink" title="一般工作流程如下"></a>一般工作流程如下</h4><ol><li>git clone:克隆 Git 资源作为工作目录。</li><li>在克隆的资源上添加或修改文件。注意：修改前保证代码的最新，不然提交可能产生冲突需要解决（git pull）</li><li>git add:提交修改或者新增到暂存库。</li><li>git diff:在提交前查看修改。错误，可以撤回提交（git reset HEAD）</li><li>git commit：提交修改到本地仓库。如果错误，可以撤回提交（git reset commit_id 或 git revert）</li><li>git push:提交修改到远端仓库。</li></ol><h4 id="更新代码"><a href="#更新代码" class="headerlink" title="更新代码"></a>更新代码</h4><ol><li>git fetch origin master 从远程的origin的master主分支下载最新的版本到origin/master分支上   </li><li>git stash 把当前修改放入暂存库    </li><li>git log -p master origin/master 比较本地的master分支和origin/master分支的差别    </li><li>git merge origin/master 合并master代码到当前分支   </li><li>git stash pop 把修改从暂存看恢复回来来</li></ol><h3 id="流程类型"><a href="#流程类型" class="headerlink" title="流程类型"></a>流程类型</h3><h4 id="1-集中式工作流"><a href="#1-集中式工作流" class="headerlink" title="1.集中式工作流"></a>1.集中式工作流</h4><p>类似<code>Subversion</code>，集中式工作流让你无需去适应一个全新流程就可以体验<code>Git</code>带来的收益。这个工作流也可以作为向更<code>Git</code>风格工作流迁移的友好过渡。</p><p><img src="/image/Git流程/Git流程_002.png" alt=""></p><h5 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.合并上游的修改到自己的仓库</span></span><br><span class="line">git pull --rebase origin master</span><br><span class="line"><span class="comment"># 2.查看冲突文件</span></span><br><span class="line">git status</span><br><span class="line"><span class="comment"># 3.修改完成后，用老套路暂存这些文件，并让git rebase完成剩下的事</span></span><br><span class="line">git add &lt;some-file&gt; </span><br><span class="line">git rebase --<span class="built_in">continue</span></span><br><span class="line"><span class="comment"># 4.修改完推送</span></span><br><span class="line">git push origin master</span><br><span class="line"><span class="comment"># 如果你碰到了冲突，但发现搞不定，不要惊慌。只要执行下面这条命令，就可以回到你执行git pull --rebase命令前的样子</span></span><br><span class="line">git rebase --abort</span><br></pre></td></tr></table></figure><h4 id="2-功能分支工作流"><a href="#2-功能分支工作流" class="headerlink" title="2.功能分支工作流"></a>2.功能分支工作流</h4><p>功能分支工作流以集中式工作流为基础，不同的是为各个新功能分配一个专门的分支来开发。这样可以在把新功能集成到正式项目前，用<code>Pull Requests</code>的方式讨论变更。</p><p><img src="/image/Git流程/Git流程_003.png" alt=""></p><h5 id="常用命令-1"><a href="#常用命令-1" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.在开始开发功能前，使用下面的命令新建一个分支：</span></span><br><span class="line">git checkout -b marys-feature master</span><br><span class="line"><span class="comment"># 2.这个新分支上，小红按老套路编辑、暂存和提交修改，按需要提交以实现功能</span></span><br><span class="line">git status</span><br><span class="line">git add &lt;some-file&gt;</span><br><span class="line">git commit</span><br><span class="line">git push -u origin marys-feature</span><br></pre></td></tr></table></figure><h4 id="3-Gitflow工作流"><a href="#3-Gitflow工作流" class="headerlink" title="3.Gitflow工作流"></a>3.Gitflow工作流</h4><p><code>Gitflow</code>工作流通过为功能开发、发布准备和维护分配独立的分支，让发布迭代过程更流畅。严格的分支模型也为大型项目提供了一些非常必要的结构。</p><p><img src="/image/Git流程/Git流程_004.png" alt=""></p><h5 id="常用命令-2"><a href="#常用命令-2" class="headerlink" title="常用命令"></a>常用命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.创建开发分支</span></span><br><span class="line">git branch develop</span><br><span class="line">git push -u origin develop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.基于develop分支产生功能分支</span></span><br><span class="line">git checkout -b some-feature develop</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.老套路添加提交到各自功能分支上：编辑、暂存、提交：</span></span><br><span class="line">git status</span><br><span class="line">git add &lt;some-file&gt;</span><br><span class="line">git commit</span><br><span class="line"><span class="comment"># 4.功能开发完合并到开发分支</span></span><br><span class="line">git pull origin develop</span><br><span class="line">git checkout develop</span><br><span class="line">git merge some-feature</span><br><span class="line">git push</span><br><span class="line">git branch -d some-feature</span><br><span class="line"><span class="comment"># 5.准备发布</span></span><br><span class="line">git checkout -b release-0.1 develop</span><br><span class="line"><span class="comment"># 6.完成发布，合并修改到master分支和develop分支上，删除发布分支</span></span><br><span class="line">git checkout master</span><br><span class="line">git merge release-0.1</span><br><span class="line">git push</span><br><span class="line">git checkout develop</span><br><span class="line">git merge release-0.1</span><br><span class="line">git push</span><br><span class="line">git branch -d release-0.1</span><br><span class="line"><span class="comment"># 7.发布分支是作为功能开发（develop分支）和对外发布（master分支）间的缓冲。只要有合并到master分支，就应该打好Tag以方便跟踪。</span></span><br><span class="line">git tag -a 0.1 -m <span class="string">"Initial public release"</span> master</span><br><span class="line">git push --tags</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.线上发现bug，从master分支上拉出了一个维护分支，提交修改以解决问题，然后直接合并回master分支</span></span><br><span class="line">git checkout -b issue-<span class="comment">#001 master</span></span><br><span class="line"><span class="comment"># Fix the bug</span></span><br><span class="line">git checkout master</span><br><span class="line">git merge issue-<span class="comment">#001</span></span><br><span class="line">git push</span><br><span class="line"><span class="comment"># 2.新加这些重要修改需要包含到develop分支，并删除维护分支</span></span><br><span class="line">git checkout develop</span><br><span class="line">git merge issue-<span class="comment">#001</span></span><br><span class="line">git push</span><br><span class="line">git branch -d issue-<span class="comment">#001</span></span><br></pre></td></tr></table></figure><h4 id="4-Forking工作流"><a href="#4-Forking工作流" class="headerlink" title="4.Forking工作流"></a>4.Forking工作流</h4><p><code>Forking</code>工作流是分布式工作流，充分利用了<code>Git</code>在分支和克隆上的优势。可以安全可靠地管理大团队的开发者（<code>developer</code>），并能接受不信任贡献者（<code>contributor</code>）的提交。</p><p><img src="/image/Git流程/Git流程_005.png" alt=""></p><h5 id="常用命令："><a href="#常用命令：" class="headerlink" title="常用命令："></a>常用命令：</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.项目维护者初始化正式仓库</span></span><br><span class="line">git init --bare /path/to/repo.git</span><br><span class="line"><span class="comment"># 2.开发者fork正式仓库</span></span><br><span class="line">git <span class="built_in">clone</span> https://user@bitbucket.org/user/repo.git</span><br><span class="line"><span class="comment"># 3.orking工作流需要2个远程别名 —— 一个指向正式仓库，另一个指向开发者自己的服务端仓库。别名的名字可以任意命名，常见的约定是使用origin作为远程克隆的仓库的别名 （这个别名会在运行git clone自动创建），upstream（上游）作为正式仓库的别名。</span></span><br><span class="line">git remote add upstream https://bitbucket.org/maintainer/repo</span><br><span class="line"><span class="comment"># 4.开发者开发自己的功能</span></span><br><span class="line">git checkout -b some-feature</span><br><span class="line"><span class="comment"># Edit some code</span></span><br><span class="line">git commit -a -m <span class="string">"Add first draft of some feature"</span></span><br><span class="line"><span class="comment"># 5.用git pull命令获得新的提交</span></span><br><span class="line">git pull upstream master</span><br><span class="line"><span class="comment"># 6.开发者发布自己的功能</span></span><br><span class="line">git push origin feature-branch</span><br><span class="line"><span class="comment"># 7.使用Pull Request提交到正式仓库</span></span><br><span class="line"><span class="comment"># 8.维护者需要从开发者的服务端仓库中fetch功能分支， 合并到他本地的master分支</span></span><br><span class="line">git fetch https://bitbucket.org/user/repo feature-branch</span><br><span class="line"><span class="comment"># 查看变更</span></span><br><span class="line">git checkout master</span><br><span class="line">git merge FETCH_HEAD</span><br><span class="line"><span class="comment"># 9.开发者和正式仓库做同步</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure><h4 id="5-Pull-Requests"><a href="#5-Pull-Requests" class="headerlink" title="5.Pull Requests"></a>5.Pull Requests</h4><p><code>Pull requests</code>是<code>Bitbucket</code>提供的让开发者更方便地进行协作的功能，提供了友好的<code>Web</code>界面可以在提议的修改合并到正式项目之前对修改进行讨论。</p><p>开发者向团队成员通知功能开发已经完成，<code>Pull Requests</code>是最简单的用法。 开发者完成功能开发后，通过<code>Bitbucket</code>账号发起一个<code>Pull Request</code>。 这样让涉及这个功能的所有人知道要去做<code>Code Review</code>和合并到<code>master</code>分支。</p><ul><li>在功能分支工作流中使用Pull Request</li></ul><p><img src="/image/Git流程/Git流程_006.png" alt=""></p><ul><li>在Gitflow工作流中使用Pull Request</li></ul><p><img src="/image/Git流程/Git流程_007.png" alt=""></p><ul><li>在Forking工作流中使用Pull Request</li></ul><p><img src="/image/Git流程/Git流程_008.png" alt=""></p><h3 id="企业日常开发模式探索"><a href="#企业日常开发模式探索" class="headerlink" title="企业日常开发模式探索"></a>企业日常开发模式探索</h3><p>解决的需求场景如下：</p><ul><li>能支持日常迭代开发、紧急线上bug修复、多功能并行开发</li><li>大概50人左右的团队，平日迭代项目较多，且周期短（1~2周一个迭代）</li><li>能够通过tag重建整个系统</li><li>支持code review</li><li>所有上线的代码必须都是经过测试保证，且能自动同步到下一次的迭代中</li><li>能和公司的项目管理/持续集成系统整合</li></ul><p><img src="/image/Git流程/Git流程_009.png" alt=""></p><ol><li>迭代需求会、冲刺会后确定本次迭代的目标后，将迭代内容视为一个项目，在 Gitlab 上创建一个 Repository，初始化工程代码结构，根据上线日期，比如20150730上线，开出分支 release20150730、dev20150730 两个分支，dev 分支作为日常开发主干分支，release 分支作为提测打包、Code Review 的分支。</li><li>迭代开始，日常开发进行中，开发人员在 dev 分支上进行 Commit、Push 代码，并且解决掉日常协同开发中的冲突等问题，等到达到提测条件的时候，提测者，首先 Merge Master 分支上的最新代码 <code>git merge --no-ff origin/master</code> ，使得 Master 分支上的变更更新到迭代开发分支dev上面，之后，在 Gitlab 上面发起 <code>pull request</code> 请求，并指定 Code Review 人，请求的分支选择本次上线的 release 分支，即 release20150730。</li><li>被指定 Code Review 的人，对发起者的代码 Review 后，决定是否可以提交测试，若有问题，评论注释代码后，提交者对代码进行进行修改，重复步骤2，直到代码 Review 者认为 Ok。之后便可以借助自己公司的打包部署，对这些代码发布到测试环境验证。</li><li>步骤2-3重复多次后，就会达到一个稳定可发布的版本，即上线版本，上线后，将 release 版本上面最后的提交（图中0.2.4上线对应处）合并到 Master 分支上面，并打 Tag0.3。至此，一次完整的迭代开发完成。</li><li>若此次上线后，不久发现生产环境有 Bug 需要修复，则从 Tag 处新开分支 release_bugfix_20150731、dev_bugfix_20150731 ，开发人员从 dev_bugfix_20150731分支上进行开发，提测code review在 release_bugfix_20150731 分支上，具体步骤参考2-3，测试环境验证通过后，发布到线上，验证OK，合并到 Master 分支，并打 Tag0.2.3，此次 Bug 修复完毕，专为解 Bug 而生的这两个分支可以退伍了，删除release_bugfix_20150731、dev_bugfix_20150731两分支即可。（所有的历史 Commit 信息均已经提交到了 Master 分支上，不用担心丢失）</li></ol><p><img src="/image/Git流程/Git流程_010.png" alt=""></p><ul><li>master：master永远是线上代码，最稳定的分支，存放的是随时可供在生产环境中部署的代码，当开发活动告一段落，产生了一份新的可供部署的代码时，发布成功之后，代码才会由 aone2 提交到 master，master 分支上的代码会被更新。应用上 aone2 后禁掉所有人的 master的写权限</li><li>develop：保存当前最新开发成果的分支。通常这个分支上的代码也是可进行每日夜间发布的代码，只对开发负责人开放develop权限。</li><li>feature: 功能特性分支，每个功能特性一个 feature/ 分支，开发完成自测通过后合并入 develop 分支。可以从 master 或者develop 中拉出来。</li><li>hotfix: 紧急bug分支修复分支。修复上线后，可以直接合并入master。</li></ul><p><img src="/image/Git流程/Git流程_011.png" alt=""></p><ul><li>master：master永远是线上代码，最稳定的分支，存放的是随时可供在生产环境中部署的代码，当开发活动告一段落，产生了一份新的可供部署的代码时，发布成功之后，代码才会由 aone2 提交到 master，master 分支上的代码会被更新。应用上 aone2 后禁掉所有人的 master的写权限</li><li>develop：保存当前最新开发成果的分支。通常这个分支上的代码也是可进行每日夜间发布的代码，只对开发负责人开放develop权限。</li><li>feature: 功能特性分支，每个功能特性一个 feature/ 分支，开发完成自测通过后合并入 develop 分支。可以从 master 或者develop 中拉出来。</li><li>hotfix: 紧急bug分支修复分支。修复上线后，可以直接合并入master。</li></ul>]]></content>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Git常用命令</title>
      <link href="/2015/12/13/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2015/12/13/Git%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<p>Git是一个开源的分布式版本控制系统，用于敏捷高效地处理项目。文章介绍Git的常用命令。<br><a id="more"></a></p><h2 id="Quick-Guide"><a href="#Quick-Guide" class="headerlink" title="Quick Guide"></a>Quick Guide</h2><h3 id="基本命令"><a href="#基本命令" class="headerlink" title="基本命令"></a>基本命令</h3><ul><li><p>1.工作区域</p><p>  <img src="/image/Git常用命令_001.jpg" alt=""></p><ul><li>工作区(workspace)：就是你在电脑里能看到的目录。</li><li>暂存区(Index/Stage)：英文叫stage, 或index。一般存放在 “.git目录下” 下的index文件（.git/index）中，所以我们把暂存区有时也叫作索引（index）。</li><li>版本库(master):工作区有一个隐藏目录.git，这个不算工作区，而是Git的版本库。</li><li>远端仓库(Remote): Git服务器的仓库(自己搭建或者托管平台),存储对应项目代码</li></ul></li><li><p>2.文件的状态</p><ul><li>未修改(Origin)</li><li>已修改(Modified)</li><li>已暂存(Staged)</li><li>已提交(Committed)</li><li>已推送(Pushed)</li></ul></li><li><p>3.基本操作</p><ul><li><p>git add:把工作区的文件放入暂存区</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git add &lt;path&gt; <span class="comment"># 把工作区的文件修改提交到暂存区</span></span><br><span class="line">git add . <span class="comment"># 提交工作区的所有文件修改</span></span><br></pre></td></tr></table></figure></li><li><p>git commit：把文件从暂存区提交进本地仓库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git commit -m <span class="string">"the commit message"</span> <span class="comment"># 提交当前暂存区的修改记录</span></span><br><span class="line">git commit -a <span class="comment"># 会先把所有已经track的文件的改动`git add`进来，然后提交。</span></span><br><span class="line">git commit --amend <span class="comment"># 增补提交，会使用与当前提交节点相同的父节点进行一次新的提交，旧的提交将会被取消。</span></span><br></pre></td></tr></table></figure></li><li><p>git push:把文件从本地仓库推送进远程仓库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git push &lt;远程主机名&gt; &lt;本地分支名&gt;:&lt;远程分支名&gt; <span class="comment"># 从 Git 本地仓库中更新到远端仓库</span></span><br><span class="line">git push origin [tagname] <span class="comment"># 分享标签</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>4.检查修改以及回滚</p><ul><li><p>git diff:在提交前工作目录中当前文件和暂存区域快照之间的差异,。如果错误，可以撤回提交（git reset HEAD）</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git diff &lt;file&gt; <span class="comment"># 比较当前文件和暂存区文件差异</span></span><br><span class="line">git diff &lt;id1&gt;&lt;id1&gt;&lt;id2&gt; <span class="comment"># 比较两次提交之间的差异</span></span><br><span class="line">git diff &lt;branch1&gt; &lt;branch2&gt; <span class="comment"># 在两个分支之间比较</span></span><br><span class="line">git diff <span class="comment"># 比较未修改和已修改后差异---已修改，未暂存</span></span><br><span class="line">git diff --staged <span class="comment"># 比较暂存区和版本库差异---已未暂存，未提交</span></span><br><span class="line">git diff --cached <span class="comment"># 比较暂存区和版本库差异---已未暂存，未提交</span></span><br><span class="line">git diff &lt;当前分支&gt; &lt;远程主机名/远端分支&gt; <span class="comment"># 比较本地分支和远端分支的差异---已提交，未推送</span></span><br><span class="line">git diff --<span class="built_in">stat</span> <span class="comment"># 仅仅比较统计信息</span></span><br></pre></td></tr></table></figure></li><li><p>git reset:将HEAD指向的位置改变为之前存在的某个版本,用于撤消之前的一些操作(add, commit)</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard <span class="comment"># 回退到上个版本，放弃版本后的修改、暂存和提交</span></span><br><span class="line">git reset --mixed <span class="comment"># mixed是默认参数，回退到上个版本，放弃版本后的暂存和提交</span></span><br><span class="line">git reset --soft <span class="comment"># 回退到上个版本，放弃版本后的提交</span></span><br><span class="line">git reset --hard HEAD~n <span class="comment"># 回退n个版本</span></span><br><span class="line">git reset --hard &lt;commit_id&gt; <span class="comment"># 回滚到指定版本，修改不能保存</span></span><br></pre></td></tr></table></figure></li><li><p>git revert:同reset，只不过撤销操作之前和之后的commit和history都会保留，并且把这次撤销作为一次最新的提交</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git revert HEAD <span class="comment"># 撤销前一次 commit</span></span><br><span class="line">git revert HEAD^ <span class="comment"># 撤销前前一次 commit</span></span><br><span class="line">git revert &lt;commit-id&gt; <span class="comment"># 撤回指定commit-id</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>5.其他基本命令</p><ul><li><p>git init：初始化一个 Git 仓库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init newrepo <span class="comment"># 指定目录作为Git仓库</span></span><br></pre></td></tr></table></figure></li><li><p>git config：命令用于获取并设置存储库或全局选项</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">"xiaoming"</span> <span class="comment"># 设置全局用户名</span></span><br><span class="line">git config --global user.email <span class="string">"xiaoming@gmail.com"</span> <span class="comment"># 设置全局邮箱</span></span><br><span class="line">git config --global core.editor emacs <span class="comment"># 设置编缉器</span></span><br><span class="line">git config --global merge.tool vimdiff <span class="comment"># 设置比较工具，比较工具用来解决合并时的冲突</span></span><br><span class="line">git config --list <span class="comment"># 检查配置</span></span><br></pre></td></tr></table></figure></li><li><p>git clone:克隆 Git 资源作为工作目录。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> &lt;repo&gt; &lt;directory&gt; <span class="comment"># 从现有 Git 仓库中拷贝项目克隆到指定的目录</span></span><br></pre></td></tr></table></figure></li><li><p>git pull:是从远程获取最新版本到本地，并自动merge</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull &lt;远程主机名&gt; &lt;远程分支名&gt;:&lt;本地分支名&gt; <span class="comment"># 从 Git 远端仓库中更新到本地仓库</span></span><br></pre></td></tr></table></figure></li><li><p>git status:显示文件修改是否被暂存或者tracked。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git status</span><br></pre></td></tr></table></figure></li><li><p>git branch：用于列出，创建或删除分支。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git branch <span class="comment"># 查看当前有哪些分支</span></span><br><span class="line">git branch &lt;分支&gt; <span class="comment"># 新建分支</span></span><br><span class="line">git branch -d &lt;分支&gt; <span class="comment"># 删除分支</span></span><br></pre></td></tr></table></figure></li><li><p>git checkout:用于切换分支或恢复工作树文件。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git checkout &lt;文件&gt; <span class="comment"># 还原文件的修改</span></span><br><span class="line">git checkout &lt;分支&gt; <span class="comment"># 切换分支</span></span><br><span class="line">git checkout -b &lt;分支&gt; <span class="comment"># 创建并切换分支</span></span><br></pre></td></tr></table></figure></li><li><p>git log:用于显示提交日志信息</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> [&lt;options&gt;] [&lt;revision range&gt;] [[\--] &lt;path&gt;…]</span><br></pre></td></tr></table></figure></li><li><p>git stash:用于将改过的被追踪的文件和暂存的变更储藏在脏工作目录中（refs/stas）</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git stash <span class="comment"># 将当前的修改和暂存储藏存储起来，用于更新远端分支产生冲突时候</span></span><br><span class="line">git stash list <span class="comment"># 查看储藏</span></span><br><span class="line">git stash pop <span class="comment"># 释放储藏</span></span><br></pre></td></tr></table></figure></li><li><p>git fetch:命令用于从另一个存储库下载对象和引用。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git fetch origin <span class="comment"># 从远程refs/heads/命名空间复制所有分支，并将它们存储到本地的refs/remotes/origin/命名空间中</span></span><br><span class="line">git fetch &lt;远程主机名&gt; &lt;分支名&gt; <span class="comment"># 更新远程主机的分支到本地</span></span><br></pre></td></tr></table></figure></li><li><p>git merge:用于将两个或两个以上的开发历史加入(合并)一起</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git merge &lt;分支&gt;1… &lt;分支2&gt;… <span class="comment"># 合并分支到当前分支</span></span><br><span class="line">git merge &lt;远程主机名/分支名&gt; <span class="comment"># 合并fetch的分支到当前分支</span></span><br></pre></td></tr></table></figure></li><li><p>git rebase:用于把一个分支的修改合并到当前分支,放弃一个分支的记录</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git rebase &lt;分支&gt;1… &lt;分支2&gt;… <span class="comment"># 合并分支到当前分支</span></span><br><span class="line">git rebase &lt;远程主机名/分支名&gt; <span class="comment"># 合并fetch的分支到当前分支</span></span><br></pre></td></tr></table></figure></li><li><p>git remote:管理一组跟踪的存储库</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote -v <span class="comment"># 列出已经存在的远程分支的详细信息</span></span><br><span class="line">git remote add &lt;shortname&gt; &lt;url&gt; <span class="comment"># 添加远程仓库</span></span><br></pre></td></tr></table></figure></li><li><p>git help:显示有关Git的帮助信息。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">help</span> &lt;verb&gt; <span class="comment"># 显示命令的帮助信息</span></span><br><span class="line">git &lt;verb&gt; --<span class="built_in">help</span> <span class="comment"># 显示命令的帮助信息</span></span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul><li><p>git rm：用于从工作区和索引中删除文件</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rm [-f | --force] [-n] [-r] [--cached] [--ignore-unmatch] [--quiet] [--] &lt;file&gt;…</span><br></pre></td></tr></table></figure></li><li><p>git mv：用于移动或重命名文件，目录或符号链接</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git mv &lt;options&gt;… &lt;args&gt;…</span><br></pre></td></tr></table></figure></li><li><p>git mergetool:用于运行合并冲突解决工具来解决合并冲突</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git mergetool [--tool=&lt;tool&gt;] [-y | --[no-]prompt] [&lt;file&gt;…]</span><br></pre></td></tr></table></figure></li><li><p>git tag：用于创建，列出，删除或验证使用GPG签名的标签对象。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git tag <span class="comment"># 列显已有的标签</span></span><br><span class="line">git tag -a &lt;tag-name&gt;-m <span class="string">'version info'</span> <span class="comment"># 创建标签</span></span><br><span class="line">git tag -s &lt;tag-name&gt;-m <span class="string">'version info'</span> <span class="comment"># 签署标签</span></span><br><span class="line">git tag -d <span class="comment"># 删除标签</span></span><br><span class="line">git tag &lt;tag-name&gt; <span class="comment"># 创建轻量级标签</span></span><br><span class="line">git tag -v &lt;tag-name&gt; <span class="comment"># 验证标签</span></span><br><span class="line">git tag -a &lt;tag-name&gt; &lt;<span class="built_in">command</span>-id&gt; <span class="comment"># 后期加注标签</span></span><br></pre></td></tr></table></figure></li><li><p>git submodule:用于初始化，更新或检查子模块(另外一个仓库)</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git submodule add &lt;url&gt; <span class="comment"># 添加子模块</span></span><br><span class="line">git submodule init <span class="comment"># 初始化本地配置文件的子模块</span></span><br><span class="line">git submodule update <span class="comment"># 更新子模块</span></span><br></pre></td></tr></table></figure></li><li><p>git show:用于显示各种类型的对象</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git show [options] &lt;object&gt;…​ <span class="comment"># 显示一个或多个对象(blobs，树，标签和提交)</span></span><br></pre></td></tr></table></figure></li><li><p>git shortlog:用于汇总git日志输出</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git shortlog <span class="comment"># 返回这个 git repository 底下每个用户进行 commit 的次数，以及每次 commit 的注释</span></span><br></pre></td></tr></table></figure></li><li><p>git describe:显示离当前提交最近的标签。</p>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git describe [--all] [--tags] [--contains] [--abbrev=&lt;n&gt;] [&lt;commit-ish&gt;…​]</span><br></pre></td></tr></table></figure></li></ul><p>More info: <a href="https://git-scm.com/docs" target="_blank" rel="noopener">Git 完整命令手册</a></p>]]></content>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署Git</title>
      <link href="/2015/11/23/%E9%83%A8%E7%BD%B2Git/"/>
      <url>/2015/11/23/%E9%83%A8%E7%BD%B2Git/</url>
      <content type="html"><![CDATA[<p>这是一个简单的指导说明，介绍如何git部署和配置使用.<br><a id="more"></a></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><a href="https://git-scm.com/download/gui/windows" target="_blank" rel="noopener">下载地址</a></p><h3 id="配置Git"><a href="#配置Git" class="headerlink" title="配置Git"></a>配置Git</h3><ul><li>首先在本地创建<code>ssh key</code>,后面的<a href="mailto:`your_email@youremail.com" target="_blank" rel="noopener">`your_email@youremail.com</a>`改为你在github上注册的邮箱，之后会要求确认路径和输入密码，我们这使用默认的一路回车就行。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C <span class="string">"your_email@youremail.com"</span></span><br></pre></td></tr></table></figure><p>💡 默认在 <code>.ssh</code>下面生成两个两个文件 私钥:<code>id_rsa</code>  公钥:<code>id_rsa.pub</code></p><ul><li><p>在<code>~/</code>下生成<code>.ssh</code>文件夹，进去，打开<code>id_rsa.pub</code>，复制里面的<code>key</code>。</p><p>  💡 注:修改公钥最后的字符只会影响名字</p></li><li><p>回到github上，进入 Account Settings（账户配置），左边选择SSH Keys，Add SSH Key,title随便填，粘贴在你电脑上生成的key。<br><img src="/image/部署Git/部署Git_001.png" alt=""></p></li><li><p>为了验证是否成功，在git bash下输入：</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><ul><li>如果是第一次的会提示是否continue，输入yes就会看到：You’ve successfully authenticated, but GitHub does not provide shell access 。这就表示已成功连上github。</li><li>设置username和email</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name <span class="string">"your name"</span></span><br><span class="line">git config --global user.email <span class="string">"your_email@youremail.com"</span></span><br></pre></td></tr></table></figure><ul><li>进入要上传的仓库，右键git bash，添加远程地址：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote add origin git@github.com:yourName/yourRepo.git</span><br></pre></td></tr></table></figure><h3 id="使用多个密钥"><a href="#使用多个密钥" class="headerlink" title="使用多个密钥"></a>使用多个密钥</h3><ul><li>1.通过上面方式创建多对密钥和公钥,只不过每次创建需要修改不同名称,防止第二次覆盖</li><li>2.修改<code>.ssh</code>下面的<strong><code>config</code></strong>文件,按照下面模板每一对密钥和公钥需要配置对应 <code>Host</code>和<code>公钥位置</code></li></ul><p><img src="/image/部署Git/部署Git_002.png" alt=""></p><ul><li>3.更新代码需要把<code>github.com</code>替换成 对应配置Host</li></ul><h3 id="链接与资源"><a href="#链接与资源" class="headerlink" title="链接与资源"></a>链接与资源</h3><ul><li>图形化客户端<ul><li><a href="http://www.git-tower.com/" target="_blank" rel="noopener">Tower (OSX)</a></li><li><a href="http://www.sourcetreeapp.com/" target="_blank" rel="noopener">Source Tree (OSX, 免费)</a></li><li><a href="https://itunes.apple.com/gb/app/gitbox/id403388357?mt=12" target="_blank" rel="noopener">GitBox (OSX, App Store)</a></li></ul></li></ul><p>More info:  <a href="http://think-like-a-git.net/" target="_blank" rel="noopener">像 git 那样思考</a> <a href="http://marklodato.github.io/visual-git-guide/index-zh-cn.html" target="_blank" rel="noopener">图解 Git</a></p>]]></content>
      
      
        <tags>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署Tomcat</title>
      <link href="/2015/10/26/%E9%83%A8%E7%BD%B2Tomcat/"/>
      <url>/2015/10/26/%E9%83%A8%E7%BD%B2Tomcat/</url>
      <content type="html"><![CDATA[<p>Tomcat 是由 Apache 开发的一个 Servlet 容器，实现了对 Servlet 和 JSP 的支持，并提供了作为Web服务器的一些特有功能。文章介绍如何在居于Centos7.5安装Tomcat。<br><a id="more"></a></p><h2 id="Quick-Deploy"><a href="#Quick-Deploy" class="headerlink" title="Quick Deploy"></a>Quick Deploy</h2><h3 id="部署准备"><a href="#部署准备" class="headerlink" title="部署准备"></a>部署准备</h3><ul><li>1.参照下表格检查环境的JDK版本是否满足(Tomcat 8.5 要求 JDK 版本为 1.7 以上)</li></ul><table><thead><tr><th>Servlet Spec</th><th>JSP Spec</th><th>EL Spec</th><th>WebSocket Spec</th><th>JASPIC Spec</th><th>Apache Tomcat Version</th><th>Latest Released Version</th><th>Supported Java Versions</th></tr></thead><tbody><tr><td>4.0</td><td>2.3</td><td>3.0</td><td>1.1</td><td>1.1</td><td>9.0.x</td><td>9.0.6</td><td>8 and later</td></tr><tr><td>3.1</td><td>2.3</td><td>3.0</td><td>1.1</td><td>1.1</td><td>8.5.x</td><td>8.5.29</td><td>7 and later</td></tr><tr><td>3.1</td><td>2.3</td><td>3.0</td><td>1.1</td><td>N/A</td><td>8.0.x (superseded)</td><td>8.0.50 (superseded)</td><td>7 and later</td></tr><tr><td>3.0</td><td>2.2</td><td>2.2</td><td>1.1</td><td>N/A</td><td>7.0.x</td><td>7.0.85</td><td>6 and later(7 and later for WebSocket)</td></tr><tr><td>2.5</td><td>2.1</td><td>2.1</td><td>N/A</td><td>N/A</td><td>6.0.x (archived)</td><td>6.0.53 (archived)</td><td>5 and later</td></tr><tr><td>2.4</td><td>2.0</td><td>N/A</td><td>N/A</td><td>N/A</td><td>5.5.x (archived)</td><td>5.5.36 (archived)</td><td>1.4 and later</td></tr><tr><td>2.3</td><td>1.2</td><td>N/A</td><td>N/A</td><td>N/A</td><td>4.1.x (archived)</td><td>4.1.40 (archived)</td><td>1.3 and later</td></tr><tr><td>2.2</td><td>1.1</td><td>N/A</td><td>N/A</td><td>N/A</td><td>3.3.x (archived)</td><td>3.3.2 (archived)</td><td>1.1 and later</td></tr></tbody></table><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whereis java</span><br></pre></td></tr></table></figure><ul><li>2.安装JDK(详细请自行查询)</li></ul><h3 id="安装和配置"><a href="#安装和配置" class="headerlink" title="安装和配置"></a>安装和配置</h3><ul><li>1.下载安装包</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-8/v8.5.37/bin/apache-tomcat-8.5.37.tar.gz</span><br></pre></td></tr></table></figure><ul><li>2.解压安装包</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf apache-tomcat-8.5.37.tar.gz</span><br></pre></td></tr></table></figure><ul><li>3.启动 Tomcat</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./apache-tomcat-8.5.37/bin/startup.sh</span><br></pre></td></tr></table></figure><ul><li>4.通过curl或者浏览器访问</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:8080</span><br></pre></td></tr></table></figure><p><img src="/image/部署OpenResty_001.png" alt=""></p><h3 id="重要目录说明"><a href="#重要目录说明" class="headerlink" title="重要目录说明"></a>重要目录说明</h3><ul><li>bin - Tomcat 脚本存放目录（如启动、关闭脚本）。 <em>.sh 文件用于 Unix 系统,</em>.bat 文件用于 Windows 系统</li><li>conf - Tomcat 配置文件目录<ul><li>server.xml 配置文件中的根元素。它的属性代表了整个 servlet 容器的特性。</li></ul></li><li>logs - Tomcat 默认日志目录</li><li>webapps - webapp 运行的目录</li></ul><h3 id="web-工程发布（例如jenkin）"><a href="#web-工程发布（例如jenkin）" class="headerlink" title="web 工程发布（例如jenkin）"></a>web 工程发布（例如jenkin）</h3><ul><li>1.打包好的 war 包放在 Tomcat 安装目录下的 webapps 目录下</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv jenkins.war apache-tomcat-8.5.37/webapps/</span><br></pre></td></tr></table></figure><ul><li>2.启动Tomcat(Tomcat 会自动解压 webapps 目录下的 war 包)</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./apache-tomcat-8.5.37/bin/startup.sh</span><br></pre></td></tr></table></figure><ul><li>3.通过curl或者浏览器访问</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:8080/jenkins</span><br></pre></td></tr></table></figure><p><img src="/image/部署OpenResty_002.png" alt=""></p><h3 id="web-项目路径结构"><a href="#web-项目路径结构" class="headerlink" title="web 项目路径结构"></a>web 项目路径结构</h3><ul><li>webapp                         站点根目录(例如解压后的jenkins目录)<ul><li>META-INF                   存放工程自身相关的一些信息，元文件信息，通常由开发工具，环境自动生成。<ul><li>MANIFEST.MF            配置清单文件</li></ul></li><li>WEB-INF                   Java web应用的安全目录。所谓安全就是客户端无法访问，只有服务端可以访问的目录<ul><li>classes                存放程序所需要的所有 Java class 文件<ul><li>*.class            程序需要的 class 文件</li><li>*.xml              程序需要的 xml 文件</li></ul></li><li>lib                    库文件夹<ul><li>*.jar              程序需要的 jar 包</li></ul></li><li>web.xml                Web应用程序的部署描述文件。它是工程中最重要的配置文件，它描述了 servlet 和组成应用的其它组件，以及应用初始化参数、安全管理约束等。</li></ul></li><li><userdir>                  自定义的目录</userdir></li><li><userfiles>                自定义的资源文件</userfiles></li></ul></li></ul><p><img src="/image/部署OpenResty_003.png" alt=""></p><p>More info: <a href="https://wiki.apache.org/tomcat/FrontPage" target="_blank" rel="noopener">Tomcat Wiki</a></p>]]></content>
      
      
        <tags>
            
            <tag> 环境部署 </tag>
            
            <tag> tomcat </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>部署博客</title>
      <link href="/2015/09/23/%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2/"/>
      <url>/2015/09/23/%E9%83%A8%E7%BD%B2%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<p>这是一个简单的指导说明，介绍如何使用github和hexo搭建一个自己的博客.<br><a id="more"></a></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="部署准备"><a href="#部署准备" class="headerlink" title="部署准备"></a>部署准备</h3><ul><li>1.本地安装<a href="https://git-scm.com/" target="_blank" rel="noopener">git</a>和<a href="https://nodejs.org/en/" target="_blank" rel="noopener">nodejs</a></li><li>2.去<a href="https://github.com/" target="_blank" rel="noopener">github</a>申请账号,并创建一个仓库(仓库名为账户名.github.io)</li></ul><h3 id="安装和配置hexo"><a href="#安装和配置hexo" class="headerlink" title="安装和配置hexo"></a>安装和配置hexo</h3><ul><li>1.安装hexo</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure><ul><li>2.安装git部署工具</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$  npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><ul><li>3.创建hexo的工程目录</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$  hexo init <span class="built_in">source</span>.账户名.github.io</span><br></pre></td></tr></table></figure><ul><li>4.设置git部署仓库</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> <span class="built_in">source</span>.账户名.github.io</span><br><span class="line">$ vim _config.yml</span><br><span class="line">$ deploy:</span><br><span class="line">    <span class="built_in">type</span>: git</span><br><span class="line">    repo: https://github.com/账户名/账户名.github.io.git</span><br><span class="line">    branch: master</span><br></pre></td></tr></table></figure><h3 id="部署hexo"><a href="#部署hexo" class="headerlink" title="部署hexo"></a>部署hexo</h3><ul><li>1.克隆仓库到本地</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/账户名/账户名.github.io.git</span><br></pre></td></tr></table></figure><ul><li>2.创建分支</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> 账户名.github.io</span><br><span class="line">$ git checkout -b <span class="built_in">source</span></span><br><span class="line">$ git branch -a</span><br></pre></td></tr></table></figure><ul><li>3.移动hexo工程到仓库</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv <span class="built_in">source</span>.账户名.github.io/* 账户名.github.io</span><br></pre></td></tr></table></figure><ul><li>4.保存源码到仓库</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add -A</span><br><span class="line">$ git commit -m <span class="string">"add source file"</span></span><br><span class="line">$ git push origin <span class="built_in">source</span></span><br></pre></td></tr></table></figure><ul><li>5.部署hexo</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d</span><br></pre></td></tr></table></figure><ul><li>6.访问博客</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ https://账户名.github.io</span><br></pre></td></tr></table></figure><h3 id="修改主题"><a href="#修改主题" class="headerlink" title="修改主题"></a>修改主题</h3><ul><li><p>1.下载主题放入themes目录下</p></li><li><p>2.修改_config.yml的theme为对应主题名</p></li><li><p>3.使主题生效</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清理静态文件</span></span><br><span class="line">hexo clean</span><br><span class="line"><span class="comment"># 生成静态文件</span></span><br><span class="line">hexo g </span><br><span class="line"><span class="comment"># 部署</span></span><br><span class="line">hexo d</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>More info: <a href="https://blog.csdn.net/qq_33699981/article/details/72716951" target="_blank" rel="noopener">优化主题</a> <a href="https://hexo.io/zh-cn/docs/commands.html" target="_blank" rel="noopener">hexo常用命令</a></p>]]></content>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
